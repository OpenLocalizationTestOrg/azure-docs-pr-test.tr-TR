## <a name="prepare-for-akv-integration"></a><span data-ttu-id="b77c5-101">AKV tümleştirme için hazırlama</span><span class="sxs-lookup"><span data-stu-id="b77c5-101">Prepare for AKV Integration</span></span>
<span data-ttu-id="b77c5-102">toouse Azure anahtar kasası tümleştirmeyi tooconfigure SQL Server VM'nize birkaç önkoşul vardır:</span><span class="sxs-lookup"><span data-stu-id="b77c5-102">toouse Azure Key Vault Integration tooconfigure your SQL Server VM, there are several prerequisites:</span></span> 

1. [<span data-ttu-id="b77c5-103">Azure PowerShell'i yükleme</span><span class="sxs-lookup"><span data-stu-id="b77c5-103">Install Azure Powershell</span></span>](#install-azure-powershell)
2. [<span data-ttu-id="b77c5-104">Bir Azure Active Directory oluşturun</span><span class="sxs-lookup"><span data-stu-id="b77c5-104">Create an Azure Active Directory</span></span>](#create-an-azure-active-directory)
3. [<span data-ttu-id="b77c5-105">Bir anahtar kasası oluşturma</span><span class="sxs-lookup"><span data-stu-id="b77c5-105">Create a key vault</span></span>](#create-a-key-vault)

<span data-ttu-id="b77c5-106">Merhaba aşağıdaki bölümlerde bu Önkoşullar ve toocollect çalıştırmak toolater hello PowerShell cmdlet'leri gereksinim hello bilgileri açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="b77c5-106">hello following sections describe these prerequisites and hello information you need toocollect toolater run hello PowerShell cmdlets.</span></span>

### <a name="install-azure-powershell"></a><span data-ttu-id="b77c5-107">Azure PowerShell'i yükleme</span><span class="sxs-lookup"><span data-stu-id="b77c5-107">Install Azure PowerShell</span></span>
<span data-ttu-id="b77c5-108">Yüklediğinizden emin olun en son Azure PowerShell SDK hello.</span><span class="sxs-lookup"><span data-stu-id="b77c5-108">Make sure you have installed hello latest Azure PowerShell SDK.</span></span> <span data-ttu-id="b77c5-109">Daha fazla bilgi için bkz: [nasıl tooinstall Azure PowerShell'i ve yapılandırma](/powershell/azureps-cmdlets-docs).</span><span class="sxs-lookup"><span data-stu-id="b77c5-109">For more information, see [How tooinstall and configure Azure PowerShell](/powershell/azureps-cmdlets-docs).</span></span>

### <a name="create-an-azure-active-directory"></a><span data-ttu-id="b77c5-110">Bir Azure Active Directory oluşturun</span><span class="sxs-lookup"><span data-stu-id="b77c5-110">Create an Azure Active Directory</span></span>
<span data-ttu-id="b77c5-111">Toohave gereken ilk olarak, bir [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) aboneliğinizde.</span><span class="sxs-lookup"><span data-stu-id="b77c5-111">First, you need toohave an [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) in your subscription.</span></span> <span data-ttu-id="b77c5-112">Birçok avantaj arasında bu, belirli kullanıcılar ve uygulamalar için toogrant izni tooyour anahtar kasasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="b77c5-112">Among many benefits, this allows you toogrant permission tooyour key vault for certain users and applications.</span></span>

<span data-ttu-id="b77c5-113">Ardından, bir uygulamanın AAD ile kaydedin.</span><span class="sxs-lookup"><span data-stu-id="b77c5-113">Next, register an application with AAD.</span></span> <span data-ttu-id="b77c5-114">Bu, VM ihtiyaç duyacağı erişim tooyour anahtar kasası olan bir hizmet sorumlusu hesabı verir.</span><span class="sxs-lookup"><span data-stu-id="b77c5-114">This will give you a Service Principal account that has access tooyour key vault which your VM will need.</span></span> <span data-ttu-id="b77c5-115">Hello Azure anahtar kasası makalede hello adımları bulabilirsiniz [bir uygulamayı Azure Active Directory ile kaydetme](../articles/key-vault/key-vault-get-started.md#register) bölüm veya hello ekran görüntüleri ile Merhaba adımları görebilirsiniz **hello uygulama için bir kimlik alma bölüm** , [bu blog gönderisine](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span><span class="sxs-lookup"><span data-stu-id="b77c5-115">In hello Azure Key Vault article, you can find these steps in hello [Register an application with Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) section, or you can see hello steps with screen shots in hello **Get an identity for hello application section** of [this blog post](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span></span> <span data-ttu-id="b77c5-116">Bu adımları gerçekleştirmeden önce aşağıdaki bilgilerle SQL VM üzerinde Azure anahtar kasası tümleştirmeyi etkinleştirdiğinizde, daha sonra gerekli bu kayıt sırasında toocollect hello gerektiğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="b77c5-116">Before completing these steps, note that you need toocollect hello following information during this registration that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

* <span data-ttu-id="b77c5-117">Merhaba uygulaması eklendikten sonra hello bulur **istemci kimliği** hello üzerinde **yapılandırma** sekmesi.   ![Azure Active Directory istemci kimliği](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span><span class="sxs-lookup"><span data-stu-id="b77c5-117">After hello application is added, find hello **CLIENT ID**  on hello **CONFIGURE** tab.   ![Azure Active Directory Client ID](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span></span>
  
    <span data-ttu-id="b77c5-118">Merhaba istemci kimliği, daha sonra toohello atandığı **$spName** hello PowerShell komut dosyası tooenable Azure anahtar kasası tümleştirmeyi parametresinde (hizmet asıl adı).</span><span class="sxs-lookup"><span data-stu-id="b77c5-118">hello client ID is assigned later toohello **$spName** (Service Principal name) parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span> 
* <span data-ttu-id="b77c5-119">Ayrıca, anahtarınızı oluşturduğunuzda, bu adımları sırasında hello gizli anahtarınız için hello ekran aşağıdaki gösterildiği gibi kopyalayın.</span><span class="sxs-lookup"><span data-stu-id="b77c5-119">Also, during these steps when you create your key, copy hello secret for your key as is shown in hello following screenshot.</span></span> <span data-ttu-id="b77c5-120">Bu anahtar sırrı sonraki toohello atanan **$spSecret** hello PowerShell Betiği parametresinde (hizmet sorumlusu gizli).</span><span class="sxs-lookup"><span data-stu-id="b77c5-120">This key secret is assigned later toohello **$spSecret** (Service Principal secret) parameter in hello PowerShell script.</span></span>  
    <span data-ttu-id="b77c5-121">![Azure Active Directory parolası](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span><span class="sxs-lookup"><span data-stu-id="b77c5-121">![Azure Active Directory Secret](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span></span>
* <span data-ttu-id="b77c5-122">Aşağıdaki erişim izinleri bu yeni istemci kimliği toohave hello yetkilendirmeniz gerekir: **şifrelemek**, **şifresini**, **wrapKey**, **unwrapKey**, **oturum**, ve **doğrulayın**.</span><span class="sxs-lookup"><span data-stu-id="b77c5-122">You must authorize this new client ID toohave hello following access permissions: **encrypt**, **decrypt**, **wrapKey**, **unwrapKey**, **sign**, and **verify**.</span></span> <span data-ttu-id="b77c5-123">Bu hello ile yapılır [kümesi AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) cmdlet'i.</span><span class="sxs-lookup"><span data-stu-id="b77c5-123">This is done with hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) cmdlet.</span></span> <span data-ttu-id="b77c5-124">Daha fazla bilgi için bkz: [Authorize hello uygulama toouse hello anahtar veya gizli](../articles/key-vault/key-vault-get-started.md#authorize).</span><span class="sxs-lookup"><span data-stu-id="b77c5-124">For more information see [Authorize hello application toouse hello key or secret](../articles/key-vault/key-vault-get-started.md#authorize).</span></span>

### <a name="create-a-key-vault"></a><span data-ttu-id="b77c5-125">Bir anahtar kasası oluşturma</span><span class="sxs-lookup"><span data-stu-id="b77c5-125">Create a key vault</span></span>
<span data-ttu-id="b77c5-126">VM ile şifreleme için kullanacağınız sipariş toouse Azure anahtar kasası toostore hello anahtarlarında erişim tooa anahtar kasası gerekir.</span><span class="sxs-lookup"><span data-stu-id="b77c5-126">In order toouse Azure Key Vault toostore hello keys you will use for encryption in your VM, you need access tooa key vault.</span></span> <span data-ttu-id="b77c5-127">Anahtar kasanız zaten ayarlamadıysanız hello hello adımları izleyerek oluşturun [Azure anahtar kasası ile çalışmaya başlama](../articles/key-vault/key-vault-get-started.md) konu.</span><span class="sxs-lookup"><span data-stu-id="b77c5-127">If you have not already set up your key vault, create one by following hello steps in hello [Getting Started with Azure Key Vault](../articles/key-vault/key-vault-get-started.md) topic.</span></span> <span data-ttu-id="b77c5-128">Bu adımları gerçekleştirmeden önce SQL VM üzerinde Azure anahtar kasası tümleştirmeyi etkinleştirdiğinizde, bu kurulum sırasında toocollect gereken bazı bilgiler daha sonra gerekli olduğuna dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="b77c5-128">Before completing these steps, note that there is some information you need toocollect during this set up that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

<span data-ttu-id="b77c5-129">Aldığınız toohello oluşturduğunuzda bir anahtar kasası adımı Not hello döndürülen **vaultUri** hello anahtar kasası URL'si özelliği.</span><span class="sxs-lookup"><span data-stu-id="b77c5-129">When you get toohello Create a key vault step, note hello returned **vaultUri** property, which is hello key vault URL.</span></span> <span data-ttu-id="b77c5-130">Bu adımda, aşağıda gösterilen sağlanan hello örnekte hello anahtar kasası adı ContosoKeyVault, bu nedenle hello anahtar kasası URL'si https://contosokeyvault.vault.azure.net/ olacaktır.</span><span class="sxs-lookup"><span data-stu-id="b77c5-130">In hello example provided in that step, shown below, hello key vault name is ContosoKeyVault, therefore hello key vault URL would be https://contosokeyvault.vault.azure.net/.</span></span>

    New-AzureRmKeyVault -VaultName 'ContosoKeyVault' -ResourceGroupName 'ContosoResourceGroup' -Location 'East Asia'

<span data-ttu-id="b77c5-131">Merhaba anahtar kasası URL'si sonraki toohello atanan **$akvURL** hello PowerShell komut dosyası tooenable Azure anahtar kasası tümleştirmeyi parametresi.</span><span class="sxs-lookup"><span data-stu-id="b77c5-131">hello key vault URL is assigned later toohello **$akvURL** parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span>

