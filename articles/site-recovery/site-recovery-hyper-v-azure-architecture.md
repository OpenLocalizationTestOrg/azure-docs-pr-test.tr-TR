---
title: "Site Recovery’de Azure’a Hyper-V çoğaltması nasıl işliyor? | Microsoft Belgeleri"
description: "Bu makalede, Hyper-V çoğaltmasının Azure Site Recovery’de nasıl çalıştığına dair genel bir bakış sağlanmaktadır"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/14/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: site-recovery-architecture-hyper-v-to-azure
ms.openlocfilehash: 6fa952af93033f82effdef418903fc93d94dd05c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="how-does-hyper-v-replication-to-azure-work"></a><span data-ttu-id="969d8-104">Azure’a Hyper-V çoğaltması nasıl işler?</span><span class="sxs-lookup"><span data-stu-id="969d8-104">How does Hyper-V replication to Azure work?</span></span>

<span data-ttu-id="969d8-105">Bu makaleyi, [Azure Site Recovery](site-recovery-overview.md) hizmeti kullanılarak Azure’a Hyper-V çoğaltması için iş akışlarını ve mimariyi anlamak üzere okuyun.</span><span class="sxs-lookup"><span data-stu-id="969d8-105">Read this article to understand the architecture and workflows for Hyper-V replication to Azure using the [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="969d8-106">Tüm yorumlarınızı bu makalenin alt kısmında veya [Azure Kurtarma Hizmetleri Forumu](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr)'nda paylaşabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="969d8-106">Post any comments at the bottom of this article, or in the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="969d8-107">Azure'a aşağıdakileri çoğaltabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="969d8-107">You can replicate the following to Azure:</span></span>
- <span data-ttu-id="969d8-108">**VMM ile Hyper-V**: System Center Virtual MAchine Manager (VMM) bulutlarında yönetilen şirket içi Hyper-V ana bilgisayarlarında yer alan VM'ler.</span><span class="sxs-lookup"><span data-stu-id="969d8-108">**Hyper-V with VMM**: VMs located on on-premises Hyper-V hosts managed in  System Center Virtual MAchine Manager (VMM) clouds.</span></span> <span data-ttu-id="969d8-109">Ana bilgisayarlar, [desteklenen herhangi bir işletim sistemini](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers) çalıştırıyor olabilir.</span><span class="sxs-lookup"><span data-stu-id="969d8-109">Hosts can be running any [supported operating system](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span></span> <span data-ttu-id="969d8-110">[Hyper-V ve Azure tarafından desteklenen](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows) herhangi bir konuk işletim sistemini çalıştıran Hyper-V VM’lerini çoğaltabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="969d8-110">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>
- <span data-ttu-id="969d8-111">**VMM olmadan Hyper-V**: VMM bulutlarında yönetilmeyen Hyper-V ana bilgisayarlarında bulunan şirket içi VM’ler.</span><span class="sxs-lookup"><span data-stu-id="969d8-111">**Hyper-V without VMM**: On-premises VMs located on Hyper-V hosts that aren't managed in VMM clouds.</span></span> <span data-ttu-id="969d8-112">Ana bilgisayarlar [desteklenen herhangi bir işletim sisteminde](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions) çalışabilir.</span><span class="sxs-lookup"><span data-stu-id="969d8-112">Hosts can run any of the [supported operating systems](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span></span> <span data-ttu-id="969d8-113">[Hyper-V ve Azure tarafından desteklenen](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows) herhangi bir konuk işletim sistemini çalıştıran Hyper-V VM’lerini çoğaltabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="969d8-113">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="969d8-114">Mimari bileşenler</span><span class="sxs-lookup"><span data-stu-id="969d8-114">Architectural components</span></span>

<span data-ttu-id="969d8-115">**Alan**</span><span class="sxs-lookup"><span data-stu-id="969d8-115">**Area**</span></span> | <span data-ttu-id="969d8-116">**Bileşen**</span><span class="sxs-lookup"><span data-stu-id="969d8-116">**Component**</span></span> | <span data-ttu-id="969d8-117">**Ayrıntılar**</span><span class="sxs-lookup"><span data-stu-id="969d8-117">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="969d8-118">**Azure**</span><span class="sxs-lookup"><span data-stu-id="969d8-118">**Azure**</span></span> | <span data-ttu-id="969d8-119">Azure’da bir Microsoft Azure hesabına, bir Azure depolama hesabına ve bir Azure ağına ihtiyacınız vardır.</span><span class="sxs-lookup"><span data-stu-id="969d8-119">In Azure you need a Microsoft Azure account, an Azure storage account, and a Azure network.</span></span> | <span data-ttu-id="969d8-120">Depolama ve ağ, Kaynak Yöneticisi tabanlı veya klasik hesaplar olabilir.</span><span class="sxs-lookup"><span data-stu-id="969d8-120">Storage and network can be Resource Manager-based, or classic accounts.</span></span><br/><br/> <span data-ttu-id="969d8-121">Çoğaltılan veriler depolama hesabında depolanır ve şirket içi sitenizden yük devretme gerçekleştiğinde çoğaltılan verilerle Azure VM’leri oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="969d8-121">Replicated data is stored in the storage account, and Azure VMs are created with the replicated data when failover from your on-premises site occurs.</span></span><br/><br/> <span data-ttu-id="969d8-122">Azure VM’leri oluşturulduğunda Azure sanal ağına bağlanır.</span><span class="sxs-lookup"><span data-stu-id="969d8-122">The Azure VMs connect to the Azure virtual network when they're created.</span></span>
<span data-ttu-id="969d8-123">**VMM sunucusu**</span><span class="sxs-lookup"><span data-stu-id="969d8-123">**VMM server**</span></span> | <span data-ttu-id="969d8-124">VMM bulutlarında bulunan Hyper-V ana bilgisayarları</span><span class="sxs-lookup"><span data-stu-id="969d8-124">Hyper-V hosts located in VMM clouds</span></span> | <span data-ttu-id="969d8-125">Hyper-V ana bilgisayarları VMM bulutlarında yönetiliyorsa, VMM sunucusunu Kurtarma Hizmetleri kasasına kaydedin.</span><span class="sxs-lookup"><span data-stu-id="969d8-125">If Hyper-V hosts are managed in VMM clouds, you register the VMM server in the Recovery Services vault.</span></span><br/><br/> <span data-ttu-id="969d8-126">VMM sunucusuna, Azure ile çoğaltmayı düzenlemek için Site Recovery Sağlayıcısı’nı yükleyin.</span><span class="sxs-lookup"><span data-stu-id="969d8-126">On the VMM server you install the Site Recovery Provider to orchestrate replication with Azure.</span></span><br/><br/> <span data-ttu-id="969d8-127">Ağ eşlemeyi yapılandırmak için, mantıksal ağlar ve VM ağları kurulumu gerekir.</span><span class="sxs-lookup"><span data-stu-id="969d8-127">You need logical and VM networks set up to configure network mapping.</span></span> <span data-ttu-id="969d8-128">VM ağının da bulutla ilişkilendirilen bir mantıksal ağ ile bağlantılı olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="969d8-128">A VM network should be linked to a logical network that's associated with the cloud.</span></span>
<span data-ttu-id="969d8-129">**Hyper-V konağı**</span><span class="sxs-lookup"><span data-stu-id="969d8-129">**Hyper-V host**</span></span> | <span data-ttu-id="969d8-130">Hyper-V sunucuları VMM sunucusu ile veya sunucu olmadan dağıtılabilir.</span><span class="sxs-lookup"><span data-stu-id="969d8-130">Hyper-V servers can be deployed with or without VMM server.</span></span> | <span data-ttu-id="969d8-131">VMM sunucusu yoksa, İnternet’ten Site Recovery ile çoğaltmayı düzenlemek için ana bilgisayara Site Recovery Sağlayıcısı yüklenir.</span><span class="sxs-lookup"><span data-stu-id="969d8-131">If there's no VMM server, the Site Recovery Provider is installed on the host to orchestrate replication with Site Recovery over the internet.</span></span> <span data-ttu-id="969d8-132">Bir VMM sunucusu varsa, Sağlayıcı ana bilgisayara değil bu sunucuya yüklenir.</span><span class="sxs-lookup"><span data-stu-id="969d8-132">If there's a VMM server, the Provider is installed on it, and not on the host.</span></span><br/><br/> <span data-ttu-id="969d8-133">Kurtarma Hizmetleri aracısı, veri çoğaltmayı işlemek için ana bilgisayara yüklenir.</span><span class="sxs-lookup"><span data-stu-id="969d8-133">The Recovery Services agent is installed on the host to handle data replication.</span></span><br/><br/> <span data-ttu-id="969d8-134">Sağlayıcı ve aracı arasındaki iletişimler şifrelenir ve güvence altına alınır.</span><span class="sxs-lookup"><span data-stu-id="969d8-134">Communications from both the Provider and the agent are secure and encrypted.</span></span> <span data-ttu-id="969d8-135">Azure depolama alanında çoğaltılan veriler de şifrelenir.</span><span class="sxs-lookup"><span data-stu-id="969d8-135">Replicated data in Azure storage is also encrypted.</span></span>
<span data-ttu-id="969d8-136">**Hyper-V VM’leri**</span><span class="sxs-lookup"><span data-stu-id="969d8-136">**Hyper-V VMs**</span></span> | <span data-ttu-id="969d8-137">Hyper-V konak sunucusunda bir veya daha fazla VM’niz olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="969d8-137">You need one or more VMs on the Hyper-V host server.</span></span> | <span data-ttu-id="969d8-138">Sanal makinelere açıkça bir şey yüklenmesi gerekmez</span><span class="sxs-lookup"><span data-stu-id="969d8-138">Nothing needs to explicitly installed on VMs</span></span>

## <a name="deployment-steps"></a><span data-ttu-id="969d8-139">Dağıtım adımları</span><span class="sxs-lookup"><span data-stu-id="969d8-139">Deployment steps</span></span>

1. <span data-ttu-id="969d8-140">**Azure**: Azure bileşenlerini ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="969d8-140">**Azure**: You set up the Azure components.</span></span> <span data-ttu-id="969d8-141">Site Recovery dağıtımına başlamadan önce depolama ve ağ hesapları ayarlamanızı öneririz.</span><span class="sxs-lookup"><span data-stu-id="969d8-141">We recommend you set up storage and network accounts before you begin Site Recovery deployment.</span></span>
2. <span data-ttu-id="969d8-142">**Kasa**: Site Recovery için bir Kurtarma Hizmetleri kasası oluşturun ve kaynak ile hedef ayarlarını yapılandırma, bir çoğaltma ilkesi ayarlama ve çoğaltmayı etkinleştirilme de dahil olmak üzere kasa ayarlarını yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="969d8-142">**Vault**: You create a Recovery Services vault for Site Recovery, and configure vault settings, including configuring source and target settings, setting up a replication policy, and enabling replication.</span></span>
3. <span data-ttu-id="969d8-143">**Kaynak ve hedef**:</span><span class="sxs-lookup"><span data-stu-id="969d8-143">**Source and target**:</span></span>
    - <span data-ttu-id="969d8-144">**VMM bulutlarındaki Hyper-V ana bilgisayarları**: Kaynak ayarlarını belirtmenin parçası olarak, VMM sunucusuna Azure Site Recovery Sağlayıcısını ve her Hyper-V ana bilgisayarında Azure Kurtarma Hizmetleri aracısını indirip yükleyin.</span><span class="sxs-lookup"><span data-stu-id="969d8-144">**Hyper-V hosts in VMM clouds**: As part of specifying source settings, you download and install the Azure Site Recovery Provider on the VMM server, and the Azure Recovery Services agent on each Hyper-V host.</span></span> <span data-ttu-id="969d8-145">Kaynak, VMM sunucusu olacaktır.</span><span class="sxs-lookup"><span data-stu-id="969d8-145">The source will be the VMM server.</span></span> <span data-ttu-id="969d8-146">Hedef, Azure’dur.</span><span class="sxs-lookup"><span data-stu-id="969d8-146">The target is Azure.</span></span>
    - <span data-ttu-id="969d8-147">VMM olmadan Hyper-V ana bilgisayarları: Kaynak ayarlarını belirttiğinizde, her Hyper-V ana bilgisayarına Sağlayıcıyı ve aracıyı indirip yükleyin.</span><span class="sxs-lookup"><span data-stu-id="969d8-147">Hyper-V hosts without VMM: When you specify source settings, you download and install the Provider and agent on each Hyper-V host.</span></span> <span data-ttu-id="969d8-148">Dağıtım esnasında, ana bilgisayarları bir Hyper-V sitesinde toplayın ve bunu kaynak olarak belirtin.</span><span class="sxs-lookup"><span data-stu-id="969d8-148">During deployment you gather the hosts into a Hyper-V site, and specify this site as the source.</span></span> <span data-ttu-id="969d8-149">Hedef, Azure’dur.</span><span class="sxs-lookup"><span data-stu-id="969d8-149">The target is Azure.</span></span>

    <span data-ttu-id="969d8-150">![Hyper-V/VMM çoğaltma Azure için](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V sitesi çoğaltma Azure için](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span><span class="sxs-lookup"><span data-stu-id="969d8-150">![Hyper-V/VMM replication to Azure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V site replication to Azure](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span></span>


4. <span data-ttu-id="969d8-151">**Çoğaltma ilkesi**: Hyper-V sitesi veya VMM bulutu için bir çoğaltma ilkesi oluştur.</span><span class="sxs-lookup"><span data-stu-id="969d8-151">**Replication policy**: You create a replication policy for the Hyper-V site or VMM cloud.</span></span> <span data-ttu-id="969d8-152">İlke, site veya buluttaki tüm konaklarda yer alan tüm VM’lere uygulanır.</span><span class="sxs-lookup"><span data-stu-id="969d8-152">The policy is applied to all VMs located on hosts in the site or cloud.</span></span>
5. <span data-ttu-id="969d8-153">**Çoğaltmayı etkinleştir**: Hyper-V VM’leri için çoğaltmayı etkinleştir.</span><span class="sxs-lookup"><span data-stu-id="969d8-153">**Enable replication**: You enable replication for Hyper-V VMs.</span></span> <span data-ttu-id="969d8-154">İlk çoğaltma, çoğaltma ilkesi ayarlarına uygun şekilde gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="969d8-154">Initial replication occurs in accordance with the replication policy settings.</span></span> <span data-ttu-id="969d8-155">Veri değişiklikleri izlenir ve delta değişikliklerinin Azure’a çoğaltılması ilk çoğaltma işlemi tamamlandıktan sonra başlar.</span><span class="sxs-lookup"><span data-stu-id="969d8-155">Data changes are tracked, and replication of delta changes to Azure begins after the initial replication finishes.</span></span> <span data-ttu-id="969d8-156">Bir öğe için izlenen değişiklikler bir .hrl dosyasında saklanır.</span><span class="sxs-lookup"><span data-stu-id="969d8-156">Tracked changes for an item are held in a .hrl file.</span></span>
6. <span data-ttu-id="969d8-157">**Test yük devretme**:  Her şeyin çalıştığından emin olmak için bir Yük devretme testi çalıştır.</span><span class="sxs-lookup"><span data-stu-id="969d8-157">**Test failover**:  You run a test failover to make sure everything's working as expected.</span></span>

<span data-ttu-id="969d8-158">Dağıtım hakkında daha fazla bilgi edinin:</span><span class="sxs-lookup"><span data-stu-id="969d8-158">Learn more about deployment:</span></span>
- [<span data-ttu-id="969d8-159">Hyper-V VM’lerini Azure’a çoğaltmaya başlayın - VMM ile</span><span class="sxs-lookup"><span data-stu-id="969d8-159">Get started with Hyper-V VM replication to Azure - with VMM</span></span>](site-recovery-vmm-to-azure.md)
- [<span data-ttu-id="969d8-160">Hyper-V VM’lerini Azure’a çoğaltmaya başlayın - VMM olmadan</span><span class="sxs-lookup"><span data-stu-id="969d8-160">Get started with Hyper-V VM replication to Azure - without VMM</span></span>](site-recovery-hyper-v-site-to-azure.md)

## <a name="hyper-v-replication-workflow"></a><span data-ttu-id="969d8-161">Hyper-V çoğaltma iş akışı</span><span class="sxs-lookup"><span data-stu-id="969d8-161">Hyper-V replication workflow</span></span>

### <a name="enable-protection"></a><span data-ttu-id="969d8-162">Korumayı etkinleştir</span><span class="sxs-lookup"><span data-stu-id="969d8-162">Enable protection</span></span>

1. <span data-ttu-id="969d8-163">Azure portalında veya şirket içinde bir Hyper-V VM’si için koruma etkinleştirdikten sonra, **Korumayı etkinleştir** başlatılır.</span><span class="sxs-lookup"><span data-stu-id="969d8-163">After you enable protection for a Hyper-V VM, in the Azure portal or on-premises, the **Enable protection** starts.</span></span>
2. <span data-ttu-id="969d8-164">İş, makinenin önkoşullarla uyumlu olup olmadığını denetler, ardından, çoğaltmayı daha önce yapılandırdığınız ayarları uygulamak üzere [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx) çağırır.</span><span class="sxs-lookup"><span data-stu-id="969d8-164">The job checks that the machine complies with prerequisites, before invoking the [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), to set up replication with the settings you've configured.</span></span>
3. <span data-ttu-id="969d8-165">İş, tam bir VM çoğaltması başlatmak için [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) yöntemini çağırarak ilk çoğaltmayı başlatır ve VM’lerin sanal disklerini Azure’a gönderir.</span><span class="sxs-lookup"><span data-stu-id="969d8-165">The job starts initial replication by invoking the [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) method, to initialize a full VM replication, and send the VM's virtual disks to Azure.</span></span>
4. <span data-ttu-id="969d8-166">**İşler** sekmesinde işi izleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="969d8-166">You can monitor the job in the **Jobs** tab.</span></span>
        <span data-ttu-id="969d8-167">![İşler listesi](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Korumayı etkinleştir ayrıntıları](media/site-recovery-hyper-v-azure-architecture/image2.png)</span><span class="sxs-lookup"><span data-stu-id="969d8-167">![Jobs list](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Enable protection drill down](media/site-recovery-hyper-v-azure-architecture/image2.png)</span></span>

### <a name="initial-replication"></a><span data-ttu-id="969d8-168">İlk çoğaltma</span><span class="sxs-lookup"><span data-stu-id="969d8-168">Initial replication</span></span>

1. <span data-ttu-id="969d8-169">İlk çoğaltma tetiklendiğinde bir [Hyper-V VM anlık görüntüsü](https://technet.microsoft.com/library/dd560637.aspx) alınır.</span><span class="sxs-lookup"><span data-stu-id="969d8-169">A [Hyper-V VM snapshot](https://technet.microsoft.com/library/dd560637.aspx) snapshot is taken when initial replication is triggered.</span></span>
2. <span data-ttu-id="969d8-170">Sanal diskler, hepsi Azure'a kopyalanana kadar birer birer çoğaltılır.</span><span class="sxs-lookup"><span data-stu-id="969d8-170">Virtual hard disks are replicated one by one until they're all copied to Azure.</span></span> <span data-ttu-id="969d8-171">VM boyutuna ve ağ bant genişliğine bağlı olarak biraz uzun sürebilir.</span><span class="sxs-lookup"><span data-stu-id="969d8-171">It could take a while, depending on the VM size, and network bandwidth.</span></span> <span data-ttu-id="969d8-172">Ağ kullanımınızı iyileştirmek için, bkz: [Şirket içinden Azure'a koruma ağ bant genişliği kullanımını yönetme](https://support.microsoft.com/kb/3056159).</span><span class="sxs-lookup"><span data-stu-id="969d8-172">To optimize your network usage, see [How to manage on-premises to Azure protection network bandwidth usage](https://support.microsoft.com/kb/3056159).</span></span>
3. <span data-ttu-id="969d8-173">İlk çoğaltma devam ederken disk değişiklikleri meydana gelirse, Hyper-V Çoğaltma'nın Çoğaltma İzleyicisi bu değişiklikleri Hyper-V Çoğaltma Günlükleri (.hrl) olarak izler.</span><span class="sxs-lookup"><span data-stu-id="969d8-173">If disk changes occur while initial replication is in progress, the Hyper-V Replica Replication Tracker tracks those changes as Hyper-V Replication Logs (.hrl).</span></span> <span data-ttu-id="969d8-174">Bu dosyalar disklerle aynı klasörde bulunur.</span><span class="sxs-lookup"><span data-stu-id="969d8-174">These files are located in the same folder as the disks.</span></span> <span data-ttu-id="969d8-175">Her diskin ikincil depolamaya gönderilecek bir ilişkili .hrl dosyası vardır.</span><span class="sxs-lookup"><span data-stu-id="969d8-175">Each disk has an associated .hrl file that will be sent to secondary storage.</span></span>
4. <span data-ttu-id="969d8-176">İlk çoğaltma sırasında anlık görüntü ve günlük dosyaları disk kaynaklarını kullanır.</span><span class="sxs-lookup"><span data-stu-id="969d8-176">The snapshot and log files consume disk resources while initial replication is in progress.</span></span>
5. <span data-ttu-id="969d8-177">İlk çoğaltma tamamlandığında, VM anlık görüntüsü silinir.</span><span class="sxs-lookup"><span data-stu-id="969d8-177">When the initial replication finishes, the VM snapshot is deleted.</span></span> <span data-ttu-id="969d8-178">Günlükteki değişim disk değişiklikleri eşitlenir ve üst diske birleştirilir.</span><span class="sxs-lookup"><span data-stu-id="969d8-178">Delta disk changes in the log are synchronized and merged to the parent disk.</span></span>


### <a name="finalize-protection"></a><span data-ttu-id="969d8-179">Korumayı sonlandırma</span><span class="sxs-lookup"><span data-stu-id="969d8-179">Finalize protection</span></span>

1. <span data-ttu-id="969d8-180">İlk çoğaltma sona erdikten sonra, **Sanal makinede korumayı sonlandır** işi, sanal makinenin korunabilmesi adına ağı ve diğer çoğaltma sonrası ayarlarını yapılandırır.</span><span class="sxs-lookup"><span data-stu-id="969d8-180">After the initial replication finishes, the **Finalize protection on the virtual machine** job configures network and other post-replication settings, so that the virtual machine is protected.</span></span>
    <span data-ttu-id="969d8-181">![Korumayı sonlandır işi](media/site-recovery-hyper-v-azure-architecture/image3.png)</span><span class="sxs-lookup"><span data-stu-id="969d8-181">![Finalize protection job](media/site-recovery-hyper-v-azure-architecture/image3.png)</span></span>
2. <span data-ttu-id="969d8-182">Azure'da çoğaltma yapıyorsanız sanal makinede ince ayar yapmanız gerekebilir. Böylece sanal makine yük devretme için hazır hale gelir.</span><span class="sxs-lookup"><span data-stu-id="969d8-182">If you're replicating to Azure, you might need to tweak the settings for the virtual machine so that it's ready for failover.</span></span> <span data-ttu-id="969d8-183">Bu noktada, her şeyin istendiği şekilde çalıştığını denetlemek için yük devretme testi çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="969d8-183">At this point you can run a test failover to check everything is working as expected.</span></span>

### <a name="delta-replication"></a><span data-ttu-id="969d8-184">Değişim çoğaltması</span><span class="sxs-lookup"><span data-stu-id="969d8-184">Delta replication</span></span>

1. <span data-ttu-id="969d8-185">İlk çoğaltma sonrasında, çoğaltma ayarlarına uygun olarak değişim eşitlemesi başlar.</span><span class="sxs-lookup"><span data-stu-id="969d8-185">After the initial replication, delta synchronization begins, in accordance with replication settings.</span></span>
2. <span data-ttu-id="969d8-186">Bir Çoğaltma İzleyicisi olan Hyper-V Çoğaltma, bir sanal sabit diskteki değişiklikleri .hrl dosyası olarak izler.</span><span class="sxs-lookup"><span data-stu-id="969d8-186">The Hyper-V Replica Replication Tracker tracks the changes to a virtual hard disk as .hrl files.</span></span> <span data-ttu-id="969d8-187">Çoğaltma için yapılandırılmış her diskin ilişkili bir .hrl dosyası vardır.</span><span class="sxs-lookup"><span data-stu-id="969d8-187">Each disk that's configured for replication has an associated .hrl file.</span></span> <span data-ttu-id="969d8-188">İlk çoğaltma tamamlandıktan sonra bu günlük müşterinin depolama hesabına gönderilir.</span><span class="sxs-lookup"><span data-stu-id="969d8-188">This log is sent to the customer's storage account after initial replication is complete.</span></span> <span data-ttu-id="969d8-189">Bir günlük Azure’a iletilmekteyken, birincil diskteki değişiklikler aynı dizindeki başka bir günlük dosyasında izlenir.</span><span class="sxs-lookup"><span data-stu-id="969d8-189">When a log is in transit to Azure, the changes in the primary disk are tracked in another log file, in the same directory.</span></span>
3. <span data-ttu-id="969d8-190">İlk çoğaltma ve değişim çoğaltması esnasında, VM görünümünde VM’yi izleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="969d8-190">During initial and delta replication, you can monitor the VM in the VM view.</span></span> <span data-ttu-id="969d8-191">[Daha fazla bilgi edinin](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="969d8-191">[Learn more](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span></span>  

### <a name="replication-synchronization"></a><span data-ttu-id="969d8-192">Çoğaltma eşitleme</span><span class="sxs-lookup"><span data-stu-id="969d8-192">Replication synchronization</span></span>

1. <span data-ttu-id="969d8-193">Değişim çoğaltması başarısız olursa ve bant genişliği ile zaman açısından tam çoğaltma maliyetli olacaksa, bir VM yeniden eşitleme için işaretlenir.</span><span class="sxs-lookup"><span data-stu-id="969d8-193">If delta replication fails, and a full replication would be costly in terms of bandwidth or time, then a VM is marked for resynchronization.</span></span> <span data-ttu-id="969d8-194">Örneğin, .hrl dosyası disk boyutunun %50'sine ulaşırsa VM, yeniden eşitleme için işaretlenir.</span><span class="sxs-lookup"><span data-stu-id="969d8-194">For example, if the .hrl files reach 50% of the disk size, then the VM will be marked for resynchronization.</span></span>
2.  <span data-ttu-id="969d8-195">Yeniden eşitleme, kaynak ve hedef sanal makinelerin sağlama toplamlarını hesaplayarak ve yalnızca değişim verilerini göndererek, gönderilen veri miktarını en aza indirir.</span><span class="sxs-lookup"><span data-stu-id="969d8-195">Resynchronization minimizes the amount of data sent by computing checksums of the source and target virtual machines, and sending only the delta data.</span></span> <span data-ttu-id="969d8-196">Yeniden eşitleme, kaynak ve hedef dosyaların sabit öbeklere bölündüğü bir sabit blok kümeleme algoritması kullanır.</span><span class="sxs-lookup"><span data-stu-id="969d8-196">Resynchronization uses a fixed-block chunking algorithm where source and target files are divided into fixed chunks.</span></span> <span data-ttu-id="969d8-197">Her öbek için sağlama toplamları oluşturulur ve ardından, kaynaktan hangi blokların hedefe uygulanması gerektiğini belirlemek üzere karşılaştırılır.</span><span class="sxs-lookup"><span data-stu-id="969d8-197">Checksums for each chunk are generated and then compared to determine which blocks from the source need to be applied to the target.</span></span>
3. <span data-ttu-id="969d8-198">Yeniden eşitleme sona erdikten sonra, normal değişim çoğaltması devam edecektir.</span><span class="sxs-lookup"><span data-stu-id="969d8-198">After resynchronization finishes, normal delta replication should resume.</span></span> <span data-ttu-id="969d8-199">Varsayılan olarak, yeniden eşitleme ofis saatleri dışında otomatik olarak çalışacak şekilde planlanmıştır ancak sanal makineyi elle yeniden eşitleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="969d8-199">By default resynchronization is scheduled to run automatically outside office hours, but you can resynchronize a virtual machine manually.</span></span> <span data-ttu-id="969d8-200">Örneğin, bir ağ kesintisi veya başka bir kesinti oluşursa, yeniden eşitlemeyi devam ettirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="969d8-200">For example, you can resume resynchronization if a network outage or another outage occurs.</span></span> <span data-ttu-id="969d8-201">Bunu yapmak için, portalda VM’yi > **Yeniden eşitle**’yi seçin.</span><span class="sxs-lookup"><span data-stu-id="969d8-201">To do this, select the VM in the portal > **Resynchronize**.</span></span>

    ![El ile yeniden eşitleme](media/site-recovery-hyper-v-azure-architecture/image4.png)


### <a name="retries"></a><span data-ttu-id="969d8-203">Yeniden deneme sayısı</span><span class="sxs-lookup"><span data-stu-id="969d8-203">Retries</span></span>

<span data-ttu-id="969d8-204">Bir çoğaltma hatası meydana gelirse, yerleşik yeniden deneme işlevi vardır.</span><span class="sxs-lookup"><span data-stu-id="969d8-204">If a replication error occurs, there's a built-in retry.</span></span> <span data-ttu-id="969d8-205">Bu mantık iki kategoride sınıflandırılabilir:</span><span class="sxs-lookup"><span data-stu-id="969d8-205">This logic can be classified into two categories:</span></span>

<span data-ttu-id="969d8-206">**Kategori**</span><span class="sxs-lookup"><span data-stu-id="969d8-206">**Category**</span></span> | <span data-ttu-id="969d8-207">**Ayrıntılar**</span><span class="sxs-lookup"><span data-stu-id="969d8-207">**Details**</span></span>
--- | ---
<span data-ttu-id="969d8-208">**Kurtarılamaz hatalar**</span><span class="sxs-lookup"><span data-stu-id="969d8-208">**Non-recoverable errors**</span></span> | <span data-ttu-id="969d8-209">Yeniden deneme yapılmaya çalışılmaz.</span><span class="sxs-lookup"><span data-stu-id="969d8-209">No retry is attempted.</span></span> <span data-ttu-id="969d8-210">VM durumu **Kritik** olacaktır ve yönetici müdahalesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="969d8-210">VM status will be **Critical**, and administrator intervention is required.</span></span> <span data-ttu-id="969d8-211">Bu hataların örnekleri şunlardır: kırılmış VHD zinciri; Çoğaltma VM için geçersiz durum; Ağ kimlik doğrulama hataları: yetkilendirme hataları; VM bulunamadı hataları (tek başına Hyper-V sunucuları için)</span><span class="sxs-lookup"><span data-stu-id="969d8-211">Examples of these errors include: broken VHD chain; Invalid state for the replica VM; Network authentication errors: authorization errors; VM not found errors (for standalone Hyper-V servers)</span></span>
<span data-ttu-id="969d8-212">**Kurtarılabilir hatalar**</span><span class="sxs-lookup"><span data-stu-id="969d8-212">**Recoverable errors**</span></span> | <span data-ttu-id="969d8-213">Yeniden deneme aralığını ilk denemenin başlangıcına göre 1, 2, 4, 8 ve 10 dakika artıran bir üstel geri çekme kullanılarak her çoğaltma aralığında yeniden denemeler gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="969d8-213">Retries occur every replication interval, using an exponential back-off that increases the retry interval from the start of the first attempt by 1, 2, 4, 8, and 10 minutes.</span></span> <span data-ttu-id="969d8-214">Hata devam ederse, 30 dakikada bir yeniden deneyin.</span><span class="sxs-lookup"><span data-stu-id="969d8-214">If an error persists, retry every 30 minutes.</span></span> <span data-ttu-id="969d8-215">Örnekler şunlardır: ağ hataları; düşük disk hataları; yetersiz bellek durumları</span><span class="sxs-lookup"><span data-stu-id="969d8-215">Examples include: network errors; low disk  errors; low memory conditions</span></span> |

## <a name="protection-and-recovery-lifecycle"></a><span data-ttu-id="969d8-216">Koruma ve kurtarma yaşam döngüsü</span><span class="sxs-lookup"><span data-stu-id="969d8-216">Protection and recovery lifecycle</span></span>

![iş akışı](./media/site-recovery-components/arch-hyperv-azure-workflow.png)

## <a name="next-steps"></a><span data-ttu-id="969d8-218">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="969d8-218">Next steps</span></span>

- [<span data-ttu-id="969d8-219">Dağıtım önkoşullarını denetleme</span><span class="sxs-lookup"><span data-stu-id="969d8-219">Check deployment prerequisites</span></span>](site-recovery-prereq.md)
- <span data-ttu-id="969d8-220">Aşağıdakilerle sorun giderme:</span><span class="sxs-lookup"><span data-stu-id="969d8-220">Troubleshoot with:</span></span>
    - [<span data-ttu-id="969d8-221">Koruma izleme ve sorun giderme</span><span class="sxs-lookup"><span data-stu-id="969d8-221">Monitor and troubleshoot protection</span></span>](site-recovery-monitoring-and-troubleshooting.md)
    - [<span data-ttu-id="969d8-222">Microsoft destekten yardım</span><span class="sxs-lookup"><span data-stu-id="969d8-222">Help from Microsoft support</span></span>](site-recovery-monitoring-and-troubleshooting.md#reach-out-for-microsoft-support)
    - [<span data-ttu-id="969d8-223">Genel sorunlar ve çözümleri</span><span class="sxs-lookup"><span data-stu-id="969d8-223">Common errors and resolutions</span></span>](site-recovery-monitoring-and-troubleshooting.md#common-azure-site-recovery-errors-and-their-resolutions)
