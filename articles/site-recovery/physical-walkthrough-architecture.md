---
title: "Fiziksel sunucu çoğaltma için Azure Site Kurtarma'yı kullanarak Azure Mimarisi gözden | Microsoft Docs"
description: "Bu makalede, bileşenleri ve Azure Site Recovery hizmeti ile şirket içi fiziksel sunucuların Azure'a çoğaltırken kullanılan mimariye genel bakış sağlar"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: 09c9b136-35f5-465e-8d0f-f4c5d5d9f880
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27/2017
ms.author: raynew
ms.openlocfilehash: 843c3f1b54f50fe50b162ed242deab717a080830
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="step-1-review-the-architecture-for-physical-server-replication-to-azure"></a><span data-ttu-id="639f8-103">1. adım: Gözden geçirme fiziksel sunucu çoğaltma Azure için mimarisi</span><span class="sxs-lookup"><span data-stu-id="639f8-103">Step 1: Review the architecture for physical server replication to Azure</span></span>

<span data-ttu-id="639f8-104">Bu makalede bileşenleri ve şirket içi Windows/Linux fiziksel sunucuları Azure'a çoğaltırken kullanılan işlemleri kullanarak [Azure Site Recovery](site-recovery-overview.md) hizmet.</span><span class="sxs-lookup"><span data-stu-id="639f8-104">This article describes the components and processes used when you replicate on-premises Windows/Linux physical servers to Azure, using the [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="639f8-105">Tüm yorumlarınızı bu makalenin alt kısmında paylaşabilir veya [Azure Kurtarma Hizmetleri Forumu](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr)'nda soru sorabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="639f8-105">Post any comments at the bottom of this article, or ask questions in the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="639f8-106">Mimari bileşenler</span><span class="sxs-lookup"><span data-stu-id="639f8-106">Architectural components</span></span>

<span data-ttu-id="639f8-107">Tablo gereksinim duyduğunuz bileşenleri özetler.</span><span class="sxs-lookup"><span data-stu-id="639f8-107">The table summarizes the components you need.</span></span>

<span data-ttu-id="639f8-108">**Bileşen**</span><span class="sxs-lookup"><span data-stu-id="639f8-108">**Component**</span></span> | <span data-ttu-id="639f8-109">**Gereksinim**</span><span class="sxs-lookup"><span data-stu-id="639f8-109">**Requirement**</span></span> | <span data-ttu-id="639f8-110">**Ayrıntılar**</span><span class="sxs-lookup"><span data-stu-id="639f8-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="639f8-111">**Azure**</span><span class="sxs-lookup"><span data-stu-id="639f8-111">**Azure**</span></span> | <span data-ttu-id="639f8-112">Bir Azure hesabı, bir Azure depolama hesabı ve bir Azure ağı gerekir.</span><span class="sxs-lookup"><span data-stu-id="639f8-112">You need an Azure account, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="639f8-113">Çoğaltılan veriler depolama hesabında depolanır ve yük devretme durumunda Azure Vm'leri çoğaltılan veriler ile oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="639f8-113">Replicated data is stored in the storage account, and Azure VMs are created with the replicated data when failover occurs.</span></span> <span data-ttu-id="639f8-114">Bunlar oluşturulduğunda azure sanal makineleri Azure sanal ağına bağlayın.</span><span class="sxs-lookup"><span data-stu-id="639f8-114">Azure VMs connect to the Azure virtual network when they're created.</span></span>
<span data-ttu-id="639f8-115">**Yapılandırma sunucusu**</span><span class="sxs-lookup"><span data-stu-id="639f8-115">**Configuration server**</span></span> | <span data-ttu-id="639f8-116">Tek bir tüm şirket içi Site Recovery bileşenlerini çalıştıran yönetim sunucusu (fiziksel sunucu veya VMware VM) şirket içi.</span><span class="sxs-lookup"><span data-stu-id="639f8-116">A single on-premises management server (physical server or VMware VM) that runs all the on-premises Site Recovery components.</span></span> <span data-ttu-id="639f8-117">Bunlar bir yapılandırma sunucusuna işlem sunucusu, ana hedef sunucusu içerir.</span><span class="sxs-lookup"><span data-stu-id="639f8-117">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="639f8-118">Yapılandırma sunucusu bileşeni, şirket içi ile Azure arasındaki iletişimi düzenler ve veri çoğaltma işlemlerini yönetir.</span><span class="sxs-lookup"><span data-stu-id="639f8-118">The configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="639f8-119">**İşlem sunucusu**</span><span class="sxs-lookup"><span data-stu-id="639f8-119">**Process server**</span></span>  | <span data-ttu-id="639f8-120">Varsayılan olarak yapılandırma sunucusuna yüklenir.</span><span class="sxs-lookup"><span data-stu-id="639f8-120">Installed by default on the configuration server.</span></span> | <span data-ttu-id="639f8-121">Çoğaltma ağ geçidi olarak davranır.</span><span class="sxs-lookup"><span data-stu-id="639f8-121">Acts as a replication gateway.</span></span> <span data-ttu-id="639f8-122">Çoğaltma verilerini alıp bu verileri önbelleğe alma, sıkıştırma ve şifreleme işlemleriyle iyileştirir ve Azure depolama alanına gönderir.</span><span class="sxs-lookup"><span data-stu-id="639f8-122">Receives replication data, optimizes it with caching, compression, and encryption, and sends it to Azure storage.</span></span><br/><br/> <span data-ttu-id="639f8-123">İşlem sunucusu ayrıca Mobility hizmetinin korunan makinelere göndermeli yüklemesini işler.</span><span class="sxs-lookup"><span data-stu-id="639f8-123">The process server also handles push installation of the Mobility service to protected machines.</span></span><br/><br/> <span data-ttu-id="639f8-124">Artan hacimli çoğaltma trafiğini işlemek için ek ayrı adanmış işlem sunucuları ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="639f8-124">You can add additional separate dedicated process servers, to handle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="639f8-125">**Ana hedef sunucu**</span><span class="sxs-lookup"><span data-stu-id="639f8-125">**Master target server**</span></span> | <span data-ttu-id="639f8-126">Varsayılan olarak şirket içi yapılandırma sunucusuna yüklenir.</span><span class="sxs-lookup"><span data-stu-id="639f8-126">Installed by default on the on-premises configuration server.</span></span> | <span data-ttu-id="639f8-127">Azure’dan yeniden çalışma sırasında çoğaltma verilerini işler.</span><span class="sxs-lookup"><span data-stu-id="639f8-127">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="639f8-128">Yeniden çalışma trafiğinin hacmi yüksekse, yeniden çalışma için ayrı bir ana hedef sunucu dağıtabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="639f8-128">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="639f8-129">**Çoğaltılmış sunucuları**</span><span class="sxs-lookup"><span data-stu-id="639f8-129">**Replicated servers**</span></span> | <span data-ttu-id="639f8-130">Mobility hizmeti bileşeninin çoğaltmak istediğiniz her Windows/Linux sunucusuna yüklenir.</span><span class="sxs-lookup"><span data-stu-id="639f8-130">The Mobility service component is installed on each Windows/Linux server you want to replicate.</span></span> <span data-ttu-id="639f8-131">Her makineye el ile yüklenebileceği gibi, işlem sunucusundan göndererek yükleme yoluyla da yüklenebilir.</span><span class="sxs-lookup"><span data-stu-id="639f8-131">It can be installed manually on each machine, or with a push installation from the process server.</span></span>
<span data-ttu-id="639f8-132">**İlk duruma döndürme**</span><span class="sxs-lookup"><span data-stu-id="639f8-132">**Failback**</span></span> | <span data-ttu-id="639f8-133">Yeniden çalışma için bir VMware altyapı gereklidir.</span><span class="sxs-lookup"><span data-stu-id="639f8-133">For failback a VMware infrastructure is required.</span></span> <span data-ttu-id="639f8-134">Bir fiziksel sunucuda yeniden çalışamazsınız.</span><span class="sxs-lookup"><span data-stu-id="639f8-134">You can't fail back to a physical server.</span></span>


<span data-ttu-id="639f8-135">**Şekil 1: Fiziksel Azure bileşenleri**</span><span class="sxs-lookup"><span data-stu-id="639f8-135">**Figure 1: Physical to Azure components**</span></span>

![Bileşenler](./media/physical-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="639f8-137">Çoğaltma işlemi</span><span class="sxs-lookup"><span data-stu-id="639f8-137">Replication process</span></span>

1. <span data-ttu-id="639f8-138">Şirket içi ve Azure bileşenleri de dahil olmak üzere dağıtım, ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="639f8-138">You set up the deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="639f8-139">Kurtarma Hizmetleri kasasına çoğaltma kaynak ve hedef yapılandırma sunucusunu ayarlamayı, bir çoğaltma ilkesi oluşturun Mobility hizmeti dağıtmak, çoğaltmayı etkinleştirmek ve yük devretme testi çalıştırmak belirtin.</span><span class="sxs-lookup"><span data-stu-id="639f8-139">In the Recovery Services vault, you specify the replication source and target, set up the configuration server, create a replication policy, deploy the Mobility service, enable replication, and run a test failover.</span></span>
2.  <span data-ttu-id="639f8-140">Makinelerin çoğaltılacağı Çoğaltma İlkesi ve bir başlangıç kopyasını veri uygun olarak Azure depolama alanına çoğaltılır.</span><span class="sxs-lookup"><span data-stu-id="639f8-140">Machines replicate in accordance with the replication policy, and an initial copy of the data is replicated to Azure storage.</span></span>
4. <span data-ttu-id="639f8-141">İlk çoğaltma sonlandırıldıktan sonra Azure delta değişikliklerini başlar.</span><span class="sxs-lookup"><span data-stu-id="639f8-141">After initial replication finishes, replication of delta changes to Azure begins.</span></span> <span data-ttu-id="639f8-142">Bir makine için izlenen değişiklikler bir .hrl dosyasında saklanır.</span><span class="sxs-lookup"><span data-stu-id="639f8-142">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="639f8-143">Çoğaltılan makineler çoğaltma yönetimi için HTTPS 443 gelen bağlantı noktasındaki yapılandırma sunucusuyla iletişim kurar.</span><span class="sxs-lookup"><span data-stu-id="639f8-143">Replicating machines communicate with the configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="639f8-144">Çoğaltılan makinelerin çoğaltma veri gönderme bağlantı noktası HTTPS 9443 işlem sunucusu için gelen (değiştirilmiş).</span><span class="sxs-lookup"><span data-stu-id="639f8-144">Replicating machines send replication data to the process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="639f8-145">Yapılandırma sunucusu, HTTPS 443 giden bağlantı noktası üzerinden Azure ile çoğaltma yönetimini düzenler.</span><span class="sxs-lookup"><span data-stu-id="639f8-145">The configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="639f8-146">İşlem sunucusu kaynak makinelerden gelen verileri alır, iyileştirip şifreler ve 443 giden bağlantı noktası üzerinden Azure depolamaya gönderir.</span><span class="sxs-lookup"><span data-stu-id="639f8-146">The process server receives data from source machines, optimizes and encrypts it, and sends it to Azure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="639f8-147">Çoklu VM tutarlılığını etkinleştirirseniz çoğaltma grubundaki makineler birbiriyle 20004 bağlantı noktası üzerinden iletişim kurar.</span><span class="sxs-lookup"><span data-stu-id="639f8-147">If you enable multi-VM consistency, then machines in the replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="639f8-148">Çoklu VM, birden çok makineyi yük devrettikleri zaman kilitlenmeyle tutarlı ve uygulamayla tutarlı kurtarma noktalarını paylaşan çoğaltma grupları halinde gruplandırdığınızda kullanılır.</span><span class="sxs-lookup"><span data-stu-id="639f8-148">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="639f8-149">Bu özellik, makinelerin aynı iş yükünü çalıştırdığı ve tutarlı olmasının gerektiği durumlarda kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="639f8-149">This is useful if machines are running the same workload and need to be consistent.</span></span>
5. <span data-ttu-id="639f8-150">Trafik İnternet üzerinden Azure depolama genel uç noktalarına çoğaltılır.</span><span class="sxs-lookup"><span data-stu-id="639f8-150">Traffic is replicated to Azure storage public endpoints, over the internet.</span></span> <span data-ttu-id="639f8-151">Alternatif olarak, Azure ExpressRoute [genel eşliğini](../expressroute/expressroute-circuit-peerings.md#public-peering) kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="639f8-151">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="639f8-152">Trafiğin siteden siteye bir VPN aracılığıyla şirket içi bir siteden Azure’a çoğaltılması desteklenmez.</span><span class="sxs-lookup"><span data-stu-id="639f8-152">Replicating traffic over a site-to-site VPN from an on-premises site to Azure isn't supported.</span></span>

<span data-ttu-id="639f8-153">**Şekil 2: Fiziksel Azure çoğaltma**</span><span class="sxs-lookup"><span data-stu-id="639f8-153">**Figure 2: Physical to Azure replication**</span></span>

![Gelişmiş](./media/physical-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="639f8-155">Yük devretme ve yeniden çalışma işlemi</span><span class="sxs-lookup"><span data-stu-id="639f8-155">Failover and failback process</span></span>

<span data-ttu-id="639f8-156">Yük devretme testinin beklenen şekilde çalıştığını doğruladıktan sonra, gerektiğinde Azure’a planlanmamış yük devretmeler çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="639f8-156">After you verify that test failover is working as expected, you can run unplanned failovers to Azure as required.</span></span> <span data-ttu-id="639f8-157">Bir yük devretme çalıştırdığınızda, Azure Vm'leri çoğaltılmış verilerden oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="639f8-157">When you run a failover, Azure VMs are created from replicated data.</span></span> <span data-ttu-id="639f8-158">Birincil şirket içi sitenize yeniden kullanılabilir duruma geldiğinde, daha sonra geri yük devredebilir.</span><span class="sxs-lookup"><span data-stu-id="639f8-158">Then, when your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="639f8-159">Şunlara dikkat edin:</span><span class="sxs-lookup"><span data-stu-id="639f8-159">Note that:</span></span>

- <span data-ttu-id="639f8-160">Planlanan yük devretme desteklenmez.</span><span class="sxs-lookup"><span data-stu-id="639f8-160">Planned failover isn't supported.</span></span>
- <span data-ttu-id="639f8-161">Üzerinde tek bir makine başarısız veya oluşturma [kurtarma planlarına](site-recovery-create-recovery-plans.md), birden çok makinede yük birlikte başarısız.</span><span class="sxs-lookup"><span data-stu-id="639f8-161">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), to fail over multiple machines together.</span></span>
- <span data-ttu-id="639f8-162">Kopya Azure VM’sindeki iş yüküne erişmeye başlamak için bir yük devretme yürütürsünüz.</span><span class="sxs-lookup"><span data-stu-id="639f8-162">You commit a failover to start accessing the workload from the replica Azure VM.</span></span>
- <span data-ttu-id="639f8-163">Birincil sitenin yeniden kullanılabilir duruma geldiğinde, makine birincil siteye ikincil çoğaltma.</span><span class="sxs-lookup"><span data-stu-id="639f8-163">When the primary site is available again, you replicate the machine from the secondary to the primary site.</span></span> <span data-ttu-id="639f8-164">Ardından, ikincil siteden planlanmamış bir yük devretme çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="639f8-164">Then, run an unplanned failover from the secondary site.</span></span> <span data-ttu-id="639f8-165">Bu yük devretme yürütüldükten sonra, veriler şirket içine döner ve Azure’a çoğaltmayı yeniden etkinleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="639f8-165">After you commit this failover, data will be back on-premises, and you need to enable replication to Azure again.</span></span>

<span data-ttu-id="639f8-166">Yeniden çalışma bileşenleri şunları içerir:</span><span class="sxs-lookup"><span data-stu-id="639f8-166">Failback components include:</span></span>

- <span data-ttu-id="639f8-167">**Azure'da geçici işlem sunucusu**: Azure VM'yi yedekleme azure'dan çoğaltmayı düzenlemek için bir işlem sunucusu olarak davranacak şekilde ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="639f8-167">**Temporary process server in Azure**: You need to set up an Azure VM to act as a process server, to handle replication from Azure.</span></span> <span data-ttu-id="639f8-168">Yeniden çalışma sona erdikten sonra bu VM'yi silebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="639f8-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="639f8-169">**VPN bağlantısı**:, bir VPN bağlantısı (veya Azure ExpressRoute) Azure ağından şirket içi siteye gerekir.</span><span class="sxs-lookup"><span data-stu-id="639f8-169">**VPN connection**: You need a VPN connection (or Azure ExpressRoute) from the Azure network to the on-premises site.</span></span>
- <span data-ttu-id="639f8-170">**Ayrı şirket içi ana hedef sunucusu**: (varsayılan olarak yapılandırma sunucusunda yüklü) şirket içi ana hedef sunucusu yeniden çalışma işlemini yürütür.</span><span class="sxs-lookup"><span data-stu-id="639f8-170">**Separate on-premises master target server**: The on-premises master target server (installed by default on the configuration server) handles failback.</span></span> <span data-ttu-id="639f8-171">Geri büyük miktarda trafik başarısız olursa, bu amaçla bir ayrı şirket içi ana hedef sunucusu ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="639f8-171">If you fail back large volumes of traffic, you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="639f8-172">**Yeniden çalışma ilkesi**: geri dönme ilkesini gerekir.</span><span class="sxs-lookup"><span data-stu-id="639f8-172">**Failback policy**: You need a failback policy.</span></span> <span data-ttu-id="639f8-173">Bu ilke çoğaltma ilkenizi oluşturduğunuzda otomatik olarak oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="639f8-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="639f8-174">**VMware altyapısı**: Bir şirket içi VMware VM'ye geri dönmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="639f8-174">**VMware infrastructure**: You must fail back to an on-premises VMware VM.</span></span> <span data-ttu-id="639f8-175">Bu, şirket içi fiziksel sunucuları Azure'a çoğaltıyor olsanız bile şirket içi VMware altyapısına ihtiyacınız olduğu anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="639f8-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers to Azure.</span></span>

<span data-ttu-id="639f8-176">**Şekil 3: Fiziksel sunucuya geri dönme**</span><span class="sxs-lookup"><span data-stu-id="639f8-176">**Figure 3: Physical server failback**</span></span>

![Yeniden çalışma](./media/physical-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="639f8-178">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="639f8-178">Next steps</span></span>

<span data-ttu-id="639f8-179">Git [2. adım: Önkoşullar ve sınırlamalar doğrulayın](physical-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="639f8-179">Go to [Step 2: Verify prerequisites and limitations](physical-walkthrough-prerequisites.md)</span></span>
