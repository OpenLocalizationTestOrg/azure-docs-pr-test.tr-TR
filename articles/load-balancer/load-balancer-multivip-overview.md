---
title: "Azure için birden çok Vip yük dengeleyici | Microsoft Docs"
description: "Azure yük dengeleyici üzerinde birden çok Vip genel bakış"
services: load-balancer
documentationcenter: na
author: chkuhtz
manager: narayan
editor: 
ms.assetid: 748e50cd-3087-4c2e-a9e1-ac0ecce4f869
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/11/2016
ms.author: chkuhtz
ms.openlocfilehash: d9e88b859020be2a96a57a01e5624052ed134b64
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="multiple-vips-for-azure-load-balancer"></a><span data-ttu-id="1416c-103">Azure Load Balancer için birden çok VIP</span><span class="sxs-lookup"><span data-stu-id="1416c-103">Multiple VIPs for Azure Load Balancer</span></span>

<span data-ttu-id="1416c-104">Azure yük dengeleyici, birden çok bağlantı noktası, birden çok IP adresi veya her ikisi de Hizmetleri yüklemenizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="1416c-104">Azure Load Balancer allows you to load balance services on multiple ports, multiple IP addresses, or both.</span></span> <span data-ttu-id="1416c-105">Genel ve iç yük dengeleyici tanımları Bakiye akışları VM'ler kümesi boyunca yüklemek için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1416c-105">You can use public and internal load balancer definitions to load balance flows across a set of VMs.</span></span>

<span data-ttu-id="1416c-106">Bu makalede, bu özelliği, önemli kavramlar ve kısıtlamaları temelleri açıklanır.</span><span class="sxs-lookup"><span data-stu-id="1416c-106">This article describes the fundamentals of this ability, important concepts, and constraints.</span></span> <span data-ttu-id="1416c-107">Yalnızca bir IP adresi hizmetlerinde kullanıma sunmak istiyorsanız, için Basitleştirilmiş yönergelerini bulabilirsiniz [ortak](load-balancer-get-started-internet-portal.md) veya [iç](load-balancer-get-started-ilb-arm-portal.md) yük dengeleyici yapılandırmalarının.</span><span class="sxs-lookup"><span data-stu-id="1416c-107">If you only intend to expose services on one IP address, you can find simplified instructions for [public](load-balancer-get-started-internet-portal.md) or [internal](load-balancer-get-started-ilb-arm-portal.md) load balancer configurations.</span></span> <span data-ttu-id="1416c-108">Birden çok Vip eklemek için tek bir VIP yapılandırması artımlı olur.</span><span class="sxs-lookup"><span data-stu-id="1416c-108">Adding Multiple VIPs is incremental to a single VIP configuration.</span></span> <span data-ttu-id="1416c-109">Bu makalede kavramları kullanarak herhangi bir zamanda Basitleştirilmiş bir yapılandırma genişletebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1416c-109">Using the concepts in this article, you can expand a simplified configuration at any time.</span></span>

<span data-ttu-id="1416c-110">Bir Azure yük dengeleyici tanımladığınızda, bir ön uç ve arka uç yapılandırması kuralları ile bağlanır.</span><span class="sxs-lookup"><span data-stu-id="1416c-110">When you define an Azure Load Balancer, a frontend and a backend configuration are connected with rules.</span></span> <span data-ttu-id="1416c-111">Kuralı tarafından başvurulan durumu araştırması nasıl yeni akışları belirlemek için kullanılan bir düğüme arka uç havuzundaki gönderilir.</span><span class="sxs-lookup"><span data-stu-id="1416c-111">The health probe referenced by the rule is used to determine how new flows are sent to a node in the backend pool.</span></span> <span data-ttu-id="1416c-112">Ön uç sanal IP (bir IP adresi (ortak veya dahili), Aktarım Protokolü (UDP veya TCP) ve bir bağlantı noktası numarası oluşan 3-tanımlama grubu olan bir VIP tarafından), tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="1416c-112">The frontend is defined by a Virtual IP (VIP), which is a 3-tuple comprised of an IP address (public or internal), a transport protocol (UDP or TCP), and a port number.</span></span> <span data-ttu-id="1416c-113">Bir DIP, arka uç havuzundaki bir VM'ye bağlı bir Azure sanal NIC üzerinde bir IP adresidir.</span><span class="sxs-lookup"><span data-stu-id="1416c-113">A DIP is an IP address on an Azure virtual NIC attached to a VM in the backend pool.</span></span>

<span data-ttu-id="1416c-114">Aşağıdaki tabloda bazı örnek ön uç yapılandırmaları içerir:</span><span class="sxs-lookup"><span data-stu-id="1416c-114">The following table contains some example frontend configurations:</span></span>

| <span data-ttu-id="1416c-115">VIP</span><span class="sxs-lookup"><span data-stu-id="1416c-115">VIP</span></span> | <span data-ttu-id="1416c-116">IP adresi</span><span class="sxs-lookup"><span data-stu-id="1416c-116">IP address</span></span> | <span data-ttu-id="1416c-117">Protokolü</span><span class="sxs-lookup"><span data-stu-id="1416c-117">protocol</span></span> | <span data-ttu-id="1416c-118">port</span><span class="sxs-lookup"><span data-stu-id="1416c-118">port</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="1416c-119">1</span><span class="sxs-lookup"><span data-stu-id="1416c-119">1</span></span> |<span data-ttu-id="1416c-120">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="1416c-120">65.52.0.1</span></span> |<span data-ttu-id="1416c-121">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-121">TCP</span></span> |<span data-ttu-id="1416c-122">80</span><span class="sxs-lookup"><span data-stu-id="1416c-122">80</span></span> |
| <span data-ttu-id="1416c-123">2</span><span class="sxs-lookup"><span data-stu-id="1416c-123">2</span></span> |<span data-ttu-id="1416c-124">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="1416c-124">65.52.0.1</span></span> |<span data-ttu-id="1416c-125">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-125">TCP</span></span> |<span data-ttu-id="1416c-126">*8080*</span><span class="sxs-lookup"><span data-stu-id="1416c-126">*8080*</span></span> |
| <span data-ttu-id="1416c-127">3</span><span class="sxs-lookup"><span data-stu-id="1416c-127">3</span></span> |<span data-ttu-id="1416c-128">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="1416c-128">65.52.0.1</span></span> |<span data-ttu-id="1416c-129">*UDP*</span><span class="sxs-lookup"><span data-stu-id="1416c-129">*UDP*</span></span> |<span data-ttu-id="1416c-130">80</span><span class="sxs-lookup"><span data-stu-id="1416c-130">80</span></span> |
| <span data-ttu-id="1416c-131">4</span><span class="sxs-lookup"><span data-stu-id="1416c-131">4</span></span> |<span data-ttu-id="1416c-132">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="1416c-132">*65.52.0.2*</span></span> |<span data-ttu-id="1416c-133">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-133">TCP</span></span> |<span data-ttu-id="1416c-134">80</span><span class="sxs-lookup"><span data-stu-id="1416c-134">80</span></span> |

<span data-ttu-id="1416c-135">Tablo dört farklı ön uçlar gösterir.</span><span class="sxs-lookup"><span data-stu-id="1416c-135">The table shows four different frontends.</span></span> <span data-ttu-id="1416c-136">Ön Uçlar #1, #2 ve #3 birden çok kural ile tek bir VIP değerlerdir.</span><span class="sxs-lookup"><span data-stu-id="1416c-136">Frontends #1, #2 and #3 are a single VIP with multiple rules.</span></span> <span data-ttu-id="1416c-137">Aynı IP adresi kullanılır ancak protokolü ve bağlantı noktası her ön uç için farklıdır.</span><span class="sxs-lookup"><span data-stu-id="1416c-137">The same IP address is used but the port or protocol is different for each frontend.</span></span> <span data-ttu-id="1416c-138">Ön Uçlar #1 ve #4 aynı ön uç protokolü ve bağlantı noktası birden çok Vip burada yeniden birden çok Vip bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="1416c-138">Frontends #1 and #4 are an example of Multiple VIPs, where the same frontend protocol and port are reused across multiple VIPs.</span></span>

<span data-ttu-id="1416c-139">Azure yük dengeleyici Yük Dengeleme kuralları tanımlama esneklik sağlar.</span><span class="sxs-lookup"><span data-stu-id="1416c-139">Azure Load Balancer provides flexibility in defining the load balancing rules.</span></span> <span data-ttu-id="1416c-140">Nasıl bir adresi ve bağlantı noktası ön uç üzerinde eşlendiği arka uç bağlantı noktası ve hedef adresi için bir kural bildirir.</span><span class="sxs-lookup"><span data-stu-id="1416c-140">A rule declares how an address and port on the frontend is mapped to the destination address and port on the backend.</span></span> <span data-ttu-id="1416c-141">Arka uç bağlantı noktaları kuralları yeniden kural türüne bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="1416c-141">Whether or not backend ports are reused across rules depends on the type of the rule.</span></span> <span data-ttu-id="1416c-142">Her kural türünün, ana bilgisayar yapılandırması ve araştırma tasarım etkileyebilir belirli gereksinimleri vardır.</span><span class="sxs-lookup"><span data-stu-id="1416c-142">Each type of rule has specific requirements that can affect host configuration and probe design.</span></span> <span data-ttu-id="1416c-143">İki kural türü vardır:</span><span class="sxs-lookup"><span data-stu-id="1416c-143">There are two types of rules:</span></span>

1. <span data-ttu-id="1416c-144">Hiçbir arka uç bağlantı noktasını yeniden varsayılan kural</span><span class="sxs-lookup"><span data-stu-id="1416c-144">The default rule with no backend port reuse</span></span>
2. <span data-ttu-id="1416c-145">Arka uç bağlantı noktaları nerede tekrar kayan IP kuralı</span><span class="sxs-lookup"><span data-stu-id="1416c-145">The Floating IP rule where backend ports are reused</span></span>

<span data-ttu-id="1416c-146">Azure yük dengeleyici aynı yük dengeleyici yapılandırmasında her iki kural türlerini karma olarak sağlar.</span><span class="sxs-lookup"><span data-stu-id="1416c-146">Azure Load Balancer allows you to mix both rule types on the same load balancer configuration.</span></span> <span data-ttu-id="1416c-147">Kural kısıtlamalar tarafından uymanız sürece yük dengeleyici bunları aynı anda belirli bir VM veya herhangi bir birleşimini kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1416c-147">The load balancer can use them simultaneously for a given VM, or any combination, as long as you abide by the constraints of the rule.</span></span> <span data-ttu-id="1416c-148">Seçtiğiniz hangi kural türü, uygulamanızın gereksinimlerine ve bu yapılandırmayı destekleyen karmaşıklığına bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="1416c-148">Which rule type you choose depends on the requirements of your application and the complexity of supporting that configuration.</span></span> <span data-ttu-id="1416c-149">Hangi kural türlerinin senaryonuz için en iyi olduğunu değerlendirmelidir.</span><span class="sxs-lookup"><span data-stu-id="1416c-149">You should evaluate which rule types are best for your scenario.</span></span>

<span data-ttu-id="1416c-150">Biz bu senaryolar daha fazla varsayılan davranışı ile başlatarak keşfedin.</span><span class="sxs-lookup"><span data-stu-id="1416c-150">We explore these scenarios further by starting with the default behavior.</span></span>

## <a name="rule-type-1-no-backend-port-reuse"></a><span data-ttu-id="1416c-151">Kural türü #1: hiçbir arka uç bağlantı noktasını yeniden kullanma</span><span class="sxs-lookup"><span data-stu-id="1416c-151">Rule type #1: No backend port reuse</span></span>

![MultiVIP çizim](./media/load-balancer-multivip-overview/load-balancer-multivip.png)

<span data-ttu-id="1416c-153">Bu senaryoda, ön uç VIP'ler aşağıdaki gibi yapılandırılır:</span><span class="sxs-lookup"><span data-stu-id="1416c-153">In this scenario, the frontend VIPs are configured as follows:</span></span>

| <span data-ttu-id="1416c-154">VIP</span><span class="sxs-lookup"><span data-stu-id="1416c-154">VIP</span></span> | <span data-ttu-id="1416c-155">IP adresi</span><span class="sxs-lookup"><span data-stu-id="1416c-155">IP address</span></span> | <span data-ttu-id="1416c-156">Protokolü</span><span class="sxs-lookup"><span data-stu-id="1416c-156">protocol</span></span> | <span data-ttu-id="1416c-157">port</span><span class="sxs-lookup"><span data-stu-id="1416c-157">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-159">1</span><span class="sxs-lookup"><span data-stu-id="1416c-159">1</span></span> |<span data-ttu-id="1416c-160">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="1416c-160">65.52.0.1</span></span> |<span data-ttu-id="1416c-161">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-161">TCP</span></span> |<span data-ttu-id="1416c-162">80</span><span class="sxs-lookup"><span data-stu-id="1416c-162">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-164">2</span><span class="sxs-lookup"><span data-stu-id="1416c-164">2</span></span> |<span data-ttu-id="1416c-165">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="1416c-165">*65.52.0.2*</span></span> |<span data-ttu-id="1416c-166">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-166">TCP</span></span> |<span data-ttu-id="1416c-167">80</span><span class="sxs-lookup"><span data-stu-id="1416c-167">80</span></span> |

<span data-ttu-id="1416c-168">DIP gelen akışının hedefi değil.</span><span class="sxs-lookup"><span data-stu-id="1416c-168">The DIP is the destination of the inbound flow.</span></span> <span data-ttu-id="1416c-169">Arka uç havuzundaki her VM benzersiz bir bağlantı noktası bir DIP üzerinde istenen hizmeti kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="1416c-169">In the backend pool, each VM exposes the desired service on a unique port on a DIP.</span></span> <span data-ttu-id="1416c-170">Bu hizmet, bir kural tanımı aracılığıyla ön uç ile ilişkilidir.</span><span class="sxs-lookup"><span data-stu-id="1416c-170">This service is associated with the frontend through a rule definition.</span></span>

<span data-ttu-id="1416c-171">Şu iki kural tanımlayın:</span><span class="sxs-lookup"><span data-stu-id="1416c-171">We define two rules:</span></span>

| <span data-ttu-id="1416c-172">Kural</span><span class="sxs-lookup"><span data-stu-id="1416c-172">Rule</span></span> | <span data-ttu-id="1416c-173">Ön uç eşleme</span><span class="sxs-lookup"><span data-stu-id="1416c-173">Map frontend</span></span> | <span data-ttu-id="1416c-174">Arka uç havuzuna</span><span class="sxs-lookup"><span data-stu-id="1416c-174">To backend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1416c-175">1</span><span class="sxs-lookup"><span data-stu-id="1416c-175">1</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-177">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="1416c-177">VIP1:80</span></span> |![arka uç](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-179">DIP1:80,</span><span class="sxs-lookup"><span data-stu-id="1416c-179">DIP1:80,</span></span> ![arka uç](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-181">DIP2:80</span><span class="sxs-lookup"><span data-stu-id="1416c-181">DIP2:80</span></span> |
| <span data-ttu-id="1416c-182">2</span><span class="sxs-lookup"><span data-stu-id="1416c-182">2</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-184">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="1416c-184">VIP2:80</span></span> |![arka uç](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-186">DIP1:81,</span><span class="sxs-lookup"><span data-stu-id="1416c-186">DIP1:81,</span></span> ![arka uç](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-188">DIP2:81</span><span class="sxs-lookup"><span data-stu-id="1416c-188">DIP2:81</span></span> |

<span data-ttu-id="1416c-189">Azure yük dengeleyici tam eşlemesindeki şimdi aşağıdaki gibidir:</span><span class="sxs-lookup"><span data-stu-id="1416c-189">The complete mapping in Azure Load Balancer is now as follows:</span></span>

| <span data-ttu-id="1416c-190">Kural</span><span class="sxs-lookup"><span data-stu-id="1416c-190">Rule</span></span> | <span data-ttu-id="1416c-191">VIP IP adresi</span><span class="sxs-lookup"><span data-stu-id="1416c-191">VIP IP address</span></span> | <span data-ttu-id="1416c-192">Protokolü</span><span class="sxs-lookup"><span data-stu-id="1416c-192">protocol</span></span> | <span data-ttu-id="1416c-193">port</span><span class="sxs-lookup"><span data-stu-id="1416c-193">port</span></span> | <span data-ttu-id="1416c-194">Hedef</span><span class="sxs-lookup"><span data-stu-id="1416c-194">Destination</span></span> | <span data-ttu-id="1416c-195">port</span><span class="sxs-lookup"><span data-stu-id="1416c-195">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![Kural](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-197">1</span><span class="sxs-lookup"><span data-stu-id="1416c-197">1</span></span> |<span data-ttu-id="1416c-198">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="1416c-198">65.52.0.1</span></span> |<span data-ttu-id="1416c-199">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-199">TCP</span></span> |<span data-ttu-id="1416c-200">80</span><span class="sxs-lookup"><span data-stu-id="1416c-200">80</span></span> |<span data-ttu-id="1416c-201">DIP IP adresi</span><span class="sxs-lookup"><span data-stu-id="1416c-201">DIP IP Address</span></span> |<span data-ttu-id="1416c-202">80</span><span class="sxs-lookup"><span data-stu-id="1416c-202">80</span></span> |
| ![Kural](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-204">2</span><span class="sxs-lookup"><span data-stu-id="1416c-204">2</span></span> |<span data-ttu-id="1416c-205">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="1416c-205">65.52.0.2</span></span> |<span data-ttu-id="1416c-206">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-206">TCP</span></span> |<span data-ttu-id="1416c-207">80</span><span class="sxs-lookup"><span data-stu-id="1416c-207">80</span></span> |<span data-ttu-id="1416c-208">DIP IP adresi</span><span class="sxs-lookup"><span data-stu-id="1416c-208">DIP IP Address</span></span> |<span data-ttu-id="1416c-209">81</span><span class="sxs-lookup"><span data-stu-id="1416c-209">81</span></span> |

<span data-ttu-id="1416c-210">Her kural benzersiz bir hedef IP adresi ve hedef bağlantı noktası birleşimi ile akışını üretmek gerekir.</span><span class="sxs-lookup"><span data-stu-id="1416c-210">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="1416c-211">Hedef bağlantı noktası akışının değiştirerek, birden çok kural akışları farklı bağlantı noktalarını aynı DIP ulaştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1416c-211">By varying the destination port of the flow, multiple rules can deliver flows to the same DIP on different ports.</span></span>

<span data-ttu-id="1416c-212">Sistem durumu araştırmalarının her zaman bir VM DIP için yönlendirilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1416c-212">Health probes are always directed to the DIP of a VM.</span></span> <span data-ttu-id="1416c-213">Sağlamanız gerekir, araştırma VM durumunu yansıtır.</span><span class="sxs-lookup"><span data-stu-id="1416c-213">You must ensure you that your probe reflects the health of the VM.</span></span>

## <a name="rule-type-2-backend-port-reuse-by-using-floating-ip"></a><span data-ttu-id="1416c-214">Kural türü #2: kayan IP kullanarak arka uç bağlantı noktasını yeniden kullanma</span><span class="sxs-lookup"><span data-stu-id="1416c-214">Rule type #2: backend port reuse by using Floating IP</span></span>

<span data-ttu-id="1416c-215">Azure yük dengeleyici ön uç bağlantı noktası üzerinden birden çok Vip kullanılan kural türü ne olursa olsun yeniden kullanma esnekliği sağlar.</span><span class="sxs-lookup"><span data-stu-id="1416c-215">Azure Load Balancer provides the flexibility to reuse the frontend port across multiple VIPs regardless of the rule type used.</span></span> <span data-ttu-id="1416c-216">Ayrıca, bazı uygulama senaryoları tercih veya arka uç havuzundaki tek bir VM üzerindeki birden çok uygulama örneği tarafından kullanılmak üzere aynı bağlantı noktası gerektirir.</span><span class="sxs-lookup"><span data-stu-id="1416c-216">Additionally, some application scenarios prefer or require the same port to be used by multiple application instances on a single VM in the backend pool.</span></span> <span data-ttu-id="1416c-217">Bağlantı noktası yeniden ortak örnekleri için yüksek kullanılabilirliği kümeleme içerir, ağ sanal Gereçleri ve birden çok TLS uç noktaları yeniden şifreleme olmadan gösterme.</span><span class="sxs-lookup"><span data-stu-id="1416c-217">Common examples of port reuse include clustering for high availability, network virtual appliances, and exposing multiple TLS endpoints without re-encryption.</span></span>

<span data-ttu-id="1416c-218">Arka uç bağlantı noktası birden çok kural yeniden kullanmak istiyorsanız, kural tanımı kayan IP etkinleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="1416c-218">If you want to reuse the backend port across multiple rules, you must enable Floating IP in the rule definition.</span></span>

<span data-ttu-id="1416c-219">Kayan IP, doğrudan sunucu Döndür (DSR olarak) bilinen bir bölümüdür.</span><span class="sxs-lookup"><span data-stu-id="1416c-219">Floating IP is a portion of what is known as Direct Server Return (DSR).</span></span> <span data-ttu-id="1416c-220">DSR iki bölümden oluşur: Eşleme Şeması bir akış topolojisi ve bir IP adresi.</span><span class="sxs-lookup"><span data-stu-id="1416c-220">DSR consists of two parts: a flow topology and an IP address mapping scheme.</span></span> <span data-ttu-id="1416c-221">Bir platform düzeyde Azure yük dengeleyici DSR akış topolojisinde kayan IP etkin olup olmadığı bağımsız olarak her zaman çalışır.</span><span class="sxs-lookup"><span data-stu-id="1416c-221">At a platform level, Azure Load Balancer always operates in a DSR flow topology regardless of whether Floating IP is enabled or not.</span></span> <span data-ttu-id="1416c-222">Bu, doğrudan kaynağa geri akışı için bir akış giden parçası her zaman doğru yeniden anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="1416c-222">This means that the outbound part of a flow is always correctly rewritten to flow directly back to the origin.</span></span>

<span data-ttu-id="1416c-223">Varsayılan kural türüyle Azure geleneksel Yük Dengeleme kullanım kolaylığı için IP adresi eşleme şeması kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="1416c-223">With the default rule type, Azure exposes a traditional load balancing IP address mapping scheme for ease of use.</span></span> <span data-ttu-id="1416c-224">Kayan IP etkinleştirme aşağıda açıklandığı gibi ek esneklik sağlamak amacıyla IP adresi eşleme şeması değiştirir.</span><span class="sxs-lookup"><span data-stu-id="1416c-224">Enabling Floating IP changes the IP address mapping scheme to allow for additional flexibility as explained below.</span></span>

<span data-ttu-id="1416c-225">Aşağıdaki diyagramda bu yapılandırma gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="1416c-225">The following diagram illustrates this configuration:</span></span>

![MultiVIP çizim](./media/load-balancer-multivip-overview/load-balancer-multivip-dsr.png)

<span data-ttu-id="1416c-227">Bu senaryo için arka uç havuzundaki her VM üç ağ arabirimi bulunur:</span><span class="sxs-lookup"><span data-stu-id="1416c-227">For this scenario, every VM in the backend pool has three network interfaces:</span></span>

* <span data-ttu-id="1416c-228">DIP: sanal (Azure'un NIC kaynak IP yapılandırması) VM ile ilişkili NIC</span><span class="sxs-lookup"><span data-stu-id="1416c-228">DIP: a Virtual NIC associated with the VM (IP configuration of Azure's NIC resource)</span></span>
* <span data-ttu-id="1416c-229">Vıp1: bir geri döngü arabirimde Konuk vıp1 IP adresiyle yapılandırılmış işletim sistemi</span><span class="sxs-lookup"><span data-stu-id="1416c-229">VIP1: a loopback interface within guest OS that is configured with IP address of VIP1</span></span>
* <span data-ttu-id="1416c-230">Vıp2: bir geri döngü arabirimde Konuk vıp2 IP adresiyle yapılandırılmış işletim sistemi</span><span class="sxs-lookup"><span data-stu-id="1416c-230">VIP2: a loopback interface within guest OS that is configured with IP address of VIP2</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1416c-231">Mantıksal birimleri yapılandırma konuk işletim sistemi içinde gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="1416c-231">The configuration of the logical interfaces is performed within the guest OS.</span></span> <span data-ttu-id="1416c-232">Bu yapılandırma değil gerçekleştirilen veya Azure tarafından yönetiliyor.</span><span class="sxs-lookup"><span data-stu-id="1416c-232">This configuration is not performed or managed by Azure.</span></span> <span data-ttu-id="1416c-233">Bu yapılandırma olmazsa, kurallar çalışmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="1416c-233">Without this configuration, the rules will not function.</span></span> <span data-ttu-id="1416c-234">Sistem durumu araştırma tanımları mantıksal VIP yerine VM DIP kullanın.</span><span class="sxs-lookup"><span data-stu-id="1416c-234">Health probe definitions use the DIP of the VM rather than the logical VIP.</span></span> <span data-ttu-id="1416c-235">Bu nedenle, hizmetiniz mantıksal VIP sunulan hizmetinin durumunu yansıtacak bir DIP bağlantı noktasında araştırma yanıtları sağlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1416c-235">Therefore, your service must provide probe responses on a DIP port that reflect the status of the service offered on the logical VIP.</span></span>

<span data-ttu-id="1416c-236">Önceki senaryoda olduğu gibi aynı ön uç yapılandırma varsayalım:</span><span class="sxs-lookup"><span data-stu-id="1416c-236">Let's assume the same frontend configuration as in the previous scenario:</span></span>

| <span data-ttu-id="1416c-237">VIP</span><span class="sxs-lookup"><span data-stu-id="1416c-237">VIP</span></span> | <span data-ttu-id="1416c-238">IP adresi</span><span class="sxs-lookup"><span data-stu-id="1416c-238">IP address</span></span> | <span data-ttu-id="1416c-239">Protokolü</span><span class="sxs-lookup"><span data-stu-id="1416c-239">protocol</span></span> | <span data-ttu-id="1416c-240">port</span><span class="sxs-lookup"><span data-stu-id="1416c-240">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-242">1</span><span class="sxs-lookup"><span data-stu-id="1416c-242">1</span></span> |<span data-ttu-id="1416c-243">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="1416c-243">65.52.0.1</span></span> |<span data-ttu-id="1416c-244">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-244">TCP</span></span> |<span data-ttu-id="1416c-245">80</span><span class="sxs-lookup"><span data-stu-id="1416c-245">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-247">2</span><span class="sxs-lookup"><span data-stu-id="1416c-247">2</span></span> |<span data-ttu-id="1416c-248">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="1416c-248">*65.52.0.2*</span></span> |<span data-ttu-id="1416c-249">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-249">TCP</span></span> |<span data-ttu-id="1416c-250">80</span><span class="sxs-lookup"><span data-stu-id="1416c-250">80</span></span> |

<span data-ttu-id="1416c-251">Şu iki kural tanımlayın:</span><span class="sxs-lookup"><span data-stu-id="1416c-251">We define two rules:</span></span>

| <span data-ttu-id="1416c-252">Kural</span><span class="sxs-lookup"><span data-stu-id="1416c-252">Rule</span></span> | <span data-ttu-id="1416c-253">Ön uç eşleme</span><span class="sxs-lookup"><span data-stu-id="1416c-253">Map frontend</span></span> | <span data-ttu-id="1416c-254">Arka uç havuzuna</span><span class="sxs-lookup"><span data-stu-id="1416c-254">To backend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1416c-255">1</span><span class="sxs-lookup"><span data-stu-id="1416c-255">1</span></span> |![Kural](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-257">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="1416c-257">VIP1:80</span></span> |![arka uç](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-259">VIP1:80 (içinde VM1 ve VM2)</span><span class="sxs-lookup"><span data-stu-id="1416c-259">VIP1:80 (in VM1 and VM2)</span></span> |
| <span data-ttu-id="1416c-260">2</span><span class="sxs-lookup"><span data-stu-id="1416c-260">2</span></span> |![Kural](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-262">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="1416c-262">VIP2:80</span></span> |![arka uç](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-264">VIP2:80 (içinde VM1 ve VM2)</span><span class="sxs-lookup"><span data-stu-id="1416c-264">VIP2:80 (in VM1 and VM2)</span></span> |

<span data-ttu-id="1416c-265">Aşağıdaki tabloda yük dengeleyicide tam eşleme gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="1416c-265">The following table shows the complete mapping in the load balancer:</span></span>

| <span data-ttu-id="1416c-266">Kural</span><span class="sxs-lookup"><span data-stu-id="1416c-266">Rule</span></span> | <span data-ttu-id="1416c-267">VIP IP adresi</span><span class="sxs-lookup"><span data-stu-id="1416c-267">VIP IP address</span></span> | <span data-ttu-id="1416c-268">Protokolü</span><span class="sxs-lookup"><span data-stu-id="1416c-268">protocol</span></span> | <span data-ttu-id="1416c-269">port</span><span class="sxs-lookup"><span data-stu-id="1416c-269">port</span></span> | <span data-ttu-id="1416c-270">Hedef</span><span class="sxs-lookup"><span data-stu-id="1416c-270">Destination</span></span> | <span data-ttu-id="1416c-271">port</span><span class="sxs-lookup"><span data-stu-id="1416c-271">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="1416c-273">1</span><span class="sxs-lookup"><span data-stu-id="1416c-273">1</span></span> |<span data-ttu-id="1416c-274">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="1416c-274">65.52.0.1</span></span> |<span data-ttu-id="1416c-275">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-275">TCP</span></span> |<span data-ttu-id="1416c-276">80</span><span class="sxs-lookup"><span data-stu-id="1416c-276">80</span></span> |<span data-ttu-id="1416c-277">VIP (65.52.0.1) ile aynı</span><span class="sxs-lookup"><span data-stu-id="1416c-277">same as VIP (65.52.0.1)</span></span> |<span data-ttu-id="1416c-278">VIP (80) aynı</span><span class="sxs-lookup"><span data-stu-id="1416c-278">same as VIP (80)</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="1416c-280">2</span><span class="sxs-lookup"><span data-stu-id="1416c-280">2</span></span> |<span data-ttu-id="1416c-281">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="1416c-281">65.52.0.2</span></span> |<span data-ttu-id="1416c-282">TCP</span><span class="sxs-lookup"><span data-stu-id="1416c-282">TCP</span></span> |<span data-ttu-id="1416c-283">80</span><span class="sxs-lookup"><span data-stu-id="1416c-283">80</span></span> |<span data-ttu-id="1416c-284">VIP (65.52.0.2) ile aynı</span><span class="sxs-lookup"><span data-stu-id="1416c-284">same as VIP (65.52.0.2)</span></span> |<span data-ttu-id="1416c-285">VIP (80) aynı</span><span class="sxs-lookup"><span data-stu-id="1416c-285">same as VIP (80)</span></span> |

<span data-ttu-id="1416c-286">Gelen akış hedef VM'deki geri döngü arabirimde VIP adresi değil.</span><span class="sxs-lookup"><span data-stu-id="1416c-286">The destination of the inbound flow is the VIP address on the loopback interface in the VM.</span></span> <span data-ttu-id="1416c-287">Her kural benzersiz bir hedef IP adresi ve hedef bağlantı noktası birleşimi ile akışını üretmek gerekir.</span><span class="sxs-lookup"><span data-stu-id="1416c-287">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="1416c-288">Akış hedef IP adresini değiştirerek, bağlantı noktası yeniden aynı VM'de mümkündür.</span><span class="sxs-lookup"><span data-stu-id="1416c-288">By varying the destination IP address of the flow, port reuse is possible on the same VM.</span></span> <span data-ttu-id="1416c-289">Hizmetiniz için yük dengeleyici VIP'ın IP adresi ve bağlantı noktası ilgili geri döngü arabiriminin bağlayarak açıktır.</span><span class="sxs-lookup"><span data-stu-id="1416c-289">Your service is exposed to the load balancer by binding it to the VIP’s IP address and port of the respective loopback interface.</span></span>

<span data-ttu-id="1416c-290">Bu örnek hedef bağlantı noktası değiştirmez dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="1416c-290">Notice that this example does not change the destination port.</span></span> <span data-ttu-id="1416c-291">Bu bir kayan IP senaryo olsa da, Azure yük dengeleyici arka uç hedef bağlantı noktası yeniden yazma ve ön uç hedef bağlantı noktası farklı sağlamak için kural tanımlama de destekler.</span><span class="sxs-lookup"><span data-stu-id="1416c-291">Even though this is a Floating IP scenario, Azure Load Balancer also supports defining a rule to rewrite the backend destination port and to make it different from the frontend destination port.</span></span>

<span data-ttu-id="1416c-292">Kayan IP kural türü birden fazla yük dengeleyici yapılandırması desenlerini oluşturmaktadır.</span><span class="sxs-lookup"><span data-stu-id="1416c-292">The Floating IP rule type is the foundation of several load balancer configuration patterns.</span></span> <span data-ttu-id="1416c-293">Şu anda kullanılabilir bir örnektir [SQL AlwaysOn ile birden çok dinleyici](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) yapılandırma.</span><span class="sxs-lookup"><span data-stu-id="1416c-293">One example that is currently available is the [SQL AlwaysOn with Multiple Listeners](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuration.</span></span> <span data-ttu-id="1416c-294">Zamanla, biz bu senaryoların birkaçı belge.</span><span class="sxs-lookup"><span data-stu-id="1416c-294">Over time, we will document more of these scenarios.</span></span>

## <a name="limitations"></a><span data-ttu-id="1416c-295">Sınırlamalar</span><span class="sxs-lookup"><span data-stu-id="1416c-295">Limitations</span></span>

* <span data-ttu-id="1416c-296">Birden çok VIP yapılandırmaları yalnızca Iaas VM'ler ile desteklenir.</span><span class="sxs-lookup"><span data-stu-id="1416c-296">Multiple VIP configurations are only supported with IaaS VMs.</span></span>
* <span data-ttu-id="1416c-297">Kayan IP kuralla uygulamanız için giden trafik akışları DIP kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1416c-297">With the Floating IP rule, your application must use the DIP for outbound flows.</span></span> <span data-ttu-id="1416c-298">Uygulamanız için konuk işletim sistemi geri döngü arabiriminde yapılandırılan VIP adresine bağlanır, ardından SNAT giden akış yeniden kullanılabilir değil ve akış başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="1416c-298">If your application binds to the VIP address configured on the loopback interface in the guest OS, then SNAT is not available to rewrite the outbound flow and the flow fails.</span></span>
* <span data-ttu-id="1416c-299">Genel IP adresleri faturalama üzerinde bir etkisi yoktur.</span><span class="sxs-lookup"><span data-stu-id="1416c-299">Public IP addresses have an effect on billing.</span></span> <span data-ttu-id="1416c-300">Daha fazla bilgi için bkz: [IP adresi fiyatlandırma](https://azure.microsoft.com/pricing/details/ip-addresses/)</span><span class="sxs-lookup"><span data-stu-id="1416c-300">For more information, see [IP Address pricing](https://azure.microsoft.com/pricing/details/ip-addresses/)</span></span>
* <span data-ttu-id="1416c-301">Abonelik sınırları uygulayın.</span><span class="sxs-lookup"><span data-stu-id="1416c-301">Subscription limits apply.</span></span> <span data-ttu-id="1416c-302">Daha fazla bilgi için bkz: [hizmet sınırları](../azure-subscription-service-limits.md#networking-limits) Ayrıntılar için.</span><span class="sxs-lookup"><span data-stu-id="1416c-302">For more information, see [Service limits](../azure-subscription-service-limits.md#networking-limits) for details.</span></span>
