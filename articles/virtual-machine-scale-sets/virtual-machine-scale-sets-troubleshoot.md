---
title: "Sanal makine ölçek kümeleri ile aaaTroubleshoot otomatik ölçeklendirme | Microsoft Docs"
description: "Sanal makine ölçek kümeleri olan otomatik ölçeklendirme sorunlarını giderin. Karşılaşılan tipik sorunları anlamak ve nasıl tooresolve bunları."
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: c7d87b72-ee24-4e52-9377-a42f337f76fa
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: windows
ms.devlang: na
ms.topic: article
ms.date: 10/28/2016
ms.author: guybo
ms.openlocfilehash: 4c9a70992348d87fb43646421a90a027bf400a17
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-autoscale-with-virtual-machine-scale-sets"></a><span data-ttu-id="97754-104">Sanal makine ölçek kümeleri ile sorun giderme otomatik ölçeklendirme</span><span class="sxs-lookup"><span data-stu-id="97754-104">Troubleshooting autoscale with Virtual Machine Scale Sets</span></span>
<span data-ttu-id="97754-105">**Sorun** – otomatik ölçeklendirmeyi altyapı VM ölçek kümesi kullanarak Azure Resource Manager ile oluşturduğunuz – bu gibi bir şablon dağıtarak örneğin: https://github.com/Azure/azure-quickstart-templates/tree/master/201- vmss-bottle-otomatik ölçeklendirme – ölçek kurallarınızı tanımlanmış olması ve isteğe bağlı olarak hello VM'ler üzerinde put ne kadar yük olursa olsun, otomatik ölçeklendirme olmaz ancak bu harika, çalışır.</span><span class="sxs-lookup"><span data-stu-id="97754-105">**Problem** – you’ve created an autoscaling infrastructure in Azure Resource Manager using VM Scale Sets –  for example by deploying a template like this: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale  – you have your scale rules defined and it works great, except that no matter how much load you put on hello VMs, it won’t autoscale.</span></span>

## <a name="troubleshooting-steps"></a><span data-ttu-id="97754-106">Sorun giderme adımları</span><span class="sxs-lookup"><span data-stu-id="97754-106">Troubleshooting steps</span></span>
<span data-ttu-id="97754-107">Bazı şeyleri tooconsider şunları içerir:</span><span class="sxs-lookup"><span data-stu-id="97754-107">Some things tooconsider include:</span></span>

* <span data-ttu-id="97754-108">Her VM kaç çekirdeğe sahip ve her çekirdek yükleniyor? Merhaba örnek Azure Hızlı Başlangıç şablonu yukarıdaki tek bir çekirdek yükleyen bir do_work.php komut dosyası yok.</span><span class="sxs-lookup"><span data-stu-id="97754-108">How many cores does each VM have, and are you loading each core? hello example Azure Quickstart template above has a do_work.php script, which loads a single core.</span></span> <span data-ttu-id="97754-109">Standard_A1 veya D1 sonra bu yük birden çok kez toorun gerekir gibi tek bir çekirdek VM boyutu büyük bir VM kullanıyorsanız.</span><span class="sxs-lookup"><span data-stu-id="97754-109">If you’re using a VM bigger than a single core VM size like Standard_A1 or D1 then you’d need toorun this load multiple times.</span></span> <span data-ttu-id="97754-110">Kaç tane Vm'leriniz çekirdek gözden geçirerek denetleyin [boyutları için Windows azure'da sanal makineler](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span><span class="sxs-lookup"><span data-stu-id="97754-110">Check how many cores your VMs by reviewing [Sizes for Windows virtual machines in Azure](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span></span>
* <span data-ttu-id="97754-111">Merhaba VM ölçek kümesi, kaç tane Vm'lerde, her bir iş yapmakta olduğunuz?</span><span class="sxs-lookup"><span data-stu-id="97754-111">How many VMs in hello VM Scale Set, are you doing work on each one?</span></span>
  
    <span data-ttu-id="97754-112">Merhaba ortalama zaman arasında CPU olay genişletme yalnızca devre dışı gerçekleşecek **tüm** ölçek kümesindeki sanal makineleri hello hello otomatik ölçeklendirme kurallarında tanımlanan hello eşik değeri, iç hello zamanla aşıyor.</span><span class="sxs-lookup"><span data-stu-id="97754-112">A scale out event will only take place when hello average CPU across **all** hello VMs in a scale set exceeds hello threshold value, over hello time internal defined in hello autoscale rules.</span></span>
* <span data-ttu-id="97754-113">Herhangi bir ölçek olayı eksik olabilir mi?</span><span class="sxs-lookup"><span data-stu-id="97754-113">Did you miss any scale events?</span></span>
  
    <span data-ttu-id="97754-114">Merhaba ölçek olayları için Azure portalı Hello denetim günlüklerini denetleyin.</span><span class="sxs-lookup"><span data-stu-id="97754-114">Check hello audit logs in hello Azure portal for scale events.</span></span> <span data-ttu-id="97754-115">Belki de var. ölçek yukarı ve bir ölçekte da aşağı kaçırılan.</span><span class="sxs-lookup"><span data-stu-id="97754-115">Maybe there was a scale up and a scale down which was missed.</span></span> <span data-ttu-id="97754-116">"Ölçek" tarafından filtreleyebilirsiniz...</span><span class="sxs-lookup"><span data-stu-id="97754-116">You can filter by “Scale”..</span></span>
  
    ![Denetim Günlükleri][audit]
* <span data-ttu-id="97754-118">Ölçek ve genişletme eşikleri yeterince farklı misiniz?</span><span class="sxs-lookup"><span data-stu-id="97754-118">Are your scale-in and scale-out thresholds sufficiently different?</span></span>
  
    <span data-ttu-id="97754-119">Ortalama CPU % 50'den az olduğunda bir ortalama CPU 5 dakika boyunca % 50'den büyük olduğunda çıkışı kural tooscale ve tooscale ayarlayın varsayalım.</span><span class="sxs-lookup"><span data-stu-id="97754-119">Suppose you set a rule tooscale out when average CPU is greater than 50% over 5 minutes, and tooscale in when average CPU is less than 50%.</span></span> <span data-ttu-id="97754-120">CPU kullanımı ile sürekli artırma ve azaltma hello ölçeklendirme eylemi Kapat toothis eşik olduğunda bu hello kümesinin boyutu "flapping" sorunu neden olur.</span><span class="sxs-lookup"><span data-stu-id="97754-120">This would cause a “flapping” problem when CPU usage is close toothis threshold, with scale actions constantly increasing and decreasing hello size of hello set.</span></span> <span data-ttu-id="97754-121">Bu nedenle, hello otomatik ölçeklendirme hizmeti tooprevent "dalgalanma", hangi değil ölçeklendirme olarak bildirilebilir çalışır.</span><span class="sxs-lookup"><span data-stu-id="97754-121">Because of this, hello autoscale service tries tooprevent “flapping”, which can manifest as not scaling.</span></span> <span data-ttu-id="97754-122">Bu nedenle bazı ölçeklendirme arasında boşluk yeterince farklı tooallow genişleme ve ölçek bileşenini eşikleri olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="97754-122">Therefore make sure your scale-out and scale-in thresholds are sufficiently different tooallow some space in between scaling.</span></span>
* <span data-ttu-id="97754-123">Kendi JSON şablonunu yazdım?</span><span class="sxs-lookup"><span data-stu-id="97754-123">Did you write your own JSON template?</span></span>
  
    <span data-ttu-id="97754-124">Kolay toomake hatalar olduğundan, bu nedenle, yukarıdaki toowork kanıtlanmış hello gibi bir şablon ile başlayın ve küçük artımlı değişiklikleri yapın.</span><span class="sxs-lookup"><span data-stu-id="97754-124">It is easy toomake mistakes, so start with a template like hello one above which is proven toowork, and make small incremental changes.</span></span> 
* <span data-ttu-id="97754-125">El ile içeri veya dışarı ölçekleme yapabilirsiniz?</span><span class="sxs-lookup"><span data-stu-id="97754-125">Can you manually scale in or out?</span></span>
  
    <span data-ttu-id="97754-126">El ile yeniden dağıtırken hello VM ölçek kümesi kaynak VM'ler farklı "kapasitesi" ayarı toochange hello sayıda deneyin.</span><span class="sxs-lookup"><span data-stu-id="97754-126">Try redeploying hello VM Scale Set resource with a different “capacity” setting toochange hello number of VMs manually.</span></span> <span data-ttu-id="97754-127">Bu hazır bir örnek şablon toodo: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing – tooedit hello şablonu toomake hello olduğundan emin gerekebilir aynı makine boyutu ölçek kümesi kullanma gibi.</span><span class="sxs-lookup"><span data-stu-id="97754-127">An example template toodo this is here: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing – you may need tooedit hello template toomake sure it has hello same machine size as your Scale Set is using.</span></span> <span data-ttu-id="97754-128">Ardından VM'ler hello sayısı el ile başarılı bir şekilde değiştirirseniz, yalıtılmış tooautoscale hello sorun olduğunu bildiğiniz.</span><span class="sxs-lookup"><span data-stu-id="97754-128">If you can successfully change hello number of VMs manually, then you know hello problem is isolated tooautoscale.</span></span>
* <span data-ttu-id="97754-129">Microsoft.Compute/virtualMachineScaleSet denetleyin ve hello Microsoft.ınsights kaynaklarında [Azure kaynak Gezgini](https://resources.azure.com/)</span><span class="sxs-lookup"><span data-stu-id="97754-129">Check your Microsoft.Compute/virtualMachineScaleSet, and Microsoft.Insights resources in hello [Azure Resource Explorer](https://resources.azure.com/)</span></span>
  
    <span data-ttu-id="97754-130">Bu bir vazgeçilmez olan sorun giderme, gösteren aracı hello Azure Resource Manager kaynaklarınızı durumu.</span><span class="sxs-lookup"><span data-stu-id="97754-130">This is an indispensable troubleshooting tool which shows you hello state of your Azure Resource Manager resources.</span></span> <span data-ttu-id="97754-131">Aboneliğinizi tıklatın ve kaynak grubu sorun gidermekte olduğunuz hello arayın.</span><span class="sxs-lookup"><span data-stu-id="97754-131">Click on your subscription and look at hello Resource Group you are troubleshooting.</span></span> <span data-ttu-id="97754-132">Hello işlem kaynak sağlayıcısı altında hello sırasında oluşturduğunuz VM ölçek kümesi arayın ve Merhaba, gösterir örnek görünümünü kontrol hello dağıtımının durumu.</span><span class="sxs-lookup"><span data-stu-id="97754-132">Under hello Compute resource provider look at hello VM Scale Set you created and check hello Instance View, which shows you hello state of a deployment.</span></span> <span data-ttu-id="97754-133">Ayrıca hello örneği görünümünde VM'ler hello VM ölçek kümesi denetleyin.</span><span class="sxs-lookup"><span data-stu-id="97754-133">Also check hello instance view of VMs in hello VM Scale Set.</span></span> <span data-ttu-id="97754-134">Ardından hello Microsoft.ınsights kaynak sağlayıcısını gidin ve hello otomatik ölçeklendirme kurallarını iyi görünen denetleyin.</span><span class="sxs-lookup"><span data-stu-id="97754-134">Then go into hello Microsoft.Insights resource provider and check hello autoscale rules look good.</span></span>
* <span data-ttu-id="97754-135">Merhaba tanılama uzantısını çalışma ve performans verilerini yayma?</span><span class="sxs-lookup"><span data-stu-id="97754-135">Is hello Diagnostic extension working and emitting performance data?</span></span>
  
    <span data-ttu-id="97754-136">**Güncelleştirme:** Azure otomatik ölçeklendirme, bir ana bilgisayar tabanlı artık yüklü bir tanılama uzantısını toobe gerektiren ölçüm ardışık Gelişmiş toouse açıldı.</span><span class="sxs-lookup"><span data-stu-id="97754-136">**Update:** Azure autoscale has been enhanced toouse a host based metrics pipeline which no longer requires a diagnostics extension toobe installed.</span></span> <span data-ttu-id="97754-137">Sonraki birkaç hello yani paragrafları artık geçerli hello yeni işlem hattı kullanarak otomatik ölçeklendirmeyi uygulama oluşturmak istiyorsanız.</span><span class="sxs-lookup"><span data-stu-id="97754-137">This means hello next few paragraphs no longer apply if you create an autoscaling application using hello new pipeline.</span></span> <span data-ttu-id="97754-138">Dönüştürülen toouse Merhaba ana ardışık silinmiş Azure şablonları örneğidir: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale.</span><span class="sxs-lookup"><span data-stu-id="97754-138">An example of Azure templates which have been converted toouse hello host pipeline is: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale.</span></span> 
  
    <span data-ttu-id="97754-139">Otomatik ölçeklendirme için ana bilgisayar tabanlı ölçümleri kullanarak aşağıdaki nedenlerden hello için daha iyi olur:</span><span class="sxs-lookup"><span data-stu-id="97754-139">Using host based metrics for autoscale is better for hello following reasons:</span></span>
  
  * <span data-ttu-id="97754-140">Tanılama uzantısız olarak daha az hareketli parça yüklü toobe gerekir.</span><span class="sxs-lookup"><span data-stu-id="97754-140">Fewer moving parts as no diagnostics extensions need toobe installed.</span></span>
  * <span data-ttu-id="97754-141">Daha basit şablonları.</span><span class="sxs-lookup"><span data-stu-id="97754-141">Simpler templates.</span></span> <span data-ttu-id="97754-142">Şablon Öngörüler otomatik ölçeklendirme kurallarını tooan varolan ölçek kümesi eklemeniz yeterlidir.</span><span class="sxs-lookup"><span data-stu-id="97754-142">Just add insights autoscale rules tooan existing scale set template.</span></span>
  * <span data-ttu-id="97754-143">Daha güvenilir raporlama ve yeni Vm'leri daha hızlı başlatma.</span><span class="sxs-lookup"><span data-stu-id="97754-143">More reliable reporting and faster launching of new VMs.</span></span>
    
    <span data-ttu-id="97754-144">Merhaba yalnızca tanılama uzantısını kullanarak tookeep isteyebilirsiniz nedeniyle Bellek Tanılama raporlama/ölçeklendirme gerekip gerekmediğini olacaktır.</span><span class="sxs-lookup"><span data-stu-id="97754-144">hello only reasons you might want tookeep using a diagnostic extension would be if you need memory diagnostics reporting/scaling.</span></span> <span data-ttu-id="97754-145">Ana bilgisayar tabanlı ölçümleri bellek bildirmez.</span><span class="sxs-lookup"><span data-stu-id="97754-145">Host based metrics doesn't report memory.</span></span>
    
    <span data-ttu-id="97754-146">Otomatik ölçeklendirmeyi için hala tanılama uzantılarını kullanıyorsanız, aklınızda yalnızca Merhaba, bu makalenin kalanında izleyin.</span><span class="sxs-lookup"><span data-stu-id="97754-146">With that in mind, only follow hello rest of this article if you are still using diagnostic extensions for your autoscaling.</span></span>
    
    <span data-ttu-id="97754-147">Otomatik ölçeklendirme Azure Kaynak Yöneticisi'nde çalışabilirsiniz (ancak artık gerekir) hello tanılama uzantısını adlı VM uzantısı yoluyla.</span><span class="sxs-lookup"><span data-stu-id="97754-147">Autoscale in Azure Resource Manager can work (but no longer has to) by means of a VM extension called hello Diagnostics Extension.</span></span> <span data-ttu-id="97754-148">Performans veri tooa depolama hesabı hello şablonda tanımlamak yayar.</span><span class="sxs-lookup"><span data-stu-id="97754-148">It emits performance data tooa storage account you define in hello template.</span></span> <span data-ttu-id="97754-149">Bu veriler, ardından hello Azure izleme hizmeti tarafından toplanır.</span><span class="sxs-lookup"><span data-stu-id="97754-149">This data is then aggregated by hello Azure Monitor service.</span></span>
    
    <span data-ttu-id="97754-150">Merhaba Öngörüler hizmeti VM'ler hello verileri okuyamadığında toosend beklenir, bir e-posta – örneğin hello VM'ler aşağı, bu nedenle e-posta (Merhaba hello Azure hesabı oluşturulurken belirtilen birinin) denetleyin.</span><span class="sxs-lookup"><span data-stu-id="97754-150">If hello Insights service can’t read data from hello VMs, it is supposed toosend you an email – for example if hello VMs were down, so check your email (hello one you specified when creating hello Azure account).</span></span>
    
    <span data-ttu-id="97754-151">Ayrıca, Git ve hello veri kendiniz bakın.</span><span class="sxs-lookup"><span data-stu-id="97754-151">You can also go and look at hello data yourself.</span></span> <span data-ttu-id="97754-152">Cloud explorer'ı kullanarak Azure depolama hesabı Hello arayın.</span><span class="sxs-lookup"><span data-stu-id="97754-152">Look at hello Azure storage account using a cloud explorer.</span></span> <span data-ttu-id="97754-153">Örneğin hello kullanarak [Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), oturum açma ve hello kullanmakta olduğunuz Azure aboneliği seçin ve tanılama depolama hesabı adı hello tanılama uzantısını dağıtımınızı tanımında başvurulan hello Şablon...</span><span class="sxs-lookup"><span data-stu-id="97754-153">For example using hello [Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), log in and pick hello Azure subscription you’re using, and hello Diagnostics storage account name referenced in hello Diagnostics extension definition in your deployment template..</span></span>
    
    ![Bulut Gezgini][explorer]
    
    <span data-ttu-id="97754-155">Burada, her bir VM hello verilerden depolandığı tabloları bir dizi görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="97754-155">Here you will see a bunch of tables where hello data from each VM is being stored.</span></span> <span data-ttu-id="97754-156">Linux ve hello CPU ölçüm örnek alarak, hello en son satırları arayın.</span><span class="sxs-lookup"><span data-stu-id="97754-156">Taking Linux and hello CPU metric as an example, look at hello most recent rows.</span></span> <span data-ttu-id="97754-157">Merhaba Visual Studio cloud explorer gibi bir sorgu çalıştırabilmeniz için bir sorgu dili destekler "zaman damgası gt datetime'2016-02-02T21:20:00Z'" toomake hello en son olayların (zamanı UTC olarak varsayılmıştır) edinin.</span><span class="sxs-lookup"><span data-stu-id="97754-157">hello Visual Studio cloud explorer supports a query language so you can run a query like “Timestamp gt datetime’2016-02-02T21:20:00Z’” toomake sure you get hello most recent events (assume time is in UTC).</span></span> <span data-ttu-id="97754-158">Hello veri vardır, toohello karşılık gördüğünüz ayarladığınız kuralları ölçeklendirme mu?</span><span class="sxs-lookup"><span data-stu-id="97754-158">Does hello data you see in there correspond toohello scale rules you set up?</span></span> <span data-ttu-id="97754-159">Merhaba aşağıdaki örnekte, too100% hello son 5 dakika artan hello CPU makine 20 başladı...</span><span class="sxs-lookup"><span data-stu-id="97754-159">In hello example below, hello CPU for machine 20 started increasing too100% over hello last 5 minutes..</span></span>
    
    ![Depolama tabloları][tables]
    
    <span data-ttu-id="97754-161">Merhaba veri yoksa, sonra da hello tanılama uzantılı hello VM'ler çalıştıran hello sorunudur anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="97754-161">If hello data is not there, then it implies hello problem is with hello diagnostic extension running in hello VMs.</span></span> <span data-ttu-id="97754-162">Merhaba veri varsa, Ölçek kurallarınızı ile veya hello Öngörüler hizmeti ile bir sorun var. anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="97754-162">If hello data is there, it implies there is either a problem with your scale rules, or with hello Insights service.</span></span> <span data-ttu-id="97754-163">Denetleme [Azure durum](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="97754-163">Check [Azure Status](https://azure.microsoft.com/status/).</span></span>
    
    <span data-ttu-id="97754-164">Otomatik ölçeklendirme sorun yaşıyorsanız bu adımları uygularken size atanmış sonra hello forumları deneyin [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), veya [yığın taşması](http://stackoverflow.com/questions/tagged/azure), veya bir destek çağrısı oturum.</span><span class="sxs-lookup"><span data-stu-id="97754-164">Once you’ve been through these steps, if you are still having autoscale problems you could try hello forums on [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), or [Stack overflow](http://stackoverflow.com/questions/tagged/azure), or log a support call.</span></span> <span data-ttu-id="97754-165">Hazırlanan tooshare hello şablonu ve bir görünüm hello performans verilerinin olması.</span><span class="sxs-lookup"><span data-stu-id="97754-165">Be prepared tooshare hello template and a view of hello performance data.</span></span>

[audit]: ./media/virtual-machine-scale-sets-troubleshoot/image3.png
[explorer]: ./media/virtual-machine-scale-sets-troubleshoot/image1.png
[tables]: ./media/virtual-machine-scale-sets-troubleshoot/image4.png
