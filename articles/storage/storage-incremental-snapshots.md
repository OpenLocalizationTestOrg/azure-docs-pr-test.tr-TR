---
title: "Yedekleme ve kurtarma yönetilmeyen Azure VM diskleri için artımlı anlık görüntüleri kullanma | Microsoft Docs"
description: "Yedekleme ve kurtarma artımlı anlık görüntülerini kullanarak Azure sanal makine disklerinizi için özel bir çözüm oluşturun."
services: storage
documentationcenter: na
author: aungoo-msft
manager: tadb
editor: tysonn
ms.assetid: 3524b987-bd65-4e35-83e7-fbc2136643e5
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/23/2017
ms.author: aungoo
ms.openlocfilehash: 7b08ce207b2a3cc2dd3d3559765def6af42a844a
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="back-up-azure-unmanaged-vm-disks-with-incremental-snapshots"></a><span data-ttu-id="17217-103">Artımlı anlık görüntüleri ile Azure yönetilmeyen VM diskleri yedekleyin</span><span class="sxs-lookup"><span data-stu-id="17217-103">Back up Azure unmanaged VM disks with incremental snapshots</span></span>
## <a name="overview"></a><span data-ttu-id="17217-104">Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="17217-104">Overview</span></span>
<span data-ttu-id="17217-105">Azure Storage blobları anlık görüntüsünü yeteneği sağlar.</span><span class="sxs-lookup"><span data-stu-id="17217-105">Azure Storage provides the capability to take snapshots of blobs.</span></span> <span data-ttu-id="17217-106">Anlık görüntüler zamandaki o noktada blob durumu yakalayın.</span><span class="sxs-lookup"><span data-stu-id="17217-106">Snapshots capture the blob state at that point in time.</span></span> <span data-ttu-id="17217-107">Bu makalede, biz anlık görüntülerini kullanarak sanal makine disklerinin yedeklerini nasıl koruyabilirsiniz bir senaryoyu açıklar.</span><span class="sxs-lookup"><span data-stu-id="17217-107">In this article, we will describe a scenario of how you can maintain backups of virtual machine disks using snapshots.</span></span> <span data-ttu-id="17217-108">Azure yedekleme ve kurtarma hizmeti kullanmamayı ve sanal makine diskleriniz için özel bir yedekleme stratejisi oluşturmak isterseniz bu yöntemi kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-108">You can use this methodology when you choose not to use Azure Backup and Recovery Service, and wish to create a custom backup strategy for your virtual machine disks.</span></span>

<span data-ttu-id="17217-109">Azure virtual machine diskleri sayfa blobları Azure storage'da olarak depolanır.</span><span class="sxs-lookup"><span data-stu-id="17217-109">Azure virtual machine disks are stored as page blobs in Azure Storage.</span></span> <span data-ttu-id="17217-110">Bu makalede sanal makine disklerini yedekleme stratejisi hakkında varsayılır olduğundan, biz sayfa bloblarını bağlamında anlık görüntüler için başvuran.</span><span class="sxs-lookup"><span data-stu-id="17217-110">Since we are talking about backup strategy for virtual machine disks in this article, we will be referring to snapshots in the context of page blobs.</span></span> <span data-ttu-id="17217-111">Anlık görüntüler hakkında daha fazla bilgi için bkz [Blob anlık görüntüsünün oluşturulmasına](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="17217-111">To learn more about snapshots, refer to [Creating a Snapshot of a Blob](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

## <a name="what-is-a-snapshot"></a><span data-ttu-id="17217-112">Bir anlık görüntü nedir?</span><span class="sxs-lookup"><span data-stu-id="17217-112">What is a snapshot?</span></span>
<span data-ttu-id="17217-113">Bir blob anlık bir noktada zamanında yakalanan bir blob, salt okunur bir sürümüdür.</span><span class="sxs-lookup"><span data-stu-id="17217-113">A blob snapshot is a read-only version of a blob that is captured at a point in time.</span></span> <span data-ttu-id="17217-114">Bir anlık görüntü oluşturulduktan sonra okumak, kopyalanan, veya silinmiş, ancak değişiklik.</span><span class="sxs-lookup"><span data-stu-id="17217-114">Once a snapshot has been created, it can be read, copied, or deleted, but not modified.</span></span> <span data-ttu-id="17217-115">Anlık görüntüler bir anda göründüğü gibi bir blob yedeklemek için bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="17217-115">Snapshots provide a way to back up a blob as it appears at a moment in time.</span></span> <span data-ttu-id="17217-116">Sürüm 2015-04-05 REST kadar tam anlık görüntü kopyalama becerisini vardı.</span><span class="sxs-lookup"><span data-stu-id="17217-116">Until REST version 2015-04-05 you had the ability to copy full snapshots.</span></span> <span data-ttu-id="17217-117">Ayrıca sürüm 2015-07-08 REST ve üstü ile, artımlı anlık görüntüleri kopyalayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-117">With the REST version 2015-07-08 and above, you can also copy incremental snapshots.</span></span>

## <a name="full-snapshot-copy"></a><span data-ttu-id="17217-118">Tam anlık görüntü kopyalama</span><span class="sxs-lookup"><span data-stu-id="17217-118">Full snapshot copy</span></span>
<span data-ttu-id="17217-119">Anlık görüntüler için başka bir depolama hesabı temel blob yedeklerini tutmak için blob olarak kopyalanabilir.</span><span class="sxs-lookup"><span data-stu-id="17217-119">Snapshots can be copied to another storage account as a blob to keep backups of the base blob.</span></span> <span data-ttu-id="17217-120">Blob bir önceki sürüme geri yüklemeyi gibi kendi temel blob üzerinden bir anlık görüntü de kopyalayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-120">You can also copy a snapshot over its base blob, which is like restoring the blob to an earlier version.</span></span> <span data-ttu-id="17217-121">Bir anlık görüntü bir depolama hesabından başka bir kopyalandığında temel sayfa blobu olarak aynı alanı kaplar.</span><span class="sxs-lookup"><span data-stu-id="17217-121">When a snapshot is copied from one storage account to another, it will occupy the same space as the base page blob.</span></span> <span data-ttu-id="17217-122">Bu nedenle, kopyalama tüm anlık görüntüler bir depolama hesabı başka bir yavaş olacaktır ve aynı zamanda çok sayıda hedef depolama hesabı alanı kullanır.</span><span class="sxs-lookup"><span data-stu-id="17217-122">Therefore, copying whole snapshots from one storage account to another will be slow and will also consume lot of space in the target storage account.</span></span>

> [!NOTE]
> <span data-ttu-id="17217-123">Başka bir hedefe temel blob kopyalarsanız, blob anlık görüntüleri onunla birlikte kopyalanmaz.</span><span class="sxs-lookup"><span data-stu-id="17217-123">If you copy the base blob to another destination, the snapshots of the blob are not copied along with it.</span></span> <span data-ttu-id="17217-124">Benzer şekilde, bir kopya ile temel bir blob üzerine, temel blob ile ilişkili anlık görüntüleri etkilenmez ve temel blob adı altında olduğu gibi kalır.</span><span class="sxs-lookup"><span data-stu-id="17217-124">Similarly, if you overwrite a base blob with a copy, snapshots associated with the base blob are not affected and stay intact under base blob name.</span></span>
> 
> 

### <a name="back-up-disks-using-snapshots"></a><span data-ttu-id="17217-125">Diskleri anlık görüntülerini kullanarak yedekleme</span><span class="sxs-lookup"><span data-stu-id="17217-125">Back up disks using snapshots</span></span>
<span data-ttu-id="17217-126">Sanal makine diskleriniz için bir yedekleme stratejisi disk ya da sayfa blob düzenli anlık görüntüleri alabilir ve bunları başka bir depolama hesabı kullanarak kopyalama araçları gibi [kopyalama Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) işlemi veya [AzCopy](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="17217-126">As a backup strategy for your virtual machine disks, you can take periodic snapshots of the disk or page blob, and copy them to another storage account using tools like [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) operation or [AzCopy](storage-use-azcopy.md).</span></span> <span data-ttu-id="17217-127">Farklı bir ada sahip bir hedef sayfa blob'u için bir anlık görüntü kopyalayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-127">You can copy a snapshot to a destination page blob with a different name.</span></span> <span data-ttu-id="17217-128">Sonuçta elde edilen hedef sayfa blobu yazılabilir sayfa blobu ve anlık görüntü olmayan ' dir.</span><span class="sxs-lookup"><span data-stu-id="17217-128">The resulting destination page blob is a writeable page blob and not a snapshot.</span></span> <span data-ttu-id="17217-129">Bu makalenin sonraki bölümlerinde biz anlık görüntülerini kullanarak sanal makine disklerinin yedeklerini uygulamanız gereken adımlar açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="17217-129">Later in this article we will describe steps to take backups of virtual machine disks using snapshots.</span></span>

### <a name="restore-disks-using-snapshots"></a><span data-ttu-id="17217-130">Anlık görüntülerini kullanarak disklerini geri yükle</span><span class="sxs-lookup"><span data-stu-id="17217-130">Restore disks using snapshots</span></span>
<span data-ttu-id="17217-131">Yedekleme anlık görüntülerinin birinde yakalanan bir önceki kararlı sürüm diskinizde geri zamanı geldiğinde, bir anlık görüntü üzerinde temel sayfa blobu kopyalayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-131">When it is time to restore your disk to a previous stable version captured in one of the backup snapshots, you can copy a snapshot over the base page blob.</span></span> <span data-ttu-id="17217-132">Taban sayfası için anlık görüntü yükseltildikten sonra anlık görüntü kalır blob ancak kaynağı, hem okuma ve yazılabilir bir kopya ile üzerine yazılır.</span><span class="sxs-lookup"><span data-stu-id="17217-132">After the snapshot is promoted to the base page blob, the snapshot remains, but its source is overwritten with a copy that can be both read and written.</span></span> <span data-ttu-id="17217-133">Bu makalenin sonraki bölümlerinde biz diskinizin önceki bir sürümü, anlık görüntüden geri yüklemek için adımları anlatmaktadır.</span><span class="sxs-lookup"><span data-stu-id="17217-133">Later in this article we will describe steps to restore a previous version of your disk from its snapshot.</span></span>

### <a name="implementing-full-snapshot-copy"></a><span data-ttu-id="17217-134">Tam anlık görüntü kopyalama uygulama</span><span class="sxs-lookup"><span data-stu-id="17217-134">Implementing full snapshot copy</span></span>
<span data-ttu-id="17217-135">Aşağıdakileri yaparak tam anlık görüntü kopyalama uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-135">You can implement a full snapshot copy by doing the following,</span></span>

* <span data-ttu-id="17217-136">İlk olarak, temel blob kullanmanın bir anlık görüntüsünü [anlık görüntü Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) işlemi.</span><span class="sxs-lookup"><span data-stu-id="17217-136">First, take a snapshot of the base blob using the [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) operation.</span></span>
* <span data-ttu-id="17217-137">Ardından, hedef depolama hesabı kullanarak bir anlık görüntü kopyalama [kopyalama Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span><span class="sxs-lookup"><span data-stu-id="17217-137">Then, copy the snapshot to a target storage account using [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span></span>
* <span data-ttu-id="17217-138">Temel blob yedek kopyalarını korumak için bu işlemi yineleyin.</span><span class="sxs-lookup"><span data-stu-id="17217-138">Repeat this process to maintain backup copies of your base blob.</span></span>

## <a name="incremental-snapshot-copy"></a><span data-ttu-id="17217-139">Artımlı anlık görüntü kopyalama</span><span class="sxs-lookup"><span data-stu-id="17217-139">Incremental snapshot copy</span></span>
<span data-ttu-id="17217-140">Yeni özelliği [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) API sayfa BLOB'ları veya diskleri anlık görüntüleri yedeklemek için daha iyi bir yöntem sunar.</span><span class="sxs-lookup"><span data-stu-id="17217-140">The new feature in [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) API provides a much better way to back up the snapshots of your page blobs or disks.</span></span> <span data-ttu-id="17217-141">API temel blob ve anlık görüntülerin arasında değişiklik listesini döndürür.</span><span class="sxs-lookup"><span data-stu-id="17217-141">The API returns the list of changes between the base blob and the snapshots.</span></span> <span data-ttu-id="17217-142">Bu yedekleme hesabında kullanılan depolama alanı miktarını azaltır.</span><span class="sxs-lookup"><span data-stu-id="17217-142">This reduces the amount of storage space used on the backup account.</span></span> <span data-ttu-id="17217-143">API, standart depolama yanı sıra Premium depolama üzerinde sayfa bloblarını destekler.</span><span class="sxs-lookup"><span data-stu-id="17217-143">The API supports page blobs on Premium Storage as well as Standard Storage.</span></span> <span data-ttu-id="17217-144">Bu API kullanarak Azure VM'ler için daha hızlı ve verimli yedekleme çözümleri şimdi oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-144">Using this API, you can now build faster and efficient backup solutions for Azure VMs.</span></span> <span data-ttu-id="17217-145">Bu, 2015-07-08 REST sürümüyle kullanılabilir ve daha yüksek olur.</span><span class="sxs-lookup"><span data-stu-id="17217-145">This will be available with the REST version 2015-07-08 and higher.</span></span>

<span data-ttu-id="17217-146">Artımlı anlık görüntü kopyalama, bir depolama hesabından başka bir arasındaki farkı kopyalamanıza olanak sağlar,</span><span class="sxs-lookup"><span data-stu-id="17217-146">Incremental Snapshot Copy allows you to copy from one storage account to another the difference between,</span></span>

* <span data-ttu-id="17217-147">Temel blob ve onun anlık görüntü veya</span><span class="sxs-lookup"><span data-stu-id="17217-147">Base blob and its Snapshot OR</span></span>
* <span data-ttu-id="17217-148">Temel BLOB iki tüm anlık görüntüleri</span><span class="sxs-lookup"><span data-stu-id="17217-148">Any two snapshots of the base blob</span></span>

<span data-ttu-id="17217-149">Aşağıdaki koşulların karşılandığından sağlanan,</span><span class="sxs-lookup"><span data-stu-id="17217-149">Provided the following conditions are met,</span></span>

* <span data-ttu-id="17217-150">Blob Oca 1 2016 veya sonraki bir sürümünde oluşturulmuş.</span><span class="sxs-lookup"><span data-stu-id="17217-150">The blob was created on Jan-1-2016 or later.</span></span>
* <span data-ttu-id="17217-151">Blob ile yazıldı değil [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) veya [kopyalama Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) arasında iki anlık görüntüler.</span><span class="sxs-lookup"><span data-stu-id="17217-151">The blob was not overwritten with [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) or [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) between two snapshots.</span></span>

<span data-ttu-id="17217-152">**Not**: Bu özellik Premium ve standart Azure sayfa BLOB'ları için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="17217-152">**Note**: This feature is available for Premium and Standard Azure Page Blobs.</span></span>

<span data-ttu-id="17217-153">Anlık görüntüler bir depolama hesabından kopyalama anlık görüntüleri kullanan özel bir yedekleme stratejisi olduğunda çok yavaş olabilir ve çok miktarda depolama alanı kullanır.</span><span class="sxs-lookup"><span data-stu-id="17217-153">When you have a custom backup strategy that uses snapshots, copying the snapshots from one storage account to another can be very slow and consumes a lot of storage space.</span></span> <span data-ttu-id="17217-154">Tüm anlık görüntü bir yedekleme depolama hesabına kopyalamak yerine art arda gelen anlık görüntüleri yedekleme sayfa blobu için arasındaki farkı yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-154">Instead of copying the entire snapshot to a backup storage account, you can write the difference between consecutive snapshots to a backup page blob.</span></span> <span data-ttu-id="17217-155">Bu şekilde, kopyalama ve yedekleri depolamak için alanı süresini önemli ölçüde azalır.</span><span class="sxs-lookup"><span data-stu-id="17217-155">This way, the time to copy and space to store backups is substantially reduced.</span></span>

### <a name="implementing-incremental-snapshot-copy"></a><span data-ttu-id="17217-156">Uygulama artımlı anlık görüntü kopyalama</span><span class="sxs-lookup"><span data-stu-id="17217-156">Implementing Incremental Snapshot Copy</span></span>
<span data-ttu-id="17217-157">Aşağıdakileri yaparak artımlı anlık görüntü kopyalama uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="17217-157">You can implement incremental snapshot copy by doing the following,</span></span>

* <span data-ttu-id="17217-158">Temel blob kullanmanın bir anlık görüntüsünü [anlık görüntü Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx).</span><span class="sxs-lookup"><span data-stu-id="17217-158">Take a snapshot of the base blob using [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx).</span></span>
* <span data-ttu-id="17217-159">Anlık görüntü kopyalama hedefi yedekleme depolama kullanarak hesabı [kopyalama Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span><span class="sxs-lookup"><span data-stu-id="17217-159">Copy the snapshot to the target backup storage account using [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span></span> <span data-ttu-id="17217-160">Bu yedekleme sayfa blobu olacaktır.</span><span class="sxs-lookup"><span data-stu-id="17217-160">This will be the backup page blob.</span></span> <span data-ttu-id="17217-161">Bu yedekleme sayfa blobu bir anlık görüntüsünü ve yedekleme hesabında depolayın.</span><span class="sxs-lookup"><span data-stu-id="17217-161">Take a snapshot of this backup page blob and store in backup account.</span></span>
* <span data-ttu-id="17217-162">Anlık görüntü Blob kullanarak temel BLOB başka bir anlık görüntü alın.</span><span class="sxs-lookup"><span data-stu-id="17217-162">Take another snapshot of the base blob using Snapshot Blob.</span></span>
* <span data-ttu-id="17217-163">Temel blob kullanmanın ilk ve ikinci anlık görüntüleri arasındaki farkı alma [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx).</span><span class="sxs-lookup"><span data-stu-id="17217-163">Get the difference between first and second snapshots of base blob using  [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx).</span></span> <span data-ttu-id="17217-164">Yeni bir parametre kullanmak **prevsnapshot** farkı almak için anlık görüntüsünü DateTime değerini belirtmek için.</span><span class="sxs-lookup"><span data-stu-id="17217-164">Use the new parameter **prevsnapshot** to specify the DateTime value of the snapshot you want to get the difference with.</span></span> <span data-ttu-id="17217-165">Bu parametre mevcut olduğunda, REST yanıt hedef anlık görüntüsü ile Temizle sayfalar dahil olmak üzere önceki anlık arasında değiştirilen sayfalar içerir.</span><span class="sxs-lookup"><span data-stu-id="17217-165">When this parameter is present, the REST response will include only the pages that were changed between target snapshot and previous snapshot including clear pages.</span></span>
* <span data-ttu-id="17217-166">Kullanım [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) yedekleme sayfa blobu bu değişiklikleri uygulamak için.</span><span class="sxs-lookup"><span data-stu-id="17217-166">Use [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) to apply these changes to the backup page blob.</span></span>
* <span data-ttu-id="17217-167">Son olarak, bir yedekleme sayfa blobu alın ve yedekleme depolama hesabında saklayın.</span><span class="sxs-lookup"><span data-stu-id="17217-167">Finally, take a snapshot of the backup page blob and store it in the backup storage account.</span></span>

<span data-ttu-id="17217-168">Sonraki bölümde, biz daha ayrıntılı olarak artımlı anlık görüntü kopyalama kullanarak diskleri yedeklerini nasıl koruyabilirsiniz anlatmaktadır</span><span class="sxs-lookup"><span data-stu-id="17217-168">In the next section, we will describe in more detail how you can maintain backups of disks using Incremental Snapshot Copy</span></span>

## <a name="scenario"></a><span data-ttu-id="17217-169">Senaryo</span><span class="sxs-lookup"><span data-stu-id="17217-169">Scenario</span></span>
<span data-ttu-id="17217-170">Bu bölümde biz anlık görüntülerini kullanarak sanal makine disklerini için özel bir yedekleme stratejisi içeren bir senaryo açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="17217-170">In this section we will describe a scenario that involves a custom backup strategy for virtual machine disks using snapshots.</span></span>

<span data-ttu-id="17217-171">DS serisi Azure VM'ye bağlı premium depolama P30 diskle göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="17217-171">Consider a DS-series Azure VM with a premium storage P30 disk attached.</span></span> <span data-ttu-id="17217-172">P30 disk adı *mypremiumdisk* adlı bir premium depolama hesabında depolanan *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="17217-172">The P30 disk called *mypremiumdisk* is stored in a premium storage account called *mypremiumaccount*.</span></span> <span data-ttu-id="17217-173">Standart depolama hesabı olarak adlandırılan *mybackupstdaccount* yedeğini depolamak için kullanılacak *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="17217-173">A standard storage account called *mybackupstdaccount* will be used for storing the backup of *mypremiumdisk*.</span></span> <span data-ttu-id="17217-174">Biz anlık görüntüsünü almak istediğiniz *mypremiumdisk* 12 saatte bir.</span><span class="sxs-lookup"><span data-stu-id="17217-174">We would like to keep a snapshot of *mypremiumdisk* every 12 hours.</span></span>

<span data-ttu-id="17217-175">Depolama hesabı ve diskleri oluşturma hakkında bilgi edinmek için bkz [Azure storage hesapları hakkında](storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="17217-175">To learn about creating storage account and disks, refer to [About Azure storage accounts](storage-create-storage-account.md).</span></span>

<span data-ttu-id="17217-176">Azure VM'lerin yedeklenmesi hakkında bilgi edinmek için bkz [planlama Azure VM yedeklemeleri](../backup/backup-azure-vms-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="17217-176">To learn about backing up Azure VMs, refer to [Plan Azure VM backups](../backup/backup-azure-vms-introduction.md).</span></span>

## <a name="steps-to-maintain-backups-of-a-disk-using-incremental-snapshots"></a><span data-ttu-id="17217-177">Artımlı anlık görüntülerini kullanarak bir disk yedeklerini korumak için adımlar</span><span class="sxs-lookup"><span data-stu-id="17217-177">Steps to maintain backups of a disk using incremental snapshots</span></span>
<span data-ttu-id="17217-178">Aşağıda açıklanan adımları anlık görüntülerini sürer *mypremiumdisk* ve yedeklemelerin sürdürmek *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="17217-178">The steps described below will take snapshots of *mypremiumdisk* and maintain the backups in *mybackupstdaccount*.</span></span> <span data-ttu-id="17217-179">Yedekleme adlı bir standart sayfa blob'u olacaktır *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="17217-179">The backup will be a standard page blob called *mybackupstdpageblob*.</span></span> <span data-ttu-id="17217-180">Yedekleme sayfa blobu her zaman son anlık görüntüsü ile aynı duruma yansıtılacaktır *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="17217-180">The backup page blob will always reflect the same state as the last snapshot of *mypremiumdisk*.</span></span>

1. <span data-ttu-id="17217-181">İlk olarak, yedekleme sayfa blobu, premium depolama diski oluşturun.</span><span class="sxs-lookup"><span data-stu-id="17217-181">First, create the backup page blob for your premium storage disk.</span></span> <span data-ttu-id="17217-182">Bunu yapmak için bir anlık görüntüsünü *mypremiumdisk* adlı *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="17217-182">To do this, take a snapshot of *mypremiumdisk* called *mypremiumdisk_ss1*.</span></span>
2. <span data-ttu-id="17217-183">Bu anlık görüntü için mybackupstdaccount adlı bir sayfa blob'u olarak kopyalamak *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="17217-183">Copy this snapshot to mybackupstdaccount as a page blob called *mybackupstdpageblob*.</span></span>
3. <span data-ttu-id="17217-184">Bir anlık görüntüsünü *mybackupstdpageblob* adlı *mybackupstdpageblob_ss1*kullanarak [anlık görüntü Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) içinde depolamak ve *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="17217-184">Take a snapshot of *mybackupstdpageblob* called *mybackupstdpageblob_ss1*, using [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) and store it in *mybackupstdaccount*.</span></span>
4. <span data-ttu-id="17217-185">Yedekleme penceresi sırasında başka bir anlık görüntüsünü oluşturmak *mypremiumdisk*, deyin *mypremiumdisk_ss2*, içinde depolamak ve *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="17217-185">During the backup window, create another snapshot of *mypremiumdisk*, say *mypremiumdisk_ss2*, and store it in *mypremiumaccount*.</span></span>
5. <span data-ttu-id="17217-186">Artımlı değişiklikler arasında iki anlık görüntüleri alma *mypremiumdisk_ss2* ve *mypremiumdisk_ss1*kullanarak [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) üzerinde *mypremiumdisk_ ss2* ile **prevsnapshot** parametre kümesi için zaman damgasını *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="17217-186">Get the incremental changes between the two snapshots, *mypremiumdisk_ss2* and *mypremiumdisk_ss1*, using [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) on *mypremiumdisk_ss2* with **prevsnapshot** parameter set to the timestamp of *mypremiumdisk_ss1*.</span></span> <span data-ttu-id="17217-187">Bu artımlı değişiklikler için yedekleme sayfa blobu yazma *mybackupstdpageblob* içinde *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="17217-187">Write these incremental changes to the backup page blob *mybackupstdpageblob* in *mybackupstdaccount*.</span></span> <span data-ttu-id="17217-188">Artımlı değişiklikler silinen aralık varsa yedekleme sayfa BLOB'dan temizlenmelidir.</span><span class="sxs-lookup"><span data-stu-id="17217-188">If there are deleted ranges in the incremental changes, they must be cleared from the backup page blob.</span></span> <span data-ttu-id="17217-189">Kullanım [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) artımlı değişiklikler için yedekleme sayfa blobu yazma.</span><span class="sxs-lookup"><span data-stu-id="17217-189">Use [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) to write incremental changes to the backup page blob.</span></span>
6. <span data-ttu-id="17217-190">Yedekleme sayfa blobu bir anlık görüntüsünü *mybackupstdpageblob*adlı *mybackupstdpageblob_ss2*.</span><span class="sxs-lookup"><span data-stu-id="17217-190">Take a snapshot of the backup page blob *mybackupstdpageblob*, called *mybackupstdpageblob_ss2*.</span></span> <span data-ttu-id="17217-191">Önceki anlık görüntüyü silmek *mypremiumdisk_ss1* premium depolama hesabından.</span><span class="sxs-lookup"><span data-stu-id="17217-191">Delete the previous snapshot *mypremiumdisk_ss1* from premium storage account.</span></span>
7. <span data-ttu-id="17217-192">Her yedekleme penceresi 4-6 adımlarını yineleyin.</span><span class="sxs-lookup"><span data-stu-id="17217-192">Repeat steps 4-6 every backup window.</span></span> <span data-ttu-id="17217-193">Bu şekilde, yedeklerini bulundurabilirsiniz *mypremiumdisk* bir standart depolama hesabı.</span><span class="sxs-lookup"><span data-stu-id="17217-193">In this way, you can maintain backups of *mypremiumdisk* in a standard storage account.</span></span>

![Artımlı anlık görüntülerini kullanarak diski yedeklemeniz](./media/storage-incremental-snapshots/storage-incremental-snapshots-1.png)

## <a name="steps-to-restore-a-disk-from-snapshots"></a><span data-ttu-id="17217-195">Bir disk anlık görüntülerden geri yüklemek için adımları</span><span class="sxs-lookup"><span data-stu-id="17217-195">Steps to restore a disk from snapshots</span></span>
<span data-ttu-id="17217-196">Aşağıda açıklanan adımları premium disk geri *mypremiumdisk* önceki bir anlık görüntüye yedekleme depolama hesabından *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="17217-196">The steps described below will restore premium disk, *mypremiumdisk* to an earlier snapshot from the backup storage account *mybackupstdaccount*.</span></span>

1. <span data-ttu-id="17217-197">Premium diske geri yüklemek istediğiniz zaman noktası belirleyin.</span><span class="sxs-lookup"><span data-stu-id="17217-197">Identify the point in time you wish to restore the premium disk to.</span></span> <span data-ttu-id="17217-198">Anlık görüntü düşünelim *mybackupstdpageblob_ss2*, yedekleme depolama hesabında depolanan *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="17217-198">Let's say that is snapshot *mybackupstdpageblob_ss2*, which is stored in the backup storage account *mybackupstdaccount*.</span></span>
2. <span data-ttu-id="17217-199">Anlık görüntü mybackupstdaccount içinde Yükselt *mybackupstdpageblob_ss2* yeni yedekleme temel sayfa blobu olarak *mybackupstdpageblobrestored*.</span><span class="sxs-lookup"><span data-stu-id="17217-199">In mybackupstdaccount, promote the snapshot *mybackupstdpageblob_ss2* as the new backup base page blob *mybackupstdpageblobrestored*.</span></span>
3. <span data-ttu-id="17217-200">Adlı bu geri yüklenen yedekleme sayfa blobu bir anlık görüntüsünü *mybackupstdpageblobrestored_ss1*.</span><span class="sxs-lookup"><span data-stu-id="17217-200">Take a snapshot of this restored backup page blob, called *mybackupstdpageblobrestored_ss1*.</span></span>
4. <span data-ttu-id="17217-201">Geri yüklenen sayfa blob kopyalama *mybackupstdpageblobrestored* gelen *mybackupstdaccount* için *mypremiumaccount* yeni premium disk olarak  *mypremiumdiskrestored*.</span><span class="sxs-lookup"><span data-stu-id="17217-201">Copy the restored page blob *mybackupstdpageblobrestored* from *mybackupstdaccount* to *mypremiumaccount* as the new premium disk *mypremiumdiskrestored*.</span></span>
5. <span data-ttu-id="17217-202">Bir anlık görüntüsünü *mypremiumdiskrestored*adlı *mypremiumdiskrestored_ss1* gelecekteki artımlı yedekleme yapmak için.</span><span class="sxs-lookup"><span data-stu-id="17217-202">Take a snapshot of *mypremiumdiskrestored*, called *mypremiumdiskrestored_ss1* for making future incremental backups.</span></span>
6. <span data-ttu-id="17217-203">Geri yüklenen diske DS serisi VM'ın üzerine *mypremiumdiskrestored* ve eski ayırma *mypremiumdisk* VM'den.</span><span class="sxs-lookup"><span data-stu-id="17217-203">Point the DS series VM to the restored disk *mypremiumdiskrestored* and detach the old *mypremiumdisk* from the VM.</span></span>
7. <span data-ttu-id="17217-204">Geri yüklenen disk için önceki bölümde açıklanan yedekleme işlemine başlamak *mypremiumdiskrestored*kullanarak *mybackupstdpageblobrestored* yedekleme sayfa blobu olarak.</span><span class="sxs-lookup"><span data-stu-id="17217-204">Begin the Backup process described in previous section for the restored disk *mypremiumdiskrestored*, using the *mybackupstdpageblobrestored* as the backup page blob.</span></span>

![Disk anlık görüntülerden geri yükleme](./media/storage-incremental-snapshots/storage-incremental-snapshots-2.png)

## <a name="next-steps"></a><span data-ttu-id="17217-206">Sonraki Adımlar</span><span class="sxs-lookup"><span data-stu-id="17217-206">Next Steps</span></span>
<span data-ttu-id="17217-207">Bir blob anlık görüntülerini oluşturma ve aşağıdaki bağlantıları kullanarak VM yedekleme altyapınızı planlama hakkında daha fazla bilgi edinin.</span><span class="sxs-lookup"><span data-stu-id="17217-207">Learn more about creating snapshots of a blob and planning your VM backup infrastructure using the links below.</span></span>

* [<span data-ttu-id="17217-208">Bir BLOB bir anlık görüntü oluşturma</span><span class="sxs-lookup"><span data-stu-id="17217-208">Creating a Snapshot of a Blob</span></span>](https://msdn.microsoft.com/library/azure/hh488361.aspx)
* [<span data-ttu-id="17217-209">VM yedekleme altyapınızı planlama</span><span class="sxs-lookup"><span data-stu-id="17217-209">Plan your VM Backup Infrastructure</span></span>](../backup/backup-azure-vms-introduction.md)

