---
title: "aaaDesigning Azure okuma erişimli coğrafi olarak yedekli depolama (RA-GRS) kullanarak yüksek oranda kullanılabilir uygulamalar | Microsoft Docs"
description: "Nasıl toouse Azure RA-GRS depolama tooarchitect esnek bir yüksek oranda kullanılabilir uygulama yeterli toohandle kesintileri."
services: storage
documentationcenter: .net
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 8f040b0f-8926-4831-ac07-79f646f31926
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 1/19/2017
ms.author: robinsh
ms.openlocfilehash: e4a9fe7ef33eecd894408b3c1ef59920a248d1bd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-applications-using-ra-grs"></a><span data-ttu-id="170ef-103">Yüksek oranda kullanılabilir RA-GRS kullanarak uygulamalar tasarlama</span><span class="sxs-lookup"><span data-stu-id="170ef-103">Designing Highly Available Applications using RA-GRS</span></span>

<span data-ttu-id="170ef-104">Bir ortak bulut tabanlı altyapılar uygulamalarını barındırmak için yüksek oranda kullanılabilir bir platform sağlar özelliğidir.</span><span class="sxs-lookup"><span data-stu-id="170ef-104">A common feature of cloud-based infrastructures is that they provide a highly available platform for hosting applications.</span></span> <span data-ttu-id="170ef-105">Bulut tabanlı uygulaması geliştiricileri düşünmeniz gerekir dikkatle nasıl tooleverage bu platform toodeliver yüksek oranda kullanılabilir uygulamalar tootheir kullanıcılar.</span><span class="sxs-lookup"><span data-stu-id="170ef-105">Developers of cloud-based applications must consider carefully how tooleverage this platform toodeliver highly available applications tootheir users.</span></span> <span data-ttu-id="170ef-106">Bu makalede özellikle nasıl geliştiriciler hello Azure depolama okuma erişimi coğrafi olarak yedekli depolama (RA-GRS) toomake kullanabilir üzerinde daha fazla kullanılabilir uygulamalarını odaklanır.</span><span class="sxs-lookup"><span data-stu-id="170ef-106">This article focuses specifically on how developers can use hello Azure Storage Read Access Geo Redundant Storage (RA-GRS) toomake their applications more available.</span></span>

<span data-ttu-id="170ef-107">Artıklık – (yerel olarak yedekli depolama) LRS, ZRS (bölge olarak yedekli depolama), (coğrafi olarak yedekli depolama) GRS ve RA-GRS (coğrafi olarak yedekli depolamaya okuma erişimi) için dört seçeneğiniz vardır.</span><span class="sxs-lookup"><span data-stu-id="170ef-107">There are four choices for redundancy – LRS (Locally Redundant Storage), ZRS (Zone Redundant Storage), GRS (Geo-Redundant Storage), and RA-GRS (Read Access Geo-Redundant Storage).</span></span> <span data-ttu-id="170ef-108">Bu makalede toodiscuss GRS ve RA-GRS adımıdır.</span><span class="sxs-lookup"><span data-stu-id="170ef-108">We are going toodiscuss GRS and RA-GRS in this article.</span></span> <span data-ttu-id="170ef-109">GRS ile verilerinizin üç kopyasını hello depolama hesabı oluştururken seçtiğiniz hello birincil bölge içinde tutulur.</span><span class="sxs-lookup"><span data-stu-id="170ef-109">With GRS, three copies of your data are kept in hello primary region you selected when setting up hello storage account.</span></span> <span data-ttu-id="170ef-110">Üç ek kopya Azure tarafından belirtilen bir ikincil bölge içinde zaman uyumsuz olarak korunur.</span><span class="sxs-lookup"><span data-stu-id="170ef-110">Three additional copies are maintained asynchronously in a secondary region specified by Azure.</span></span> <span data-ttu-id="170ef-111">RA-grs okuma erişimi toohello ikincil kopya olması dışında aynı şeyi GRS hello.</span><span class="sxs-lookup"><span data-stu-id="170ef-111">RA-GRS is hello same thing as GRS except that you have read access toohello secondary copy.</span></span> <span data-ttu-id="170ef-112">Merhaba farklı Azure Storage artıklık seçenekleri hakkında daha fazla bilgi için bkz: [Azure Storage çoğaltma](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span><span class="sxs-lookup"><span data-stu-id="170ef-112">For more information about hello different Azure Storage redundancy options, see [Azure Storage replication](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span></span> <span data-ttu-id="170ef-113">Merhaba çoğaltma makalede ayrıca hello birincil ve ikincil bölgeler hello eşleştirmelerini gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="170ef-113">hello replication article also shows hello pairings of hello primary and secondary regions.</span></span>

<span data-ttu-id="170ef-114">Bu makalede ve bağlantı tooa tam bir örnek, indirin ve çalıştırın hello sonunda bulunan kod parçacıkları vardır.</span><span class="sxs-lookup"><span data-stu-id="170ef-114">There are code snippets included in this article, and a link tooa complete sample at hello end that you can download and run.</span></span>

## <a name="key-features-of-ra-grs"></a><span data-ttu-id="170ef-115">RA-GRS temel özellikleri</span><span class="sxs-lookup"><span data-stu-id="170ef-115">Key features of RA-GRS</span></span>

<span data-ttu-id="170ef-116">Biz hakkında konuşun önce toouse RA-GRS depolama özelliklerini ve davranışı hakkında şimdi konuşun.</span><span class="sxs-lookup"><span data-stu-id="170ef-116">Before we talk about how toouse RA-GRS storage, let's talk about its properties and behavior.</span></span>

* <span data-ttu-id="170ef-117">Azure depolama ikincil bir bölgede birincil bölgenizde hello verileri salt okunur bir kopyasını tutar; Yukarıda belirtildiği gibi hello depolama hizmeti hello ikincil bölge'hello konumunu belirler.</span><span class="sxs-lookup"><span data-stu-id="170ef-117">Azure Storage maintains a read-only copy of hello data you store in your primary region in a secondary region; as noted above, hello storage service determines hello location of hello secondary region.</span></span>

* <span data-ttu-id="170ef-118">Merhaba salt okunur kopyasıdır [sonuçta tutarlı](https://en.wikipedia.org/wiki/Eventual_consistency) hello birincil bölgede hello verilerle.</span><span class="sxs-lookup"><span data-stu-id="170ef-118">hello read-only copy is [eventually consistent](https://en.wikipedia.org/wiki/Eventual_consistency) with hello data in hello primary region.</span></span>

* <span data-ttu-id="170ef-119">BLOB'lar, tablolar ve Kuyruklar hello ikincil bölge için Sorgulayabileceğiniz bir *son eşitleme zamanı* hello son hello birincil toohello ikincil bölge Çoğaltmada gerçekleştiği belirten değer.</span><span class="sxs-lookup"><span data-stu-id="170ef-119">For blobs, tables, and queues, you can query hello secondary region for a *Last Sync Time* value that tells you when hello last replication from hello primary toohello secondary region occurred.</span></span> <span data-ttu-id="170ef-120">(Bu RA-GRS artıklık şu anda yok Azure File storage için desteklenmiyor.)</span><span class="sxs-lookup"><span data-stu-id="170ef-120">(This is not supported for Azure File storage, which doesn't have RA-GRS redundancy at this time.)</span></span>

* <span data-ttu-id="170ef-121">Merhaba birincil veya ikincil bölge içindeki hello verilerle hello depolama istemci kitaplığı toointeract kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-121">You can use hello Storage Client Library toointeract with hello data in either hello primary or secondary region.</span></span> <span data-ttu-id="170ef-122">Ayrıca yönlendirebilirsiniz okuma istekleri otomatik olarak toohello ikincil bölge Okuma isteği toohello birincil bölge Zaman aşımına uğrarsa.</span><span class="sxs-lookup"><span data-stu-id="170ef-122">You can also redirect read requests automatically toohello secondary region if a read request toohello primary region times out.</span></span>

* <span data-ttu-id="170ef-123">Merhaba veri hello birincil bölgede hello erişilebilirliğini etkileyen önemli bir sorun varsa, hello Azure ekibi bir coğrafi hangi noktada toohello birincil bölge işaret eden hello DNS girişlerini değiştirilen toopoint toohello ikincil bölge olacaktır yük devretme, tetikleyebilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-123">If there is a major issue affecting hello accessibility of hello data in hello primary region, hello Azure team may trigger a geo-failover, at which point hello DNS entries pointing toohello primary region will be changed toopoint toohello secondary region.</span></span>

* <span data-ttu-id="170ef-124">Bir coğrafi yük devretme gerçekleşirse, Azure yeni bir ikincil konum seçin ve hello veri toothat konumu çoğaltmak ardından hello ikincil DNS girişlerini tooit gelin.</span><span class="sxs-lookup"><span data-stu-id="170ef-124">If a geo-failover occurs, Azure will select a new secondary location and replicate hello data toothat location, then point hello secondary DNS entries tooit.</span></span> <span data-ttu-id="170ef-125">Merhaba depolama hesabı çoğaltma tamamlanana kadar hello ikincil uç kullanılamaz.</span><span class="sxs-lookup"><span data-stu-id="170ef-125">hello secondary endpoint will be unavailable until hello storage account has finished replicating.</span></span> <span data-ttu-id="170ef-126">Daha fazla bilgi için lütfen bkz [bir Azure Storage kesinti oluşursa hangi toodo](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span><span class="sxs-lookup"><span data-stu-id="170ef-126">For more information, please see [What toodo if an Azure Storage outage occurs](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span></span>

## <a name="application-design-considerations-when-using-ra-grs"></a><span data-ttu-id="170ef-127">RA-GRS kullanırken uygulama tasarım konuları</span><span class="sxs-lookup"><span data-stu-id="170ef-127">Application design considerations when using RA-GRS</span></span>

<span data-ttu-id="170ef-128">Merhaba ana amacı, bu makalenin tooshow olduğu, nasıl toodesign toofunction (bir sınırlı kapasite ile birlikte) daha büyük bir felaket hello birincil veri hello olayı içinde devam edecek bir uygulama Merkezi.</span><span class="sxs-lookup"><span data-stu-id="170ef-128">hello main purpose of this article is tooshow you how toodesign an application that will continue toofunction (albeit in a limited capacity) even in hello event of a major disaster at hello primary data center.</span></span> <span data-ttu-id="170ef-129">Bunun için bir sorun olmasa tooread hello ikincil bölge ' geçiş yapma ve hello birincil bölge yeniden kullanılabilir olduğunda yeniden geçiş yapmayı sağlayarak uygulama toohandle geçici veya uzun süreli sorunları.</span><span class="sxs-lookup"><span data-stu-id="170ef-129">You do this by having your application toohandle transient or long-running issues by switching tooread from hello secondary region while there is a problem, and switching back when hello primary region is available again.</span></span>

### <a name="using-eventually-consistent-data"></a><span data-ttu-id="170ef-130">Sonuçta tutarlı verileri kullanma</span><span class="sxs-lookup"><span data-stu-id="170ef-130">Using eventually consistent data</span></span>

<span data-ttu-id="170ef-131">Önerilen Bu çözüm, eski veri toohello çağrı yapan uygulamanın olabilir kesebilirsiniz tooreturn olduğunu varsayar.</span><span class="sxs-lookup"><span data-stu-id="170ef-131">This proposed solution assumes that it is okay tooreturn what could be stale data toohello calling application.</span></span> <span data-ttu-id="170ef-132">Merhaba ikincil veri sonuçta tutarlı olduğundan hello veri toohello birincil yazılmıştır, ancak hello güncelleştirme toohello ikincil hello birincil bölge erişilemez geçtiğinde, çoğaltma bitmedi mümkündür.</span><span class="sxs-lookup"><span data-stu-id="170ef-132">Because hello secondary data is eventually consistent, it is possible that hello data was written toohello primary but hello update toohello secondary had not finished replicating when hello primary region became inaccessible.</span></span>

<span data-ttu-id="170ef-133">Örneğin, müşteriniz başarılı bir güncelleştirme gönderme, ve hello güncelleştirme yayılan toohello ikincil önce sonra hello birincil gidin.</span><span class="sxs-lookup"><span data-stu-id="170ef-133">For example, your customer could submit an update that is successful, and then hello primary could go down before hello update is propagated toohello secondary.</span></span> <span data-ttu-id="170ef-134">Bu durumda, Hello müşteri sonra geri tooread hello veri isterse, kendisinin güncelleştirilmiş hello veri yerine hello eski veri alır.</span><span class="sxs-lookup"><span data-stu-id="170ef-134">In this case, if hello customer then asks tooread hello data back, he receives hello stale data instead of hello updated data.</span></span> <span data-ttu-id="170ef-135">Merhaba müşteri ileti nasıl bu kabul edilebilir ise ve bu durumda, karar vermeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="170ef-135">You must decide if this is acceptable, and if so, how you will message hello customer.</span></span> <span data-ttu-id="170ef-136">Nasıl toocheck hello son eşitleme zamanı hello ikincil veriler üzerinde daha sonra bu makalede toosee hello ikincil güncel ise görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="170ef-136">You'll see how toocheck hello Last Sync Time on hello secondary data later in this article toosee if hello secondary is up-to-date.</span></span>

### <a name="handling-services-separately-or-all-together"></a><span data-ttu-id="170ef-137">Ayrı ayrı veya hepsini bir araya Hizmetleri işleme</span><span class="sxs-lookup"><span data-stu-id="170ef-137">Handling services separately or all together</span></span>

<span data-ttu-id="170ef-138">Merhaba diğer hizmetlerin hala tam olarak işlevsel durumdayken olası değil, ancak kullanılabilir bir hizmet toobecome için mümkündür.</span><span class="sxs-lookup"><span data-stu-id="170ef-138">While not likely, it is possible for one service toobecome unavailable while hello other services are still fully functional.</span></span> <span data-ttu-id="170ef-139">Tanıtıcı hello yeniden deneme ve salt okunur modda her biri için ayrı olarak hizmet verebilir (BLOB, kuyruklar, tablolar) ya da yeniden deneme tüm hello depolama hizmetleri için genel birlikte işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-139">You can handle hello retries and read-only mode for each service separately (blobs, queues, tables), or you can handle retries generically for all hello storage services together.</span></span>

<span data-ttu-id="170ef-140">Örneğin, kuyruklar ve BLOB'lar uygulamanızda kullanırsanız, bunların her biri için ayrı kod toohandle yeniden denenebilir hataları tooput karar verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-140">For example, if you use queues and blobs in your application, you may decide tooput in separate code toohandle retryable errors for each of these.</span></span> <span data-ttu-id="170ef-141">Daha sonra bir yeniden deneme hello blob hizmetinden Al, ancak hello sıra hizmeti hala çalıştığından, yalnızca hello parçası blobları işlediği uygulamanızı etkilenir.</span><span class="sxs-lookup"><span data-stu-id="170ef-141">Then if you get a retry from hello blob service, but hello queue service is still working, only hello part of your application that handles blobs will be impacted.</span></span> <span data-ttu-id="170ef-142">Karar verirseniz toohandle tüm depolama hizmeti genel olarak yeniden dener ve çağrısı toohello blob hizmeti yeniden denenebilir hata döndürür ve istekleri tooboth hello blob hizmeti ve hello kuyruk hizmeti etkilenir.</span><span class="sxs-lookup"><span data-stu-id="170ef-142">If you decide toohandle all storage service retries generically and a call toohello blob service returns a retryable error, then requests tooboth hello blob service and hello queue service will be impacted.</span></span>

<span data-ttu-id="170ef-143">Sonuç olarak, bu, uygulamanızın hello karmaşıklığına bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="170ef-143">Ultimately, this depends on hello complexity of your application.</span></span> <span data-ttu-id="170ef-144">Hizmeti tarafından toohandle hello hataları karar verebilirsiniz, ancak bunun yerine tooredirect okuma istekleri tüm depolama hizmetleri toohello ikincil bölge için herhangi bir depolama hizmeti ile ilgili bir sorun hello birincil bölgede algıladığınızda hello uygulamasını ve salt okunur modda çalıştırmak.</span><span class="sxs-lookup"><span data-stu-id="170ef-144">You may decide not toohandle hello failures by service, but instead tooredirect read requests for all storage services toohello secondary region and run hello application in read-only mode when you detect a problem with any storage service in hello primary region.</span></span>

### <a name="other-considerations"></a><span data-ttu-id="170ef-145">Diğer konular</span><span class="sxs-lookup"><span data-stu-id="170ef-145">Other considerations</span></span>

<span data-ttu-id="170ef-146">Bunlar olan hello diğer noktalar, bu makalenin hello kalan aşağıdakiler ele alınacaktır.</span><span class="sxs-lookup"><span data-stu-id="170ef-146">These are hello other considerations we will discuss in hello rest of this article.</span></span>

*   <span data-ttu-id="170ef-147">Yeniden deneme, hello devre kesici desen kullanan okuma isteklerinin işlenmesi</span><span class="sxs-lookup"><span data-stu-id="170ef-147">Handling retries of read requests using hello Circuit Breaker pattern</span></span>

*   <span data-ttu-id="170ef-148">Sonuçta tutarlı verileri ve hello son eşitleme zamanı</span><span class="sxs-lookup"><span data-stu-id="170ef-148">Eventually-consistent data and hello Last Sync Time</span></span>

*   <span data-ttu-id="170ef-149">Test Etme</span><span class="sxs-lookup"><span data-stu-id="170ef-149">Testing</span></span>

## <a name="running-your-application-in-read-only-mode"></a><span data-ttu-id="170ef-150">Salt okunur modda da uygulamanızı çalıştırma</span><span class="sxs-lookup"><span data-stu-id="170ef-150">Running your application in read-only mode</span></span>

<span data-ttu-id="170ef-151">başarısız mümkün toohandle hem okuma isteklerinin olmalıdır ve güncelleştirme isteği başarısız oldu (Bu durumda ekler, güncelleştirmeleri ve silme işlemleri anlamına güncelleştirmesiyle) toouse RA-GRS depolama.</span><span class="sxs-lookup"><span data-stu-id="170ef-151">toouse RA-GRS storage, you must be able toohandle both failed read requests and failed update requests (with update in this case meaning inserts, updates, and deletions).</span></span> <span data-ttu-id="170ef-152">Merhaba birincil veri merkezi başarısız olursa, okuma isteklerinin yeniden yönlendirilen toohello ikincil veri merkezi olabilir, ancak hello ikincil salt okunur olduğu için güncelleştirme isteklerinin olamaz.</span><span class="sxs-lookup"><span data-stu-id="170ef-152">If hello primary data center fails, read requests can be redirected toohello secondary data center, but update requests cannot because hello secondary is read only.</span></span> <span data-ttu-id="170ef-153">Bu nedenle, bazı yolu toorun salt okunur modda uygulamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="170ef-153">For this reason, you need some way toorun your application in read-only mode.</span></span>

<span data-ttu-id="170ef-154">Örneğin, herhangi bir güncelleştirme istekleri toohello depolama hizmeti göndermeden önce denetlenecek bayrağı ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-154">For example, you can set a flag that will be checked before submitting any update requests toohello storage service.</span></span> <span data-ttu-id="170ef-155">Merhaba güncelleştirme isteklerinin birini geldiğinde, atlayın ve uygun yanıtı toohello müşteri döndürür.</span><span class="sxs-lookup"><span data-stu-id="170ef-155">When one of hello update requests comes through, you can skip it and return an appropriate response toohello customer.</span></span> <span data-ttu-id="170ef-156">Hatta hello Sorun çözülene kadar bazı özellikler değerlerinin toodisable istediğiniz ve bu özellikleri geçici olarak kullanılamıyor kullanıcıları bilgilendirin.</span><span class="sxs-lookup"><span data-stu-id="170ef-156">You may even want toodisable certain features altogether until hello problem is resolved and notify users that those features are temporarily unavailable.</span></span>

<span data-ttu-id="170ef-157">Toohandle hataları her hizmet için ayrı ayrı karar verirseniz, hizmeti tarafından salt okunur modda uygulamanızda toohandle hello özelliği toorun de gerekir.</span><span class="sxs-lookup"><span data-stu-id="170ef-157">If you decide toohandle errors for each service separately, you will also need toohandle hello ability toorun your application in read-only mode by service.</span></span> <span data-ttu-id="170ef-158">Salt okunur bayrakları etkinleştirilebilir her hizmet için sahip olabilir ve devre dışı bırakılır ve tanıtıcı kodunuzda hello uygun yerlerde uygun bayrağı hello.</span><span class="sxs-lookup"><span data-stu-id="170ef-158">You could have read-only flags for each service that can be enabled and disabled and handle hello appropriate flag in hello appropriate places in your code.</span></span>

<span data-ttu-id="170ef-159">Salt okunur modda uygulamanızda başka bir yan avantajına sahiptir – size verir mümkün toorun olan hello özelliği tooensure ana uygulama yükseltme sırasında işlevleri sınırlıdır.</span><span class="sxs-lookup"><span data-stu-id="170ef-159">Being able toorun your application in read-only mode has another side benefit – it gives you hello ability tooensure limited functionality during a major application upgrade.</span></span> <span data-ttu-id="170ef-160">Yükseltme yaparken hiç kimse hello hello birincil bölge verilere sağlama, uygulama toorun salt okunur mod ve noktası toohello ikincil veri merkezi içinde tetikleyebilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-160">You can trigger your application toorun in read-only mode and point toohello secondary data center, ensuring nobody is accessing hello data in hello primary region while you're making upgrades.</span></span>

## <a name="handling-updates-when-running-in-read-only-mode"></a><span data-ttu-id="170ef-161">Güncelleştirmeler salt okunur modda çalışırken işleme</span><span class="sxs-lookup"><span data-stu-id="170ef-161">Handling updates when running in read-only mode</span></span>

<span data-ttu-id="170ef-162">Birçok yolu vardır toohandle güncelleştirme salt okunur modda çalışırken ister.</span><span class="sxs-lookup"><span data-stu-id="170ef-162">There are many ways toohandle update requests when running in read-only mode.</span></span> <span data-ttu-id="170ef-163">Biz bu kapsamlı kapak olmaz ancak genellikle birkaç düşündüğünüz desenleri vardır.</span><span class="sxs-lookup"><span data-stu-id="170ef-163">We won't cover this comprehensively, but generally, there are a couple of patterns that you consider.</span></span>

1.  <span data-ttu-id="170ef-164">Tooyour kullanıcı yanıt ve şu anda güncelleştirmeleri kabul ettiğiniz değil söyleyin.</span><span class="sxs-lookup"><span data-stu-id="170ef-164">You can respond tooyour user and tell them you are not currently accepting updates.</span></span> <span data-ttu-id="170ef-165">Örneğin, bir kişi yönetim sistemi müşteriler tooaccess kişi bilgilerini etkinleştirme ancak güncelleştirmeleri olmamasını.</span><span class="sxs-lookup"><span data-stu-id="170ef-165">For example, a contact management system could enable customers tooaccess contact information but not make updates.</span></span>

2.  <span data-ttu-id="170ef-166">Sıraya alma güncelleştirmelerinizi başka bir bölgede olabilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-166">You can enqueue your updates in another region.</span></span> <span data-ttu-id="170ef-167">Bu durumda, farklı bir bölgede bekleyen güncelleştirme istekleri tooa sıranız yazma ve hello birincil veri merkezi yeniden çevrimiçi olduktan sonra bu istekleri bir şekilde tooprocess olması.</span><span class="sxs-lookup"><span data-stu-id="170ef-167">In this case, you would write your pending update requests tooa queue in a different region, and then have a way tooprocess those requests after hello primary data center comes online again.</span></span> <span data-ttu-id="170ef-168">Bu senaryoda, istenen bu hello güncelleştirmeyi daha sonra işlenmek üzere sıraya bilmeniz hello müşteri izin vermemelisiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-168">In this scenario, you should let hello customer know that hello update requested is queued for later processing.</span></span>

3.  <span data-ttu-id="170ef-169">Başka bir bölgede tooa depolama hesabı güncelleştirmelerinizi yazabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-169">You can write your updates tooa storage account in another region.</span></span> <span data-ttu-id="170ef-170">Merhaba birincil veri merkezi tekrar çevrimiçi olduğunda, bu güncelleştirmeleri hello verilerin hello yapısını bağlı olarak hello birincil veri yolu toomerge sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-170">Then when hello primary data center comes back online, you can have a way toomerge those updates into hello primary data, depending on hello structure of hello data.</span></span> <span data-ttu-id="170ef-171">Örneğin, bir tarih damgası hello adı ile ayrı dosyalar oluşturuyorsanız, bu dosyaları geri toohello birincil bölge kopyalayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-171">For example, if you are creating separate files with a date/time stamp in hello name, you can copy those files back toohello primary region.</span></span> <span data-ttu-id="170ef-172">Bu günlüğe kaydetme ve IOT verileri gibi bazı iş yükleri için çalışır.</span><span class="sxs-lookup"><span data-stu-id="170ef-172">This works for some workloads such as logging and iOT data.</span></span>

## <a name="handling-retries"></a><span data-ttu-id="170ef-173">Yeniden deneme işleme</span><span class="sxs-lookup"><span data-stu-id="170ef-173">Handling retries</span></span>

<span data-ttu-id="170ef-174">Bunu nasıl hangi hataları yeniden denenebilir bilmeniz?</span><span class="sxs-lookup"><span data-stu-id="170ef-174">How do you know which errors are retryable?</span></span> <span data-ttu-id="170ef-175">Bu hello depolama istemcisi kitaplığı tarafından belirlenir.</span><span class="sxs-lookup"><span data-stu-id="170ef-175">This is determined by hello storage client library.</span></span> <span data-ttu-id="170ef-176">Örneğin, onu yeniden deneniyor başarı de büyük olasılıkla tooresult olmadığından 404 hatası (kaynak bulunamadı) yeniden denenebilir değil.</span><span class="sxs-lookup"><span data-stu-id="170ef-176">For example, a 404 error (resource not found) is not retryable because retrying it is not likely tooresult in success.</span></span> <span data-ttu-id="170ef-177">Merhaba diğer yandan, bir 500 sunucu hatası olduğundan ve yalnızca geçici bir sorun olabilir yeniden denenebilir hatasıdır.</span><span class="sxs-lookup"><span data-stu-id="170ef-177">On hello other hand, a 500 error is retryable because it is a server error, and it may simply be a transient issue.</span></span> <span data-ttu-id="170ef-178">Daha fazla ayrıntı için hello denetleyin [açık kaynak kodu hello ExponentialRetry sınıfı için](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) hello .NET depolama istemci Kitaplığı'nda.</span><span class="sxs-lookup"><span data-stu-id="170ef-178">For more details, check out hello [open source code for hello ExponentialRetry class](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) in hello .NET storage client library.</span></span> <span data-ttu-id="170ef-179">(Merhaba ShouldRetry yöntemi bakın.)</span><span class="sxs-lookup"><span data-stu-id="170ef-179">(Look for hello ShouldRetry method.)</span></span>

### <a name="read-requests"></a><span data-ttu-id="170ef-180">Okuma isteği</span><span class="sxs-lookup"><span data-stu-id="170ef-180">Read requests</span></span>

<span data-ttu-id="170ef-181">Birincil depolama ile ilgili bir sorun varsa Okuma isteği yeniden yönlendirilen toosecondary depolama olabilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-181">Read requests can be redirected toosecondary storage if there is a problem with primary storage.</span></span> <span data-ttu-id="170ef-182">İçinde yukarıda olarak belirtildiği [sonunda tutarlı verileri kullanarak](#using-eventually-consistent-data), uygulama toopotentially eski verileri okumak için kabul edilebilir olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="170ef-182">As noted above in [Using Eventually Consistent Data](#using-eventually-consistent-data), it must be acceptable for your application toopotentially read stale data.</span></span> <span data-ttu-id="170ef-183">Merhaba depolama istemci kitaplığı tooaccess RA-GRS veri kullanıyorsanız, hello için bir değer ayarlayarak Okuma isteği hello yeniden deneme davranışını belirtebilirsiniz **LocationMode** hello aşağıdaki özellik tooone:</span><span class="sxs-lookup"><span data-stu-id="170ef-183">If you are using hello storage client library tooaccess RA-GRS data, you can specify hello retry behavior of a read request by setting a value for hello **LocationMode** property tooone of hello following:</span></span>

*   <span data-ttu-id="170ef-184">**PrimaryOnly** (Merhaba varsayılan)</span><span class="sxs-lookup"><span data-stu-id="170ef-184">**PrimaryOnly** (hello default)</span></span>

*   <span data-ttu-id="170ef-185">**PrimaryThenSecondary**</span><span class="sxs-lookup"><span data-stu-id="170ef-185">**PrimaryThenSecondary**</span></span>

*   <span data-ttu-id="170ef-186">**SecondaryOnly**</span><span class="sxs-lookup"><span data-stu-id="170ef-186">**SecondaryOnly**</span></span>

*   <span data-ttu-id="170ef-187">**SecondaryThenPrimary**</span><span class="sxs-lookup"><span data-stu-id="170ef-187">**SecondaryThenPrimary**</span></span>

<span data-ttu-id="170ef-188">Merhaba ayarlandığında **LocationMode** çok**PrimaryThenSecondary**hello ilk okuyun, istek toohello birincil uç nokta yeniden denenebilir hatayla başarısız olursa, hello istemci otomatik olarak başka bir okuma yapar toohello ikincil uç isteyin.</span><span class="sxs-lookup"><span data-stu-id="170ef-188">When you set hello **LocationMode** too**PrimaryThenSecondary**, if hello initial read request toohello primary endpoint fails with a retryable error, hello client automatically makes another read request toohello secondary endpoint.</span></span> <span data-ttu-id="170ef-189">Ardından sunucu zaman aşımı Hello hata olması durumunda hello hizmetinden yeniden denenebilir hata almadan önce hello istemci hello zaman aşımı tooexpire toowait gerekir.</span><span class="sxs-lookup"><span data-stu-id="170ef-189">If hello error is a server timeout, then hello client will have toowait for hello timeout tooexpire before it receives a retryable error from hello service.</span></span>

<span data-ttu-id="170ef-190">Alırken temelde iki senaryo tooconsider karar verirken nasıl toorespond tooa yeniden denenebilir hata:</span><span class="sxs-lookup"><span data-stu-id="170ef-190">There are basically two scenarios tooconsider when you are deciding how toorespond tooa retryable error:</span></span>

*   <span data-ttu-id="170ef-191">Bu yalıtılmış bir sorundur ve sonraki istekleri toohello birincil uç nokta yeniden denenebilir hata döndürmez.</span><span class="sxs-lookup"><span data-stu-id="170ef-191">This is an isolated problem and subsequent requests toohello primary endpoint will not return a retryable error.</span></span> <span data-ttu-id="170ef-192">Geçici ağ hatası olduğunda, bu durum oluşabilir bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="170ef-192">An example of where this might happen is when there is a transient network error.</span></span>

    <span data-ttu-id="170ef-193">Bu senaryoda, yoktur önemli performansta düşme olmaz elde etmeyle **LocationMode** çok ayarlamak**PrimaryThenSecondary** yalnızca seyrek böyle gibi.</span><span class="sxs-lookup"><span data-stu-id="170ef-193">In this scenario, there is no significant performance penalty in having **LocationMode** set too**PrimaryThenSecondary** as this only happens infrequently.</span></span>

*   <span data-ttu-id="170ef-194">Bu hello depolama hizmetleri hello birincil bölge içinde en az biri ile ilgili bir sorun olduğunu ve sonraki istekleri toothat hello birincil bölge alt hizmetinde büyük olasılıkla tooreturn yeniden denenebilir hata bir süre.</span><span class="sxs-lookup"><span data-stu-id="170ef-194">This is a problem with at least one of hello storage services in hello primary region and all subsequent requests toothat service in hello primary region are likely tooreturn retryable errors for a period of time.</span></span> <span data-ttu-id="170ef-195">Bu hello birincil bölge tamamen erişilemez örneğidir.</span><span class="sxs-lookup"><span data-stu-id="170ef-195">An example of this is if hello primary region is completely inaccessible.</span></span>

    <span data-ttu-id="170ef-196">Bu senaryoda, bulunmaktadır performans tüm okuma istekleri hello birincil endpoint ilk deneyin, hello zaman aşımı tooexpire için bekleyin ve ardından toohello ikincil uç geçiş için.</span><span class="sxs-lookup"><span data-stu-id="170ef-196">In this scenario, there is a performance penalty because all your read requests will try hello primary endpoint first, wait for hello timeout tooexpire, then switch toohello secondary endpoint.</span></span>

<span data-ttu-id="170ef-197">Bu senaryolarda, bunları olmadığını hello birincil uç noktası ile devam eden bir sorundur ve tüm okuma isteklerinin ayarlayarak toohello ikincil uç noktaya hello doğrudan göndermek tanımlamanız gerekir **LocationMode** özelliği çok **SecondaryOnly**.</span><span class="sxs-lookup"><span data-stu-id="170ef-197">For these scenarios, you should identify that there is an ongoing issue with hello primary endpoint and send all read requests directly toohello secondary endpoint by setting hello **LocationMode** property too**SecondaryOnly**.</span></span> <span data-ttu-id="170ef-198">Şu anda salt okunur modda hello uygulama toorun aynı zamanda değiştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="170ef-198">At this time, you should also change hello application toorun in read-only mode.</span></span> <span data-ttu-id="170ef-199">Bu yaklaşım hello adlandırılıyor [devre kesici düzeni](https://msdn.microsoft.com/library/dn589784.aspx).</span><span class="sxs-lookup"><span data-stu-id="170ef-199">This approach is known as hello [Circuit Breaker Pattern](https://msdn.microsoft.com/library/dn589784.aspx).</span></span>

### <a name="update-requests"></a><span data-ttu-id="170ef-200">Güncelleştirme isteği</span><span class="sxs-lookup"><span data-stu-id="170ef-200">Update requests</span></span>

<span data-ttu-id="170ef-201">Merhaba devre kesici düzeni uygulanan tooupdate istekleri de olabilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-201">hello Circuit Breaker pattern can also be applied tooupdate requests.</span></span> <span data-ttu-id="170ef-202">Ancak, güncelleştirme isteklerinin salt okunur yeniden yönlendirilen toosecondary depolama olamaz.</span><span class="sxs-lookup"><span data-stu-id="170ef-202">However, update requests cannot be redirected toosecondary storage, which is read-only.</span></span> <span data-ttu-id="170ef-203">Bu istekler için hello bırakmanız **LocationMode** çok ayarlanan özelliği**PrimaryOnly** (Merhaba varsayılan).</span><span class="sxs-lookup"><span data-stu-id="170ef-203">For these requests, you should leave hello **LocationMode** property set too**PrimaryOnly** (hello default).</span></span> <span data-ttu-id="170ef-204">toohandle bu hataları – bir satırda – 10 hataları gibi bir ölçüm toothese istekleri geçerli ve salt okunur modda hello uygulamasına, eşiğine ulaşıldığında geçiş yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-204">toohandle these errors, you can apply a metric toothese requests – such as 10 failures in a row – and when your threshold is met, switch hello application into read-only mode.</span></span> <span data-ttu-id="170ef-205">Kullanabileceğiniz hello olanlar hello devre kesici desen hakkında hello sonraki bölümde, aşağıda açıklandığı şekilde tooupdate modu döndürmek için aynı yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="170ef-205">You can use hello same methods for returning tooupdate mode as those described below in hello next section about hello Circuit Breaker pattern.</span></span>

## <a name="circuit-breaker-pattern"></a><span data-ttu-id="170ef-206">Devre kesici düzeni</span><span class="sxs-lookup"><span data-stu-id="170ef-206">Circuit Breaker pattern</span></span>

<span data-ttu-id="170ef-207">Uygulamanızda Hello devre kesici desenini kullanarak büyük olasılıkla toofail art arda olduğundan bir işlem yeniden deneniyor engelleyebilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-207">Using hello Circuit Breaker pattern in your application can prevent it from retrying an operation that is likely toofail repeatedly.</span></span> <span data-ttu-id="170ef-208">Merhaba işlem katlanarak yeniden sırada zaman ayırdığınız yerine hello uygulama toocontinue toorun sağlar.</span><span class="sxs-lookup"><span data-stu-id="170ef-208">It allows hello application toocontinue toorun rather than taking up time while hello operation is retried exponentially.</span></span> <span data-ttu-id="170ef-209">Merhaba hataya sabit zaman zaman Merhaba uygulaması hello işlemi yeniden deneyebilirsiniz de algılar.</span><span class="sxs-lookup"><span data-stu-id="170ef-209">It also detects when hello fault has been fixed, at which time hello application can try hello operation again.</span></span>

### <a name="how-tooimplement-hello-circuit-breaker-pattern"></a><span data-ttu-id="170ef-210">Nasıl tooimplement hello devre kesici düzeni</span><span class="sxs-lookup"><span data-stu-id="170ef-210">How tooimplement hello circuit breaker pattern</span></span>

<span data-ttu-id="170ef-211">tooidentify birincil uç noktası ile devam eden bir sorun olduğunu, ne sıklıkta hello istemci yeniden denenebilir hatayla karşılaştığında izleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-211">tooidentify that there is an ongoing problem with a primary endpoint, you can monitor how frequently hello client encounters retryable errors.</span></span> <span data-ttu-id="170ef-212">Her durumda farklı olduğundan, toodecide sahip hello eşik üzerinde toouse hello karar tooswitch toohello ikincil uç noktası için istediğiniz ve salt okunur modda hello uygulamayı çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="170ef-212">Because each case is different, you have toodecide on hello threshold you want toouse for hello decision tooswitch toohello secondary endpoint and run hello application in read-only mode.</span></span> <span data-ttu-id="170ef-213">Örneğin, bir satırda hiçbir başarı ile 10 hata varsa tooperform hello anahtar karar.</span><span class="sxs-lookup"><span data-stu-id="170ef-213">For example, you could decide tooperform hello switch if there are 10 failures in a row with no successes.</span></span> <span data-ttu-id="170ef-214">% 90'hello istekleri 2 dakikalık bir dönemde başarısız olursa bir başka örnek tooswitch ' dir.</span><span class="sxs-lookup"><span data-stu-id="170ef-214">Another example is tooswitch if 90% of hello requests in a 2-minute period fail.</span></span>

<span data-ttu-id="170ef-215">Merhaba ilk senaryo için yalnızca hello başarısızlık sayısı tutabilir ve varsa en fazla, ayarlanmış hello sayısı geri toozero hello ulaşmadan önce başarılı.</span><span class="sxs-lookup"><span data-stu-id="170ef-215">For hello first scenario, you can simply keep a count of hello failures, and if there is a success before reaching hello maximum, set hello count back toozero.</span></span> <span data-ttu-id="170ef-216">Merhaba ikinci senaryo için toouse olan tek yönlü tooimplement hello MemoryCache nesnesinde (.NET).</span><span class="sxs-lookup"><span data-stu-id="170ef-216">For hello second scenario, one way tooimplement it is toouse hello MemoryCache object (in .NET).</span></span> <span data-ttu-id="170ef-217">Her istek için bir CacheItem toohello önbellek ekleyin, hello değeri toosuccess (1) ayarlayın veya (0) başarısız ve hello sona erme saati too2 dakika şimdi (veya ne olursa olsun, zaman sınırlaması) ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="170ef-217">For each request, add a CacheItem toohello cache, set hello value toosuccess (1) or fail (0), and set hello expiration time too2 minutes from now (or whatever your time constraint is).</span></span> <span data-ttu-id="170ef-218">Bir girdi sona erme süresine ulaşıldığında hello girişi otomatik olarak kaldırılır.</span><span class="sxs-lookup"><span data-stu-id="170ef-218">When an entry's expiration time is reached, hello entry is automatically removed.</span></span> <span data-ttu-id="170ef-219">Bu bir çalışırken 2 dakikalık penceresi verir.</span><span class="sxs-lookup"><span data-stu-id="170ef-219">This will give you a rolling 2-minute window.</span></span> <span data-ttu-id="170ef-220">Bir istek toohello depolama hizmeti yaptığınızda, ilk LINQ sorgusu hello MemoryCache nesnesi toocalculate hello yüzde başarı arasında hello değerlerin toplamını ve hello sayısına göre bölme kullanın.</span><span class="sxs-lookup"><span data-stu-id="170ef-220">Each time you make a request toohello storage service, you first use a Linq query across hello MemoryCache object toocalculate hello percent success by summing hello values and dividing by hello count.</span></span> <span data-ttu-id="170ef-221">Merhaba yüzde başarı (örneğin, % 10) bazı eşiğin altına düştüğünde hello ayarlamak **LocationMode** özelliği için okuma isteklerinin çok**SecondaryOnly** ve salt okunur modda önce hello uygulamasına geçiş devam ediliyor.</span><span class="sxs-lookup"><span data-stu-id="170ef-221">When hello percent success drops below some threshold (such as 10%), set hello **LocationMode** property for read requests too**SecondaryOnly** and switch hello application into read-only mode before continuing.</span></span>

<span data-ttu-id="170ef-222">Merhaba eşik hataların yapılandırılabilir parametreler yapmadan dikkate almanız gereken şekilde toomake hello anahtar hizmet tooservice, uygulamanızda gelen değişebilir toodetermine kullanılır.</span><span class="sxs-lookup"><span data-stu-id="170ef-222">hello threshold of errors used toodetermine when toomake hello switch may vary from service tooservice in your application, so you should consider making them configurable parameters.</span></span> <span data-ttu-id="170ef-223">Ayrıca her hizmetinde yeniden denenebilir hatayla toohandle ayrı ayrı karar veya olarak, daha önce bahsedildiği gibi budur.</span><span class="sxs-lookup"><span data-stu-id="170ef-223">This is also where you decide toohandle retryable errors from each service separately or as one, as discussed previously.</span></span>

<span data-ttu-id="170ef-224">Başka bir husustur nasıl toohandle bir uygulama birden çok örneğini ve her örnek yeniden denenebilir hata algıladığınızda hangi toodo.</span><span class="sxs-lookup"><span data-stu-id="170ef-224">Another consideration is how toohandle multiple instances of an application, and what toodo when you detect retryable errors in each instance.</span></span> <span data-ttu-id="170ef-225">Örneğin, aynı uygulama yüklenen hello ile çalışan 20 VM'ye sahip.</span><span class="sxs-lookup"><span data-stu-id="170ef-225">For example, you may have 20 VMs running with hello same application loaded.</span></span> <span data-ttu-id="170ef-226">Her örneği ayrı ayrı işlemek?</span><span class="sxs-lookup"><span data-stu-id="170ef-226">Do you handle each instance separately?</span></span> <span data-ttu-id="170ef-227">Yolu bir örneği bir sorun olduğunda sorunlarınız bir örneğini başlatır, bu bir örnek toolimit hello yanıt toojust istiyor musunuz veya tootry toohave istiyorsunuz tüm örneklerini hello aynı yanıt?</span><span class="sxs-lookup"><span data-stu-id="170ef-227">If one instance starts having problems, do you want toolimit hello response toojust that one instance, or do you want tootry toohave all instances respond in hello same way when one instance has a problem?</span></span> <span data-ttu-id="170ef-228">Merhaba örnekleri ayrı olarak işleme toocoordinate hello yanıt arasında gezinmek çalışırken daha çok daha kolaydır, ancak bunu nasıl yapacağınız uygulamanızın mimarisine bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="170ef-228">Handling hello instances separately is much simpler than trying toocoordinate hello response across them, but how you do this depends on your application's architecture.</span></span>

### <a name="options-for-monitoring-hello-error-frequency"></a><span data-ttu-id="170ef-229">Merhaba hata sıklığı izleme seçenekleri</span><span class="sxs-lookup"><span data-stu-id="170ef-229">Options for monitoring hello error frequency</span></span>

<span data-ttu-id="170ef-230">Tooswitch toohello ikincil bölge ve değişiklik üzerinden hello olduğunda uygulama toorun salt okunur modda yeniden deneme sırasını toodetermine içinde hello birincil bölgede hello sıklığını izleme için üç ana seçeneğiniz vardır.</span><span class="sxs-lookup"><span data-stu-id="170ef-230">You have three main options for monitoring hello frequency of retries in hello primary region in order toodetermine when tooswitch over toohello secondary region and change hello application toorun in read-only mode.</span></span>

*   <span data-ttu-id="170ef-231">Hello için bir işleyici ekleyin [ **yeniden deneniyor** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) hello olayda [ **OperationContext** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) tooyour depolama isteklerini iletmek – hello budur nesnesi yöntemi bu makalede gösterilen ve örnek eşlik hello kullanılır.</span><span class="sxs-lookup"><span data-stu-id="170ef-231">Add a handler for hello [**Retrying**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) event on hello [**OperationContext**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) object you pass tooyour storage requests – this is hello method displayed in this article and used in hello accompanying sample.</span></span> <span data-ttu-id="170ef-232">Merhaba istemcinin bir isteği yeniden deneme zaman bu olayları yangın, tootrack ne sıklıkta etkinleştirme hello istemci birincil bir uç noktada yeniden denenebilir hatayla karşılaştığında.</span><span class="sxs-lookup"><span data-stu-id="170ef-232">These events fire whenever hello client retries a request, enabling you tootrack how often hello client encounters retryable errors on a primary endpoint.</span></span>

    ```csharp 
    operationContext.Retrying += (sender, arguments) =>
    {
        // Retrying in hello primary region
        if (arguments.Request.Host == primaryhostname)
            ...
    };
    ```

*   <span data-ttu-id="170ef-233">Merhaba, [ **değerlendir** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) yöntemi bir özel yeniden deneme İlkesi'nde çalıştırabilirsiniz özel kod her bir yeniden deneme gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="170ef-233">In hello [**Evaluate**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) method in a custom retry policy, you can run custom code whenever a retry takes place.</span></span> <span data-ttu-id="170ef-234">Yeniden deneme olduğunda, bu da, yeniden deneme davranışı fırsat toomodify hello verir toplama toorecording içinde.</span><span class="sxs-lookup"><span data-stu-id="170ef-234">In addition toorecording when a retry happens, this also gives you hello opportunity toomodify your retry behavior.</span></span>

    ```csharp 
    public RetryInfo Evaluate(RetryContext retryContext,
    OperationContext operationContext)
    {
        var statusCode = retryContext.LastRequestResult.HttpStatusCode;
        if (retryContext.CurrentRetryCount >= this.maximumAttempts
        || ((statusCode &gt;= 300 && statusCode &lt; 500 && statusCode != 408)
        || statusCode == 501 // Not Implemented
        || statusCode == 505 // Version Not Supported
            ))
        {
        // Do not retry
            return null;
        }

        // Monitor retries in hello primary location
        ...

        // Determine RetryInterval and TargetLocation
        RetryInfo info =
            CreateRetryInfo(retryContext.CurrentRetryCount);

        return info;
    }
    ```

*   <span data-ttu-id="170ef-235">Merhaba üçüncü tooimplement kukla ile birincil storage uç noktanız sürekli olarak ping uygulamanızda özel bir izleme bileşeni yaklaşımdır, sistem durumunu (örneğin, küçük bir blob okuma) istekleri toodetermine okuyun.</span><span class="sxs-lookup"><span data-stu-id="170ef-235">hello third approach is tooimplement a custom monitoring component in your application that continually pings your primary storage endpoint with dummy read requests (such as reading a small blob) toodetermine its health.</span></span> <span data-ttu-id="170ef-236">Bu, bazı kaynaklar ancak önemli ölçüde kalırsınız.</span><span class="sxs-lookup"><span data-stu-id="170ef-236">This would take up some resources, but not a significant amount.</span></span> <span data-ttu-id="170ef-237">Eşiğe ulaştığında bir sorun algılandığında, ardından hello anahtar çok gerçekleştireceği**SecondaryOnly** ve salt okunur modda.</span><span class="sxs-lookup"><span data-stu-id="170ef-237">When a problem is discovered that reaches your threshold, you would then perform hello switch too**SecondaryOnly** and read-only mode.</span></span>

<span data-ttu-id="170ef-238">Belirli bir noktada tooswitch geri toousing hello birincil uç noktası ve güncelleştirmelere izin isteyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-238">At some point, you will want tooswitch back toousing hello primary endpoint and allowing updates.</span></span> <span data-ttu-id="170ef-239">Yukarıda listelenen hello ilk iki yöntemden birini kullanıyorsanız, yalnızca geri toohello birincil endpoint geçin ve rasgele seçilen bir zaman miktarı veya işlemlerinin sayısı gerçekleştirildikten sonra güncelleştirme modunu etkinleştirmek.</span><span class="sxs-lookup"><span data-stu-id="170ef-239">If using one of hello first two methods listed above, you could simply switch back toohello primary endpoint and enable update mode after an arbitrarily selected amount of time or number of operations has been performed.</span></span> <span data-ttu-id="170ef-240">Ardından, hello yeniden deneme mantığı yeniden Git izin verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-240">You can then let it go through hello retry logic again.</span></span> <span data-ttu-id="170ef-241">Merhaba sorunun giderilmiş, toouse hello birincil endpoint devam ve güncelleştirmelere izin verecek.</span><span class="sxs-lookup"><span data-stu-id="170ef-241">If hello problem has been fixed, it will continue toouse hello primary endpoint and allow updates.</span></span> <span data-ttu-id="170ef-242">Hala bir sorun varsa, bu kez daha geri toohello ikincil uç noktası ve salt okunur modda ayarlamış hello ölçütleri başarısız sonra geçiş yapar.</span><span class="sxs-lookup"><span data-stu-id="170ef-242">If there is still a problem, it will once more switch back toohello secondary endpoint and read-only mode after failing hello criteria you've set.</span></span>

<span data-ttu-id="170ef-243">Ping hello birincil depolama endpoint yeniden, başarılı olduğunda hello üçüncü senaryo için geri hello anahtar çok tetikleyebilir**PrimaryOnly** ve güncelleştirmelere izin devam edin.</span><span class="sxs-lookup"><span data-stu-id="170ef-243">For hello third scenario, when pinging hello primary storage endpoint becomes successful again, you can trigger hello switch back too**PrimaryOnly** and continue allowing updates.</span></span>

## <a name="handling-eventually-consistent-data"></a><span data-ttu-id="170ef-244">Sonuçta tutarlı verileri işleme</span><span class="sxs-lookup"><span data-stu-id="170ef-244">Handling eventually consistent data</span></span>

<span data-ttu-id="170ef-245">RA-GRS hello birincil toohello ikincil bölge ' işlemleri yineleyerek çalışır.</span><span class="sxs-lookup"><span data-stu-id="170ef-245">RA-GRS works by replicating transactions from hello primary toohello secondary region.</span></span> <span data-ttu-id="170ef-246">Bu çoğaltma işlemi hello ikincil bölge'hello verilerde olduğunu garanti *sonuçta tutarlı*.</span><span class="sxs-lookup"><span data-stu-id="170ef-246">This replication process guarantees that hello data in hello secondary region is *eventually consistent*.</span></span> <span data-ttu-id="170ef-247">Merhaba ikincil bölge'de aynı olarak sipariş hello içinde bu hello birincil bölge içinde tüm hello işlemleri sonunda hello ikincil bölge'de görünür, ancak olabileceğini bir gecikme göründükleri önce anlamına gelir ve hello işlemleri garantisi yoktur gelmesini Bunlar ilk olarak hello birincil bölgede uygulandı.</span><span class="sxs-lookup"><span data-stu-id="170ef-247">This means that all hello transactions in hello primary region will eventually appear in hello secondary region, but that there may be a lag before they appear, and that there is no guarantee hello transactions arrive in hello secondary region in hello same order as that in which they were originally applied in hello primary region.</span></span> <span data-ttu-id="170ef-248">İşlemlerinizi sırasıyla dışında hello ikincil bölgede ulaşırsa, *olabilir* hello hizmet arayı kapatıncaya kadar verilerinizi hello ikincil bölge toobe tutarsız bir durumda göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="170ef-248">If your transactions arrive in hello secondary region out of order, you *may* consider your data in hello secondary region toobe in an inconsistent state until hello service catches up.</span></span>

<span data-ttu-id="170ef-249">Merhaba aşağıdaki tabloda gösterilmektedir çalışan toomake hello ayrıntılarını güncelleştirdiğinizde ne gerçekleşebilir örneği her hello üyesi *Yöneticiler* rol.</span><span class="sxs-lookup"><span data-stu-id="170ef-249">hello following table shows an example of what might happen when you update hello details of an employee toomake her a member of hello *administrators* role.</span></span> <span data-ttu-id="170ef-250">Bu örnek Hello artırmak amacıyla için bu hello güncelleştirmenin gerektirdiği **çalışan** varlık ve güncelleştirme bir **Yönetici rolü** Yöneticiler toplam sayısı hello sayısı olan varlık.</span><span class="sxs-lookup"><span data-stu-id="170ef-250">For hello sake of this example, this requires you update hello **employee** entity and update an **administrator role** entity with a count of hello total number of administrators.</span></span> <span data-ttu-id="170ef-251">Nasıl hello güncelleştirmeleri bozuk hello ikincil bölge'de uygulandığını dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="170ef-251">Notice how hello updates are applied out of order in hello secondary region.</span></span>

| <span data-ttu-id="170ef-252">**Saat**</span><span class="sxs-lookup"><span data-stu-id="170ef-252">**Time**</span></span> | <span data-ttu-id="170ef-253">**İşlem**</span><span class="sxs-lookup"><span data-stu-id="170ef-253">**Transaction**</span></span>                                            | <span data-ttu-id="170ef-254">**Çoğaltma**</span><span class="sxs-lookup"><span data-stu-id="170ef-254">**Replication**</span></span>                       | <span data-ttu-id="170ef-255">**Son eşitleme zamanı**</span><span class="sxs-lookup"><span data-stu-id="170ef-255">**Last Sync Time**</span></span> | <span data-ttu-id="170ef-256">**Sonuç**</span><span class="sxs-lookup"><span data-stu-id="170ef-256">**Result**</span></span> |
|----------|------------------------------------------------------------|---------------------------------------|--------------------|------------| 
| <span data-ttu-id="170ef-257">T0</span><span class="sxs-lookup"><span data-stu-id="170ef-257">T0</span></span>       | <span data-ttu-id="170ef-258">İşlem A:</span><span class="sxs-lookup"><span data-stu-id="170ef-258">Transaction A:</span></span> <br> <span data-ttu-id="170ef-259">Çalışanı Ekle</span><span class="sxs-lookup"><span data-stu-id="170ef-259">Insert employee</span></span> <br> <span data-ttu-id="170ef-260">birincil varlık</span><span class="sxs-lookup"><span data-stu-id="170ef-260">entity in primary</span></span> |                                   |                    | <span data-ttu-id="170ef-261">İşlem A tooprimary eklenen</span><span class="sxs-lookup"><span data-stu-id="170ef-261">Transaction A inserted tooprimary,</span></span><br> <span data-ttu-id="170ef-262">henüz çoğaltılmamış.</span><span class="sxs-lookup"><span data-stu-id="170ef-262">not replicated yet.</span></span> |
| <span data-ttu-id="170ef-263">T1</span><span class="sxs-lookup"><span data-stu-id="170ef-263">T1</span></span>       |                                                            | <span data-ttu-id="170ef-264">İşlem A</span><span class="sxs-lookup"><span data-stu-id="170ef-264">Transaction A</span></span> <br> <span data-ttu-id="170ef-265">Çoğaltılan</span><span class="sxs-lookup"><span data-stu-id="170ef-265">replicated to</span></span><br> <span data-ttu-id="170ef-266">İkincil</span><span class="sxs-lookup"><span data-stu-id="170ef-266">secondary</span></span> | <span data-ttu-id="170ef-267">T1</span><span class="sxs-lookup"><span data-stu-id="170ef-267">T1</span></span> | <span data-ttu-id="170ef-268">İşlem A toosecondary çoğaltılan.</span><span class="sxs-lookup"><span data-stu-id="170ef-268">Transaction A replicated toosecondary.</span></span> <br><span data-ttu-id="170ef-269">Son eşitleme zamanı güncelleştirildi.</span><span class="sxs-lookup"><span data-stu-id="170ef-269">Last Sync Time updated.</span></span>    |
| <span data-ttu-id="170ef-270">T2</span><span class="sxs-lookup"><span data-stu-id="170ef-270">T2</span></span>       | <span data-ttu-id="170ef-271">İşlem B:</span><span class="sxs-lookup"><span data-stu-id="170ef-271">Transaction B:</span></span><br><span data-ttu-id="170ef-272">Güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="170ef-272">Update</span></span><br> <span data-ttu-id="170ef-273">çalışan varlık</span><span class="sxs-lookup"><span data-stu-id="170ef-273">employee entity</span></span><br> <span data-ttu-id="170ef-274">birincil</span><span class="sxs-lookup"><span data-stu-id="170ef-274">in primary</span></span>  |                                | <span data-ttu-id="170ef-275">T1</span><span class="sxs-lookup"><span data-stu-id="170ef-275">T1</span></span>                 | <span data-ttu-id="170ef-276">İşlem tooprimary yazılmış B,</span><span class="sxs-lookup"><span data-stu-id="170ef-276">Transaction B written tooprimary,</span></span><br> <span data-ttu-id="170ef-277">henüz çoğaltılmamış.</span><span class="sxs-lookup"><span data-stu-id="170ef-277">not replicated yet.</span></span>  |
| <span data-ttu-id="170ef-278">T3</span><span class="sxs-lookup"><span data-stu-id="170ef-278">T3</span></span>       | <span data-ttu-id="170ef-279">İşlem C:</span><span class="sxs-lookup"><span data-stu-id="170ef-279">Transaction C:</span></span><br> <span data-ttu-id="170ef-280">Güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="170ef-280">Update</span></span> <br><span data-ttu-id="170ef-281">Yönetici</span><span class="sxs-lookup"><span data-stu-id="170ef-281">administrator</span></span><br><span data-ttu-id="170ef-282">Rol varlığı</span><span class="sxs-lookup"><span data-stu-id="170ef-282">role entity in</span></span><br><span data-ttu-id="170ef-283">birincil</span><span class="sxs-lookup"><span data-stu-id="170ef-283">primary</span></span> |                    | <span data-ttu-id="170ef-284">T1</span><span class="sxs-lookup"><span data-stu-id="170ef-284">T1</span></span>                 | <span data-ttu-id="170ef-285">İşlem tooprimary yazılmış C,</span><span class="sxs-lookup"><span data-stu-id="170ef-285">Transaction C written tooprimary,</span></span><br> <span data-ttu-id="170ef-286">henüz çoğaltılmamış.</span><span class="sxs-lookup"><span data-stu-id="170ef-286">not replicated yet.</span></span>  |
| <span data-ttu-id="170ef-287">*T4*</span><span class="sxs-lookup"><span data-stu-id="170ef-287">*T4*</span></span>     |                                                       | <span data-ttu-id="170ef-288">İşlem C</span><span class="sxs-lookup"><span data-stu-id="170ef-288">Transaction C</span></span> <br><span data-ttu-id="170ef-289">Çoğaltılan</span><span class="sxs-lookup"><span data-stu-id="170ef-289">replicated to</span></span><br> <span data-ttu-id="170ef-290">İkincil</span><span class="sxs-lookup"><span data-stu-id="170ef-290">secondary</span></span> | <span data-ttu-id="170ef-291">T1</span><span class="sxs-lookup"><span data-stu-id="170ef-291">T1</span></span>         | <span data-ttu-id="170ef-292">İşlem C toosecondary çoğaltılan.</span><span class="sxs-lookup"><span data-stu-id="170ef-292">Transaction C replicated toosecondary.</span></span><br><span data-ttu-id="170ef-293">Olduğundan güncelleştirilmedi LastSyncTime</span><span class="sxs-lookup"><span data-stu-id="170ef-293">LastSyncTime not updated because</span></span> <br><span data-ttu-id="170ef-294">işlem B henüz çoğaltılmamış.</span><span class="sxs-lookup"><span data-stu-id="170ef-294">transaction B has not been replicated yet.</span></span>|
| <span data-ttu-id="170ef-295">*T5*</span><span class="sxs-lookup"><span data-stu-id="170ef-295">*T5*</span></span>     | <span data-ttu-id="170ef-296">Varlıkların okuma</span><span class="sxs-lookup"><span data-stu-id="170ef-296">Read entities</span></span> <br><span data-ttu-id="170ef-297">İkincil</span><span class="sxs-lookup"><span data-stu-id="170ef-297">from secondary</span></span>                           |                                  | <span data-ttu-id="170ef-298">T1</span><span class="sxs-lookup"><span data-stu-id="170ef-298">T1</span></span>                 | <span data-ttu-id="170ef-299">Çalışanın hello eski değer alma</span><span class="sxs-lookup"><span data-stu-id="170ef-299">You get hello stale value for employee</span></span> <br> <span data-ttu-id="170ef-300">Varlık işlem B kurmadı çünkü</span><span class="sxs-lookup"><span data-stu-id="170ef-300">entity because transaction B hasn't</span></span> <br> <span data-ttu-id="170ef-301">henüz çoğaltılan.</span><span class="sxs-lookup"><span data-stu-id="170ef-301">replicated yet.</span></span> <span data-ttu-id="170ef-302">Merhaba yeni değerini alın</span><span class="sxs-lookup"><span data-stu-id="170ef-302">You get hello new value for</span></span><br> <span data-ttu-id="170ef-303">Yönetici rolü varlığı C olduğundan</span><span class="sxs-lookup"><span data-stu-id="170ef-303">administrator role entity because C has</span></span><br> <span data-ttu-id="170ef-304">Çoğaltılan.</span><span class="sxs-lookup"><span data-stu-id="170ef-304">replicated.</span></span> <span data-ttu-id="170ef-305">Son eşitleme zamanı hala tamamlanmamış</span><span class="sxs-lookup"><span data-stu-id="170ef-305">Last Sync Time still hasn't</span></span><br> <span data-ttu-id="170ef-306">Silinmiş olduğundan güncelleştirilmiş işlem B</span><span class="sxs-lookup"><span data-stu-id="170ef-306">been updated because transaction B</span></span><br> <span data-ttu-id="170ef-307">Çoğaltılan kurmadı.</span><span class="sxs-lookup"><span data-stu-id="170ef-307">hasn't replicated.</span></span> <span data-ttu-id="170ef-308">Size söyleyebilir</span><span class="sxs-lookup"><span data-stu-id="170ef-308">You can tell the</span></span><br><span data-ttu-id="170ef-309">Yönetici rolü varlığı tutarsız.</span><span class="sxs-lookup"><span data-stu-id="170ef-309">administrator role entity is inconsistent</span></span> <br><span data-ttu-id="170ef-310">Merhaba varlık tarih/saat sonra olduğundan</span><span class="sxs-lookup"><span data-stu-id="170ef-310">because hello entity date/time is after</span></span> <br><span data-ttu-id="170ef-311">Merhaba son eşitleme zamanı.</span><span class="sxs-lookup"><span data-stu-id="170ef-311">hello Last Sync Time.</span></span> |
| <span data-ttu-id="170ef-312">*T6*</span><span class="sxs-lookup"><span data-stu-id="170ef-312">*T6*</span></span>     |                                                      | <span data-ttu-id="170ef-313">İşlem B</span><span class="sxs-lookup"><span data-stu-id="170ef-313">Transaction B</span></span><br> <span data-ttu-id="170ef-314">Çoğaltılan</span><span class="sxs-lookup"><span data-stu-id="170ef-314">replicated to</span></span><br> <span data-ttu-id="170ef-315">İkincil</span><span class="sxs-lookup"><span data-stu-id="170ef-315">secondary</span></span> | <span data-ttu-id="170ef-316">T6</span><span class="sxs-lookup"><span data-stu-id="170ef-316">T6</span></span>                 | <span data-ttu-id="170ef-317">*T6* – C aracılığıyla tüm işlemlerin</span><span class="sxs-lookup"><span data-stu-id="170ef-317">*T6* – All transactions through C have</span></span> <br><span data-ttu-id="170ef-318">edilmiş çoğaltılan, son eşitleme zamanı</span><span class="sxs-lookup"><span data-stu-id="170ef-318">been replicated, Last Sync Time</span></span><br> <span data-ttu-id="170ef-319">güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="170ef-319">is updated.</span></span> |

<span data-ttu-id="170ef-320">Bu örnekte, hello istemci anahtarları tooreading T5 hello ikincil bölge'den varsayalım.</span><span class="sxs-lookup"><span data-stu-id="170ef-320">In this example, assume hello client switches tooreading from hello secondary region at T5.</span></span> <span data-ttu-id="170ef-321">Başarılı bir şekilde hello okuyabilirsiniz **Yönetici rolü** varlık şu anda, ancak hello varlık hello hello sayısı ile tutarlı değil yöneticiler sayısı için bir değer içeriyorsa **çalışan** varlıklar Yöneticiler hello ikincil bölge, şu anda işaretlenmedi.</span><span class="sxs-lookup"><span data-stu-id="170ef-321">It can successfully read hello **administrator role** entity at this time, but hello entity contains a value for hello count of administrators that is not consistent with hello number of **employee** entities that are marked as administrators in hello secondary region at this time.</span></span> <span data-ttu-id="170ef-322">İstemci yalnızca bu değerle tutarsız bilgiler olduğunu hello risk görüntüleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-322">Your client could simply display this value, with hello risk that it is inconsistent information.</span></span> <span data-ttu-id="170ef-323">Alternatif olarak, hello istemci toodetermine bu hello çalışabilir **Yönetici rolü** hello güncelleştirmeleri sıralama dışında gerçekleşen ve sonra bu olayının hello kullanıcı bildirmeniz büyük olasılıkla tutarsız bir durumda olduğundan.</span><span class="sxs-lookup"><span data-stu-id="170ef-323">Alternatively, hello client could attempt toodetermine that hello **administrator role** is in a potentially inconsistent state because hello updates have happened out of order, and then inform hello user of this fact.</span></span>

<span data-ttu-id="170ef-324">toorecognize, büyük olasılıkla tutarsız veriler içerdiğinden emin hello istemci hello hello değerini kullanabilir *son eşitleme zamanı* herhangi bir anda bir depolama birimi hizmeti sorgulayarak alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-324">toorecognize that it has potentially inconsistent data, hello client can use hello value of hello *Last Sync Time* that you can get at any time by querying a storage service.</span></span> <span data-ttu-id="170ef-325">Bu size bildirir hello zaman zaman hello ikincil bölge'hello verileri son tutarlı ve hello hizmet uygulandığında tüm işlemleri önceki toothat noktası zamanında hello.</span><span class="sxs-lookup"><span data-stu-id="170ef-325">This tells you hello time when hello data in hello secondary region was last consistent and when hello service had applied all hello transactions prior toothat point in time.</span></span> <span data-ttu-id="170ef-326">Merhaba hizmet hello ekledikten sonra yukarıda gösterilen hello örnekte **çalışan** hello ikincil bölge varlıkta hello son eşitleme Zamanı ayarlanmış çok*T1*.</span><span class="sxs-lookup"><span data-stu-id="170ef-326">In hello example shown above, after hello service inserts hello **employee** entity in hello secondary region, hello last sync time is set too*T1*.</span></span> <span data-ttu-id="170ef-327">Kalır *T1* hello hello hizmet güncelleştirmeleri kadar **çalışan** çok olarak ayarlandığında hello ikincil bölge varlık*T6*.</span><span class="sxs-lookup"><span data-stu-id="170ef-327">It remains at *T1* until hello service updates hello **employee** entity in hello secondary region when it is set too*T6*.</span></span> <span data-ttu-id="170ef-328">Merhaba istemci hello hello varlıkta, okur, son eşitleme zamanı alır, *T5*, onu hello varlıkta hello damgasıyla karşılaştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="170ef-328">If hello client retrieves hello last sync time when it reads hello entity at *T5*, it can compare it with hello timestamp on hello entity.</span></span> <span data-ttu-id="170ef-329">Merhaba varlık Hello zaman damgasını hello sonraki zaman, son eşitleme sonra hello varlık büyük olasılıkla tutarsız bir durumda olur ve ne olursa olsun, uygulamanız için hello uygun eylemi gerçekleştirin.</span><span class="sxs-lookup"><span data-stu-id="170ef-329">If hello timestamp on hello entity is later than hello last sync time, then hello entity is in a potentially inconsistent state, and you can take whatever is hello appropriate action for your application.</span></span> <span data-ttu-id="170ef-330">Bu alanı kullanarak hello son güncelleştirme toohello birincil tamamlandığı bilmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="170ef-330">Using this field requires that you know when hello last update toohello primary was completed.</span></span>

## <a name="testing"></a><span data-ttu-id="170ef-331">Test Etme</span><span class="sxs-lookup"><span data-stu-id="170ef-331">Testing</span></span>

<span data-ttu-id="170ef-332">Bu, uygulamanızın yeniden denenebilir hatalarla karşılaştığında beklendiği gibi davranır önemli tootest olur.</span><span class="sxs-lookup"><span data-stu-id="170ef-332">It's important tootest that your application behaves as expected when it encounters retryable errors.</span></span> <span data-ttu-id="170ef-333">Örneğin, uygulama anahtarları toohello ikincil hello tootest gerekir ve salt okunur moduna bir sorun algılar ve anahtarlar geri zaman hello birincil bölge yeniden kullanılabilir duruma gelir.</span><span class="sxs-lookup"><span data-stu-id="170ef-333">For example, you need tootest that hello application switches toohello secondary and into read-only mode when it detects a problem, and switches back when hello primary region becomes available again.</span></span> <span data-ttu-id="170ef-334">toodo Bu, ne sıklıkta ortaya denetlemek ve bir şekilde toosimulate yeniden denenebilir hata gerekir.</span><span class="sxs-lookup"><span data-stu-id="170ef-334">toodo this, you need a way toosimulate retryable errors and control how often they occur.</span></span>

<span data-ttu-id="170ef-335">Kullanabileceğiniz [Fiddler](http://www.telerik.com/fiddler) toointercept ve HTTP yanıtını bir betik içinde değiştirin.</span><span class="sxs-lookup"><span data-stu-id="170ef-335">You can use [Fiddler](http://www.telerik.com/fiddler) toointercept and modify HTTP responses in a script.</span></span> <span data-ttu-id="170ef-336">Bu komut dosyasını birincil uç noktasından gelen yanıtları tanımlamak ve depolama istemci kitaplığı yeniden denenebilir hata olarak tanır bu hello hello HTTP durum kodu tooone değiştirin.</span><span class="sxs-lookup"><span data-stu-id="170ef-336">This script can identify responses that come from your primary endpoint and change hello HTTP status code tooone that hello Storage Client Library recognizes as a retryable error.</span></span> <span data-ttu-id="170ef-337">Bu kod parçacığını hello yanıtları tooread isteklerini karşılar Fiddler komut basit bir örnek gösterilmektedir **employeedata** tablo tooreturn 502 durumu:</span><span class="sxs-lookup"><span data-stu-id="170ef-337">This code snippet shows a simple example of a Fiddler script that intercepts responses tooread requests against hello **employeedata** table tooreturn a 502 status:</span></span>

```java
static function OnBeforeResponse(oSession: Session) {
    ...
    if ((oSession.hostname == "\[yourstorageaccount\].table.core.windows.net")
      && (oSession.PathAndQuery.StartsWith("/employeedata?$filter"))) {
        oSession.responseCode = 502;
    }
}
```

<span data-ttu-id="170ef-338">Bu örnek toointercept istekleri daha geniş ölçüdeki genişletmek ve yalnızca hello değiştirme **yanıt kodu** bazı bunları toobetter benzetimini gerçek dünya senaryoları.</span><span class="sxs-lookup"><span data-stu-id="170ef-338">You could extend this example toointercept a wider range of requests and only change hello **responseCode** on some of them toobetter simulate a real-world scenario.</span></span> <span data-ttu-id="170ef-339">Fiddler betikleri özelleştirme hakkında daha fazla bilgi için bkz: [bir istek veya yanıt değiştirme](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) hello Fiddler belge içinde.</span><span class="sxs-lookup"><span data-stu-id="170ef-339">For more information about customizing Fiddler scripts, see [Modifying a Request or Response](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) in hello Fiddler documentation.</span></span>

<span data-ttu-id="170ef-340">Hello eşikleri, uygulama yalnızca tooread modu yapılandırılabilir geçiş yaptıysanız, üretim dışı işlem birimleri ile daha kolay tootest hello davranış olacaktır.</span><span class="sxs-lookup"><span data-stu-id="170ef-340">If you have made hello thresholds for switching your application tooread-only mode configurable, it will be easier tootest hello behavior with non-production transaction volumes.</span></span>

## <a name="next-steps"></a><span data-ttu-id="170ef-341">Sonraki Adımlar</span><span class="sxs-lookup"><span data-stu-id="170ef-341">Next Steps</span></span>

* <span data-ttu-id="170ef-342">Merhaba LastSyncTime nasıl ayarlanır, başka bir örnek de dahil olmak üzere ilgili okuma erişimi coğrafi Yedeklilik daha fazla bilgi için lütfen bkz [Windows Azure Depolama artıklık seçenekleri ve okuma erişimli coğrafi olarak yedekli depolama](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span><span class="sxs-lookup"><span data-stu-id="170ef-342">For more information about Read Access Geo-Redundancy, including another example of how hello LastSyncTime is set, please see [Windows Azure Storage Redundancy Options and Read Access Geo Redundant Storage](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span></span>

* <span data-ttu-id="170ef-343">Lütfen nasıl toomake hello geri ve İleri hello birincil ve ikincil uç noktaları arasında geçiş gösteren tam bir örnek için bkz: [Azure kullanan örnekler – hello devre kesici düzeni RA-GRS depolama ile](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span><span class="sxs-lookup"><span data-stu-id="170ef-343">For a complete sample showing how toomake hello switch back and forth between hello Primary and Secondary endpoints, please see [Azure Samples – Using hello Circuit Breaker Pattern with RA-GRS storage](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span></span>
