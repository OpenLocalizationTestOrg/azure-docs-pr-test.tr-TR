---
title: "Azure Otomasyonu grafik runbook’larında hata işleme | Microsoft Belgeleri"
description: "Bu makalede, Azure Otomasyonu grafik runbook’larında hata işleme mantığının nasıl uygulanacağı açıklanmıştır."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 12/26/2016
ms.author: magoedte
ms.openlocfilehash: 12313f7f245d32c33882f1036f7d4b48bfb3ddc5
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="error-handling-in-azure-automation-graphical-runbooks"></a><span data-ttu-id="d3375-103">Azure Otomasyonu grafik runbook’larında hata işleme</span><span class="sxs-lookup"><span data-stu-id="d3375-103">Error handling in Azure Automation graphical runbooks</span></span>

<span data-ttu-id="d3375-104">Bir runbook’un karşılaşabileceği farklı sorunların tanımlanması, göz önünde bulundurulması gereken temel bir runbook tasarım ilkesidir.</span><span class="sxs-lookup"><span data-stu-id="d3375-104">A key runbook design principal to consider is identifying different issues that a runbook might experience.</span></span> <span data-ttu-id="d3375-105">Bu sorunlar arasında başarı, beklenen hata durumları ve beklenmeyen hata koşulları sayılabilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-105">These issues can include success, expected error states, and unexpected error conditions.</span></span>

<span data-ttu-id="d3375-106">Runbook’lar hata işleme özelliğini içermelidir.</span><span class="sxs-lookup"><span data-stu-id="d3375-106">Runbooks should include error handling.</span></span> <span data-ttu-id="d3375-107">Grafiksel runbook’lar ile ilgili bir etkinliğin çıktısını doğrulamak veya hatayı işlemek için bir Windows PowerShell kod etkinliği kullanabilir, etkinliğin çıktı bağlantısında koşullu mantığı tanımlayabilir veya başka bir yöntem uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d3375-107">To validate the output of an activity or handle an error with graphical runbooks, you could use a Windows PowerShell code activity, define conditional logic on the output link of the activity, or apply another method.</span></span>          

<span data-ttu-id="d3375-108">Genellikle, bir runbook etkinliğiyle ilgili sonlandırıcı olmayan bir hata oluşursa, sonrasındaki herhangi bir etkinlik hataya bakılmaksızın işlenir.</span><span class="sxs-lookup"><span data-stu-id="d3375-108">Often, if there is a non-terminating error that occurs with a runbook activity, any activity that follows is processed regardless of the error.</span></span> <span data-ttu-id="d3375-109">Hata büyük olasılıkla bir özel durum oluşturur, ancak sonraki etkinliğin çalışmasına yine de izin verilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-109">The error is likely to generate an exception, but the next activity is still allowed to run.</span></span> <span data-ttu-id="d3375-110">PowerShell, hataları işlemek için bu şekilde tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="d3375-110">This is the way that PowerShell is designed to handle errors.</span></span>    

<span data-ttu-id="d3375-111">Yürütme sırasında oluşabilecek PowerShell hataları sonlandıran ve sonlandırmayan hatalar şeklinde iki türe ayrılır.</span><span class="sxs-lookup"><span data-stu-id="d3375-111">The types of PowerShell errors that can occur during execution are terminating or non-terminating.</span></span> <span data-ttu-id="d3375-112">Sonlandıran ve sonlandırıcı olmayan hatalar arasındaki farklar aşağıdaki gibidir:</span><span class="sxs-lookup"><span data-stu-id="d3375-112">The differences between terminating and non-terminating errors are as follows:</span></span>

* <span data-ttu-id="d3375-113">**Sonlandıran hata**: Yürütme sırasında gerçekleşen ve komutu (veya betiğin yürütülmesini) tamamen durduran ciddi bir hata.</span><span class="sxs-lookup"><span data-stu-id="d3375-113">**Terminating error**: A serious error during execution that halts the command (or script execution) completely.</span></span> <span data-ttu-id="d3375-114">Örnek olarak mevcut olmayan cmdlet’ler, bir cmdlet’in çalışmasını önleyecek söz dizimi hataları veya diğer önemli hatalar verilebilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-114">Examples include non-existent cmdlets, syntax errors that prevent a cmdlet from running, or other fatal errors.</span></span>

* <span data-ttu-id="d3375-115">**Sonlandırıcı olmayan hata**: Hataya rağmen yürütme işleminin devam etmesini engellenmeyen ve ciddi olmayan bir hata.</span><span class="sxs-lookup"><span data-stu-id="d3375-115">**Non-terminating error**: A non-serious error that allows execution to continue despite the failure.</span></span> <span data-ttu-id="d3375-116">Örnek olarak bir dosyanın bulunamaması, hatalar ve izin sorunları yaşanması gibi işlemsel hatalar verilebilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-116">Examples include operational errors such as file not found errors and permissions problems.</span></span>

<span data-ttu-id="d3375-117">Azure Otomasyonu grafiksel runbook’ları, hata işleme özelliğiyle geliştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="d3375-117">Azure Automation graphical runbooks have been improved with the capability to include error handling.</span></span> <span data-ttu-id="d3375-118">Bundan böyle özel durumları sonlandırıcı olmayan hatalara dönüştürebilir ve etkinlikler arasında hata bağlantıları oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d3375-118">You can now turn exceptions into non-terminating errors and create error links between activities.</span></span> <span data-ttu-id="d3375-119">Bu işlem bir runbook yazarının hataları yakalamasına ve gerçekleşen ya da beklenmeyen koşulları yönetmesine olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="d3375-119">This process allows a runbook author to catch errors and manage realized or unexpected conditions.</span></span>  

## <a name="when-to-use-error-handling"></a><span data-ttu-id="d3375-120">Hata işleme ne zaman kullanılır</span><span class="sxs-lookup"><span data-stu-id="d3375-120">When to use error handling</span></span>

<span data-ttu-id="d3375-121">Hata veya özel durum oluşturan kritik bir etkinlik olduğunda runbook’unuzdaki bir sonraki etkinliğin işlenmesini önlemek ve hatayı uygun bir şekilde işlemek önemlidir.</span><span class="sxs-lookup"><span data-stu-id="d3375-121">Whenever there is a critical activity that throws an error or exception, it's important to prevent the next activity in your runbook from processing and to handle the error appropriately.</span></span> <span data-ttu-id="d3375-122">Bu, özellikle de runbook’larınızın bir işletmeyi ya da hizmet işlemleri sürecini desteklediği durumlarda gereklidir.</span><span class="sxs-lookup"><span data-stu-id="d3375-122">This is especially critical when your runbooks are supporting a business or service operations process.</span></span>

<span data-ttu-id="d3375-123">Runbook yazarı, bir hata oluşturabilecek her bir etkinlik için başka herhangi bir etkinliği işaret eden bir hata bağlantısı ekleyebilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-123">For each activity that can produce an error, the runbook author can add an error link pointing to any other activity.</span></span>  <span data-ttu-id="d3375-124">Hedef etkinlik kod etkinliği, bir cmdlet’in çağrılması, başka bir runbook’un çağrılması gibi herhangi bir türde olabilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-124">The destination activity can be of any type, including code activities, invoking a cmdlet, invoking another runbook, and so on.</span></span>

<span data-ttu-id="d3375-125">Ayrıca, hedef etkinliğin giden bağlantıları da olabilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-125">In addition, the destination activity can also have outgoing links.</span></span> <span data-ttu-id="d3375-126">Bu bağlantılar normal bağlantılar veya hata bağlantıları olabilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-126">These links can be regular links or error links.</span></span> <span data-ttu-id="d3375-127">Başka bir deyişle, runbook yazarı bir kod etkinliğine başvurmadan karmaşık hata işleme mantığı uygulayabilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-127">This means the runbook author can implement complex error-handling logic without resorting to a code activity.</span></span> <span data-ttu-id="d3375-128">Ortak işlevselliğe sahip bir özel hata işleme runbook’u oluşturulması önerilir, ancak zorunlu değildir.</span><span class="sxs-lookup"><span data-stu-id="d3375-128">The recommended practice is to create a dedicated error-handling runbook with common functionality, but it's not mandatory.</span></span> <span data-ttu-id="d3375-129">Bir PowerShell kod etkinliğinde hata işleme mantığı tek seçenek değildir.</span><span class="sxs-lookup"><span data-stu-id="d3375-129">Error-handling logic in a PowerShell code activity it isn't the only option.</span></span>  

<span data-ttu-id="d3375-130">Örneğin, VM başlatmayı ve üzerine uygulama yüklemeyi deneyen bir runbook düşünün.</span><span class="sxs-lookup"><span data-stu-id="d3375-130">For example, consider a runbook that tries to start a VM and install an application on it.</span></span> <span data-ttu-id="d3375-131">VM doğru başlatılmazsa iki eylem gerçekleştirir:</span><span class="sxs-lookup"><span data-stu-id="d3375-131">If the VM doesn't start correctly, it performs two actions:</span></span>

1. <span data-ttu-id="d3375-132">Bu sorun hakkında bir bildirim gönderir.</span><span class="sxs-lookup"><span data-stu-id="d3375-132">It sends a notification about this problem.</span></span>
2. <span data-ttu-id="d3375-133">Bunun yerine otomatik olarak yeni bir VM sağlayan başka bir runbook başlatır.</span><span class="sxs-lookup"><span data-stu-id="d3375-133">It starts another runbook that automatically provisions a new VM instead.</span></span>

<span data-ttu-id="d3375-134">Bir çözümü ise birinci adımı işleyen etkinliği işaret eden bir hata bağlantısı oluşturulmasıdır.</span><span class="sxs-lookup"><span data-stu-id="d3375-134">One solution is to have an error link pointing to an activity that handles step one.</span></span> <span data-ttu-id="d3375-135">Örneğin, **Write-Warning** cmdlet’ini ikinci adımın **Start-AzureRmAutomationRunbook** cmdlet’i gibi bir etkinliğine bağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d3375-135">For example, you could connect the **Write-Warning** cmdlet to an activity for step two, such as the **Start-AzureRmAutomationRunbook** cmdlet.</span></span>

<span data-ttu-id="d3375-136">Ayrıca, bu iki etkinliği farklı bir hata işleme runbook’una ekleyerek ve daha önce önerilen kılavuzu izleyerek bu davranışı çok sayıda runbook’ta kullanılmak üzere genelleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d3375-136">You could also generalize this behavior for use in many runbooks by putting these two activities in a separate error handling runbook and following the guidance suggested earlier.</span></span> <span data-ttu-id="d3375-137">Bu hata işleme runbook’una bir çağrı yapmadan önce özgün runbook’taki verilerden özel bir ileti oluşturabilir ve bu iletiyi bir parametre olarak hata işleme runbook’una geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d3375-137">Before calling this error-handling runbook, you could construct a custom message from the data in the original runbook, and then pass it as a parameter to the error-handling runbook.</span></span>

## <a name="how-to-use-error-handling"></a><span data-ttu-id="d3375-138">Hata işleme nasıl kullanılır</span><span class="sxs-lookup"><span data-stu-id="d3375-138">How to use error handling</span></span>

<span data-ttu-id="d3375-139">Her etkinliğin özel durumları sonlandırıcı olmayan hatalara dönüştürmeye yönelik bir yapılandırma ayarı vardır.</span><span class="sxs-lookup"><span data-stu-id="d3375-139">Each activity has a configuration setting that turns exceptions into non-terminating errors.</span></span> <span data-ttu-id="d3375-140">Bu ayar varsayılan olarak devre dışıdır.</span><span class="sxs-lookup"><span data-stu-id="d3375-140">By default, this setting is disabled.</span></span> <span data-ttu-id="d3375-141">Hataları işlemek istediğiniz tüm etkinliklerde bu ayarı etkinleştirmeniz önerilir.</span><span class="sxs-lookup"><span data-stu-id="d3375-141">We recommend that you enable this setting on any activity where you want to handle errors.</span></span>  

<span data-ttu-id="d3375-142">Bu yapılandırmayı etkinleştirerek hem sonlandıran hem de sonlandırıcı olmayan etkinlik hatalarının sonlandırıcı olmayan hatalar olarak işlenmesini ve bir hata bağlantısıyla işlenebilmesini mümkün kılarsınız.</span><span class="sxs-lookup"><span data-stu-id="d3375-142">By enabling this configuration, you are assuring that both terminating and non-terminating errors in the activity are handled as non-terminating errors, and can be handled with an error link.</span></span>  

<span data-ttu-id="d3375-143">Bu ayarı yapılandırdıktan sonra hatayı işleyen bir etkinlik oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="d3375-143">After configuring this setting, you create an activity that handles the error.</span></span> <span data-ttu-id="d3375-144">Bir etkinlik tarafından herhangi bir hata oluşturulursa giden hata bağlantıları izlenir ve etkinlik ek olarak normal bir çıkış oluşturmuş olsa bile normal bağlantılar izlenmez.</span><span class="sxs-lookup"><span data-stu-id="d3375-144">If an activity produces any error, then the outgoing error links are followed, and the regular links are not, even if the activity produces regular output as well.</span></span><br><br> ![Otomasyon runbook’u hata bağlantısı örneği](media/automation-runbook-graphical-error-handling/error-link-example.png)

<span data-ttu-id="d3375-146">Aşağıdaki örnekte runbook, bir sanal makinenin bilgisayar adını içeren bir değişken alır.</span><span class="sxs-lookup"><span data-stu-id="d3375-146">In the following example, a runbook retrieves a variable that contains the computer name of a virtual machine.</span></span> <span data-ttu-id="d3375-147">Ardından, sanal makineyi sonraki etkinlikle başlatmayı dener.</span><span class="sxs-lookup"><span data-stu-id="d3375-147">It then attempts to start the virtual machine with the next activity.</span></span><br><br> ![Otomasyon runbook’u hata işleme örneği](media/automation-runbook-graphical-error-handling/runbook-example-error-handling.png)<br><br>      

<span data-ttu-id="d3375-149">**Get-AutomationVariable** etkinliği ve **Start-AzureRmVm**, özel durumları hatalara dönüştürecek şekilde yapılandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="d3375-149">The **Get-AutomationVariable** activity and **Start-AzureRmVm** are configured to convert exceptions to errors.</span></span>  <span data-ttu-id="d3375-150">Değişkeni alma veya VM’yi başlatma ile ilgili sorunlarla karşılaşılırsa hata oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="d3375-150">If there are problems getting the variable or starting the VM, then errors are generated.</span></span><br><br> <span data-ttu-id="d3375-151">![Otomasyon runbook’u hata işleme etkinlik ayarları](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span><span class="sxs-lookup"><span data-stu-id="d3375-151">![Automation runbook error-handling activity settings](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span></span>

<span data-ttu-id="d3375-152">Hata bağlantıları bu etkinliklerden tek bir **hata yönetimi** etkinliğine (kod etkinliği) geçer.</span><span class="sxs-lookup"><span data-stu-id="d3375-152">Error links flow from these activities to a single **error management** activity (a code activity).</span></span> <span data-ttu-id="d3375-153">Bu etkinlik, geçerli özel durumu açıklayan *$Error.Exception.Message* ile birlikte *Throw* anahtar sözcüğünü kullanan bir PowerShell ifadesiyle birlikte yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="d3375-153">This activity is configured with a simple PowerShell expression that uses the *Throw* keyword to stop processing, along with *$Error.Exception.Message* to get the message that describes the current exception.</span></span><br><br> <span data-ttu-id="d3375-154">![Otomasyon runbook’u hata işleme kod örneği](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span><span class="sxs-lookup"><span data-stu-id="d3375-154">![Automation runbook error-handling code example](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span></span>


## <a name="next-steps"></a><span data-ttu-id="d3375-155">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="d3375-155">Next steps</span></span>

* <span data-ttu-id="d3375-156">Bağlantılar ve grafik runbook’larındaki bağlantı türleri hakkında daha fazla bilgi edinmek için bkz. [Azure Otomasyonu’nda grafik yazma](automation-graphical-authoring-intro.md#links-and-workflow).</span><span class="sxs-lookup"><span data-stu-id="d3375-156">To learn more about links and link types in graphical runbooks, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span></span>

* <span data-ttu-id="d3375-157">Runbook yürütme, runbook işlerini izleme ve diğer teknik ayrıntılar hakkında daha fazla bilgi edinmek için bkz. [Runbook işi izleme](automation-runbook-execution.md).</span><span class="sxs-lookup"><span data-stu-id="d3375-157">To learn more about runbook execution, how to monitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span></span>
