---
title: "aaaAdd özel Service Fabric sistem durumu raporlarının | Microsoft Docs"
description: "Nasıl tooAzure Service Fabric sistem durumu varlıkları toosend özel durumu raporları açıklar. Tasarlama ve kalite sistem durumu raporlarının uygulamak için öneriler sağlar."
services: service-fabric
documentationcenter: .net
author: oanapl
manager: timlt
editor: 
ms.assetid: 0a00a7d2-510e-47d0-8aa8-24c851ea847f
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/19/2017
ms.author: oanapl
ms.openlocfilehash: 12c9f664e2a457b4e1e8f340873ca60ebcefb097
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="add-custom-service-fabric-health-reports"></a><span data-ttu-id="4a4ca-104">Özel Service Fabric durum raporları ekleme</span><span class="sxs-lookup"><span data-stu-id="4a4ca-104">Add custom Service Fabric health reports</span></span>
<span data-ttu-id="4a4ca-105">Azure Service Fabric tanıtır bir [sistem durumu modeli](service-fabric-health-introduction.md) tasarlanmış tooflag sağlıksız küme ve uygulama koşullara belirli varlıklar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-105">Azure Service Fabric introduces a [health model](service-fabric-health-introduction.md) designed tooflag unhealthy cluster and application conditions on specific entities.</span></span> <span data-ttu-id="4a4ca-106">Merhaba sistem durumu modeli kullanan **sistem durumu reporters** (sistem bileşenleri ve watchdogs).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-106">hello health model uses **health reporters** (system components and watchdogs).</span></span> <span data-ttu-id="4a4ca-107">Merhaba kolay ve hızlı tanı ve onarım hedeftir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-107">hello goal is easy and fast diagnosis and repair.</span></span> <span data-ttu-id="4a4ca-108">Sistem durumu hakkında önceden toothink beklemeleri gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-108">Service writers need toothink upfront about health.</span></span> <span data-ttu-id="4a4ca-109">Özellikle, toohello kök kapatmak bayrağı sorunları yardımcı olur, sistem durumu etkileyebilir herhangi bir koşul, bildirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-109">Any condition that can impact health should be reported on, especially if it can help flag problems close toohello root.</span></span> <span data-ttu-id="4a4ca-110">Merhaba sistem durumu bilgileri, hata ayıklama ve araştırma zaman ve çaba kaydedebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-110">hello health information can save time and effort on debugging and investigation.</span></span> <span data-ttu-id="4a4ca-111">Merhaba hizmet hello bulutta ölçekte da çalışır durumda bir kez hello yararlılığını özellikle Temizle (özel veya Azure).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-111">hello usefulness is especially clear once hello service is up and running at scale in hello cloud (private or Azure).</span></span>

<span data-ttu-id="4a4ca-112">Merhaba Service Fabric reporters İzleyici faiz koşullarını tanımlanmış.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-112">hello Service Fabric reporters monitor identified conditions of interest.</span></span> <span data-ttu-id="4a4ca-113">Kendi yerel bir görünümü temel alarak bu koşullara bildirin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-113">They report on those conditions based on their local view.</span></span> <span data-ttu-id="4a4ca-114">Merhaba [sistem durumu deposu](service-fabric-health-introduction.md#health-store) varlıklar genel sağlıklı olup tüm reporters toodetermine tarafından gönderilen sistem durumu verileri toplar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-114">hello [health store](service-fabric-health-introduction.md#health-store) aggregates health data sent by all reporters toodetermine whether entities are globally healthy.</span></span> <span data-ttu-id="4a4ca-115">Merhaba, hedeflenen toobe zengin, esnek ve kolay toouse modelidir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-115">hello model is intended toobe rich, flexible, and easy toouse.</span></span> <span data-ttu-id="4a4ca-116">Merhaba sistem durumu raporlarının Hello kalitesini hello küme hello sistem durumu görünümünü hello doğruluğunu belirler.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-116">hello quality of hello health reports determines hello accuracy of hello health view of hello cluster.</span></span> <span data-ttu-id="4a4ca-117">Yanlış sağlıksız sorunları göstermek hatalı pozitif sonuç, yükseltme veya sistem durumu verileri kullanan diğer hizmetler olumsuz yönde etkileyebilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-117">False positives that wrongly show unhealthy issues can negatively impact upgrades or other services that use health data.</span></span> <span data-ttu-id="4a4ca-118">Bu tür hizmetlerin onarım hizmetleri ve uyarı mekanizmaları gösterilebilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-118">Examples of such services are repair services and alerting mechanisms.</span></span> <span data-ttu-id="4a4ca-119">Bu nedenle, bazı düşünce hello ilgi koşullarını yakalama gerekli tooprovide raporları olan en iyi olası yol.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-119">Therefore, some thought is needed tooprovide reports that capture conditions of interest in hello best possible way.</span></span>

<span data-ttu-id="4a4ca-120">toodesign ve uygulama sistem durumu raporlaması, watchdogs ve sistem bileşenleri gerekir:</span><span class="sxs-lookup"><span data-stu-id="4a4ca-120">toodesign and implement health reporting, watchdogs and system components must:</span></span>

* <span data-ttu-id="4a4ca-121">İlginizi hello koşulu tanımlamak, izlenip hello yolu ve hello hello küme veya uygulamanın işlevselliğini etkileyebilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-121">Define hello condition they are interested in, hello way it is monitored, and hello impact on hello cluster or application functionality.</span></span> <span data-ttu-id="4a4ca-122">Bu bilgilere dayanarak hello rapor özelliği ve sistem durumu hakkında karar verin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-122">Based on this information, decide on hello health report property and health state.</span></span>
* <span data-ttu-id="4a4ca-123">Merhaba belirlemek [varlık](service-fabric-health-introduction.md#health-entities-and-hierarchy) hello rapor için geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-123">Determine hello [entity](service-fabric-health-introduction.md#health-entities-and-hierarchy) that hello report applies to.</span></span>
* <span data-ttu-id="4a4ca-124">Merhaba raporlama burada yapılır belirlemek için hizmet veya bir iç veya dış izleme içinden hello.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-124">Determine where hello reporting is done, from within hello service or from an internal or external watchdog.</span></span>
* <span data-ttu-id="4a4ca-125">Bir kaynak kullanılan tooidentify hello Raporlayıcı tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-125">Define a source used tooidentify hello reporter.</span></span>
* <span data-ttu-id="4a4ca-126">Bir raporlama stratejisi geçişleri veya düzenli aralıklarla seçin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-126">Choose a reporting strategy, either periodically or on transitions.</span></span> <span data-ttu-id="4a4ca-127">Merhaba daha basit kod gerektirir ve potansiyeli daha az tooerrors şekilde, düzenli aralıklarla önerilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-127">hello recommended way is periodically, as it requires simpler code and is less prone tooerrors.</span></span>
* <span data-ttu-id="4a4ca-128">Ne kadar süreyle hello rapor sağlıksız koşullar hello health store içinde kalmalı ve onu temizlenmelidir nasıl belirler.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-128">Determine how long hello report for unhealthy conditions should stay in hello health store and how it should be cleared.</span></span> <span data-ttu-id="4a4ca-129">Bu bilgileri kullanarak hello raporun süresi toolive ve kaldırma üzerinde süre sonu davranışını karar verin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-129">Using this information, decide hello report's time toolive and remove-on-expiration behavior.</span></span>

<span data-ttu-id="4a4ca-130">Belirtildiği gibi raporlama den yapılabilir:</span><span class="sxs-lookup"><span data-stu-id="4a4ca-130">As mentioned, reporting can be done from:</span></span>

* <span data-ttu-id="4a4ca-131">Merhaba Service Fabric hizmeti çoğaltma izlenen.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-131">hello monitored Service Fabric service replica.</span></span>
* <span data-ttu-id="4a4ca-132">İç watchdogs Service Fabric hizmeti (koşullar izler ve raporları sorunları Örneğin, bir Service Fabric durum bilgisiz hizmet) dağıtılmış.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-132">Internal watchdogs deployed as a Service Fabric service (for example, a Service Fabric stateless service that monitors conditions and issues reports).</span></span> <span data-ttu-id="4a4ca-133">Merhaba watchdogs olabilir tüm düğümlere dağıtılan veya izlenen Benzetilen toohello hizmet olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-133">hello watchdogs can be deployed an all nodes or can be affinitized toohello monitored service.</span></span>
* <span data-ttu-id="4a4ca-134">Merhaba Service Fabric düğümlerinde çalıştırın, ancak olan iç watchdogs *değil* Service Fabric Hizmetleri olarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-134">Internal watchdogs that run on hello Service Fabric nodes but are *not* implemented as Service Fabric services.</span></span>
* <span data-ttu-id="4a4ca-135">Bu araştırma hello kaynaktan dış watchdogs *dışında* hello Service Fabric kümesi (örneğin, izleme hizmeti Gomez gibi).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-135">External watchdogs that probe hello resource from *outside* hello Service Fabric cluster (for example, monitoring service like Gomez).</span></span>

> [!NOTE]
> <span data-ttu-id="4a4ca-136">Merhaba kutudan çıktığında, hello küme hello sistem bileşenleri tarafından gönderilen durum raporları ile doldurulur.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-136">Out of hello box, hello cluster is populated with health reports sent by hello system components.</span></span> <span data-ttu-id="4a4ca-137">Ayrıntılı bilgi için [kullanarak sistem durumu raporları sorun giderme için](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-137">Read more at [Using system health reports for troubleshooting](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span></span> <span data-ttu-id="4a4ca-138">Merhaba kullanıcı raporları gönderilmelidir [durumu varlıklarını](service-fabric-health-introduction.md#health-entities-and-hierarchy) , önceden oluşturulmuş hello sistem tarafından.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-138">hello user reports must be sent on [health entities](service-fabric-health-introduction.md#health-entities-and-hierarchy) that have already been created by hello system.</span></span>
> 
> 

<span data-ttu-id="4a4ca-139">Bir kez hello sistem durumu raporlama tasarım sistem durumu raporları kolayca gönderilebilir, işaretlenmemiştir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-139">Once hello health reporting design is clear, health reports can be sent easily.</span></span> <span data-ttu-id="4a4ca-140">Kullanabileceğiniz [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) hello küme değilse tooreport durumu [güvenli](service-fabric-cluster-security.md) veya hello doku istemci yönetim ayrıcalıkları varsa.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-140">You can use [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport health if hello cluster is not [secure](service-fabric-cluster-security.md) or if hello fabric client has admin privileges.</span></span> <span data-ttu-id="4a4ca-141">Raporlama yapılabilir hello API tarafından aracılığıyla kullanarak [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), PowerShell veya REST aracılığıyla.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-141">Reporting can be done through hello API by using [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), through PowerShell, or through REST.</span></span> <span data-ttu-id="4a4ca-142">Yapılandırma düğmelerini performansı için raporları toplu.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-142">Configuration knobs batch reports for improved performance.</span></span>

> [!NOTE]
> <span data-ttu-id="4a4ca-143">Rapor durumu zaman uyumlu ve yalnızca hello doğrulama iş hello istemci tarafında temsil eder.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-143">Report health is synchronous, and it represents only hello validation work on hello client side.</span></span> <span data-ttu-id="4a4ca-144">Merhaba rapor hello olgu hello sistem istemci veya hello tarafından kabul edilen `Partition` veya `CodePackageActivationContext` nesneleri değil anlamına hello deposunda uygulanır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-144">hello fact that hello report is accepted by hello health client or hello `Partition` or `CodePackageActivationContext` objects doesn't mean that it is applied in hello store.</span></span> <span data-ttu-id="4a4ca-145">Zaman uyumsuz olarak gönderilir ve büyük olasılıkla diğer raporlarla toplu.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-145">It is sent asynchronously and possibly batched with other reports.</span></span> <span data-ttu-id="4a4ca-146">Merhaba sunucuda işleme hello yine başarısız olabilir: hello sıra numarası eski olabilir, hangi hello üzerinde rapor uygulanmalıdır hello varlık silindi, vb..</span><span class="sxs-lookup"><span data-stu-id="4a4ca-146">hello processing on hello server may still fail: hello sequence number could be stale, hello entity on which hello report must be applied has been deleted, etc.</span></span>
> 
> 

## <a name="health-client"></a><span data-ttu-id="4a4ca-147">İstemci sistem durumu</span><span class="sxs-lookup"><span data-stu-id="4a4ca-147">Health client</span></span>
<span data-ttu-id="4a4ca-148">Merhaba sistem durumu raporlarının toohello sistem durumu deposu hello doku istemci içinde bulunduğu bir sistem durumu istemcisi aracılığıyla gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-148">hello health reports are sent toohello health store through a health client, which lives inside hello fabric client.</span></span> <span data-ttu-id="4a4ca-149">Merhaba sistem istemci ayarları aşağıdaki hello ile yapılandırılabilir:</span><span class="sxs-lookup"><span data-stu-id="4a4ca-149">hello health client can be configured with hello following settings:</span></span>

* <span data-ttu-id="4a4ca-150">**HealthReportSendInterval**: hello süresi hello raporu arasında hello gecikme, eklenen toohello istemci ve hello süre toohello sistem durumu deposu gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-150">**HealthReportSendInterval**: hello delay between hello time hello report is added toohello client and hello time it is sent toohello health store.</span></span> <span data-ttu-id="4a4ca-151">Her rapor için gönderen bir ileti yerine tek bir ileti kullanılan toobatch raporlar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-151">Used toobatch reports into a single message, rather than sending one message for each report.</span></span> <span data-ttu-id="4a4ca-152">Merhaba toplu performansı artırır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-152">hello batching improves performance.</span></span> <span data-ttu-id="4a4ca-153">Varsayılan: 30 saniyedir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-153">Default: 30 seconds.</span></span>
* <span data-ttu-id="4a4ca-154">**HealthReportRetrySendInterval**: hello aralığı sırasında hangi hello sistem istemci yeniden gönderir birikmiş sistem durumu raporları toohello sistem durumu deposu.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-154">**HealthReportRetrySendInterval**: hello interval at which hello health client resends accumulated health reports toohello health store.</span></span> <span data-ttu-id="4a4ca-155">Varsayılan: 30 saniyedir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-155">Default: 30 seconds.</span></span>
* <span data-ttu-id="4a4ca-156">**HealthOperationTimeout**: hello zaman aşımı süresi bir rapor iletisi için gönderilen toohello sistem durumu deposu.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-156">**HealthOperationTimeout**: hello timeout period for a report message sent toohello health store.</span></span> <span data-ttu-id="4a4ca-157">Bir ileti zaman aşımına uğrarsa, hello rapor işlenmiş hello sistem durumu deposu onaylayıncaya kadar hello sistem istemci bunu yeniden dener.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-157">If a message times out, hello health client retries it until hello health store confirms that hello report has been processed.</span></span> <span data-ttu-id="4a4ca-158">Varsayılan: iki dakika.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-158">Default: two minutes.</span></span>

> [!NOTE]
> <span data-ttu-id="4a4ca-159">Merhaba raporları toplu hale zaman hello doku istemci için Canlı tutulması gereken en az, gönderilmeden HealthReportSendInterval tooensure hello.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-159">When hello reports are batched, hello fabric client must be kept alive for at least hello HealthReportSendInterval tooensure that they are sent.</span></span> <span data-ttu-id="4a4ca-160">Canlı uzun toogive hello doku istemci selamlama iletisine kaybolur veya hello sistem durumu deposu olamaz uygularsanız bunları tootransient hatalar tutulmalıdır onu fırsat tooretry.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-160">If hello message is lost or hello health store cannot apply them due tootransient errors, hello fabric client must be kept alive longer toogive it a chance tooretry.</span></span>
> 
> 

<span data-ttu-id="4a4ca-161">Merhaba hello istemcide arabelleğe alma hello raporları hello benzersizliğini dikkate alır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-161">hello buffering on hello client takes hello uniqueness of hello reports into consideration.</span></span> <span data-ttu-id="4a4ca-162">Belirli bir hatalı Raporlayıcı 100 raporlama, örneğin, saniyede hello üzerinde aynı rapor hello özelliği aynı varlık, hello raporları hello son sürümü ile değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-162">For example, if a particular bad reporter is reporting 100 reports per second on hello same property of hello same entity, hello reports are replaced with hello last version.</span></span> <span data-ttu-id="4a4ca-163">En çok bir tür rapor hello istemci sırada yok.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-163">At most one such report exists in hello client queue.</span></span> <span data-ttu-id="4a4ca-164">Toplu işleme yapılandırılmışsa, rapor hello sayısı toohello sistem durumu deposu gönderme aralığı başına yalnızca bir tanesini gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-164">If batching is configured, hello number of reports sent toohello health store is just one per send interval.</span></span> <span data-ttu-id="4a4ca-165">Bu rapor hello en güncel duruma hello varlığın yansıtan hello son eklenen raporudur.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-165">This report is hello last added report, which reflects hello most current state of hello entity.</span></span>
<span data-ttu-id="4a4ca-166">Yapılandırma parametrelerini belirtin, `FabricClient` geçirerek oluşturulan [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) ile Merhaba istenen değerlerini sistem durumu ile ilgili girdileri.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-166">Specify configuration parameters when `FabricClient` is created by passing [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) with hello desired values for health-related entries.</span></span>

<span data-ttu-id="4a4ca-167">Merhaba aşağıdaki örnekte bir doku istemci oluşturur ve eklendiklerinde hello raporları gönderilmesi gerektiğini belirtir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-167">hello following example creates a fabric client and specifies that hello reports should be sent when they are added.</span></span> <span data-ttu-id="4a4ca-168">Zaman aşımları ve yeniden denenebilir hata, yeniden deneme 40 saniyede gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-168">On timeouts and errors that can be retried, retries happen every 40 seconds.</span></span>

```csharp
var clientSettings = new FabricClientSettings()
{
    HealthOperationTimeout = TimeSpan.FromSeconds(120),
    HealthReportSendInterval = TimeSpan.FromSeconds(0),
    HealthReportRetrySendInterval = TimeSpan.FromSeconds(40),
};
var fabricClient = new FabricClient(clientSettings);
```

<span data-ttu-id="4a4ca-169">Merhaba varsayılan doku ayarlamak istemci ayarları tutma öneririz `HealthReportSendInterval` too30 saniye.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-169">We recommend keeping hello default fabric client settings, which set `HealthReportSendInterval` too30 seconds.</span></span> <span data-ttu-id="4a4ca-170">Bu ayar en iyi performans sağlar son toobatching.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-170">This setting ensures optimal performance due toobatching.</span></span> <span data-ttu-id="4a4ca-171">Mümkün olan en kısa sürede gönderilmesi gereken kritik raporlar için `HealthReportSendOptions` hemen ile `true` içinde [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-171">For critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true` in [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API.</span></span> <span data-ttu-id="4a4ca-172">Hemen raporları aralığı toplu işleme hello atlama.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-172">Immediate reports bypass hello batching interval.</span></span> <span data-ttu-id="4a4ca-173">Bu bayrak dikkatli kullanın; mümkün olduğunda toplu işleme hello sistem istemci tootake avantajlarından istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-173">Use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span> <span data-ttu-id="4a4ca-174">Hemen gönder yararlıdır da hello doku istemci kapatırken (örneğin, hello işlemi geçersiz durum belirledi ve tooshut tooprevent yan etkileri aşağı gerekir).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-174">Immediate send is also useful when hello fabric client is closing (for example, hello process has determined invalid state and needs tooshut down tooprevent side effects).</span></span> <span data-ttu-id="4a4ca-175">En yüksek çaba gönderme birikmiş hello raporlar sağlar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-175">It ensures a best-effort send of hello accumulated reports.</span></span> <span data-ttu-id="4a4ca-176">Bir rapor anlık bayrağı ile eklendiğinde, hello sistem istemci tüm toplanan hello raporları itibaren son gönderme toplu işlemleri.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-176">When one report is added with Immediate flag, hello health client batches all hello accumulated reports since last send.</span></span>

<span data-ttu-id="4a4ca-177">PowerShell aracılığıyla bağlantı tooa küme oluşturulduğunda, aynı parametreleri belirtilebilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-177">Same parameters can be specified when a connection tooa cluster is created through PowerShell.</span></span> <span data-ttu-id="4a4ca-178">Aşağıdaki örnek hello bağlantı tooa yerel küme başlar:</span><span class="sxs-lookup"><span data-stu-id="4a4ca-178">hello following example starts a connection tooa local cluster:</span></span>

```powershell
PS C:\> Connect-ServiceFabricCluster -HealthOperationTimeoutInSec 120 -HealthReportSendIntervalInSec 0 -HealthReportRetrySendIntervalInSec 40
True

ConnectionEndpoint   :
FabricClientSettings : {
                       ClientFriendlyName                   : PowerShell-1944858a-4c6d-465f-89c7-9021c12ac0bb
                       PartitionLocationCacheLimit          : 100000
                       PartitionLocationCacheBucketCount    : 1024
                       ServiceChangePollInterval            : 00:02:00
                       ConnectionInitializationTimeout      : 00:00:02
                       KeepAliveInterval                    : 00:00:20
                       HealthOperationTimeout               : 00:02:00
                       HealthReportSendInterval             : 00:00:00
                       HealthReportRetrySendInterval        : 00:00:40
                       NotificationGatewayConnectionTimeout : 00:00:00
                       NotificationCacheUpdateTimeout       : 00:00:00
                       }
GatewayInformation   : {
                       NodeAddress                          : localhost:19000
                       NodeId                               : 1880ec88a3187766a6da323399721f53
                       NodeInstanceId                       : 130729063464981219
                       NodeName                             : Node.1
                       }
```

<span data-ttu-id="4a4ca-179">Benzer şekilde tooAPI, raporları kullanarak gönderilebilir `-Immediate` hemen hello bağımsız olarak gönderilen toobe geçiş `HealthReportSendInterval` değeri.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-179">Similarly tooAPI, reports can be sent using `-Immediate` switch toobe sent immediately, regardless of hello `HealthReportSendInterval` value.</span></span>

<span data-ttu-id="4a4ca-180">KALAN için bir iç doku istemci toohello Service Fabric gateway hello raporlar gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-180">For REST, hello reports are sent toohello Service Fabric gateway, which has an internal fabric client.</span></span> <span data-ttu-id="4a4ca-181">Varsayılan olarak, bu, her 30 saniyede toplu yapılandırılmış toosend raporları istemcidir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-181">By default, this client is configured toosend reports batched every 30 seconds.</span></span> <span data-ttu-id="4a4ca-182">Merhaba küme yapılandırma ayarı ile Merhaba toplu aralığını değiştirebilirsiniz `HttpGatewayHealthReportSendInterval` üzerinde `HttpGateway`.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-182">You can change hello batch interval with hello cluster configuration setting `HttpGatewayHealthReportSendInterval` on `HttpGateway`.</span></span> <span data-ttu-id="4a4ca-183">Belirtildiği gibi bir toosend hello raporları ile daha iyi seçenektir `Immediate` true.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-183">As mentioned, a better option is toosend hello reports with `Immediate` true.</span></span> 

> [!NOTE]
> <span data-ttu-id="4a4ca-184">Sistem durumu Hizmetleri yetkisiz tooensure rapor veremez hello kümedeki hello varlıklar karşı hello sunucu tooaccept istekleri yalnızca güvenli istemcilerden gelen yapılandırın.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-184">tooensure that unauthorized services can't report health against hello entities in hello cluster, configure hello server tooaccept requests only from secured clients.</span></span> <span data-ttu-id="4a4ca-185">Merhaba `FabricClient` gerekir sahip güvenliği etkinleştirilmiş toobe mümkün toocommunicate hello kümeyle (örneğin, Kerberos veya sertifika kimlik doğrulaması) ile raporlama için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-185">hello `FabricClient` used for reporting must have security enabled toobe able toocommunicate with hello cluster (for example, with Kerberos or certificate authentication).</span></span> <span data-ttu-id="4a4ca-186">Daha fazla bilgi edinin [küme güvenlik](service-fabric-cluster-security.md).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-186">Read more about [cluster security](service-fabric-cluster-security.md).</span></span>
> 
> 

## <a name="report-from-within-low-privilege-services"></a><span data-ttu-id="4a4ca-187">Gelen düşük ayrıcalıklı Hizmetleri içinde rapor</span><span class="sxs-lookup"><span data-stu-id="4a4ca-187">Report from within low privilege services</span></span>
<span data-ttu-id="4a4ca-188">Service Fabric Hizmetleri yönetici erişimi toohello küme yoksa hello geçerli bağlamdan varlıklar üzerinde sistem durumu bildirebilirsiniz `Partition` veya `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-188">If Service Fabric services do not have admin access toohello cluster, you can report health on entities from hello current context through `Partition` or `CodePackageActivationContext`.</span></span>

* <span data-ttu-id="4a4ca-189">Durum bilgisi olmayan hizmetler için kullanmak [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport hello geçerli hizmet örneği üzerinde.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-189">For stateless services, use [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport on hello current service instance.</span></span>
* <span data-ttu-id="4a4ca-190">Durum bilgisi olan hizmetler için kullanmak [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport geçerli çoğaltma.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-190">For stateful services, use [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport on current replica.</span></span>
* <span data-ttu-id="4a4ca-191">Kullanım [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport hello geçerli bölüm varlığı.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-191">Use [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport on hello current partition entity.</span></span>
* <span data-ttu-id="4a4ca-192">Kullanım [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport geçerli uygulama üzerinde.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-192">Use [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport on current application.</span></span>
* <span data-ttu-id="4a4ca-193">Kullanım [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport hello geçerli düğümde dağıtılan hello geçerli uygulama üzerinde.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-193">Use [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport on hello current application deployed on hello current node.</span></span>
* <span data-ttu-id="4a4ca-194">Kullanım [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport hello geçerli düğümde dağıtılan hello uygulaması için bir hizmet paketi üzerinde.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-194">Use [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport on a service package for hello application deployed on hello current node.</span></span>

> [!NOTE]
> <span data-ttu-id="4a4ca-195">Dahili olarak, hello `Partition` ve hello `CodePackageActivationContext` varsayılan ayarlarla yapılandırılan bir sistem durumu istemcisi tutun.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-195">Internally, hello `Partition` and hello `CodePackageActivationContext` hold a health client configured with default settings.</span></span> <span data-ttu-id="4a4ca-196">Merhaba açıklandığı gibi [sistem istemci](service-fabric-report-health.md#health-client), raporları toplu hale ve bir süreölçer gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-196">As explained for hello [health client](service-fabric-report-health.md#health-client), reports are batched and sent on a timer.</span></span> <span data-ttu-id="4a4ca-197">Merhaba nesneleri olmalıdır Canlı toohave bir fırsat toosend hello rapor tutulurlar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-197">hello objects should be kept alive toohave a chance toosend hello report.</span></span>
> 
> 

<span data-ttu-id="4a4ca-198">Belirleyebileceğiniz `HealthReportSendOptions` raporlarda gönderirken `Partition` ve `CodePackageActivationContext` sistem durumu API'leri.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-198">You can specify `HealthReportSendOptions` when sending reports through `Partition` and `CodePackageActivationContext` health APIs.</span></span> <span data-ttu-id="4a4ca-199">Mümkün olan en kısa sürede gönderilmesi gereken kritik raporlarınız varsa, kullanmak `HealthReportSendOptions` hemen ile `true`.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-199">If you have critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true`.</span></span> <span data-ttu-id="4a4ca-200">Hemen raporları hello iç sistem istemci aralığını toplu işleme hello atlama.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-200">Immediate reports bypass hello batching interval of hello internal health client.</span></span> <span data-ttu-id="4a4ca-201">Önceden belirtildiği gibi bu bayrak dikkatli kullanın; mümkün olduğunda toplu işleme hello sistem istemci tootake avantajlarından istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-201">As mentioned before, use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span>

## <a name="design-health-reporting"></a><span data-ttu-id="4a4ca-202">Sistem durumu raporlama tasarlama</span><span class="sxs-lookup"><span data-stu-id="4a4ca-202">Design health reporting</span></span>
<span data-ttu-id="4a4ca-203">Merhaba yüksek kaliteli raporları üretme ilk adımı hello hizmetinin hello durumunun etkileyebilir hello koşulları tanımlamak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-203">hello first step in generating high-quality reports is identifying hello conditions that can impact hello health of hello service.</span></span> <span data-ttu-id="4a4ca-204">Başlatıldığında--veya hatta daha iyi bir sorun gerçekleşmeden önce--olası olabilir, hello hizmet veya küme bayrağı sorunlarını yardımcı olabilecek herhangi bir koşul ABD Doları milyarlarca kaydedin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-204">Any condition that can help flag problems in hello service or cluster when it starts--or even better, before a problem happens--can potentially save billions of dollars.</span></span> <span data-ttu-id="4a4ca-205">Merhaba kesinti daha az yararları, daha az gece saat araştırma ve sorunları ve daha yüksek müşteri memnuniyetini onarma harcanan.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-205">hello benefits include less down time, fewer night hours spent investigating and repairing issues, and higher customer satisfaction.</span></span>

<span data-ttu-id="4a4ca-206">Merhaba koşullar tanımlandıktan sonra izleme yazıcılarının kendileri için ek yükü ve yararlılığını arasında dengeleyin hello en iyi şekilde toomonitor çıkışı toofigure gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-206">Once hello conditions are identified, watchdog writers need toofigure out hello best way toomonitor them for balance between overhead and usefulness.</span></span> <span data-ttu-id="4a4ca-207">Örneğin, bazı geçici dosyaları paylaşımındaki kullanmak karmaşık hesaplamalar yapan bir hizmet göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-207">For example, consider a service that does complex calculations that use some temporary files on a share.</span></span> <span data-ttu-id="4a4ca-208">Bir izleme yeterli alan vardır hello paylaşımı tooensure izleyebilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-208">A watchdog could monitor hello share tooensure that enough space is available.</span></span> <span data-ttu-id="4a4ca-209">Dosya veya dizin değişiklik bildirimleri için dinleme.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-209">It could listen for notifications of file or directory changes.</span></span> <span data-ttu-id="4a4ca-210">Bir ön eşik ulaşıldığında ve hello paylaşımı doluysa bir hata raporu bir uyarı rapor edilemedi.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-210">It could report a warning if an upfront threshold is reached, and report an error if hello share is full.</span></span> <span data-ttu-id="4a4ca-211">Bir uyarı üzerinde bir onarım sistem hello paylaşımındaki eski dosyalar temizleniyor başlayamadı.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-211">On a warning, a repair system could start cleaning up older files on hello share.</span></span> <span data-ttu-id="4a4ca-212">Bir hata üzerinde bir onarım sistem hello hizmet çoğaltma tooanother düğümü taşıyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-212">On an error, a repair system could move hello service replica tooanother node.</span></span> <span data-ttu-id="4a4ca-213">Merhaba koşul durumlarını bakımından sistem durumu nasıl açıklanan unutmayın: Merhaba durumunu hello (Tamam) sağlıklı kabul edilebilir koşul veya sağlıksız (uyarı veya hata).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-213">Note how hello condition states are described in terms of health: hello state of hello condition that can be considered healthy (ok) or unhealthy (warning or error).</span></span>

<span data-ttu-id="4a4ca-214">Merhaba İzleme Ayrıntıları ayarladıktan sonra bir izleme yazıcısı nasıl tooimplement hello İzleme çıkışı toofigure gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-214">Once hello monitoring details are set, a watchdog writer needs toofigure out how tooimplement hello watchdog.</span></span> <span data-ttu-id="4a4ca-215">Merhaba koşullar hello Hizmeti'nde belirlenebilir hello izleme hello izlenen hizmetin kendisini parçası olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-215">If hello conditions can be determined from within hello service, hello watchdog can be part of hello monitored service itself.</span></span> <span data-ttu-id="4a4ca-216">Örneğin, hello hizmet kod hello paylaşım kullanımını denetleyin ve toowrite bir dosya çalışır her zaman ardından raporlar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-216">For example, hello service code can check hello share usage, and then report every time it tries toowrite a file.</span></span> <span data-ttu-id="4a4ca-217">Bu yaklaşımın avantajı Hello raporlama kolay olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-217">hello advantage of this approach is that reporting is simple.</span></span> <span data-ttu-id="4a4ca-218">Merhaba hizmeti işlevselliğini etkileyen gelen tooprevent izleme hatalar dikkatli olunması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-218">Care must be taken tooprevent watchdog bugs from impacting hello service functionality.</span></span>

<span data-ttu-id="4a4ca-219">Kullanarak izlenen hello Hizmeti'nde raporlama her zaman bir seçenek değil.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-219">Reporting from within hello monitored service is not always an option.</span></span> <span data-ttu-id="4a4ca-220">İzleme olaylarını hello hizmet içinde mümkün toodetect hello koşullar olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-220">A watchdog within hello service may not be able toodetect hello conditions.</span></span> <span data-ttu-id="4a4ca-221">Merhaba mantığı ya da veri toomake hello belirleme olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-221">It may not have hello logic or data toomake hello determination.</span></span> <span data-ttu-id="4a4ca-222">Merhaba koşullarını izleme hello yükünü yüksek olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-222">hello overhead of monitoring hello conditions may be high.</span></span> <span data-ttu-id="4a4ca-223">Merhaba koşullar da belirli tooa hizmet olmaması, ancak bunun yerine Hizmetleri arasındaki etkileşimler etkiler.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-223">hello conditions also may not be specific tooa service, but instead affect interactions between services.</span></span> <span data-ttu-id="4a4ca-224">Başka bir seçenek toohave watchdogs hello kümedeki ayrı işlemleri olarak olur.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-224">Another option is toohave watchdogs in hello cluster as separate processes.</span></span> <span data-ttu-id="4a4ca-225">Hello watchdogs hello koşullar ve rapor, herhangi bir şekilde hello ana Hizmetleri etkilemeden izleyin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-225">hello watchdogs monitor hello conditions and report, without affecting hello main services in any way.</span></span> <span data-ttu-id="4a4ca-226">Örneğin, bu watchdogs hello durum bilgisiz Hizmetleri'nde olarak uygulanabilir veya hello tüm düğümler üzerinde dağıtılan aynı uygulama aynı düğümleri hello hizmet olarak.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-226">For example, these watchdogs could be implemented as stateless services in hello same application, deployed on all nodes or on hello same nodes as hello service.</span></span>

<span data-ttu-id="4a4ca-227">Bazı durumlarda, hello kümede çalışan bir izleme seçeneği ya da değil.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-227">Sometimes, a watchdog running in hello cluster is not an option either.</span></span> <span data-ttu-id="4a4ca-228">Kullanıcıların gördüğünüz hello kullanılabilirlik veya hello hizmet işlevselliğini izlenen hello koşul ise, en iyi toohave hello watchdogs aynı hello kullanıcı istemcileri olarak yerleştirin hello içinde var.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-228">If hello monitored condition is hello availability or functionality of hello service as users see it, it's best toohave hello watchdogs in hello same place as hello user clients.</span></span> <span data-ttu-id="4a4ca-229">Burada, hello işlemleri sınayabilirsiniz hello aynı şekilde, kullanıcılar bunları çağırın.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-229">There, they can test hello operations in hello same way users call them.</span></span> <span data-ttu-id="4a4ca-230">Örneğin, hello küme dışında yaşar, istekleri toohello hizmet veren ve hello gecikme süresi ve hello sonuç doğruluğunu denetler bir izleme olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-230">For example, you can have a watchdog that lives outside hello cluster, issues requests toohello service, and checks hello latency and correctness of hello result.</span></span> <span data-ttu-id="4a4ca-231">(Hesaplayıcı hizmeti için örneğin, 2 + 2 4 makul bir sürede return mu?)</span><span class="sxs-lookup"><span data-stu-id="4a4ca-231">(For a calculator service, for example, does 2+2 return 4 in a reasonable amount of time?)</span></span>

<span data-ttu-id="4a4ca-232">Merhaba İzleme Ayrıntıları sonlandırıldıktan sonra benzersiz olarak tanımlayan bir kaynak kimliği karar vermeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-232">Once hello watchdog details have been finalized, you should decide on a source ID that uniquely identifies it.</span></span> <span data-ttu-id="4a4ca-233">Aynı türde yaşayan Merhaba, birden çok watchdogs küme hello gerekir farklı varlıklarını rapor, veya, hakkında rapor varsa aynı varlık, kullanım farklı kaynak kimliği veya özellik hello.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-233">If multiple watchdogs of hello same type are living in hello cluster, they must report on different entities, or, if they report on hello same entity, use different source ID or property.</span></span> <span data-ttu-id="4a4ca-234">Bu şekilde raporlarının bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-234">This way, their reports can coexist.</span></span> <span data-ttu-id="4a4ca-235">Merhaba sistem durumu raporu Hello özelliği izlenen hello koşul yakalama.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-235">hello property of hello health report should capture hello monitored condition.</span></span> <span data-ttu-id="4a4ca-236">(Merhaba yukarıdaki örnekte, hello özellik olabilir **ShareSize**.) Birden çok rapor toohello uygularsanız aynı, hello koşul özelliği raporları toocoexist sağlayan bazı dinamik bilgileri içermelidir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-236">(For hello example above, hello property could be **ShareSize**.) If multiple reports apply toohello same condition, hello property should contain some dynamic information that allows reports toocoexist.</span></span> <span data-ttu-id="4a4ca-237">Örneğin, birden çok paylaşımı izlenen toobe gerekiyorsa, hello özellik adı olabilir **ShareSize sharename**.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-237">For example, if multiple shares need toobe monitored, hello property name can be **ShareSize-sharename**.</span></span>

> [!NOTE]
> <span data-ttu-id="4a4ca-238">Yapmak *değil* hello sistem durumu deposu tookeep durum bilgisini kullanın.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-238">Do *not* use hello health store tookeep status information.</span></span> <span data-ttu-id="4a4ca-239">Yalnızca sistem durumu ile ilgili bilgileri sistem durumu, bu bilgileri etkileri hello sistem durumu değerlendirmesi bir varlık olarak raporlanır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-239">Only health-related information should be reported as health, as this information impacts hello health evaluation of an entity.</span></span> <span data-ttu-id="4a4ca-240">Merhaba sistem durumu depolama genel amaçlı bir depolama alanı olarak tasarlanmamıştır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-240">hello health store was not designed as a general-purpose store.</span></span> <span data-ttu-id="4a4ca-241">Tüm veriler sistem durumu değerlendirme mantığı tooaggregate hello sistem durumu kullanır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-241">It uses health evaluation logic tooaggregate all data into hello health state.</span></span> <span data-ttu-id="4a4ca-242">Sistem durumu (gibi bir sistem durumu Tamam durumuyla raporlama) ilgisiz toohealth hello etkilemez bilgileri gönderme bir araya getirilir ancak hello sistem durumu deposu hello performansını olumsuz yönde etkileyebilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-242">Sending information unrelated toohealth (like reporting status with a health state of OK) doesn't impact hello aggregated health state, but it can negatively affect hello performance of hello health store.</span></span>
> 
> 

<span data-ttu-id="4a4ca-243">Merhaba sonraki karar noktası hangi varlık tooreport açıktır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-243">hello next decision point is which entity tooreport on.</span></span> <span data-ttu-id="4a4ca-244">Çoğu hello süreyi hello koşulu idetifies varlık açıkça hello.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-244">Most of hello time, hello condition clearly idetifies hello entity.</span></span> <span data-ttu-id="4a4ca-245">Merhaba varlık ile olası en iyi ayrıntı düzeyi seçin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-245">Choose hello entity with best possible granularity.</span></span> <span data-ttu-id="4a4ca-246">Bir koşul bir bölümdeki tüm çoğaltmaları etkiliyorsa hello hizmet üzerinde hello bölüm raporlama.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-246">If a condition impacts all replicas in a partition, report on hello partition, not on hello service.</span></span> <span data-ttu-id="4a4ca-247">Burada daha fazla düşünce, ancak gerekli köşe durumlar vardır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-247">There are corner cases where more thought is needed, though.</span></span> <span data-ttu-id="4a4ca-248">Merhaba koşul bir varlık etkiliyorsa hello bölüme bildirilmesi sonra bir çoğaltma ancak hello gibi desire çoğaltma ömrü hello süresinden daha fazla bilgi için işaretlenen toohave hello durumdur.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-248">If hello condition impacts an entity, such as a replica, but hello desire is toohave hello condition flagged for more than hello duration of replica life, then it should be reported on hello partition.</span></span> <span data-ttu-id="4a4ca-249">Aksi takdirde, Hello çoğaltma silindiğinde, hello sistem durumu depolama, tüm raporları siler.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-249">Otherwise, when hello replica is deleted, hello health store cleans up all its reports.</span></span> <span data-ttu-id="4a4ca-250">İzleme yazıcılarının hello ömrü hello varlık ve hello raporu hakkında düşünmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-250">Watchdog writers must think about hello lifetimes of hello entity and hello report.</span></span> <span data-ttu-id="4a4ca-251">Mağaza (örneğin, bir varlık üzerinde bildirdiği bir hata artık uygulanmadığında) bir rapor temizlenmelidir zaman açık olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-251">It must be clear when a report should be cleaned up from a store (for example, when an error reported on an entity no longer applies).</span></span>

<span data-ttu-id="4a4ca-252">Birlikte ı açıklanan hello noktaları koyan bir örneğe bakalım.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-252">Let's look at an example that puts together hello points I described.</span></span> <span data-ttu-id="4a4ca-253">Bir durum bilgisi olan kalıcı hizmet ana ve tüm düğümleri (görevinin her türü için bir ikincil hizmet türü) dağıtılan ikincil durum bilgisi olmayan hizmetler Service Fabric uygulaması oluşan göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-253">Consider a Service Fabric application composed of a master stateful persistent service and secondary stateless services deployed on all nodes (one secondary service type for each type of task).</span></span> <span data-ttu-id="4a4ca-254">Hello Yöneticisi ikinciller tarafından yürütülen komutları toobe içeren bir işleme sırası vardır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-254">hello master has a processing queue that contains commands toobe executed by secondaries.</span></span> <span data-ttu-id="4a4ca-255">Merhaba ikinciller hello gelen isteklerin yürütülebilmesi ve geri bildirim sinyalleri gönderin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-255">hello secondaries execute hello incoming requests and send back acknowledgement signals.</span></span> <span data-ttu-id="4a4ca-256">İzlenen bir koşul hello hello ana işleme sırası uzunluğu ' dir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-256">One condition that could be monitored is hello length of hello master processing queue.</span></span> <span data-ttu-id="4a4ca-257">Hello Yöneticisi sırası uzunluğu eşiği ulaşırsa, bir uyarı bildirilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-257">If hello master queue length reaches a threshold, a warning is reported.</span></span> <span data-ttu-id="4a4ca-258">Merhaba uyarı hello ikinciller hello yük işleyemiyor gösterir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-258">hello warning indicates that hello secondaries can't handle hello load.</span></span> <span data-ttu-id="4a4ca-259">Hello sıra hello en fazla uzunluk ulaştığında ve komutları bırakılan bir hata bildirdi, hizmet hello kurtaramazsınız.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-259">If hello queue reaches hello maximum length and commands are dropped, an error is reported, as hello service can't recover.</span></span> <span data-ttu-id="4a4ca-260">Merhaba raporları hello özellikte olabilir **QueueStatus**.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-260">hello reports can be on hello property **QueueStatus**.</span></span> <span data-ttu-id="4a4ca-261">Merhaba izleme hello hizmet içinde yaşar ve hello ana birincil Çoğaltmada düzenli aralıklarla gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-261">hello watchdog lives inside hello service, and it's sent periodically on hello master primary replica.</span></span> <span data-ttu-id="4a4ca-262">Merhaba süresi toolive iki dakikadır ve her 30 saniyede düzenli aralıklarla gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-262">hello time toolive is two minutes, and it's sent periodically every 30 seconds.</span></span> <span data-ttu-id="4a4ca-263">Merhaba birincil kullanılamaz hale gelirse hello rapor Mağazası'ndan otomatik olarak temizlenir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-263">If hello primary goes down, hello report is cleaned up automatically from store.</span></span> <span data-ttu-id="4a4ca-264">Merhaba hizmet çoğaltma çalışıyor, ancak karşılıklı veya diğer sorunlar oluşmuş hello rapor hello health store içinde süresi dolar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-264">If hello service replica is up, but it is deadlocked or having other issues, hello report expires in hello health store.</span></span> <span data-ttu-id="4a4ca-265">Bu durumda, hello varlık hatasında değerlendirilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-265">In this case, hello entity is evaluated at error.</span></span>

<span data-ttu-id="4a4ca-266">İzlenebilir başka bir koşul görev yürütme süresi ' dir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-266">Another condition that can be monitored is task execution time.</span></span> <span data-ttu-id="4a4ca-267">Hello Yöneticisi dağıtır görevleri toohello ikinciller hello görev türüne bağlı.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-267">hello master distributes tasks toohello secondaries based on hello task type.</span></span> <span data-ttu-id="4a4ca-268">Merhaba tasarım bağlı olarak, hello ana hello ikinciller görev durumu için yoklama.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-268">Depending on hello design, hello master could poll hello secondaries for task status.</span></span> <span data-ttu-id="4a4ca-269">Bunlar bittiğinde ikinciller toosend geri bildirim sinyalleri için de bekleyin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-269">It could also wait for secondaries toosend back acknowledgement signals when they are done.</span></span> <span data-ttu-id="4a4ca-270">Merhaba ikinci durumda, ikincil kopya dökme veya iletileri burada kaybolur toodetect durumlarda dikkatli olunması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-270">In hello second case, care must be taken toodetect situations where secondaries die or messages are lost.</span></span> <span data-ttu-id="4a4ca-271">Bir seçenek hello ana toosend ping isteği toohello ikincil durumunu geri gönderen aynıdır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-271">One option is for hello master toosend a ping request toohello same secondary, which sends back its status.</span></span> <span data-ttu-id="4a4ca-272">Durum yok aldıysanız hello ana bir hata olarak değerlendirir ve hello görev reschedules.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-272">If no status is received, hello master considers it a failure and reschedules hello task.</span></span> <span data-ttu-id="4a4ca-273">Bu davranış, başlangıç görevleri ıdempotent olduğunu varsayar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-273">This behavior assumes that hello tasks are idempotent.</span></span>

<span data-ttu-id="4a4ca-274">izlenen hello koşul dönüştürülür uyarı olarak hello görev belirli bir süre içinde yapmadıysanız (**t1**, örneğin 10 dakika).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-274">hello monitored condition can be translated as a warning if hello task is not done in a certain time (**t1**, for example 10 minutes).</span></span> <span data-ttu-id="4a4ca-275">Merhaba görev zamanında tamamlanmazsa (**t2**, örneğin 20 dakika), izlenen hello koşul hata olarak çevrilmiş.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-275">If hello task is not completed in time (**t2**, for example 20 minutes), hello monitored condition can be translated as Error.</span></span> <span data-ttu-id="4a4ca-276">Bu raporlama birden çok yolla yapılabilir:</span><span class="sxs-lookup"><span data-stu-id="4a4ca-276">This reporting can be done in multiple ways:</span></span>

* <span data-ttu-id="4a4ca-277">Hello Yöneticisi birincil çoğaltma kendisini düzenli aralıklarla bildirir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-277">hello master primary replica reports on itself periodically.</span></span> <span data-ttu-id="4a4ca-278">Tüm Bekleyen görevler için bir özellik hello sıraya sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-278">You can have one property for all pending tasks in hello queue.</span></span> <span data-ttu-id="4a4ca-279">En az bir daha uzun sürer hello rapor durumu hello özellikte görev **PendingTasks** bir uyarı veya hata uygun olarak.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-279">If at least one task takes longer, hello report status on hello property **PendingTasks** is a warning or error, as appropriate.</span></span> <span data-ttu-id="4a4ca-280">Bekleyen görev yok veya tüm görevler yürütme başladı hello rapor durumu Tamam olur.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-280">If there are no pending tasks or all tasks started execution, hello report status is OK.</span></span> <span data-ttu-id="4a4ca-281">Merhaba görevleri kalıcıdır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-281">hello tasks are persistent.</span></span> <span data-ttu-id="4a4ca-282">Merhaba birincil kullanılamaz hale gelirse, yeni yükseltilmiş hello birincil tooreport düzgün bir şekilde devam edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-282">If hello primary goes down, hello newly promoted primary can continue tooreport properly.</span></span>
* <span data-ttu-id="4a4ca-283">Başka bir izleme işlemde (Merhaba Bulut veya dış) hello görevleri denetler (gelen dışında istenen hello görev sonucuna bağlı olarak) bunlar tamamladıysanız toosee.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-283">Another watchdog process (in hello cloud or external) checks hello tasks (from outside, based on hello desired task result) toosee if they are completed.</span></span> <span data-ttu-id="4a4ca-284">Merhaba eşikleri uymaz, bir rapor hello ana hizmette gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-284">If they do not respect hello thresholds, a report is sent on hello master service.</span></span> <span data-ttu-id="4a4ca-285">Bir raporu da gibi hello görev tanımlayıcısı içeren her görev için gönderilen **PendingTask + Taskıd**.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-285">A report is also sent on each task that includes hello task identifier, like **PendingTask+taskId**.</span></span> <span data-ttu-id="4a4ca-286">Raporları yalnızca sağlıksız durumlarına gönderilmelidir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-286">Reports should be sent only on unhealthy states.</span></span> <span data-ttu-id="4a4ca-287">Birkaç dakika zaman toolive tooa ayarlayın ve tooensure temizleme sona erdiğinde kaldırılan hello raporları toobe işaretleyin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-287">Set time toolive tooa few minutes, and mark hello reports toobe removed when they expire tooensure cleanup.</span></span>
* <span data-ttu-id="4a4ca-288">Bu beklenen toorun uzun sürer olduğunda bir görev yürütme ikincil hello bildirir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-288">hello secondary that is executing a task reports when it takes longer than expected toorun it.</span></span> <span data-ttu-id="4a4ca-289">Merhaba özellikte hello hizmet örneği üzerinde raporları **PendingTasks**.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-289">It reports on hello service instance on hello property **PendingTasks**.</span></span> <span data-ttu-id="4a4ca-290">Merhaba rapor sorunları var. hello hizmet örneği soruna neden olan, ancak burada hello örneği sonlandıktan hello durumu yakalamaz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-290">hello report pinpoints hello service instance that has issues, but it doesn't capture hello situation where hello instance dies.</span></span> <span data-ttu-id="4a4ca-291">Merhaba raporları sonra temizlenir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-291">hello reports are cleaned up then.</span></span> <span data-ttu-id="4a4ca-292">Merhaba ikincil hizmette rapor edilemedi.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-292">It could report on hello secondary service.</span></span> <span data-ttu-id="4a4ca-293">Merhaba ikincil hello görev tamamlarsa, hello ikincil örneği hello rapor hello deposundan temizler.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-293">If hello secondary completes hello task, hello secondary instance clears hello report from hello store.</span></span> <span data-ttu-id="4a4ca-294">Merhaba rapor burada hello bildirim iletisi kaybolur ve hello görev hello Yöneticisi'nin açısından bakıldığında bitmedi hello durumu yakalamaz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-294">hello report doesn't capture hello situation where hello acknowledgement message is lost and hello task is not finished from hello master's point of view.</span></span>

<span data-ttu-id="4a4ca-295">Yukarıda açıklanan hello durumlarda Hello raporlama yapılır ancak sistem durumu değerlendirmesinde hello raporları uygulama sağlığını yakalanır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-295">However hello reporting is done in hello cases described above, hello reports are captured in application health when health is evaluated.</span></span>

## <a name="report-periodically-vs-on-transition"></a><span data-ttu-id="4a4ca-296">Raporda düzenli aralıklarla ve geçiş</span><span class="sxs-lookup"><span data-stu-id="4a4ca-296">Report periodically vs. on transition</span></span>
<span data-ttu-id="4a4ca-297">Merhaba sistem durumu modeli raporlama kullanarak watchdogs raporları düzenli aralıklarla veya geçişleri gönderebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-297">By using hello health reporting model, watchdogs can send reports periodically or on transitions.</span></span> <span data-ttu-id="4a4ca-298">Hello kod çok daha basit ve potansiyeli daha az tooerrors olduğundan hello raporlama izleme yolu, düzenli aralıklarla önerilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-298">hello recommended way for watchdog reporting is periodically, because hello code is much simpler and less prone tooerrors.</span></span> <span data-ttu-id="4a4ca-299">Merhaba watchdogs toobe yanlış raporları tetiklemek olası tooavoid hata olarak basit çaba gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-299">hello watchdogs must strive toobe as simple as possible tooavoid bugs that trigger incorrect reports.</span></span> <span data-ttu-id="4a4ca-300">Yanlış *sağlıksız* raporları, sistem durumu değerlendirmesini ve yükseltmeleri dahil olmak üzere sistem durumu hakkında temel senaryoları etkileyen.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-300">Incorrect *unhealthy* reports impact health evaluations and scenarios based on health, including upgrades.</span></span> <span data-ttu-id="4a4ca-301">Yanlış *sağlıklı* raporları istenmediği hello kümedeki sorunları gizle.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-301">Incorrect *healthy* reports hide issues in hello cluster, which is not desired.</span></span>

<span data-ttu-id="4a4ca-302">Dönemsel raporlama için hello izleme ile bir süreölçer uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-302">For periodic reporting, hello watchdog can be implemented with a timer.</span></span> <span data-ttu-id="4a4ca-303">Bir zamanlayıcı geri hello izleme hello durumunu denetleyin ve hello geçerli durumunu temel alan bir rapor gönderin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-303">On a timer callback, hello watchdog can check hello state and send a report based on hello current state.</span></span> <span data-ttu-id="4a4ca-304">Hangi raporun daha önce gönderilen veya Mesajlaşma bakımından herhangi iyileştirmeler olun hiçbir gerek toosee yoktur.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-304">There is no need toosee which report was sent previously or make any optimizations in terms of messaging.</span></span> <span data-ttu-id="4a4ca-305">Toplu işleme mantığı toohelp performans Hello sistem durumu istemcinin olur.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-305">hello health client has batching logic toohelp with performance.</span></span> <span data-ttu-id="4a4ca-306">Merhaba sistem istemci Canlı tutulur, ancak bu dahili hello rapor hello sistem durumu mağaza tarafından onaylanan veya hello izleme hello sahip yeni bir rapor oluşturur kadar yeniden deneme aynı varlık, özellik ve kaynak.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-306">While hello health client is kept alive, it retries internally until hello report is acknowledged by hello health store or hello watchdog generates a newer report with hello same entity, property, and source.</span></span>

<span data-ttu-id="4a4ca-307">Geçişleri üzerinde raporlama durumunun dikkatli işleme gerektirir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-307">Reporting on transitions requires careful handling of state.</span></span> <span data-ttu-id="4a4ca-308">Merhaba izleme bazı koşullar izler ve yalnızca hello koşullar değiştiğinde raporlar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-308">hello watchdog monitors some conditions and reports only when hello conditions change.</span></span> <span data-ttu-id="4a4ca-309">Bu yaklaşımın ters Merhaba, daha az raporları gerekli olan ' dir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-309">hello upside of this approach is that fewer reports are needed.</span></span> <span data-ttu-id="4a4ca-310">Merhaba dezavantajı hello izleme hello mantığını karmaşık olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-310">hello downside is that hello logic of hello watchdog is complex.</span></span> <span data-ttu-id="4a4ca-311">Böylece incelenen toodetermine durum değişiklikleri olabilir hello izleme hello koşullar veya hello raporları bulundurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-311">hello watchdog must maintain hello conditions or hello reports, so that they can be inspected toodetermine state changes.</span></span> <span data-ttu-id="4a4ca-312">Yük devretme, eklediğiniz, ancak henüz toohello sistem durumu deposu gönderilen raporlarla dikkatli olunması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-312">On failover, care must be taken with reports added, but not yet sent toohello health store.</span></span> <span data-ttu-id="4a4ca-313">Başlangıç sıra numarası, gitgide artan olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-313">hello sequence number must be ever-increasing.</span></span> <span data-ttu-id="4a4ca-314">Aksi durumda, hello raporları eski olarak reddedilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-314">If not, hello reports are rejected as stale.</span></span> <span data-ttu-id="4a4ca-315">Veri kaybı burada ücrete hello nadir durumlarda, eşitleme hello Raporlayıcı hello durumunu ve hello sistem durumu deposu hello durumunu arasında gerekli olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-315">In hello rare cases where data loss is incurred, synchronization may be needed between hello state of hello reporter and hello state of hello health store.</span></span>

<span data-ttu-id="4a4ca-316">Geçişleri üzerinde raporlama anlamlı kendilerini üzerinde aracılığıyla reporting services için `Partition` veya `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-316">Reporting on transitions makes sense for services reporting on themselves, through `Partition` or `CodePackageActivationContext`.</span></span> <span data-ttu-id="4a4ca-317">Ne zaman, yerel nesnesi hello (çoğaltma veya dağıtılmış hizmet paketi / dağıtılan uygulama) olan kaldırıldı, tüm raporları da kaldırılır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-317">When hello local object (replica or deployed service package / deployed application) is removed, all its reports are also removed.</span></span> <span data-ttu-id="4a4ca-318">Bu otomatik temizleme Raporlayıcı ve sistem durumu deposu arasındaki eşitleme hello gereksinimini rahatlatır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-318">This automatic cleanup relaxes hello need for synchronization between reporter and health store.</span></span> <span data-ttu-id="4a4ca-319">Merhaba rapor için üst bölüm veya üst uygulama ise, yük devretme tooavoid eski raporlarda hello health store içinde dikkatli olunması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-319">If hello report is for parent partition or parent application, care must be taken on failover tooavoid stale reports in hello health store.</span></span> <span data-ttu-id="4a4ca-320">Mantığı toomaintain hello doğru durumda ve Temizle hello rapor artık gerekmeyen zaman deposundan eklenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-320">Logic must be added toomaintain hello correct state and clear hello report from store when not needed anymore.</span></span>

## <a name="implement-health-reporting"></a><span data-ttu-id="4a4ca-321">Sistem durumu raporlamasını Uygula</span><span class="sxs-lookup"><span data-stu-id="4a4ca-321">Implement health reporting</span></span>
<span data-ttu-id="4a4ca-322">Merhaba varlık ve rapor ayrıntıları Temizle olduktan sonra sistem durumu raporları gönderme hello API'si, PowerShell veya REST yapılabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-322">Once hello entity and report details are clear, sending health reports can be done through hello API, PowerShell, or REST.</span></span>

### <a name="api"></a><span data-ttu-id="4a4ca-323">API</span><span class="sxs-lookup"><span data-stu-id="4a4ca-323">API</span></span>
<span data-ttu-id="4a4ca-324">tooreport hello API aracılığıyla toocreate üzerinde tooreport istedikleri bir sistem durumu raporu belirli toohello varlık türü gerekir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-324">tooreport through hello API, you need toocreate a health report specific toohello entity type they want tooreport on.</span></span> <span data-ttu-id="4a4ca-325">Merhaba rapor tooa sistem istemci verin.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-325">Give hello report tooa health client.</span></span> <span data-ttu-id="4a4ca-326">Alternatif olarak, bir sistem durumu bilgisi oluşturmak ve yöntemleri raporlama toocorrect geçirin `Partition` veya `CodePackageActivationContext` tooreport geçerli varlıklar üzerinde.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-326">Alternatively, create a health information and pass it toocorrect reporting methods on `Partition` or `CodePackageActivationContext` tooreport on current entities.</span></span>

<span data-ttu-id="4a4ca-327">Merhaba aşağıdaki örnek hello küme içindeki izleme olaylarını kullanarak raporlama düzenli gösterir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-327">hello following example shows periodic reporting from a watchdog within hello cluster.</span></span> <span data-ttu-id="4a4ca-328">Merhaba izleme, dış kaynak gelen bir düğümde erişilip erişilemeyeceğini denetler.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-328">hello watchdog checks whether an external resource can be accessed from within a node.</span></span> <span data-ttu-id="4a4ca-329">Merhaba kaynak hello uygulama içinde bir hizmet bildirimi tarafından gereklidir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-329">hello resource is needed by a service manifest within hello application.</span></span> <span data-ttu-id="4a4ca-330">Merhaba kaynak kullanılamıyorsa, hello Merhaba uygulaması içindeki diğer hizmetler hala düzgün bir şekilde çalışabilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-330">If hello resource is unavailable, hello other services within hello application can still function properly.</span></span> <span data-ttu-id="4a4ca-331">Bu nedenle, hello rapor dağıtılan hello hizmet paketi varlıkta her 30 saniyede bir gönderilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-331">Therefore, hello report is sent on hello deployed service package entity every 30 seconds.</span></span>

```csharp
private static Uri ApplicationName = new Uri("fabric:/WordCount");
private static string ServiceManifestName = "WordCount.Service";
private static string NodeName = FabricRuntime.GetNodeContext().NodeName;
private static Timer ReportTimer = new Timer(new TimerCallback(SendReport), null, 30 * 1000, 30 * 1000);
private static FabricClient Client = new FabricClient(new FabricClientSettings() { HealthReportSendInterval = TimeSpan.FromSeconds(0) });

public static void SendReport(object obj)
{
    // Test whether hello resource can be accessed from hello node
    HealthState healthState = this.TestConnectivityToExternalResource();

    // Send report on deployed service package, as hello connectivity is needed by hello specific service manifest
    // and can be different on different nodes
    var deployedServicePackageHealthReport = new DeployedServicePackageHealthReport(
        ApplicationName,
        ServiceManifestName,
        NodeName,
        new HealthInformation("ExternalSourceWatcher", "Connectivity", healthState));

    // TODO: handle exception. Code omitted for snippet brevity.
    // Possible exceptions: FabricException with error codes
    // FabricHealthStaleReport (non-retryable, hello report is already queued on hello health client),
    // FabricHealthMaxReportsReached (retryable; user should retry with exponential delay until hello report is accepted).
    Client.HealthManager.ReportHealth(deployedServicePackageHealthReport);
}
```

### <a name="powershell"></a><span data-ttu-id="4a4ca-332">PowerShell</span><span class="sxs-lookup"><span data-stu-id="4a4ca-332">PowerShell</span></span>
<span data-ttu-id="4a4ca-333">Sistem durumu raporları ile Gönder * *gönderme ServiceFabric*EntityType*HealthReport **.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-333">Send health reports with **Send-ServiceFabric*EntityType*HealthReport**.</span></span>

<span data-ttu-id="4a4ca-334">Merhaba aşağıdaki örnek bir düğüm üzerindeki CPU değerleri raporlama düzenli gösterir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-334">hello following example shows periodic reporting on CPU values on a node.</span></span> <span data-ttu-id="4a4ca-335">Merhaba raporları her 30 saniyede gönderilmesi gerektiğini ve birer iki dakikalık toolive sahiptir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-335">hello reports should be sent every 30 seconds, and they have a time toolive of two minutes.</span></span> <span data-ttu-id="4a4ca-336">Bunlar zaman aşımına uğrarsa hello Raporlayıcı sorunları sahiptir, böylece hello düğüm hatası değerlendirilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-336">If they expire, hello reporter has issues, so hello node is evaluated at error.</span></span> <span data-ttu-id="4a4ca-337">Merhaba CPU bir eşiğin olduğunda uyarı sistem durumu hello rapor vardır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-337">When hello CPU is above a threshold, hello report has a health state of warning.</span></span> <span data-ttu-id="4a4ca-338">Merhaba CPU yapılandırılmış başlangıç saatinden daha fazla bilgi için bir eşiğin üstünde kaldığında hata olarak bildirilir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-338">When hello CPU remains above a threshold for more than hello configured time, it's reported as an error.</span></span> <span data-ttu-id="4a4ca-339">Aksi takdirde hello Raporlayıcı Tamam sistem durumunu gönderir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-339">Otherwise, hello reporter sends a health state of OK.</span></span>

```powershell
PS C:\> Send-ServiceFabricNodeHealthReport -NodeName Node.1 -HealthState Warning -SourceId PowershellWatcher -HealthProperty CPU -Description "CPU is above 80% threshold" -TimeToLiveSec 120

PS C:\> Get-ServiceFabricNodeHealth -NodeName Node.1
NodeName              : Node.1
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='CPU', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.FM
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 5
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Fabric node is up.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : CPU
                        HealthState           : Warning
                        SequenceNumber        : 130741236814913394
                        SentAt                : 4/21/2015 9:01:21 PM
                        ReceivedAt            : 4/21/2015 9:01:21 PM
                        TTL                   : 00:02:00
                        Description           : CPU is above 80% threshold
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:01:21 PM
```

<span data-ttu-id="4a4ca-340">Merhaba aşağıdaki örnek geçici bir uyarı bir çoğaltma üzerinde raporlar.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-340">hello following example reports a transient warning on a replica.</span></span> <span data-ttu-id="4a4ca-341">İlk hello bölüm kimliği alır ve bunu ilgilendiği hello hizmeti için çoğaltma kimliği hello.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-341">It first gets hello partition ID and then hello replica ID for hello service it is interested in.</span></span> <span data-ttu-id="4a4ca-342">Ardından bir rapordan gönderir **PowershellWatcher** hello özellikte **ResourceDependency**.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-342">It then sends a report from **PowershellWatcher** on hello property **ResourceDependency**.</span></span> <span data-ttu-id="4a4ca-343">Merhaba ilgi yalnızca iki dakika rapordur ve hello Mağazası'ndan otomatik olarak kaldırılır.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-343">hello report is of interest for only two minutes, and it is removed from hello store automatically.</span></span>

```powershell
PS C:\> $partitionId = (Get-ServiceFabricPartition -ServiceName fabric:/WordCount/WordCount.Service).PartitionId

PS C:\> $replicaId = (Get-ServiceFabricReplica -PartitionId $partitionId | where {$_.ReplicaRole -eq "Primary"}).ReplicaId

PS C:\> Send-ServiceFabricReplicaHealthReport -PartitionId $partitionId -ReplicaId $replicaId -HealthState Warning -SourceId PowershellWatcher -HealthProperty ResourceDependency -Description "hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes." -TimeToLiveSec 120 -RemoveWhenExpired

PS C:\> Get-ServiceFabricReplicaHealth  -PartitionId $partitionId -ReplicaOrInstanceId $replicaId


PartitionId           : 8f82daff-eb68-4fd9-b631-7a37629e08c0
ReplicaId             : 130740415594605869
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='ResourceDependency', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.RA
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 130740768777734943
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Replica has been created.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : ResourceDependency
                        HealthState           : Warning
                        SequenceNumber        : 130741243777723555
                        SentAt                : 4/21/2015 9:12:57 PM
                        ReceivedAt            : 4/21/2015 9:12:57 PM
                        TTL                   : 00:02:00
                        Description           : hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes.
                        RemoveWhenExpired     : True
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:12:32 PM
```

### <a name="rest"></a><span data-ttu-id="4a4ca-344">REST</span><span class="sxs-lookup"><span data-stu-id="4a4ca-344">REST</span></span>
<span data-ttu-id="4a4ca-345">İstenen toohello varlık gidin ve hello gövde hello sistem durumu raporu açıklamasında POST istekleri REST kullanarak sistem durumu raporları gönder.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-345">Send health reports using REST with POST requests that go toohello desired entity and have in hello body hello health report description.</span></span> <span data-ttu-id="4a4ca-346">Örneğin, nasıl toosend REST bkz [küme sistem durumu raporlarının](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) veya [hizmet sistem durumu raporlarının](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span><span class="sxs-lookup"><span data-stu-id="4a4ca-346">For example, see how toosend REST [cluster health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) or [service health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span></span> <span data-ttu-id="4a4ca-347">Tüm varlıklar desteklenir.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-347">All entities are supported.</span></span>

## <a name="next-steps"></a><span data-ttu-id="4a4ca-348">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="4a4ca-348">Next steps</span></span>
<span data-ttu-id="4a4ca-349">Merhaba sistem durumu verilerini temel alarak hizmeti yazıcılarını ve küme/uygulama yöneticileri, yolları tooconsume hello bilgilerinin düşünebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-349">Based on hello health data, service writers and cluster/application administrators can think of ways tooconsume hello information.</span></span> <span data-ttu-id="4a4ca-350">Örneğin, bunlar kesintilere yol açabilirsiniz önce sistem durumu toocatch ciddi sorunları hakkında temel Uyarıları ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-350">For example, they can set up alerts based on health status toocatch severe issues before they provoke outages.</span></span> <span data-ttu-id="4a4ca-351">Yöneticiler ayrıca otomatik olarak onarma sistemleri toofix sorunları ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4a4ca-351">Administrators can also set up repair systems toofix issues automatically.</span></span>

[<span data-ttu-id="4a4ca-352">Giriş tooService doku sistem durumu izleme</span><span class="sxs-lookup"><span data-stu-id="4a4ca-352">Introduction tooService Fabric health Monitoring</span></span>](service-fabric-health-introduction.md)

[<span data-ttu-id="4a4ca-353">Service Fabric sistem durumu raporlarını görüntüle</span><span class="sxs-lookup"><span data-stu-id="4a4ca-353">View Service Fabric health reports</span></span>](service-fabric-view-entities-aggregated-health.md)

[<span data-ttu-id="4a4ca-354">Nasıl tooreport ve onay sistem durumu hizmeti</span><span class="sxs-lookup"><span data-stu-id="4a4ca-354">How tooreport and check service health</span></span>](service-fabric-diagnostics-how-to-report-and-check-service-health.md)

[<span data-ttu-id="4a4ca-355">Sorunlarını gidermek için sistem durumu raporlarını kullanma</span><span class="sxs-lookup"><span data-stu-id="4a4ca-355">Use system health reports for troubleshooting</span></span>](service-fabric-understand-and-troubleshoot-with-system-health-reports.md)

[<span data-ttu-id="4a4ca-356">İzleme ve Hizmetleri yerel olarak tanılama</span><span class="sxs-lookup"><span data-stu-id="4a4ca-356">Monitor and diagnose services locally</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

[<span data-ttu-id="4a4ca-357">Service Fabric uygulama yükseltme</span><span class="sxs-lookup"><span data-stu-id="4a4ca-357">Service Fabric application upgrade</span></span>](service-fabric-application-upgrade.md)

