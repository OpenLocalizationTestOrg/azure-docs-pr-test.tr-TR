---
title: "Test Edilebilirlik: Hizmet iletişimi | Microsoft Docs"
description: "Hizmet hizmet iletişimi, Service Fabric uygulaması kritik tümleştirme noktasıdır. Bu makalede, tasarım konuları ve test teknikleri anlatılmaktadır."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: 017557df-fb59-4e4a-a65d-2732f29255b8
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 4a8f941c1e8e641384a9ee3a1149dabaaf9983cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-testability-scenarios-service-communication"></a><span data-ttu-id="b7f3c-104">Service Fabric Test Edilebilirlik senaryoları: hizmet iletişimi</span><span class="sxs-lookup"><span data-stu-id="b7f3c-104">Service Fabric testability scenarios: Service communication</span></span>
<span data-ttu-id="b7f3c-105">Mikro hizmetler ve hizmet odaklı mimari stilleri yüzey doğal olarak Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-105">Microservices and service-oriented architectural styles surface naturally in Azure Service Fabric.</span></span> <span data-ttu-id="b7f3c-106">Bu dağıtılmış mimariler türlerinde bileşenlerden oluşan mikro hizmet uygulamaları genellikle tootalk tooeach diğer gereken birden çok hizmetlerini oluşur.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-106">In these types of distributed architectures, componentized microservice applications are typically composed of multiple services that need tootalk tooeach other.</span></span> <span data-ttu-id="b7f3c-107">Hatta hello en basit durumda, genellikle en az bir durum bilgisi olmayan web hizmeti ve toocommunicate gereken bir durum bilgisi olan veri depolama hizmeti vardır.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-107">In even hello simplest cases, you generally have at least a stateless web service and a stateful data storage service that need toocommunicate.</span></span>

<span data-ttu-id="b7f3c-108">Hizmet hizmet iletişimi kritik tümleştirme noktası bir uygulamanın çünkü her hizmetin bir Uzak API tooother hizmetleri sunar.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-108">Service-to-service communication is a critical integration point of an application, because each service exposes a remote API tooother services.</span></span> <span data-ttu-id="b7f3c-109">Genellikle g/ç içeren bir dizi API sınırları çalışmak bazı dikkatli iyi miktarda sınama ve doğrulama gerektirir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-109">Working with a set of API boundaries that involves I/O generally requires some care, with a good amount of testing and validation.</span></span>

<span data-ttu-id="b7f3c-110">Bu hizmet sınırları birlikte dağıtılmış bir sistemde kablolu, çok sayıda konuları toomake vardır:</span><span class="sxs-lookup"><span data-stu-id="b7f3c-110">There are numerous considerations toomake when these service boundaries are wired together in a distributed system:</span></span>

* <span data-ttu-id="b7f3c-111">*Aktarım Protokolü*.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-111">*Transport protocol*.</span></span> <span data-ttu-id="b7f3c-112">HTTP artan birlikte çalışabilirliğini ya da özel bir ikili protokol için en yüksek verimlilik kullanacaksınız?</span><span class="sxs-lookup"><span data-stu-id="b7f3c-112">Will you use HTTP for increased interoperability, or a custom binary protocol for maximum throughput?</span></span>
* <span data-ttu-id="b7f3c-113">*Hata işleme*.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-113">*Error handling*.</span></span> <span data-ttu-id="b7f3c-114">Kalıcı ve geçici hataları nasıl işleneceğini?</span><span class="sxs-lookup"><span data-stu-id="b7f3c-114">How will permanent and transient errors be handled?</span></span> <span data-ttu-id="b7f3c-115">Bir hizmet tooa farklı bir düğüme taşındığında ne?</span><span class="sxs-lookup"><span data-stu-id="b7f3c-115">What will happen when a service moves tooa different node?</span></span>
* <span data-ttu-id="b7f3c-116">*Zaman aşımları ve gecikme süresi*.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-116">*Timeouts and latency*.</span></span> <span data-ttu-id="b7f3c-117">Çok uygulamalarda her hizmet katmanı gecikme hello yığını ve toohello kullanıcı üzerinden nasıl işler mi?</span><span class="sxs-lookup"><span data-stu-id="b7f3c-117">In multitiered applications, how will each service layer handle latency through hello stack and toohello user?</span></span>

<span data-ttu-id="b7f3c-118">Service Fabric tarafından sağlanan hello yerleşik hizmet iletişimi bileşenlerden biri kullanabilir veya kendi oluşturabilirsiniz, hizmetlerinizi arasındaki hello etkileşimler sınama kritik tooensuring dayanıklılık uygulamanızda olup.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-118">Whether you use one of hello built-in service communication components provided by Service Fabric or you build your own, testing hello interactions between your services is critical tooensuring resiliency in your application.</span></span>

## <a name="prepare-for-services-toomove"></a><span data-ttu-id="b7f3c-119">Hizmetleri toomove için hazırlama</span><span class="sxs-lookup"><span data-stu-id="b7f3c-119">Prepare for services toomove</span></span>
<span data-ttu-id="b7f3c-120">Hizmet örnekleri zaman içinde hareket etme.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-120">Service instances may move around over time.</span></span> <span data-ttu-id="b7f3c-121">Bu, özellikle özel uyarlanmış en iyi kaynak Dengeleme için yük ölçümlerle yapılandırıldığında geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-121">This is especially true when they are configured with load metrics for custom-tailored optimal resource balancing.</span></span> <span data-ttu-id="b7f3c-122">Service Fabric hizmeti örnekleri toomaximize yükseltmeler, yük devretme, genişleme ve dağıtılmış bir sistemde hello ömrü boyunca gerçekleşen diğer durumlarda sırasında bile kullanılabilirliklerini taşır.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-122">Service Fabric moves your service instances toomaximize their availability even during upgrades, failovers, scale-out, and other situations that occur over hello lifetime of a distributed system.</span></span>

<span data-ttu-id="b7f3c-123">Merhaba kümede Hizmetleri dolaşmak gibi istemcilerinizi ve diğer hizmetleri tooa hizmet konuşurken hazırlıklı toohandle iki senaryo olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="b7f3c-123">As services move around in hello cluster, your clients and other services should be prepared toohandle two scenarios when they talk tooa service:</span></span>

* <span data-ttu-id="b7f3c-124">Merhaba hizmet örneği veya bölüm çoğaltma tooit açıklandı son zamanı hello itibaren taşınmıştır.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-124">hello service instance or partition replica has moved since hello last time you talked tooit.</span></span> <span data-ttu-id="b7f3c-125">Bu hizmet yaşam döngüsü normal bir parçası olan ve uygulamanızı hello ömrü boyunca beklenen toohappen olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-125">This is a normal part of a service lifecycle, and it should be expected toohappen during hello lifetime of your application.</span></span>
* <span data-ttu-id="b7f3c-126">Merhaba hizmet örneği veya bölüm çoğaltma taşıma hello işlemi devam ediyor.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-126">hello service instance or partition replica is in hello process of moving.</span></span> <span data-ttu-id="b7f3c-127">Bir düğüm tooanother hizmetinden Yük Devretmesini Service Fabric çok hızlı bir şekilde oluşur ancak bir gecikme olabilir kullanılabilirlik hello iletişim bileşeni hizmetinizin yavaş toostart ise.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-127">Although failover of a service from one node tooanother occurs very quickly in Service Fabric, there may be a delay in availability if hello communication component of your service is slow toostart.</span></span>

<span data-ttu-id="b7f3c-128">Bu senaryolar düzgün biçimde işleme düzgün çalışmasını sistemi için önemlidir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-128">Handling these scenarios gracefully is important for a smooth-running system.</span></span> <span data-ttu-id="b7f3c-129">toodo, bu nedenle, göz önünde bulundurun:</span><span class="sxs-lookup"><span data-stu-id="b7f3c-129">toodo so, keep in mind that:</span></span>

* <span data-ttu-id="b7f3c-130">Bağlı toohas olabilir her hizmetin bir *adresi* , (örneğin, HTTP veya WebSockets) dinler.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-130">Every service that can be connected toohas an *address* that it listens on (for example, HTTP or WebSockets).</span></span> <span data-ttu-id="b7f3c-131">Bir hizmet örneği veya bölüm taşındığında, adresi uç noktasında değiştirir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-131">When a service instance or partition moves, its address endpoint changes.</span></span> <span data-ttu-id="b7f3c-132">(Bu, farklı bir düğüme tooa farklı bir IP adresi ile taşınır.) Merhaba yerleşik iletişim bileşenleri kullanıyorsanız, bunlar yeniden çözümleme hizmeti adresleri sizin için işler.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-132">(It moves tooa different node with a different IP address.) If you're using hello built-in communication components, they will handle re-resolving service addresses for you.</span></span>
* <span data-ttu-id="b7f3c-133">Olabilir hizmet gecikme hello hizmet örneği başlatır, dinleyicisi yukarı olarak geçici bir artış yeniden.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-133">There may be a temporary increase in service latency as hello service instance starts up its listener again.</span></span> <span data-ttu-id="b7f3c-134">Bu hello hizmet örneği taşındıktan sonra ne kadar hızlı hello hizmet hello dinleyicisi üzerinde bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-134">This depends on how quickly hello service opens hello listener after hello service instance is moved.</span></span>
* <span data-ttu-id="b7f3c-135">Var olan tüm bağlantıları yeni bir düğümde hello hizmet açıldıktan sonra kapatıp toobe gerekir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-135">Any existing connections need toobe closed and reopened after hello service opens on a new node.</span></span> <span data-ttu-id="b7f3c-136">Normal düğümün kapanması veya yeniden başlatma düzgün biçimde kapatılamadı varolan bağlantılar toobe için zaman sağlar.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-136">A graceful node shutdown or restart allows time for existing connections toobe shut down gracefully.</span></span>

### <a name="test-it-move-service-instances"></a><span data-ttu-id="b7f3c-137">Test: taşıma hizmet örnekleri</span><span class="sxs-lookup"><span data-stu-id="b7f3c-137">Test it: Move service instances</span></span>
<span data-ttu-id="b7f3c-138">Service Fabric'ın Test Edilebilirlik araçlarını kullanarak, farklı şekillerde bu gibi durumlarda bir test senaryosu tootest yazabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="b7f3c-138">By using Service Fabric's testability tools, you can author a test scenario tootest these situations in different ways:</span></span>

1. <span data-ttu-id="b7f3c-139">Bir durum bilgisi olan hizmetin birincil çoğaltma taşıyın.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-139">Move a stateful service's primary replica.</span></span>
   
    <span data-ttu-id="b7f3c-140">Merhaba bir durum bilgisi olan hizmet bölüm birincil çoğaltmasını birkaç nedenden dolayı için taşınabilir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-140">hello primary replica of a stateful service partition can be moved for any number of reasons.</span></span> <span data-ttu-id="b7f3c-141">Bu tootarget hello birincil çoğaltmasını nasıl tepki, hizmetleri toohello hareket çok denetimli bir şekilde belirli bir bölüm toosee kullanın.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-141">Use this tootarget hello primary replica of a specific partition toosee how your services react toohello move in a very controlled manner.</span></span>
   
    ```powershell
   
    PS > Move-ServiceFabricPrimaryReplica -PartitionId 6faa4ffa-521a-44e9-8351-dfca0f7e0466 -ServiceName fabric:/MyApplication/MyService
   
    ```
2. <span data-ttu-id="b7f3c-142">Bir düğüm durdurun.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-142">Stop a node.</span></span>
   
    <span data-ttu-id="b7f3c-143">Bir düğüm durdurulduğunda, tüm hello hizmet örneği veya bu düğüm tooone üzerinde olan bölümleri Service Fabric taşır hello kümedeki kullanılabilir diğer düğümlere hello.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-143">When a node is stopped, Service Fabric moves all of hello service instances or partitions that were on that node tooone of hello other available nodes in hello cluster.</span></span> <span data-ttu-id="b7f3c-144">Bu tootest Burada, kümeden bir düğümü kaybolur ve tüm hello hizmet örneği ve çoğaltmaları bu düğümde toomove sahip bir durum kullanın.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-144">Use this tootest a situation where a node is lost from your cluster and all of hello service instances and replicas on that node have toomove.</span></span>
   
    <span data-ttu-id="b7f3c-145">Merhaba PowerShell kullanarak bir düğümü durdurabilirsiniz **Stop-ServiceFabricNode** cmdlet:</span><span class="sxs-lookup"><span data-stu-id="b7f3c-145">You can stop a node by using hello PowerShell **Stop-ServiceFabricNode** cmdlet:</span></span>
   
    ```powershell
   
    PS > Restart-ServiceFabricNode -NodeName Node_1
   
    ```

## <a name="maintain-service-availability"></a><span data-ttu-id="b7f3c-146">Hizmet kullanılabilirliği sürdürmek</span><span class="sxs-lookup"><span data-stu-id="b7f3c-146">Maintain service availability</span></span>
<span data-ttu-id="b7f3c-147">Bir platform tasarlanmış tooprovide yüksek hizmetlerinizin kullanılabilirliğini Service Fabric eklentisidir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-147">As a platform, Service Fabric is designed tooprovide high availability of your services.</span></span> <span data-ttu-id="b7f3c-148">Ancak olağanüstü durumlarda, temel alınan altyapı hala kullanılamazlık sorunlara yol açabilir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-148">But in extreme cases, underlying infrastructure problems can still cause unavailability.</span></span> <span data-ttu-id="b7f3c-149">Bu senaryolarda önemli tootest çok uzun.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-149">It is important tootest for these scenarios, too.</span></span>

<span data-ttu-id="b7f3c-150">Durum bilgisi olan hizmetler yüksek kullanılabilirlik için bir çekirdek tabanlı sistem tooreplicate durumu kullanın.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-150">Stateful services use a quorum-based system tooreplicate state for high availability.</span></span> <span data-ttu-id="b7f3c-151">Bu, bir çekirdek çoğaltmalarının toobe kullanılabilir tooperform yazma işlemleri gerektiği anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-151">This means that a quorum of replicas needs toobe available tooperform write operations.</span></span> <span data-ttu-id="b7f3c-152">Nadir durumlarda, yaygın donanım arızası gibi bir çekirdek çoğaltmalarının kullanılamayabilir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-152">In rare cases, such as a widespread hardware failure, a quorum of replicas may not be available.</span></span> <span data-ttu-id="b7f3c-153">Bu gibi durumlarda mümkün tooperform yazma işlemleri olmaz ancak mümkün tooperform okuma işlemleri olmaya devam edecektir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-153">In these cases, you will not be able tooperform write operations, but you will still be able tooperform read operations.</span></span>

### <a name="test-it-write-operation-unavailability"></a><span data-ttu-id="b7f3c-154">Test: yazma işlemi kullanılamazlık</span><span class="sxs-lookup"><span data-stu-id="b7f3c-154">Test it: Write operation unavailability</span></span>
<span data-ttu-id="b7f3c-155">Service Fabric Hello Test Edilebilirlik araçlarını kullanarak, bir test olarak çekirdek kayıp gerektiriyorsa bir arıza ekleyemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-155">By using hello testability tools in Service Fabric, you can inject a fault that induces quorum loss as a test.</span></span> <span data-ttu-id="b7f3c-156">Böyle bir senaryo ender olsa da, istemciler ve durum bilgisi olan bir hizmete bağlı hizmetler toohandle durumlarda bunlar istekleri tooit yazma burada yapamazsınız hazırlanır önemlidir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-156">Although such a scenario is rare, it is important that clients and services that depend on a stateful service are prepared toohandle situations where they cannot make write requests tooit.</span></span> <span data-ttu-id="b7f3c-157">Durum bilgisi olan hizmet hello kendisini bu olasılığını bilmektedir ve toocallers düzgün bir şekilde iletişim kurmak önemlidir.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-157">It is also important that hello stateful service itself is aware of this possibility and can gracefully communicate it toocallers.</span></span>

<span data-ttu-id="b7f3c-158">Çekirdek kayıp hello PowerShell kullanarak anlamına **Invoke-ServiceFabricPartitionQuorumLoss** cmdlet:</span><span class="sxs-lookup"><span data-stu-id="b7f3c-158">You can induce quorum loss by using hello PowerShell **Invoke-ServiceFabricPartitionQuorumLoss** cmdlet:</span></span>

```powershell

PS > Invoke-ServiceFabricPartitionQuorumLoss -ServiceName fabric:/Myapplication/MyService -QuorumLossMode QuorumReplicas -QuorumLossDurationInSeconds 20

```

<span data-ttu-id="b7f3c-159">Bu örnekte, ayarlarız `QuorumLossMode` çok`QuorumReplicas` tüm çoğaltmaları bırakmadan tooinduce çekirdek kayıp istiyoruz tooindicate.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-159">In this example, we set `QuorumLossMode` too`QuorumReplicas` tooindicate that we want tooinduce quorum loss without taking down all replicas.</span></span> <span data-ttu-id="b7f3c-160">Bu şekilde, okuma işlemleri hala mümkündür.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-160">This way, read operations are still possible.</span></span> <span data-ttu-id="b7f3c-161">tootest bir senaryo burada bölümünün tamamını kullanılamıyor, bu anahtarı çok ayarlayabilirsiniz`AllReplicas`.</span><span class="sxs-lookup"><span data-stu-id="b7f3c-161">tootest a scenario where an entire partition is unavailable, you can set this switch too`AllReplicas`.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b7f3c-162">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="b7f3c-162">Next steps</span></span>
[<span data-ttu-id="b7f3c-163">Test Edilebilirlik eylemler hakkında daha fazla bilgi edinin</span><span class="sxs-lookup"><span data-stu-id="b7f3c-163">Learn more about testability actions</span></span>](service-fabric-testability-actions.md)

[<span data-ttu-id="b7f3c-164">Test Edilebilirlik senaryoları hakkında daha fazla bilgi edinin</span><span class="sxs-lookup"><span data-stu-id="b7f3c-164">Learn more about testability scenarios</span></span>](service-fabric-testability-scenarios.md)

