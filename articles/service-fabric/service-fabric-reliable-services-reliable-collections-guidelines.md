---
title: "Yönergeleri & Azure güvenilir koleksiyonlar için öneriler hizmeti doku | Microsoft Docs"
description: "Kılavuzları ve önerileri Service Fabric güvenilir koleksiyonları kullanma"
services: service-fabric
documentationcenter: .net
author: mcoskun
manager: timlt
editor: masnider,rajak
ms.assetid: 62857523-604b-434e-bd1c-2141ea4b00d1
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: required
ms.date: 5/3/2017
ms.author: mcoskun
ms.openlocfilehash: 053a7bca76362035e428fc11806b3e4f83d00946
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="guidelines-and-recommendations-for-reliable-collections-in-azure-service-fabric"></a><span data-ttu-id="72566-103">Kılavuzları ve önerileri Azure Service Fabric güvenilir koleksiyonlar için</span><span class="sxs-lookup"><span data-stu-id="72566-103">Guidelines and recommendations for Reliable Collections in Azure Service Fabric</span></span>
<span data-ttu-id="72566-104">Bu bölümde, durum Yöneticisi'ni güvenilir ve güvenilir koleksiyonları kullanma yönergeleri sağlar.</span><span class="sxs-lookup"><span data-stu-id="72566-104">This section provides guidelines for using Reliable State Manager and Reliable Collections.</span></span> <span data-ttu-id="72566-105">Amacı kullanıcıların yaygın tehlikesinden yardımcı olmaktır.</span><span class="sxs-lookup"><span data-stu-id="72566-105">The goal is to help users avoid common pitfalls.</span></span>

<span data-ttu-id="72566-106">Yönergeler koşulları önekli basit öneriler olarak düzenlenir *yapmak*, *düşünün*, *kaçının* ve *sağlamadığı*.</span><span class="sxs-lookup"><span data-stu-id="72566-106">The guidelines are organized as simple recommendations prefixed with the terms *Do*, *Consider*, *Avoid* and *Do not*.</span></span>

* <span data-ttu-id="72566-107">Okuma işlemleri tarafından döndürülen özel türde bir nesne değiştirmeyin (örneğin, `TryPeekAsync` veya `TryGetValueAsync`).</span><span class="sxs-lookup"><span data-stu-id="72566-107">Do not modify an object of custom type returned by read operations (for example, `TryPeekAsync` or `TryGetValueAsync`).</span></span> <span data-ttu-id="72566-108">Eşzamanlı koleksiyonları gibi güvenilir koleksiyonları nesneleri ve bir kopyasını bir başvuru döndürür.</span><span class="sxs-lookup"><span data-stu-id="72566-108">Reliable Collections, just like Concurrent Collections, return a reference to the objects and not a copy.</span></span>
* <span data-ttu-id="72566-109">Derin kopyalama değiştirmeden önce bir özel tür döndürülen nesne yapın.</span><span class="sxs-lookup"><span data-stu-id="72566-109">Do deep copy the returned object of a custom type before modifying it.</span></span> <span data-ttu-id="72566-110">Yapılar ve yerleşik türler geçişi değerli olduğundan, onlar üzerinde derin bir kopya yapmak gerekmez.</span><span class="sxs-lookup"><span data-stu-id="72566-110">Since structs and built-in types are pass-by-value, you do not need to do a deep copy on them.</span></span>
* <span data-ttu-id="72566-111">Kullanmayın `TimeSpan.MaxValue` zaman aşımları için.</span><span class="sxs-lookup"><span data-stu-id="72566-111">Do not use `TimeSpan.MaxValue` for time-outs.</span></span> <span data-ttu-id="72566-112">Zaman aşımları kilitlenmeleri algılamak için kullanılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="72566-112">Time-outs should be used to detect deadlocks.</span></span>
* <span data-ttu-id="72566-113">Bunu kabul edilen, iptal, atıldı veya oluşturulduktan sonra bir işlem kullanmayın.</span><span class="sxs-lookup"><span data-stu-id="72566-113">Do not use a transaction after it has been committed, aborted, or disposed.</span></span>
* <span data-ttu-id="72566-114">Numaralandırma oluşturulduğu işlem kapsamı dışında kullanmayın.</span><span class="sxs-lookup"><span data-stu-id="72566-114">Do not use an enumeration outside of the transaction scope it was created in.</span></span>
* <span data-ttu-id="72566-115">Bir işlem içinde başka bir işlemdeki oluşturmayın `using` deyimi kilitlenmeleri neden.</span><span class="sxs-lookup"><span data-stu-id="72566-115">Do not create a transaction within another transaction’s `using` statement because it can cause deadlocks.</span></span>
* <span data-ttu-id="72566-116">Emin olun, `IComparable<TKey>` uygulamasıdır doğru.</span><span class="sxs-lookup"><span data-stu-id="72566-116">Do ensure that your `IComparable<TKey>` implementation is correct.</span></span> <span data-ttu-id="72566-117">Sistem bağımlılık alır `IComparable<TKey>` kontrol noktalarına ve satır birleştirmek için.</span><span class="sxs-lookup"><span data-stu-id="72566-117">The system takes dependency on `IComparable<TKey>` for merging checkpoints and rows.</span></span>
* <span data-ttu-id="72566-118">Güncelleştirme kilidi belirli bir sınıf kilitlenmelerin önlemek amacıyla güncelleştirmek için bir amaç bir öğesiyle okunurken kullanın.</span><span class="sxs-lookup"><span data-stu-id="72566-118">Do use Update lock when reading an item with an intention to update it to prevent a certain class of deadlocks.</span></span>
* <span data-ttu-id="72566-119">80 Kbayt öğelerinizi (örneğin, TKey + güvenilir sözlüğü için TValue) halde tutmayı düşünün: kadar küçük olursa o kadar iyi olur.</span><span class="sxs-lookup"><span data-stu-id="72566-119">Consider keeping your items (for example, TKey + TValue for Reliable Dictionary) below 80 KBytes: smaller the better.</span></span> <span data-ttu-id="72566-120">Bu, büyük nesne yığın kullanımı yanı sıra disk ve ağ g/ç gereksinimleri miktarını azaltır.</span><span class="sxs-lookup"><span data-stu-id="72566-120">This reduces the amount of Large Object Heap usage as well as disk and network IO requirements.</span></span> <span data-ttu-id="72566-121">Genellikle, yalnızca bir küçük değerinin bir parçası güncelleştirildiğinde yinelenen veri çoğaltmak azaltır.</span><span class="sxs-lookup"><span data-stu-id="72566-121">Often, it reduces replicating duplicate data when only one small part of the value is being updated.</span></span> <span data-ttu-id="72566-122">Bu güvenilir sözlükte elde etmek için genel yoludur, satır birden çok satıra geçirmesini.</span><span class="sxs-lookup"><span data-stu-id="72566-122">Common way to achieve this in Reliable Dictionary, is to break your rows in to multiple rows.</span></span>
* <span data-ttu-id="72566-123">Yedekleme kullanmayı düşünün ve olağanüstü durum kurtarma için işlevselliği geri yükleyin.</span><span class="sxs-lookup"><span data-stu-id="72566-123">Consider using backup and restore functionality to have disaster recovery.</span></span>
* <span data-ttu-id="72566-124">Tek bir varlık işlemleri ve birden çok varlık işlemleri karıştırma önlemek (örneğin `GetCountAsync`, `CreateEnumerableAsync`) farklı yalıtım düzeyi nedeniyle aynı işlem.</span><span class="sxs-lookup"><span data-stu-id="72566-124">Avoid mixing single entity operations and multi-entity operations (e.g `GetCountAsync`, `CreateEnumerableAsync`) in the same transaction due to the different isolation levels.</span></span>
* <span data-ttu-id="72566-125">InvalidOperationException işleyin.</span><span class="sxs-lookup"><span data-stu-id="72566-125">Do handle InvalidOperationException.</span></span> <span data-ttu-id="72566-126">Kullanıcı işlemleri birçok nedenden dolayı sistem tarafından iptal.</span><span class="sxs-lookup"><span data-stu-id="72566-126">User transactions can be aborted by the system for variety of reasons.</span></span> <span data-ttu-id="72566-127">Örneğin, güvenilir durum Yöneticisi rolüne birincil dışında değiştirirken veya uzun süre çalışan işlem, işlem günlüğü kesilmesi engelliyor.</span><span class="sxs-lookup"><span data-stu-id="72566-127">For example, when the Reliable State Manager is changing its role out of Primary or when a long-running transaction is blocking truncation of the transactional log.</span></span> <span data-ttu-id="72566-128">Böyle durumlarda, kullanıcı kendi işlem zaten sonlandırıldı belirten InvalidOperationException alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="72566-128">In such cases, user may receive InvalidOperationException indicating that their transaction has already been terminated.</span></span> <span data-ttu-id="72566-129">Varsayıldığında, işlemin sonlandırılması kullanıcı tarafından bu özel durumu işlemek için en iyi yoldur işlem silmek için istenmemiştir iptal belirteci işaret (veya çoğaltma rolü değiştirildi varsa) onay ve yeni bir oluşturma işlem ve yeniden deneyin.</span><span class="sxs-lookup"><span data-stu-id="72566-129">Assuming, the termination of the transaction was not requested by the user, best way to handle this exception is to dispose the transaction, check if the cancellation token has been signaled (or the role of the replica has been changed), and if not create a new transaction and retry.</span></span>  

<span data-ttu-id="72566-130">Göz önünde bulundurmanız gereken bazı şeyler şunlardır:</span><span class="sxs-lookup"><span data-stu-id="72566-130">Here are some things to keep in mind:</span></span>

* <span data-ttu-id="72566-131">Varsayılan zaman aşımı, tüm güvenilir koleksiyonu API'leri için dört saniyedir.</span><span class="sxs-lookup"><span data-stu-id="72566-131">The default time-out is four seconds for all the Reliable Collection APIs.</span></span> <span data-ttu-id="72566-132">Kullanıcıların çoğunun varsayılan zaman aşımı kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="72566-132">Most users should use the default time-out.</span></span>
* <span data-ttu-id="72566-133">Varsayılan iptal belirteci `CancellationToken.None` tüm güvenilir koleksiyonları API'lerde.</span><span class="sxs-lookup"><span data-stu-id="72566-133">The default cancellation token is `CancellationToken.None` in all Reliable Collections APIs.</span></span>
* <span data-ttu-id="72566-134">Anahtar türü parametre (*TKey*) güvenilir bir sözlük doğru uygulamalıdır için `GetHashCode()` ve `Equals()`.</span><span class="sxs-lookup"><span data-stu-id="72566-134">The key type parameter (*TKey*) for a Reliable Dictionary must correctly implement `GetHashCode()` and `Equals()`.</span></span> <span data-ttu-id="72566-135">Anahtarları sabit olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="72566-135">Keys must be immutable.</span></span>
* <span data-ttu-id="72566-136">Güvenilir koleksiyonlar için yüksek kullanılabilirlik elde etmek için her hizmetin en az bir hedef ve en küçük çoğaltma kümesi boyutu 3 olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="72566-136">To achieve high availability for the Reliable Collections, each service should have at least a target and minimum replica set size of 3.</span></span>
* <span data-ttu-id="72566-137">Okuma işlemleri ikincil kaydedilen çekirdek değildir sürümleri okuyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="72566-137">Read operations on the secondary may read versions that are not quorum committed.</span></span>
  <span data-ttu-id="72566-138">Başka bir deyişle, tek bir ikincil okuma verilerinin sürümü yanlış progressed.</span><span class="sxs-lookup"><span data-stu-id="72566-138">This means that a version of data that is read from a single secondary might be false progressed.</span></span>
  <span data-ttu-id="72566-139">Birincil okuma kararlı her zaman: hiçbir zaman false progressed.</span><span class="sxs-lookup"><span data-stu-id="72566-139">Reads from Primary are always stable: can never be false progressed.</span></span>

### <a name="next-steps"></a><span data-ttu-id="72566-140">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="72566-140">Next steps</span></span>
* [<span data-ttu-id="72566-141">Güvenilir Koleksiyonlar ile çalışma</span><span class="sxs-lookup"><span data-stu-id="72566-141">Working with Reliable Collections</span></span>](service-fabric-work-with-reliable-collections.md)
* [<span data-ttu-id="72566-142">İşlemler ve kilitleri</span><span class="sxs-lookup"><span data-stu-id="72566-142">Transactions and Locks</span></span>](service-fabric-reliable-services-reliable-collections-transactions-locks.md)
* [<span data-ttu-id="72566-143">Güvenilir durum Yöneticisi'ni ve koleksiyon dahili bileşenleri</span><span class="sxs-lookup"><span data-stu-id="72566-143">Reliable State Manager and Collection Internals</span></span>](service-fabric-reliable-services-reliable-collections-internals.md)
* <span data-ttu-id="72566-144">Veri Yönetimi</span><span class="sxs-lookup"><span data-stu-id="72566-144">Managing Data</span></span>
  * [<span data-ttu-id="72566-145">Yedekleme ve Geri Yükleme</span><span class="sxs-lookup"><span data-stu-id="72566-145">Backup and Restore</span></span>](service-fabric-reliable-services-backup-restore.md)
  * [<span data-ttu-id="72566-146">Bildirimler</span><span class="sxs-lookup"><span data-stu-id="72566-146">Notifications</span></span>](service-fabric-reliable-services-notifications.md)
  * [<span data-ttu-id="72566-147">Seri hale getirme ve yükseltme</span><span class="sxs-lookup"><span data-stu-id="72566-147">Serialization and Upgrade</span></span>](service-fabric-application-upgrade-data-serialization.md)
  * [<span data-ttu-id="72566-148">Güvenilir durum Yöneticisi yapılandırması</span><span class="sxs-lookup"><span data-stu-id="72566-148">Reliable State Manager configuration</span></span>](service-fabric-reliable-services-configuration.md)
* <span data-ttu-id="72566-149">Diğer</span><span class="sxs-lookup"><span data-stu-id="72566-149">Others</span></span>
  * [<span data-ttu-id="72566-150">Güvenilir hizmetler hızlı başlangıç</span><span class="sxs-lookup"><span data-stu-id="72566-150">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
  * [<span data-ttu-id="72566-151">Güvenilir koleksiyonlar için Geliştirici Başvurusu</span><span class="sxs-lookup"><span data-stu-id="72566-151">Developer reference for Reliable Collections</span></span>](https://msdn.microsoft.com/library/azure/microsoft.servicefabric.data.collections.aspx)
