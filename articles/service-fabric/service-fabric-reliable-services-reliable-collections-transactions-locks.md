---
title: "Service Fabric güvenilir koleksiyonları işlemleri ve Azure kilit modu | Microsoft Docs"
description: "Azure Service Fabric güvenilir durum Yöneticisi ve güvenilir koleksiyonları işlemleri ve kilitleme."
services: service-fabric
documentationcenter: .net
author: mcoskun
manager: timlt
editor: masnider,rajak
ms.assetid: 62857523-604b-434e-bd1c-2141ea4b00d1
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: required
ms.date: 5/1/2017
ms.author: mcoskun
ms.openlocfilehash: 3452473f5b2f86d29e46339c997193bc6403736a
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="transactions-and-lock-modes-in-azure-service-fabric-reliable-collections"></a><span data-ttu-id="f578d-103">İşlemler ve Azure Service Fabric güvenilir koleksiyonları kilit modu</span><span class="sxs-lookup"><span data-stu-id="f578d-103">Transactions and lock modes in Azure Service Fabric Reliable Collections</span></span>

## <a name="transaction"></a><span data-ttu-id="f578d-104">İşlem</span><span class="sxs-lookup"><span data-stu-id="f578d-104">Transaction</span></span>
<span data-ttu-id="f578d-105">Bir işlem, tek bir mantıksal birim iş olarak gerçekleştirilen işlemler dizisidir.</span><span class="sxs-lookup"><span data-stu-id="f578d-105">A transaction is a sequence of operations performed as a single logical unit of work.</span></span>
<span data-ttu-id="f578d-106">Bir işlem aşağıdaki ACID özellikleri göstermesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="f578d-106">A transaction must exhibit the following ACID properties.</span></span> <span data-ttu-id="f578d-107">(bkz: https://technet.microsoft.com/en-us/library/ms190612)</span><span class="sxs-lookup"><span data-stu-id="f578d-107">(see: https://technet.microsoft.com/en-us/library/ms190612)</span></span>
* <span data-ttu-id="f578d-108">**Kararlılık**: atomik bir iş birimine bir işlem olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="f578d-108">**Atomicity**: A transaction must be an atomic unit of work.</span></span> <span data-ttu-id="f578d-109">Diğer bir deyişle, tüm veri değişiklikleri gerçekleştirilen ya da bunların hiçbiri gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="f578d-109">In other words, either all its data modifications are performed, or none of them is performed.</span></span>
* <span data-ttu-id="f578d-110">**Tutarlılık**: tamamlandığında, bir işlem tüm verileri tutarlı bir durumda bırakmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="f578d-110">**Consistency**: When completed, a transaction must leave all data in a consistent state.</span></span> <span data-ttu-id="f578d-111">Tüm iç veri yapılarını işlemin sonunda doğru olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="f578d-111">All internal data structures must be correct at the end of the transaction.</span></span>
* <span data-ttu-id="f578d-112">**Yalıtım**: eşzamanlı işlemler tarafından yapılan değişiklikler diğer eşzamanlı işlemler tarafından yapılan değişiklikleri üzerinden olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="f578d-112">**Isolation**: Modifications made by concurrent transactions must be isolated from the modifications made by any other concurrent transactions.</span></span> <span data-ttu-id="f578d-113">Bir ITransaction içinde bir işlem için kullanılan yalıtım düzeyi, işlemi gerçekleştiren IReliableState tarafından belirlenir.</span><span class="sxs-lookup"><span data-stu-id="f578d-113">The isolation level used for an operation within an ITransaction is determined by the IReliableState performing the operation.</span></span>
* <span data-ttu-id="f578d-114">**Dayanıklılık**: bir işlem tamamlandıktan sonra etkileri kalıcı olarak sistemde karşılandığından.</span><span class="sxs-lookup"><span data-stu-id="f578d-114">**Durability**: After a transaction has completed, its effects are permanently in place in the system.</span></span> <span data-ttu-id="f578d-115">Değişikliklerin bile bir sistem hatası durumunda kalır.</span><span class="sxs-lookup"><span data-stu-id="f578d-115">The modifications persist even in the event of a system failure.</span></span>

### <a name="isolation-levels"></a><span data-ttu-id="f578d-116">Yalıtım düzeyi</span><span class="sxs-lookup"><span data-stu-id="f578d-116">Isolation levels</span></span>
<span data-ttu-id="f578d-117">Yalıtım düzeyi için işlem diğer işlemler tarafından yapılan değişiklikler üzerinden olmalıdır derece tanımlar.</span><span class="sxs-lookup"><span data-stu-id="f578d-117">Isolation level defines the degree to which the transaction must be isolated from modifications made by other transactions.</span></span>
<span data-ttu-id="f578d-118">Güvenilir koleksiyonlarda desteklenen iki yalıtım düzeyi vardır:</span><span class="sxs-lookup"><span data-stu-id="f578d-118">There are two isolation levels that are supported in Reliable Collections:</span></span>

* <span data-ttu-id="f578d-119">**Yinelenebilir Okuma**: deyimleri değiştirildi, ancak henüz diğer işlemler tarafından kaydedilen veri okunamıyor ve başka bir işlem geçerli işlem kadar geçerli işlem tarafından okunur verileri değiştirebilir belirtir tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="f578d-119">**Repeatable Read**: Specifies that statements cannot read data that has been modified but not yet committed by other transactions and that no other transactions can modify data that has been read by the current transaction until the current transaction finishes.</span></span> <span data-ttu-id="f578d-120">Daha fazla ayrıntı için bkz: [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span><span class="sxs-lookup"><span data-stu-id="f578d-120">For more details, see [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span></span>
* <span data-ttu-id="f578d-121">**Anlık Görüntü**: bir işlemde herhangi bir deyim tarafından okunan veriler işlem başlangıcında var olan verileri işlemsel olarak tutarlı sürümü olduğunu belirtir.</span><span class="sxs-lookup"><span data-stu-id="f578d-121">**Snapshot**: Specifies that data read by any statement in a transaction is the transactionally consistent version of the data that existed at the start of the transaction.</span></span>
  <span data-ttu-id="f578d-122">İşlem yalnızca işlem başlamadan önce kaydedilmiş veri değişiklikleri tanıyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f578d-122">The transaction can recognize only data modifications that were committed before the start of the transaction.</span></span>
  <span data-ttu-id="f578d-123">Geçerli işlem başladıktan sonra diğer işlemler tarafından yapılan veri değişikliklerinin geçerli işlem yürütülürken deyimleri görünür değildir.</span><span class="sxs-lookup"><span data-stu-id="f578d-123">Data modifications made by other transactions after the start of the current transaction are not visible to statements executing in the current transaction.</span></span>
  <span data-ttu-id="f578d-124">İşlem başlangıcında var gibi bir işlem deyimlerinde kaydedilen verilerin bir anlık görüntüsünü alırsanız gibi etkisidir.</span><span class="sxs-lookup"><span data-stu-id="f578d-124">The effect is as if the statements in a transaction get a snapshot of the committed data as it existed at the start of the transaction.</span></span>
  <span data-ttu-id="f578d-125">Anlık görüntüler güvenilir koleksiyonlar genelinde tutarlı değil.</span><span class="sxs-lookup"><span data-stu-id="f578d-125">Snapshots are consistent across Reliable Collections.</span></span>
  <span data-ttu-id="f578d-126">Daha fazla ayrıntı için bkz: [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span><span class="sxs-lookup"><span data-stu-id="f578d-126">For more details, see [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span></span>

<span data-ttu-id="f578d-127">Güvenilir koleksiyonları otomatik olarak hareket oluşturma zamanında işlemi ve çoğaltma rolü bağlı olarak belirli bir okuma işlemi için kullanılacak yalıtım düzeyini seçin.</span><span class="sxs-lookup"><span data-stu-id="f578d-127">Reliable Collections automatically choose the isolation level to use for a given read operation depending on the operation and the role of the replica at the time of transaction's creation.</span></span>
<span data-ttu-id="f578d-128">Güvenilir sözlük ve sıra işlemleri için yalıtım düzeyi varsayılan değerlerini gösterir tablosu aşağıdadır.</span><span class="sxs-lookup"><span data-stu-id="f578d-128">Following is the table that depicts isolation level defaults for Reliable Dictionary and Queue operations.</span></span>

| <span data-ttu-id="f578d-129">İşlem \ rolü</span><span class="sxs-lookup"><span data-stu-id="f578d-129">Operation \ Role</span></span> | <span data-ttu-id="f578d-130">Birincil</span><span class="sxs-lookup"><span data-stu-id="f578d-130">Primary</span></span> | <span data-ttu-id="f578d-131">İkincil</span><span class="sxs-lookup"><span data-stu-id="f578d-131">Secondary</span></span> |
| --- |:--- |:--- |
| <span data-ttu-id="f578d-132">Tek varlık okuma</span><span class="sxs-lookup"><span data-stu-id="f578d-132">Single Entity Read</span></span> |<span data-ttu-id="f578d-133">Yinelenebilir Okuma</span><span class="sxs-lookup"><span data-stu-id="f578d-133">Repeatable Read</span></span> |<span data-ttu-id="f578d-134">Anlık Görüntü</span><span class="sxs-lookup"><span data-stu-id="f578d-134">Snapshot</span></span> |
| <span data-ttu-id="f578d-135">Numaralandırma, sayısı</span><span class="sxs-lookup"><span data-stu-id="f578d-135">Enumeration, Count</span></span> |<span data-ttu-id="f578d-136">Anlık Görüntü</span><span class="sxs-lookup"><span data-stu-id="f578d-136">Snapshot</span></span> |<span data-ttu-id="f578d-137">Anlık Görüntü</span><span class="sxs-lookup"><span data-stu-id="f578d-137">Snapshot</span></span> |

> [!NOTE]
> <span data-ttu-id="f578d-138">Tek varlık işlemleri için ortak örnekler `IReliableDictionary.TryGetValueAsync`, `IReliableQueue.TryPeekAsync`.</span><span class="sxs-lookup"><span data-stu-id="f578d-138">Common examples for Single Entity Operations are `IReliableDictionary.TryGetValueAsync`, `IReliableQueue.TryPeekAsync`.</span></span>
> 

<span data-ttu-id="f578d-139">Sözlüğün güvenilir ve güvenilir sıranın okuma bilgisayarınızı Yazar destekler.</span><span class="sxs-lookup"><span data-stu-id="f578d-139">Both the Reliable Dictionary and the Reliable Queue support Read Your Writes.</span></span>
<span data-ttu-id="f578d-140">Diğer bir deyişle, bir işlem içinde her yazma aynı işlem ait aşağıdaki okuma görünür olacaktır.</span><span class="sxs-lookup"><span data-stu-id="f578d-140">In other words, any write within a transaction will be visible to a following read that belongs to the same transaction.</span></span>

## <a name="locks"></a><span data-ttu-id="f578d-141">Kilitler</span><span class="sxs-lookup"><span data-stu-id="f578d-141">Locks</span></span>
<span data-ttu-id="f578d-142">Kilitleme güvenilir koleksiyonlarında tüm işlemleri uygulama sıkı iki aşama: bir işlem alınan bir durdurma veya bir yürütme ile işlem sonlanana kadar kilitleri bırakmaz.</span><span class="sxs-lookup"><span data-stu-id="f578d-142">In Reliable Collections, all transactions implement rigorous two phase locking: a transaction does not release the locks it has acquired until the transaction terminates with either an abort or a commit.</span></span>

<span data-ttu-id="f578d-143">Güvenilir sözlüğü satır düzeyinde tüm tek bir varlık işlemler için kilitleme kullanır.</span><span class="sxs-lookup"><span data-stu-id="f578d-143">Reliable Dictionary uses row level locking for all single entity operations.</span></span>
<span data-ttu-id="f578d-144">Eşzamanlılık katı işlem FIFO özelliği için devre dışı güvenilir sıra trades.</span><span class="sxs-lookup"><span data-stu-id="f578d-144">Reliable Queue trades off concurrency for strict transactional FIFO property.</span></span>
<span data-ttu-id="f578d-145">Güvenilir kuyruğu kullanan bir işlemle izin verme işlemi düzeyi kilitleri `TryPeekAsync` ve/veya `TryDequeueAsync` ve bir işlemle `EnqueueAsync` birer birer.</span><span class="sxs-lookup"><span data-stu-id="f578d-145">Reliable Queue uses operation level locks allowing one transaction with `TryPeekAsync` and/or `TryDequeueAsync` and one transaction with `EnqueueAsync` at a time.</span></span>
<span data-ttu-id="f578d-146">FIFO, korumak için unutmayın bir `TryPeekAsync` veya `TryDequeueAsync` hiç gözlemleyen güvenilir sıranın boş olduğundan, ayrıca kilitleyecek `EnqueueAsync`.</span><span class="sxs-lookup"><span data-stu-id="f578d-146">Note that to preserve FIFO, if a `TryPeekAsync` or `TryDequeueAsync` ever observes that the Reliable Queue is empty, they will also lock `EnqueueAsync`.</span></span>

<span data-ttu-id="f578d-147">Yazma işlemlerinin her zaman özel kilit alıyor.</span><span class="sxs-lookup"><span data-stu-id="f578d-147">Write operations always take Exclusive locks.</span></span>
<span data-ttu-id="f578d-148">Okuma işlemleri için kilitleme, birkaç etkene bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="f578d-148">For read operations, the locking depends on a couple of factors.</span></span>
<span data-ttu-id="f578d-149">Anlık görüntü yalıtımı kullanılarak gerçekleştirilen okuma işlemi kilidi serbest ' dir.</span><span class="sxs-lookup"><span data-stu-id="f578d-149">Any read operation done using Snapshot isolation is lock free.</span></span>
<span data-ttu-id="f578d-150">Varsayılan olarak tüm yinelenebilir okuma işlemi paylaşılan kilitleri alır.</span><span class="sxs-lookup"><span data-stu-id="f578d-150">Any Repeatable Read operation by default takes Shared locks.</span></span>
<span data-ttu-id="f578d-151">Ancak, yinelenebilir okuma destekleyen tüm okuma işlemi için kullanıcı bir güncelleştirme kilidi paylaşılan kilit yerine isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="f578d-151">However, for any read operation that supports Repeatable Read, the user can ask for an Update lock instead of the Shared lock.</span></span>
<span data-ttu-id="f578d-152">Bir güncelleştirme kilidi birden çok işlem kaynakları daha sonraki bir zamanda potansiyel güncelleştirmeleri kilitlediğinizde gerçekleşen kilitlenme ortak biçimi önlemek için kullanılan bir asimetrik kilidi ' dir.</span><span class="sxs-lookup"><span data-stu-id="f578d-152">An Update lock is an asymmetric lock used to prevent a common form of deadlock that occurs when multiple transactions lock resources for potential updates at a later time.</span></span>

<span data-ttu-id="f578d-153">Kilit uyumluluk matrisi aşağıdaki tabloda bulunabilir:</span><span class="sxs-lookup"><span data-stu-id="f578d-153">The lock compatibility matrix can be found in the following table:</span></span>

| <span data-ttu-id="f578d-154">İstek \ verildi</span><span class="sxs-lookup"><span data-stu-id="f578d-154">Request \ Granted</span></span> | <span data-ttu-id="f578d-155">None</span><span class="sxs-lookup"><span data-stu-id="f578d-155">None</span></span> | <span data-ttu-id="f578d-156">Paylaşılan</span><span class="sxs-lookup"><span data-stu-id="f578d-156">Shared</span></span> | <span data-ttu-id="f578d-157">Güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="f578d-157">Update</span></span> | <span data-ttu-id="f578d-158">Özel</span><span class="sxs-lookup"><span data-stu-id="f578d-158">Exclusive</span></span> |
| --- |:--- |:--- |:--- |:--- |
| <span data-ttu-id="f578d-159">Paylaşılan</span><span class="sxs-lookup"><span data-stu-id="f578d-159">Shared</span></span> |<span data-ttu-id="f578d-160">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-160">No conflict</span></span> |<span data-ttu-id="f578d-161">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-161">No conflict</span></span> |<span data-ttu-id="f578d-162">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-162">Conflict</span></span> |<span data-ttu-id="f578d-163">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-163">Conflict</span></span> |
| <span data-ttu-id="f578d-164">Güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="f578d-164">Update</span></span> |<span data-ttu-id="f578d-165">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-165">No conflict</span></span> |<span data-ttu-id="f578d-166">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-166">No conflict</span></span> |<span data-ttu-id="f578d-167">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-167">Conflict</span></span> |<span data-ttu-id="f578d-168">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-168">Conflict</span></span> |
| <span data-ttu-id="f578d-169">Özel</span><span class="sxs-lookup"><span data-stu-id="f578d-169">Exclusive</span></span> |<span data-ttu-id="f578d-170">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-170">No conflict</span></span> |<span data-ttu-id="f578d-171">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-171">Conflict</span></span> |<span data-ttu-id="f578d-172">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-172">Conflict</span></span> |<span data-ttu-id="f578d-173">Çakışma</span><span class="sxs-lookup"><span data-stu-id="f578d-173">Conflict</span></span> |

<span data-ttu-id="f578d-174">Güvenilir koleksiyonları API'leri zaman aşımı değişkeninde kilitlenme algılama için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="f578d-174">Time-out argument in the Reliable Collections APIs is used for deadlock detection.</span></span>
<span data-ttu-id="f578d-175">Örneğin, iki işlemleri (T1 ve T2) okuma ve güncelleştirme K1 deniyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="f578d-175">For example, two transactions (T1 and T2) are trying to read and update K1.</span></span>
<span data-ttu-id="f578d-176">Her ikisi de paylaşılan kilit sahip end için kilitlenme için mümkündür.</span><span class="sxs-lookup"><span data-stu-id="f578d-176">It is possible for them to deadlock, because they both end up having the Shared lock.</span></span>
<span data-ttu-id="f578d-177">Bu durumda, bir veya iki işlem zaman aşımına uğrar.</span><span class="sxs-lookup"><span data-stu-id="f578d-177">In this case, one or both of the operations will time out.</span></span>

<span data-ttu-id="f578d-178">Bu kilitlenme senaryo, bir güncelleştirme kilidi kilitlenmeleri nasıl engelleyebilirsiniz, harika bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="f578d-178">This deadlock scenario is a great example of how an Update lock can prevent deadlocks.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f578d-179">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="f578d-179">Next steps</span></span>
* [<span data-ttu-id="f578d-180">Güvenilir Koleksiyonlar ile çalışma</span><span class="sxs-lookup"><span data-stu-id="f578d-180">Working with Reliable Collections</span></span>](service-fabric-work-with-reliable-collections.md)
* [<span data-ttu-id="f578d-181">Güvenilir hizmetler bildirimleri</span><span class="sxs-lookup"><span data-stu-id="f578d-181">Reliable Services notifications</span></span>](service-fabric-reliable-services-notifications.md)
* [<span data-ttu-id="f578d-182">Güvenilir hizmetler yedekleme ve geri yükleme (olağanüstü durum kurtarma)</span><span class="sxs-lookup"><span data-stu-id="f578d-182">Reliable Services backup and restore (disaster recovery)</span></span>](service-fabric-reliable-services-backup-restore.md)
* [<span data-ttu-id="f578d-183">Güvenilir durum Yöneticisi yapılandırması</span><span class="sxs-lookup"><span data-stu-id="f578d-183">Reliable State Manager configuration</span></span>](service-fabric-reliable-services-configuration.md)
* [<span data-ttu-id="f578d-184">Güvenilir koleksiyonlar için Geliştirici Başvurusu</span><span class="sxs-lookup"><span data-stu-id="f578d-184">Developer reference for Reliable Collections</span></span>](https://msdn.microsoft.com/library/azure/microsoft.servicefabric.data.collections.aspx)

