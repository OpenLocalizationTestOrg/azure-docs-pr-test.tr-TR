---
title: "aaaHow toobuild herhangi bir Azure AD kullanıcı oturum bir uygulama | Microsoft Docs"
description: "Adım adım bir uygulama oluşturmaya yönelik yönergeler olarak da bilinen bir çok kiracılı uygulama tüm Azure Active Directory kiracısındaki bir kullanıcı olarak oturum açabilir."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 35af95cb-ced3-46ad-b01d-5d2f6fd064a3
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/26/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 123ea8125fa3c308ce0f124cc58e85ec28d476d5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="how-toosign-in-any-azure-active-directory-ad-user-using-hello-multi-tenant-application-pattern"></a><span data-ttu-id="e3fa0-103">Nasıl tüm Azure Active Directory (AD) kullanıcı kullanarak toosign hello çok kiracılı uygulama düzeni</span><span class="sxs-lookup"><span data-stu-id="e3fa0-103">How toosign in any Azure Active Directory (AD) user using hello multi-tenant application pattern</span></span>
<span data-ttu-id="e3fa0-104">Kuruluşların bir hizmet uygulaması toomany bir yazılım teklifi sunuyorsanız, uygulama tooaccept oturum açmalardan tüm Azure AD kiracısı yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-104">If you offer a Software as a Service application toomany organizations, you can configure your application tooaccept sign-ins from any Azure AD tenant.</span></span>  <span data-ttu-id="e3fa0-105">Azure AD'de bu uygulama birden çok Kiracı yapmadan çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-105">In Azure AD this is called making your application multi-tenant.</span></span>  <span data-ttu-id="e3fa0-106">Tüm Azure AD Kiracı kullanıcılar sonra tooyour uygulamada mümkün toosign olur, uygulamanızın hesaplarıyla toouse onaylıyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-106">Users in any Azure AD tenant will be able toosign in tooyour application after consenting toouse their account with your application.</span></span>  

<span data-ttu-id="e3fa0-107">Kendi hesabı sistem veya diğer oturum açma diğer bulut sağlayıcılardan türünü destekler, var olan bir uygulamanız varsa, ekleme Azure AD oturum açma dikey basit bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-107">If you have an existing application that has its own account system, or supports other kinds of sign-in from other cloud providers, adding Azure AD sign-in from any tenant is simple.</span></span> <span data-ttu-id="e3fa0-108">Yalnızca uygulamanızı kaydetme, oturum açma kodu OAuth2, Openıd Connect veya SAML aracılığıyla ekleyin ve "Sign In ile Microsoft" düğmesi, uygulamanızda yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-108">Just register your app, add sign-in code via OAuth2, OpenID Connect, or SAML, and put a "Sign In with Microsoft" button on your application.</span></span> <span data-ttu-id="e3fa0-109">Uygulamanızı markalama hakkında daha fazla düğmesini toolearn aşağıdaki hello'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-109">Click hello following button toolearn more about branding your application.</span></span>

<span data-ttu-id="e3fa0-110">[! [Düğmesini oturum] [AAD-oturum açma]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-110">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="e3fa0-111">Bu makale, zaten Azure AD için tek bir kiracı uygulama oluşturmaya tanıdık varsayar.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-111">This article assumes you’re already familiar with building a single tenant application for Azure AD.</span></span>  <span data-ttu-id="e3fa0-112">Siz değilseniz, head toohello geri [Geliştirici Kılavuzu giriş sayfası] [ AAD-Dev-Guide] ve bizim hızlı başlangıçlar birini deneyin!</span><span class="sxs-lookup"><span data-stu-id="e3fa0-112">If you’re not, head back up toohello [developer guide homepage][AAD-Dev-Guide] and try one of our quick starts!</span></span>

<span data-ttu-id="e3fa0-113">Bir Azure AD çok kiracılı uygulama uygulamanıza dört basit adımda tooconvert vardır:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-113">There are four simple steps tooconvert your application into an Azure AD multi-tenant app:</span></span>

1. <span data-ttu-id="e3fa0-114">Uygulama kayıt toobe çok Kiracı güncelleştir</span><span class="sxs-lookup"><span data-stu-id="e3fa0-114">Update your application registration toobe multi-tenant</span></span>
2. <span data-ttu-id="e3fa0-115">Kod toosend istekleri toohello/Common güncelleştirme bitiş noktası</span><span class="sxs-lookup"><span data-stu-id="e3fa0-115">Update your code toosend requests toohello /common endpoint</span></span> 
3. <span data-ttu-id="e3fa0-116">Kod toohandle birden çok veren değerleri güncelleştirin</span><span class="sxs-lookup"><span data-stu-id="e3fa0-116">Update your code toohandle multiple issuer values</span></span>
4. <span data-ttu-id="e3fa0-117">Kullanıcı ve yönetici onayı anlamak ve uygun kodu değişiklikleri yapın</span><span class="sxs-lookup"><span data-stu-id="e3fa0-117">Understand user and admin consent and make appropriate code changes</span></span>

<span data-ttu-id="e3fa0-118">Her adım ayrıntılı bakalım.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-118">Let’s look at each step in detail.</span></span> <span data-ttu-id="e3fa0-119">Ayrıca düz çok atlayabilirsiniz[bu liste çok kiracılı örnekleri][AAD-Samples-MT].</span><span class="sxs-lookup"><span data-stu-id="e3fa0-119">You can also jump straight too[this list of multi-tenant samples][AAD-Samples-MT].</span></span>

## <a name="update-registration-toobe-multi-tenant"></a><span data-ttu-id="e3fa0-120">Güncelleştirme kayıt toobe çok kiracılı</span><span class="sxs-lookup"><span data-stu-id="e3fa0-120">Update registration toobe multi-tenant</span></span>
<span data-ttu-id="e3fa0-121">Varsayılan olarak, tek bir kiracı web app/API kayıtlar Azure AD'de etkilenir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-121">By default, web app/API registrations in Azure AD are single tenant.</span></span>  <span data-ttu-id="e3fa0-122">Kaydınızı hello "çok kiralanan" geçiş uygulama kaydınızı hello hello özellikleri sayfasında bularak çok kiracılı yapabileceğiniz [Azure portal] [ AZURE-portal] ve çok "Evet" ayarı.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-122">You can make your registration multi-tenant by finding hello “Multi-Tenanted” switch on hello properties page of your application registration in hello [Azure portal][AZURE-portal] and setting it too“Yes”.</span></span>

<span data-ttu-id="e3fa0-123">Ayrıca unutmayın, çok kiracılı bir uygulama yapılabilmesi için önce Azure AD hello hello uygulama toobe genel benzersiz uygulama kimliği URI'sini gerektirir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-123">Also note, before an application can be made multi-tenant, Azure AD requires hello App ID URI of hello application toobe globally unique.</span></span> <span data-ttu-id="e3fa0-124">Merhaba uygulama kimliği URI'si uygulama protokolü iletilerinde tanımlanan hello yollardan biridir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-124">hello App ID URI is one of hello ways an application is identified in protocol messages.</span></span>  <span data-ttu-id="e3fa0-125">Tek kiracılı uygulama için hello uygulama kimliği URI'si toobe Kiracı içinde benzersiz için yeterli olur.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-125">For a single tenant application, it is sufficient for hello App ID URI toobe unique within that tenant.</span></span>  <span data-ttu-id="e3fa0-126">Azure AD arasında tüm kiracılar Merhaba uygulaması bulabilmek için çok kiracılı uygulama için genel olarak benzersiz olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-126">For a multi-tenant application, it must be globally unique so Azure AD can find hello application across all tenants.</span></span>  <span data-ttu-id="e3fa0-127">Genel benzersizlik hello uygulama kimliği URI'si toohave hello Azure AD kiracısı doğrulanmış bir etki alanı ile eşleşen bir ana bilgisayar adı gerektirerek zorlanır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-127">Global uniqueness is enforced by requiring hello App ID URI toohave a host name that matches a verified domain of hello Azure AD tenant.</span></span>  <span data-ttu-id="e3fa0-128">Örneğin, kiracınızın hello adını contoso.onmicrosoft.com sonra geçerli bir ise uygulama kimliği URI'si olması `https://contoso.onmicrosoft.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-128">For example, if hello name of your tenant was contoso.onmicrosoft.com then a valid App ID URI would be `https://contoso.onmicrosoft.com/myapp`.</span></span>  <span data-ttu-id="e3fa0-129">Kiracı doğrulanmış bir etki alanı varsa `contoso.com`, geçerli bir uygulama kimliği URI'sini de sonra `https://contoso.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-129">If your tenant had a verified domain of `contoso.com`, then a valid App ID URI would also be `https://contoso.com/myapp`.</span></span>  <span data-ttu-id="e3fa0-130">Merhaba uygulama kimliği URI'si bu deseni izlemenizi değil çok kiracılı bir uygulama ayarı başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-130">Setting an application as multi-tenant will fail if hello App ID URI doesn’t follow this pattern.</span></span>

<span data-ttu-id="e3fa0-131">Yerel istemci kayıtları varsayılan olarak çok kiracılı.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-131">Native client registrations are multi-tenant by default.</span></span>  <span data-ttu-id="e3fa0-132">Herhangi bir yerel istemci uygulaması kayıt çok kiracılı eylem toomake tootake gerek yoktur.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-132">You don’t need tootake any action toomake a native client application registration multi-tenant.</span></span>

## <a name="update-your-code-toosend-requests-toocommon"></a><span data-ttu-id="e3fa0-133">Kod toosend istekleri çok/ortak güncelleştir</span><span class="sxs-lookup"><span data-stu-id="e3fa0-133">Update your code toosend requests too/common</span></span>
<span data-ttu-id="e3fa0-134">Tek bir kiracı uygulamada oturum açma istekleri toohello kiracının oturum açma uç noktası gönderilir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-134">In a single tenant application, sign-in requests are sent toohello tenant’s sign-in endpoint.</span></span> <span data-ttu-id="e3fa0-135">Örneğin, contoso.onmicrosoft.com için hello uç noktası olur:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-135">For example, for contoso.onmicrosoft.com hello endpoint would be:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="e3fa0-136">Gönderdiği istekleri tooa kiracının endpoint kullanıcılar (veya konuklar) bu Kiracı tooapplications Kiracı içinde oturum açma.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-136">Requests sent tooa tenant’s endpoint can sign in users (or guests) in that tenant tooapplications in that tenant.</span></span>  <span data-ttu-id="e3fa0-137">Çok kiracılı uygulama ile Merhaba uygulaması bilmiyor Önden gönderemiyor böylece, hangi Kiracı hello kullanıcının olduğu tooa kiracının endpoint ister.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-137">With a multi-tenant application, hello application doesn’t know up front what tenant hello user is from, so you can’t send requests tooa tenant’s endpoint.</span></span>  <span data-ttu-id="e3fa0-138">Bunun yerine, tüm Azure AD kiracılar arasında multiplexes tooan endpoint gönderdiği istekleri:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-138">Instead, requests are sent tooan endpoint that multiplexes across all Azure AD tenants:</span></span>

    https://login.microsoftonline.com/common

<span data-ttu-id="e3fa0-139">Azure AD hello bir isteği ne zaman alır/ortak bir uç hello kullanıcı oturum açtığında ve bir sonuç hangi Kiracı hello kullanıcı bulur gibi arasındadır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-139">When Azure AD receives a request on hello /common endpoint, it signs hello user in and as a consequence discovers which tenant hello user is from.</span></span>  <span data-ttu-id="e3fa0-140">Merhaba/ortak uç nokta çalışır tüm Azure AD tarafından desteklenen hello kimlik doğrulama protokolleri: Openıd Connect, OAuth 2.0, SAML 2.0 ve WS-Federasyon.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-140">hello /common endpoint works with all of hello authentication protocols supported by Azure AD:  OpenID Connect, OAuth 2.0, SAML 2.0, and WS-Federation.</span></span>

<span data-ttu-id="e3fa0-141">Merhaba oturum açma yanıt toohello uygulama hello kullanıcıyı temsil eden bir belirteci içeriyor.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-141">hello sign-in response toohello application then contains a token representing hello user.</span></span>  <span data-ttu-id="e3fa0-142">Hello veren değeriyle hello belirteci uygulamanın hangi Kiracı hello kullanıcı arasındadır söyler.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-142">hello issuer value in hello token tells an application what tenant hello user is from.</span></span>  <span data-ttu-id="e3fa0-143">Ne zaman hello bir yanıt döndürür/ortak uç noktası, hello veren değeriyle hello belirtecindeki toohello kullanıcının Kiracı karşılık gelir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-143">When a response returns from hello /common endpoint, hello issuer value in hello token will correspond toohello user’s tenant.</span></span>  <span data-ttu-id="e3fa0-144">Bu önemli toonote hello/ortak uç noktası bir kiracı değil ve bir veren değil, yalnızca çoğaltıcı olduğu.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-144">It’s important toonote hello /common endpoint is not a tenant and is not an issuer, it’s just a multiplexer.</span></span>  <span data-ttu-id="e3fa0-145">/ Common kullanırken, uygulama toovalidate belirteçleri hello mantığı güncelleştirilmiş toobe tootake bu hesaba gerekir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-145">When using /common, hello logic in your application toovalidate tokens needs toobe updated tootake this into account.</span></span> 

<span data-ttu-id="e3fa0-146">Daha önce açıklanan, çok kiracılı uygulamalar da kullanıcılar için tutarlı bir oturum açma deneyimini sağlamalıdır gibi aşağıdaki yönergeleri markalama Azure AD uygulaması hello.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-146">As mentioned earlier, multi-tenant applications should also provide a consistent sign-in experience for users, following hello Azure AD application branding guidelines.</span></span> <span data-ttu-id="e3fa0-147">Uygulamanızı markalama hakkında daha fazla düğmesini toolearn aşağıdaki hello'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-147">Click hello following button toolearn more about branding your application.</span></span>

<span data-ttu-id="e3fa0-148">[! [Düğmesini oturum] [AAD-oturum açma]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-148">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="e3fa0-149">Merhaba/Common hello kullanımını bir göz atalım uç noktası ve kod uygulamanızda daha ayrıntılı bilgi.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-149">Let’s take a look at hello use of hello /common endpoint and your code implementation in more detail.</span></span>

## <a name="update-your-code-toohandle-multiple-issuer-values"></a><span data-ttu-id="e3fa0-150">Kod toohandle birden çok veren değerleri güncelleştirin</span><span class="sxs-lookup"><span data-stu-id="e3fa0-150">Update your code toohandle multiple issuer values</span></span>
<span data-ttu-id="e3fa0-151">Web uygulamaları ve web API'leri alır ve Azure AD'den belirteçleri doğrulamak.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-151">Web applications and web APIs receive and validate tokens from Azure AD.</span></span>  

> [!NOTE]
> <span data-ttu-id="e3fa0-152">Yerel istemci uygulamaları istemek ve Azure AD'den belirteçleri almak olsa da, bunu toosend yaparlar bunları tooAPIs, bunlar burada doğrulanır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-152">While native client applications request and receive tokens from Azure AD, they do so toosend them tooAPIs, where they are validated.</span></span>  <span data-ttu-id="e3fa0-153">Yerel uygulama belirteçleri doğrulamaz ve bunları donuk olarak ele almanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-153">Native applications do not validate tokens and must treat them as opaque.</span></span>
> 
> 

<span data-ttu-id="e3fa0-154">Bakalım Uygulama belirteçleri nasıl doğrular Azure AD'den alır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-154">Let’s look at how an application validates tokens it receives from Azure AD.</span></span>  <span data-ttu-id="e3fa0-155">Tek kiracılı uygulama gibi bir uç nokta değeri normal olarak gösterecektir:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-155">A single tenant application will normally take an endpoint value like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="e3fa0-156">ve meta veri URL'sini (Bu durumda, Openıd Connect) gibi tooconstruct kullanın:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-156">and use it tooconstruct a metadata URL (in this case, OpenID Connect) like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com/.well-known/openid-configuration

<span data-ttu-id="e3fa0-157">kullanılan toovalidate belirteçler olan toodownload iki kritik bilgi parçalarını: hello Kiracı İmzalama anahtarları ve veren değeri.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-157">toodownload two critical pieces of information that are used toovalidate tokens:  hello tenant’s signing keys and issuer value.</span></span>  <span data-ttu-id="e3fa0-158">Her Azure AD kiracısı hello form benzersiz veren değerine sahip:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-158">Each Azure AD tenant has a unique issuer value of hello form:</span></span>

    https://sts.windows.net/31537af4-6d77-4bb9-a681-d2394888ea26/

<span data-ttu-id="e3fa0-159">Burada hello GUID değeri hello yeniden adlandırma güvenli hello Kiracı kimliği hello Kiracı sürümüdür.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-159">where hello GUID value is hello rename-safe version of hello tenant ID of hello tenant.</span></span>  <span data-ttu-id="e3fa0-160">Meta veri bağlantısı için önceki hello tıklatırsanız `contoso.onmicrosoft.com`, bu veren değeriyle hello belgedeki görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-160">If you click on hello preceding metadata link for `contoso.onmicrosoft.com`, you can see this issuer value in hello document.</span></span>

<span data-ttu-id="e3fa0-161">Tek kiracılı uygulama bir belirteç doğrular hello imza hello belirtecinin hello meta veri belgesi anahtarları imzalama hello karşı denetler.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-161">When a single tenant application validates a token, it checks hello signature of hello token against hello signing keys from hello metadata document.</span></span> <span data-ttu-id="e3fa0-162">Bu, toomake emin hello veren değeriyle hello meta veri belgesinde bulunan hello belirteci eşleşmeleri hello bir sağlar.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-162">This allows it toomake sure hello issuer value in hello token matches hello one that was found in hello metadata document.</span></span>

<span data-ttu-id="e3fa0-163">Merhaba itibaren/ortak uç nokta tooa Kiracı karşılık gelmiyor ve bir veren hello meta verilerindeki hello veren değerini inceleyin / genel, gerçek değer yerine şablonlu bir URL'ye sahip değil:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-163">Since hello /common endpoint doesn’t correspond tooa tenant and isn’t an issuer, when you examine hello issuer value in hello metadata for /common it has a templated URL instead of an actual value:</span></span>

    https://sts.windows.net/{tenantid}/

<span data-ttu-id="e3fa0-164">Bu nedenle, çok kiracılı uygulama belirteçleri hello veren değeriyle hello meta hello ile eşleştirerek doğrulayamıyor `issuer` hello belirteç değeri.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-164">Therefore, a multi-tenant application can’t validate tokens just by matching hello issuer value in hello metadata with hello `issuer` value in hello token.</span></span>  <span data-ttu-id="e3fa0-165">Çok kiracılı uygulama mantığını toodecide hangi veren değerler geçerlidir ve hangi olan gereksinim duyar değil, hello Kiracı'hello veren değeriyle kimliği bölümünü tabanlı.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-165">A multi-tenant application needs logic toodecide which issuer values are valid and which are not, based on hello tenant ID portion of hello issuer value.</span></span>  

<span data-ttu-id="e3fa0-166">Çok kiracılı uygulama yalnızca kendi hizmet için kaydolup, belirli kiracıdan oturum açma izin veriyorsa, örneğin, sonra hello veren değer veya hello kullanıma gerekir `tid` talep değeri hello belirteci toomake Kiracı kendi listesinde olduğundan emin olarak Aboneler.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-166">For example, if a multi-tenant application only allows sign-in from specific tenants who have signed up for their service, then it must check either hello issuer value or hello `tid` claim value in hello token toomake sure that tenant is in their list of subscribers.</span></span>  <span data-ttu-id="e3fa0-167">Çok kiracılı uygulama yalnızca kişiler ile ilgilenir ve kiracılar dayanarak hiçbir erişim kararları değil, ardından hello veren değeriyle tamamen yok sayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-167">If a multi-tenant application only deals with individuals and doesn’t make any access decisions based on tenants, then it can ignore hello issuer value altogether.</span></span>

<span data-ttu-id="e3fa0-168">Merhaba hello çok kiracılı örneklerindeki [ilgili içerik](#related-content) bu makalede, veren doğrulama hello sonunda bölümdür devre dışı tooenable tüm Azure AD Kiracı toosign.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-168">In hello multi-tenant samples in hello [Related Content](#related-content) section at hello end of this article, issuer validation is disabled tooenable any Azure AD tenant toosign in.</span></span>

<span data-ttu-id="e3fa0-169">Şimdi toomulti Kiracı uygulamalarda imzalama kullanıcıların hello kullanıcı deneyimini bakalım.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-169">Now let’s look at hello user experience for users that are signing in toomulti-tenant applications.</span></span>

## <a name="understanding-user-and-admin-consent"></a><span data-ttu-id="e3fa0-170">Anlama kullanıcı ve yönetici onayı</span><span class="sxs-lookup"><span data-stu-id="e3fa0-170">Understanding user and admin consent</span></span>
<span data-ttu-id="e3fa0-171">Azure AD'de tooan uygulamada bir kullanıcı toosign için Merhaba uygulaması hello kullanıcının Kiracı gösterilmelidir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-171">For a user toosign in tooan application in Azure AD, hello application must be represented in hello user’s tenant.</span></span>  <span data-ttu-id="e3fa0-172">Bu, kendi Kiracı kullanıcılardan toohello uygulamada oturum açtığınızda benzersiz ilkeleri uygulamak gibi toodo işlemler hello kuruluşunuzun olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-172">This allows hello organization toodo things like apply unique policies when users from their tenant sign in toohello application.</span></span>  <span data-ttu-id="e3fa0-173">Tek kiracılı uygulama için bu kayıt kolaydır; Bunu sahip hello hello Merhaba uygulaması kaydederken oluşan bir [Azure portal][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="e3fa0-173">For a single tenant application, this registration is simple; it’s hello one that happens when you register hello application in hello [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="e3fa0-174">Çok kiracılı uygulama için hello uygulama hello ilk kaydı hello geliştirici tarafından kullanılan hello Azure AD kiracısında yaşar.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-174">For a multi-tenant application, hello initial registration for hello application lives in hello Azure AD tenant used by hello developer.</span></span>  <span data-ttu-id="e3fa0-175">Farklı bir kiracısındaki bir kullanıcı toohello uygulamada hello için ilk kez oturum açtığında, Azure AD hello uygulama tarafından istenen tooconsent toohello izinleri ister.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-175">When a user from a different tenant signs in toohello application for hello first time, Azure AD asks them tooconsent toohello permissions requested by hello application.</span></span>  <span data-ttu-id="e3fa0-176">Bunlar onayı sonra Merhaba uygulaması gösterimini adlı bir *hizmet sorumlusu* oluşturulan kullanıcının Kiracı hello ve oturum açma işlemi devam edebilir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-176">If they consent, then a representation of hello application called a *service principal* is created in hello user’s tenant, and sign-in can continue.</span></span> <span data-ttu-id="e3fa0-177">Bir temsilci da hello kullanıcının onayı toohello uygulamasını kaydeder hello dizinde oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-177">A delegation is also created in hello directory that records hello user’s consent toohello application.</span></span> <span data-ttu-id="e3fa0-178">Bkz: [uygulama ve hizmet sorumlusu nesneleri] [ AAD-App-SP-Objects] hello uygulamanın uygulama ve ServicePrincipal nesneleri ve ne tooeach diğer ilişkili oldukları hakkında ayrıntılı bilgi için.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-178">See [Application Objects and Service Principal Objects][AAD-App-SP-Objects] for details on hello application's Application and ServicePrincipal objects, and how they relate tooeach other.</span></span>

![Onay toosingle katmanlı uygulama][Consent-Single-Tier] 

<span data-ttu-id="e3fa0-180">Bu onayı deneyimi hello uygulama tarafından istenen hello izinleri etkilenir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-180">This consent experience is affected by hello permissions requested by hello application.</span></span>  <span data-ttu-id="e3fa0-181">Azure AD, yalnızca uygulama ve temsilci izinleri iki tür destekler:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-181">Azure AD supports two kinds of permissions, app-only and delegated:</span></span>

* <span data-ttu-id="e3fa0-182">Oturum açmış olan kullanıcının hello şeyler hello kullanıcı alt kümeleri için yaptığınız gibi bir uygulama hello özelliği tooact bir temsilci izin verir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-182">A delegated permission grants an application hello ability tooact as a signed in user for a subset of hello things hello user can do.</span></span>  <span data-ttu-id="e3fa0-183">Örneğin, kullanıcının takvimde imzalı bir uygulama hello temsilci izni tooread hello verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-183">For example, you can grant an application hello delegated permission tooread hello signed in user’s calendar.</span></span>
* <span data-ttu-id="e3fa0-184">Yalnızca uygulama izni doğrudan Merhaba uygulaması toohello kimliği verilir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-184">An app-only permission is granted directly toohello identity of hello application.</span></span>  <span data-ttu-id="e3fa0-185">Örneğin, bir uygulama hello yalnızca uygulama izni tooread hello kullanıcıların listesini toohello uygulamada imzalanmış bakılmaksızın bir kiracıdaki verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-185">For example, you can grant an application hello app-only permission tooread hello list of users in a tenant, regardless of who is signed in toohello application.</span></span>

<span data-ttu-id="e3fa0-186">Diğer bir kiracı yöneticisinin iznini gerektirirken bazı izinler razı tooby normal bir kullanıcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-186">Some permissions can be consented tooby a regular user, while others require a tenant administrator’s consent.</span></span> 

### <a name="admin-consent"></a><span data-ttu-id="e3fa0-187">Yönetici onayı</span><span class="sxs-lookup"><span data-stu-id="e3fa0-187">Admin consent</span></span>
<span data-ttu-id="e3fa0-188">Yalnızca uygulama izinleri her zaman bir kiracı yönetici izni gerektirir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-188">App-only permissions always require a tenant administrator’s consent.</span></span>  <span data-ttu-id="e3fa0-189">Uygulamanızı bir yalnızca uygulama izni ister ve toosign toohello uygulamada bir kullanıcı çalışırsa, hello kullanıcı mümkün tooconsent değil bildiren bir hata iletisi görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-189">If your application requests an app-only permission and a user tries toosign in toohello application, an error message will be displayed saying hello user isn’t able tooconsent.</span></span>

<span data-ttu-id="e3fa0-190">Belirli izinlere temsilci, ayrıca bir kiracı yönetici izni gerektirir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-190">Certain delegated permissions also require a tenant administrator’s consent.</span></span>  <span data-ttu-id="e3fa0-191">Örneğin, hello özelliği toowrite geri tooAzure AD kullanıcı imzalı hello olarak bir kiracı yönetici izni gerektirir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-191">For example, hello ability toowrite back tooAzure AD as hello signed in user requires a tenant administrator’s consent.</span></span>  <span data-ttu-id="e3fa0-192">Sıradan bir kullanıcı yönetici izni gerektiren bir temsilci izni isteklerini tooan uygulamada toosign çalışırsa, yalnızca uygulama izinleri gibi uygulamanızı hata iletisi alırsınız.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-192">Like app-only permissions, if an ordinary user tries toosign in tooan application that requests a delegated permission that requires administrator consent, your application will receive an error.</span></span>  <span data-ttu-id="e3fa0-193">İzin gerektirip gerektirmediğini yönetici onayı hello kaynak yayımlanan hello geliştirici tarafından belirlenir ve hello kaynak hello belgelerinde bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-193">Whether or not a permission requires admin consent is determined by hello developer that published hello resource, and can be found in hello documentation for hello resource.</span></span>  <span data-ttu-id="e3fa0-194">Bağlantılar için hello Azure AD grafik API'si ve Microsoft Graph API hello hello izinleri açıklayan tootopics [ilgili içerik](#related-content) bu makalenin.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-194">Links tootopics describing hello available permissions for hello Azure AD Graph API and Microsoft Graph API are in hello [Related Content](#related-content) section of this article.</span></span>

<span data-ttu-id="e3fa0-195">Uygulamanızı yönetici izni gerektiren izinleri kullanıyorsa, toohave düğmesini veya hello Yöneticisi hello eylem burada başlatabilirsiniz bağlantısını gibi hareket gerekir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-195">If your application uses permissions that require admin consent, you need toohave a gesture such as a button or link where hello admin can initiate hello action.</span></span>  <span data-ttu-id="e3fa0-196">Uygulamanız bu eylemi normal bir OAuth2/Openıd Connect yetkilendirme isteği değildir ancak hello de içeren gönderir hello isteği `prompt=admin_consent` sorgu dizesi parametresi.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-196">hello request your application sends for this action is a usual OAuth2/OpenID Connect authorization request, but that also includes hello `prompt=admin_consent` query string parameter.</span></span>  <span data-ttu-id="e3fa0-197">Hello Yöneticisi rıza ve hello hizmet sorumlusu hello müşterinin Kiracı içinde oluşturulan sonra sonraki oturum açma istekleri hello gerekmez `prompt=admin_consent` parametresi.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-197">Once hello admin has consented and hello service principal is created in hello customer’s tenant, subsequent sign-in requests do not need hello `prompt=admin_consent` parameter.</span></span> <span data-ttu-id="e3fa0-198">Merhaba yönetici izinleri kabul edilebilir hello istenen karar vermiştir beri hello kiracısında başka hiçbir kullanıcı o noktadan izin istenir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-198">Since hello administrator has decided hello requested permissions are acceptable, no other users in hello tenant will be prompted for consent from that point forward.</span></span>

<span data-ttu-id="e3fa0-199">Merhaba `prompt=admin_consent` parametresi da yönetici onayı gerektirmeyen izinleri gerektiren uygulamalar tarafından kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-199">hello `prompt=admin_consent` parameter can also be used by applications that request permissions that do not require admin consent.</span></span> <span data-ttu-id="e3fa0-200">Merhaba uygulama bir deneyim gerektirdiğinde bu burada hello Kiracı Yöneticisi "kaydolduğunda" yapılır bir saat ve başka kullanıcılara sorulur o noktadan itibaren izin üzerinde.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-200">This is done when hello applicaton requires an experience where hello tenant admin “signs up” one time, and no other users are prompted for consent from that point on.</span></span>

<span data-ttu-id="e3fa0-201">Bir uygulama yönetici izni gerektirir ve bir yönetici, ancak hello imzalar `prompt=admin_consent` parametresi gönderilmez, hello Yöneticisi başarıyla toohello uygulama onay **yalnızca kullanıcı hesapları için**.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-201">If an application requires admin consent, and an admin signs in but hello `prompt=admin_consent` parameter is not sent, hello admin will successfully consent toohello application **only for their user account**.</span></span>  <span data-ttu-id="e3fa0-202">Normal kullanıcılar yine de mümkün toosign ve onay toohello uygulama olmaz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-202">Regular users will still not be able toosign in and consent toohello application.</span></span>  <span data-ttu-id="e3fa0-203">Bu, diğer kullanıcılar erişime izin vermeden önce uygulamanızın toogive hello Kiracı yönetici hello özelliği tooexplore istiyorsanız kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-203">This is useful if you want toogive hello tenant administrator hello ability tooexplore your application before allowing other users access.</span></span>

<span data-ttu-id="e3fa0-204">Kiracı Yöneticisi normal kullanıcıların tooconsent tooapplications hello özelliği devre dışı bırakabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-204">A tenant administrator can disable hello ability for regular users tooconsent tooapplications.</span></span>  <span data-ttu-id="e3fa0-205">Bu özelliği devre dışıysa, yönetici onayı her zaman hello uygulama toobe hello kiracısında ayarlamak için gereklidir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-205">If this capability is disabled, admin consent is always required for hello application toobe set up in hello tenant.</span></span>  <span data-ttu-id="e3fa0-206">Normal kullanıcı izni uygulamanızla devre dışı tootest istiyorsanız, hello yapılandırma anahtarı hello Azure AD kiracısında hello yapılandırma bölümünde bulabilirsiniz [Azure portal][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="e3fa0-206">If you want tootest your application with regular user consent disabled, you can find hello configuration switch in hello Azure AD tenant configuration section of hello [Azure portal][AZURE-portal].</span></span>

> [!NOTE]
> <span data-ttu-id="e3fa0-207">Bazı uygulamalar, nerede normal kullanıcılar mümkün tooconsent başlangıçta ve sonraki Merhaba uygulaması hello yönetici ve yönetici izni gerektiren istek izinlerine içerebileceği bir deneyim istiyor.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-207">Some applications want an experience where regular users are able tooconsent initially, and later hello application can involve hello administrator and request permissions that require admin consent.</span></span>  <span data-ttu-id="e3fa0-208">Yoktur hiçbir şekilde toodo bu bir tek bir uygulama kaydı bugün Azure AD'de.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-208">There is no way toodo this with a single application registration in Azure AD today.</span></span>  <span data-ttu-id="e3fa0-209">Merhaba yaklaşan Azure AD v2 endpoint uygulamaları toorequest izinler çalışma zamanında yerine bu senaryo etkinleştirecek kayıt aynı anda izin verir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-209">hello upcoming Azure AD v2 endpoint will allow applications toorequest permissions at runtime, instead of at registration time, which will enable this scenario.</span></span>  <span data-ttu-id="e3fa0-210">Daha fazla bilgi için bkz: Merhaba [Azure AD uygulama modeli v2 Geliştirici Kılavuzu][AAD-V2-Dev-Guide].</span><span class="sxs-lookup"><span data-stu-id="e3fa0-210">For more information, see hello [Azure AD App Model v2 Developer Guide][AAD-V2-Dev-Guide].</span></span>
> 
> 

### <a name="consent-and-multi-tier-applications"></a><span data-ttu-id="e3fa0-211">İzin ve çok katmanlı uygulamalar</span><span class="sxs-lookup"><span data-stu-id="e3fa0-211">Consent and multi-tier applications</span></span>
<span data-ttu-id="e3fa0-212">Uygulamanız birden çok katman olabilir, her kendi kayıt tarafından Azure AD'de temsil.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-212">Your application may have multiple tiers, each represented by its own registration in Azure AD.</span></span>  <span data-ttu-id="e3fa0-213">Örneğin, bir web API çağrılarının yerel bir uygulama veya bir web uygulaması, web API çağırır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-213">For example, a native application that calls a web API, or a web application that calls a web API.</span></span>  <span data-ttu-id="e3fa0-214">Bu durumların her ikisinde hello istemci (yerel uygulama veya web uygulaması) izinleri toocall hello kaynak (web API) ister.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-214">In both of these cases, hello client (native app or web app) requests permissions toocall hello resource (web API).</span></span>  <span data-ttu-id="e3fa0-215">Merhaba istemci toobe başarıyla bir müşterinin Kiracı rıza için izinleri isteyen tüm kaynakları toowhich hello Müşteri'nin kiracısında önceden var olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-215">For hello client toobe successfully consented into a customer’s tenant, all resources toowhich it requests permissions must already exist in hello customer’s tenant.</span></span>  <span data-ttu-id="e3fa0-216">Bu koşul değil, Azure AD kaynak hello hatayla ilk eklenmelidir döndürür.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-216">If this condition isn’t met, Azure AD will return an error that hello resource must be added first.</span></span>

<span data-ttu-id="e3fa0-217">**Tek bir kiracı içinde birden çok katmanları**</span><span class="sxs-lookup"><span data-stu-id="e3fa0-217">**Multiple tiers in a single tenant**</span></span>

<span data-ttu-id="e3fa0-218">Mantıksal uygulamanızı iki veya daha fazla uygulama kayıtları, örneğin ayrı istemci ve kaynak oluşuyorsa bu bir sorun olabilir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-218">This can be a problem if your logical application consists of two or more application registrations, for example a separate client and resource.</span></span>  <span data-ttu-id="e3fa0-219">Nasıl hello kaynak hello müşteri Kiracı ilk alıyorsunuz?</span><span class="sxs-lookup"><span data-stu-id="e3fa0-219">How do you get hello resource into hello customer tenant first?</span></span>  <span data-ttu-id="e3fa0-220">Bu durumda istemci etkinleştirerek Azure AD kapsar ve tek bir adımda kaynak toobe rıza.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-220">Azure AD covers this case by enabling client and resource toobe consented in a single step.</span></span> <span data-ttu-id="e3fa0-221">Merhaba kullanıcı hello toplamının hello istemci ve kaynak hello onay sayfasında tarafından istenen hello izinleri görür.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-221">hello user sees hello sum total of hello permissions requested by both hello client and resource on hello consent page.</span></span>  <span data-ttu-id="e3fa0-222">tooenable Bu davranış hello istemcinin uygulama kimliği olarak hello kaynağın uygulama kaydı içermelidir bir `knownClientApplications` kendi uygulama bildiriminde.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-222">tooenable this behavior, hello resource’s application registration must include hello client’s App ID as a `knownClientApplications` in its application manifest.</span></span>  <span data-ttu-id="e3fa0-223">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-223">For example:</span></span>

    knownClientApplications": ["94da0930-763f-45c7-8d26-04d5938baab2"]

<span data-ttu-id="e3fa0-224">Bu özellik aracılığıyla hello kaynağa güncelleştirilebilir [uygulama bildirimi][AAD-App-Manifest].</span><span class="sxs-lookup"><span data-stu-id="e3fa0-224">This property can be updated via hello resource [application’s manifest][AAD-App-Manifest].</span></span> <span data-ttu-id="e3fa0-225">Bu web API'si örneğinin hello çağırma çok katmanlı bir yerel İstemcisi'nde gösterilen [ilgili içerik](#related-content) hello bu makalenin sonunda bölüm.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-225">This is demonstrated in a multi-tier native client calling web API sample in hello [Related Content](#related-content) section at hello end of this article.</span></span> <span data-ttu-id="e3fa0-226">Merhaba Aşağıdaki diyagramda izin genel bir bakış için tek bir kiracı kayıtlı çok katmanlı bir uygulama sağlar:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-226">hello following diagram provides an overview of consent for a multi-tier app registered in a single tenant :</span></span>

![Toomulti katman bilinen istemci uygulaması onayı][Consent-Multi-Tier-Known-Client] 

<span data-ttu-id="e3fa0-228">**Birden çok Kiracı içinde birden çok katmanları**</span><span class="sxs-lookup"><span data-stu-id="e3fa0-228">**Multiple tiers in multiple tenants**</span></span>

<span data-ttu-id="e3fa0-229">Bir uygulama farklı katmanlarda Hello farklı kiracılar kayıtlı benzer bir durumda olur.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-229">A similar case happens if hello different tiers of an application are registered in different tenants.</span></span>  <span data-ttu-id="e3fa0-230">Örneğin, Office 365 Exchange Online API hello çağıran bir yerel istemci uygulaması oluşturmanın hello durumu göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-230">For example, consider hello case of building a native client application that calls hello Office 365 Exchange Online API.</span></span>  <span data-ttu-id="e3fa0-231">toodevelop hello yerel uygulama ve daha yeni bir müşterinin Kiracı içinde hello yerel uygulama toorun, hello Exchange Online hizmet sorumlusu mevcut olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-231">toodevelop hello native application, and later for hello native application toorun in a customer’s tenant, hello Exchange Online service principal must be present.</span></span>  <span data-ttu-id="e3fa0-232">Bu durumda, hello Geliştirici ve müşteri Exchange Online hello hizmet asıl toobe kiracıları içinde oluşturulan için satın almanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-232">In this case, hello developer and customer must purchase Exchange Online for hello service principal toobe created in their tenants.</span></span>  

<span data-ttu-id="e3fa0-233">Microsoft dışındaki bir kuruluş tarafından oluşturulan bir API Hello durumda hello geliştiricisi hello API, müşterilerin kiracılar kendi müşteriler tooconsent hello uygulamasına için tooprovide bir yol gerekir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-233">In hello case of an API built by an organization other than Microsoft, hello developer of hello API needs tooprovide a way for their customers tooconsent hello application into their customers' tenants.</span></span> <span data-ttu-id="e3fa0-234">Merhaba sağlayacak şekilde bir web istemcisi tooimplement kaydolma çalışabilir tasarım hello 3 taraf geliştirici toobuild hello için API önerilir:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-234">hello recommended design is for hello 3rd party developer toobuild hello API such that it can also function as a web client tooimplement sign-up :</span></span>

1. <span data-ttu-id="e3fa0-235">Merhaba izleyin önceki bölümlerde tooensure hello API uygulayan hello çok kiracılı uygulama kaydı/kodu gereksinimleri</span><span class="sxs-lookup"><span data-stu-id="e3fa0-235">Follow hello earlier sections tooensure hello API implements hello multi-tenant application registration/code requirements</span></span>
2. <span data-ttu-id="e3fa0-236">Buna ek olarak tooexposing hello API'nin kapsamları/rolleri, emin hello kayıt içerir hello "oturum açın ve kullanıcı profilini okuma" (varsayılan olarak sağlanır) Azure AD izni</span><span class="sxs-lookup"><span data-stu-id="e3fa0-236">In addition tooexposing hello API's scopes/roles, ensure hello registration includes hello "Sign in and read user profile" Azure AD permission (provided by default)</span></span>
3. <span data-ttu-id="e3fa0-237">Bir oturum-açma/kaydolma sayfası hello web istemcisi hello aşağıdaki uygulamak [yönetici onayı](#admin-consent) Kılavuzu daha önce ele alınan</span><span class="sxs-lookup"><span data-stu-id="e3fa0-237">Implement a sign-in/sign-up page in hello web client, following hello [admin consent](#admin-consent) guidance discussed earlier</span></span> 
4. <span data-ttu-id="e3fa0-238">Merhaba kullanıcı toohello uygulama izin sonra hello hizmet asıl ve onay temsilci bağlantılar kendi Kiracı içinde oluşturulur ve hello yerel uygulama hello API için belirteç alabilir</span><span class="sxs-lookup"><span data-stu-id="e3fa0-238">Once hello user consents toohello application, hello service principal and consent delegation links are created in their tenant, and hello native application can get tokens for hello API</span></span>

<span data-ttu-id="e3fa0-239">Diyagram aşağıdaki hello farklı kiracılar kayıtlı çok katmanlı bir uygulama için izin genel bir bakış sağlar:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-239">hello following diagram provides an overview of consent for a multi-tier app registered in different tenants:</span></span>

![Çok kişili toomulti katmanlı uygulama onayı][Consent-Multi-Tier-Multi-Party] 

### <a name="revoking-consent"></a><span data-ttu-id="e3fa0-241">İzni iptal etme</span><span class="sxs-lookup"><span data-stu-id="e3fa0-241">Revoking Consent</span></span>
<span data-ttu-id="e3fa0-242">Kullanıcıların ve yöneticilerin onayı tooyour uygulamasını dilediğiniz zaman iptal edebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="e3fa0-242">Users and administrators can revoke consent tooyour application at any time:</span></span>

* <span data-ttu-id="e3fa0-243">Bunları kaldırarak kullanıcılar revoke erişim tooindividual uygulamaları kendi [erişim paneli uygulamaları] [ AAD-Access-Panel] listesi.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-243">Users revoke access tooindividual applications by removing them from their [Access Panel Applications][AAD-Access-Panel] list.</span></span>
* <span data-ttu-id="e3fa0-244">Yöneticiler, hello Azure AD Yönetimi hello bölümünü kullanarak Azure AD'den kaldırarak erişim tooapplications iptal etme [Azure portal][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="e3fa0-244">Administrators revoke access tooapplications by removing them from Azure AD using hello Azure AD management section of hello [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="e3fa0-245">Yönetici bir kiracıdaki tüm kullanıcılar için tooan uygulama bulursa, kullanıcılar tek tek erişim iptal edilemez.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-245">If an administrator consents tooan application for all users in a tenant, users cannot revoke access individually.</span></span>  <span data-ttu-id="e3fa0-246">Merhaba yönetici erişimi iptal edebilirsiniz yalnızca ve yalnızca hello tüm uygulama için.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-246">Only hello administrator can revoke access, and only for hello whole application.</span></span>

### <a name="consent-and-protocol-support"></a><span data-ttu-id="e3fa0-247">İzin ve protokol desteği</span><span class="sxs-lookup"><span data-stu-id="e3fa0-247">Consent and Protocol Support</span></span>
<span data-ttu-id="e3fa0-248">Onay hello OAuth, Openıd Connect, aracılığıyla Azure AD'de desteklenir WS-Federation ve SAML protokoller.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-248">Consent is supported in Azure AD via hello OAuth, OpenID Connect, WS-Federation, and SAML protocols.</span></span>  <span data-ttu-id="e3fa0-249">Merhaba SAML ve WS-Federasyon protokollerini hello desteklemeyen `prompt=admin_consent` yönetici izni yalnızca OAuth ve Openıd Connect aracılığıyla mümkün olması için parametre.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-249">hello SAML and WS-Federation protocols do not support hello `prompt=admin_consent` parameter, so admin consent is only possible via OAuth and OpenID Connect.</span></span>

## <a name="multi-tenant-applications-and-caching-access-tokens"></a><span data-ttu-id="e3fa0-250">Çok Kiracılı uygulamalara ve erişim belirteçleri önbelleğe alma</span><span class="sxs-lookup"><span data-stu-id="e3fa0-250">Multi-Tenant Applications and Caching Access Tokens</span></span>
<span data-ttu-id="e3fa0-251">Çok kiracılı uygulamalara erişim belirteçleri toocall Azure AD tarafından korunan API'lerini de alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-251">Multi-tenant applications can also get access tokens toocall APIs that are protected by Azure AD.</span></span>  <span data-ttu-id="e3fa0-252">Merhaba Active Directory Authentication Library (ADAL) çok kiracılı uygulama ile kullanırken yaygın görülen bir hata olduğundan tooinitially istek/Common kullanarak bir kullanıcı için bir belirteç, yanıt ve sonra da/Common kullanarak, aynı kullanıcı için bir sonraki belirteç isteği.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-252">A common error when using hello Active Directory Authentication Library (ADAL) with a multi-tenant application, is tooinitially request a token for a user using /common, receive a response, then request a subsequent token for that same user also using /common.</span></span>  <span data-ttu-id="e3fa0-253">Merhaba yanıt Azure AD'den bir kiracıdan gelen değil/hello kiracısı olarak hello belirteci ortak, ADAL önbelleğe beri.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-253">Since hello response from Azure AD comes from a tenant, not /common, ADAL caches hello token as being from hello tenant.</span></span> <span data-ttu-id="e3fa0-254">Merhaba sonraki hello kullanıcı isabetsiz hello önbellek girişi ve hello kullanıcı için bir erişim belirteci yeniden istendiğinde toosign içinde olduğu çok/ortak tooget çağırın.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-254">hello subsequent call too/common tooget an access token for hello user misses hello cache entry, and hello user is prompted toosign in again.</span></span>  <span data-ttu-id="e3fa0-255">Merhaba önbellek eksik tooavoid, zaten oturum açmış olan kullanıcı için yapma emin sonraki çağrılar toohello kiracının endpoint yapılır.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-255">tooavoid missing hello cache, make sure subsequent calls for an already signed in user are made toohello tenant’s endpoint.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e3fa0-256">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="e3fa0-256">Next steps</span></span>
<span data-ttu-id="e3fa0-257">Bu makalede, nasıl öğrenilen toobuild uygulamanın tüm Azure Active Directory kiracısındaki bir kullanıcı oturum açabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-257">In this article, you learned how toobuild an application that can sign in a user from any Azure Active Directory tenant.</span></span> <span data-ttu-id="e3fa0-258">Çoklu oturum açma uygulama ve Azure Active Directory arasında etkinleştirdikten sonra uygulama tooaccess Office 365 gibi Microsoft kaynakları tarafından sunulan API'ları da güncelleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-258">After enabling Single Sign-On between your app and Azure Active Directory, you can also update your application tooaccess APIs exposed by Microsoft resources, like Office 365.</span></span> <span data-ttu-id="e3fa0-259">Bu nedenle örneğin bağlamsal bilgileri kendi profil resmi veya kendi sonraki takvim randevu gibi toohello kullanıcıları gösteren, uygulamanızda kişiselleştirilmiş bir deneyim sunabilir.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-259">So you can offer a personalized experience in your application, for example showing contextual information toohello users, like their profile picture or their next calendar appointment.</span></span> <span data-ttu-id="e3fa0-260">API yapma hakkında daha fazla toolearn tooAzure Active Directory çağırır ve Exchange, SharePoint, OneDrive, OneNote, Planlayıcısı, Excel ve daha fazlası gibi Office 365 hizmetlerini ziyaret edin: [Microsoft Graph API][MSFT-Graph-overview].</span><span class="sxs-lookup"><span data-stu-id="e3fa0-260">toolearn more about making API calls tooAzure Active Directory and Office 365 services like Exchange, SharePoint, OneDrive, OneNote, Planner, Excel and more, visit: [Microsoft Graph API][MSFT-Graph-overview].</span></span>


## <a name="related-content"></a><span data-ttu-id="e3fa0-261">İlgili içerik</span><span class="sxs-lookup"><span data-stu-id="e3fa0-261">Related content</span></span>
* <span data-ttu-id="e3fa0-262">[Çok kiracılı uygulama örnekleri][AAD-Samples-MT]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-262">[Multi-tenant application samples][AAD-Samples-MT]</span></span>
* <span data-ttu-id="e3fa0-263">[Uygulamalar için markalama talimatları][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-263">[Branding Guidelines for Applications][AAD-App-Branding]</span></span>
* <span data-ttu-id="e3fa0-264">[Azure AD Geliştirici Kılavuzu][AAD-Dev-Guide]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-264">[Azure AD Developer's Guide][AAD-Dev-Guide]</span></span>
* <span data-ttu-id="e3fa0-265">[Uygulama nesneleri ve hizmet sorumlusu nesneleri][AAD-App-SP-Objects]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-265">[Application Objects and Service Principal Objects][AAD-App-SP-Objects]</span></span>
* <span data-ttu-id="e3fa0-266">[Uygulamaları Azure Active Directory ile tümleştirme][AAD-Integrating-Apps]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-266">[Integrating Applications with Azure Active Directory][AAD-Integrating-Apps]</span></span>
* <span data-ttu-id="e3fa0-267">[Merhaba onayı Framework genel bakış][AAD-Consent-Overview]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-267">[Overview of hello Consent Framework][AAD-Consent-Overview]</span></span>
* <span data-ttu-id="e3fa0-268">[Microsoft Graph API'si izin kapsamları][MSFT-Graph-permision-scopes]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-268">[Microsoft Graph API Permission Scopes][MSFT-Graph-permision-scopes]</span></span>
* <span data-ttu-id="e3fa0-269">[Azure AD grafik API'si izin kapsamları][AAD-Graph-Perm-Scopes]</span><span class="sxs-lookup"><span data-stu-id="e3fa0-269">[Azure AD Graph API Permission Scopes][AAD-Graph-Perm-Scopes]</span></span>

<span data-ttu-id="e3fa0-270">Lütfen Açıklamalar bölümüne tooprovide geribildirim aşağıdaki hello kullanın ve daraltın ve içeriği şekil yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="e3fa0-270">Please use hello following comments section tooprovide feedback and help us refine and shape our content.</span></span>

<!--Reference style links IN USE -->
[AAD-Access-Panel]:  https://myapps.microsoft.com
[AAD-App-Branding]: ./active-directory-branding-guidelines.md
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Consent-Overview]: ./active-directory-integrating-applications.md#overview-of-the-consent-framework
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Overview]: https://azure.microsoft.com/en-us/documentation/articles/active-directory-graph-api/
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Samples-MT]: https://azure.microsoft.com/documentation/samples/?service=active-directory&term=multitenant
[AAD-Why-To-Integrate]: ./active-directory-how-to-integrate.md
[AZURE-portal]: https://portal.azure.com
[MSFT-Graph-overview]: https://graph.microsoft.io/en-us/docs/overview/overview
[MSFT-Graph-permision-scopes]: https://graph.microsoft.io/en-us/docs/authorization/permission_scopes

<!--Image references-->
[AAD-Sign-In]: ./media/active-directory-devhowto-multi-tenant-overview/sign-in-with-microsoft-light.png
[Consent-Single-Tier]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-single-tier.png
[Consent-Multi-Tier-Known-Client]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-known-clients.png
[Consent-Multi-Tier-Multi-Party]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-multi-party.png

<!--Reference style links -->
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Graph-App-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#application-entity
[AAD-Graph-Sp-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#serviceprincipal-entity
[AAD-Graph-User-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#user-entity
[AAD-How-To-Integrate]: ./active-directory-how-to-integrate.md
[AAD-Security-Token-Claims]: ./active-directory-authentication-scenarios/#claims-in-azure-ad-security-tokens
[AAD-Tokens-Claims]: ./active-directory-token-and-claims.md
[AAD-V2-Dev-Guide]: ../active-directory-appmodel-v2-overview.md
[AZURE-portal]: https://portal.azure.com
[Duyshant-Role-Blog]: http://www.dushyantgill.com/blog/2014/12/10/roles-based-access-control-in-cloud-applications-using-azure-ad/
[JWT]: https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-32
[O365-Perm-Ref]: https://msdn.microsoft.com/en-us/office/office365/howto/application-manifest
[OAuth2-Access-Token-Scopes]: https://tools.ietf.org/html/rfc6749#section-3.3
[OAuth2-AuthZ-Code-Grant-Flow]: https://msdn.microsoft.com/library/azure/dn645542.aspx
[OAuth2-AuthZ-Grant-Types]: https://tools.ietf.org/html/rfc6749#section-1.3 
[OAuth2-Client-Types]: https://tools.ietf.org/html/rfc6749#section-2.1
[OAuth2-Role-Def]: https://tools.ietf.org/html/rfc6749#page-6
[OpenIDConnect]: http://openid.net/specs/openid-connect-core-1_0.html
[OpenIDConnect-ID-Token]: http://openid.net/specs/openid-connect-core-1_0.html#IDToken














