---
title: "Azure IOT paketi bağlı aaaDeploy Fabrika ağ geçidi | Microsoft Docs"
description: "Toodeploy Windows veya Linux tooenable bağlantı toohello üzerinde bir ağ geçidi Fabrika nasıl bağlanacağını çözüm önceden yapılandırılmış."
services: 
suite: iot-suite
documentationcenter: na
author: dominicbetts
manager: timlt
editor: 
ms.service: iot-suite
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/24/2017
ms.author: dobett
ms.openlocfilehash: 72436dec60eda0de20143f362fe740b0c4412f36
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="deploy-a-gateway-on-windows-or-linux-for-hello-connected-factory-preconfigured-solution"></a><span data-ttu-id="412ce-103">Windows veya Linux üzerinde bir ağ geçidi bağlı hello Fabrika önceden yapılandırılmış çözümü dağıtma</span><span class="sxs-lookup"><span data-stu-id="412ce-103">Deploy a gateway on Windows or Linux for hello connected factory preconfigured solution</span></span>

<span data-ttu-id="412ce-104">Merhaba toodeploy bağlı hello Fabrika önceden yapılandırılmış çözümü için ağ geçidi bir iki bileşenden oluşur gerekli yazılım:</span><span class="sxs-lookup"><span data-stu-id="412ce-104">hello software required toodeploy a gateway for hello connected factory preconfigured solution has two components:</span></span>

* <span data-ttu-id="412ce-105">Merhaba *OPC Proxy* bağlantı tooIoT Hub oluşturur.</span><span class="sxs-lookup"><span data-stu-id="412ce-105">hello *OPC Proxy* establishes a connection tooIoT Hub.</span></span> <span data-ttu-id="412ce-106">Merhaba *OPC Proxy* sonra hello bağlı Fabrika çözüm portalında çalışan OPC tarayıcı tümleşik hello komut ve Denetim iletileri bekler.</span><span class="sxs-lookup"><span data-stu-id="412ce-106">hello *OPC Proxy* then waits for command and control messages from hello integrated OPC Browser that runs in hello connected factory solution portal.</span></span>
* <span data-ttu-id="412ce-107">Merhaba *OPC yayımcı* tooexisting şirket içi OPC UA sunucularını bağlar ve telemetri iletilerini onlardan tooIoT Hub iletir.</span><span class="sxs-lookup"><span data-stu-id="412ce-107">hello *OPC Publisher* connects tooexisting on-premises OPC UA servers and forwards telemetry messages from them tooIoT Hub.</span></span>

<span data-ttu-id="412ce-108">Her iki bileşenler açık kaynaklı ve GitHub kaynağına ve Docker kapsayıcılar olarak kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="412ce-108">Both components are open-source and are available as source on GitHub and as Docker containers:</span></span>

| <span data-ttu-id="412ce-109">GitHub</span><span class="sxs-lookup"><span data-stu-id="412ce-109">GitHub</span></span> | <span data-ttu-id="412ce-110">DockerHub</span><span class="sxs-lookup"><span data-stu-id="412ce-110">DockerHub</span></span> |
| ------ | --------- |
| <span data-ttu-id="412ce-111">[OPC yayımcı][lnk-publisher-github]</span><span class="sxs-lookup"><span data-stu-id="412ce-111">[OPC Publisher][lnk-publisher-github]</span></span> | <span data-ttu-id="412ce-112">[OPC yayımcı][lnk-publisher-docker]</span><span class="sxs-lookup"><span data-stu-id="412ce-112">[OPC Publisher][lnk-publisher-docker]</span></span> |
| <span data-ttu-id="412ce-113">[OPC Proxy][lnk-proxy-github]</span><span class="sxs-lookup"><span data-stu-id="412ce-113">[OPC Proxy][lnk-proxy-github]</span></span> | <span data-ttu-id="412ce-114">[OPC Proxy][lnk-proxy-docker]</span><span class="sxs-lookup"><span data-stu-id="412ce-114">[OPC Proxy][lnk-proxy-docker]</span></span> |

<span data-ttu-id="412ce-115">Genel kullanıma yönelik IP adresi veya Delik hello ağ geçidi Güvenlik Duvarı'nda ya da bileşen için gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="412ce-115">No public-facing IP address or holes in hello gateway firewall are required for either component.</span></span> <span data-ttu-id="412ce-116">Merhaba OPC Proxy ve OPC yayımcı yalnızca giden bağlantı noktası 443, 5671 ve 8883 kullanın.</span><span class="sxs-lookup"><span data-stu-id="412ce-116">hello OPC Proxy and OPC Publisher use only outbound ports 443, 5671, and 8883.</span></span>

<span data-ttu-id="412ce-117">Merhaba bu makaledeki adımlarda size yol gösterecektir Docker üzerinde kullanarak ağ geçidi bir toodeploy [Windows](#windows-deployment) veya [Linux](#linux-deployment).</span><span class="sxs-lookup"><span data-stu-id="412ce-117">hello steps in this article show you how toodeploy a gateway using Docker on either [Windows](#windows-deployment) or [Linux](#linux-deployment).</span></span> <span data-ttu-id="412ce-118">Merhaba ağ geçidi bağlantısı bağlı toohello Fabrika önceden yapılandırılmış çözümü sağlar.</span><span class="sxs-lookup"><span data-stu-id="412ce-118">hello gateway enables connectivity toohello connected factory preconfigured solution.</span></span>

> [!NOTE]
> <span data-ttu-id="412ce-119">Merhaba Docker kapsayıcısı içinde çalışan hello ağ geçidi yazılım [Azure IOT kenar].</span><span class="sxs-lookup"><span data-stu-id="412ce-119">hello gateway software that runs in hello Docker container is [Azure IoT Edge].</span></span>

## <a name="windows-deployment"></a><span data-ttu-id="412ce-120">Windows Dağıtım</span><span class="sxs-lookup"><span data-stu-id="412ce-120">Windows deployment</span></span>

> [!NOTE]
> <span data-ttu-id="412ce-121">Bir ağ geçidi cihazı henüz yoksa, Microsoft ticari bir ağ geçidi ortaklarımızdan birinden satın önerir.</span><span class="sxs-lookup"><span data-stu-id="412ce-121">If you don't yet have a gateway device, Microsoft recommends you buy a commercial gateway from one of our partners.</span></span> <span data-ttu-id="412ce-122">Merhaba ziyaret [Azure IOT cihaz katalog] ağ geçidi cihazların Merhaba ile uyumlu bir listesini Fabrika çözüm bağlandı.</span><span class="sxs-lookup"><span data-stu-id="412ce-122">Visit hello [Azure IoT device catalog] for a list of gateway devices compatible with hello connected factory solution.</span></span> <span data-ttu-id="412ce-123">Merhaba aygıt tooset hello ağ geçidi kurma gelir hello yönergeleri izleyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-123">Follow hello instructions that come with hello device tooset up hello gateway.</span></span> <span data-ttu-id="412ce-124">Alternatif olarak, varolan geçitlerinizin birinde ayarlama yönergeleri toomanually aşağıdaki hello kullanın.</span><span class="sxs-lookup"><span data-stu-id="412ce-124">Alternatively, use hello following instructions toomanually set up one of your existing gateways.</span></span>

### <a name="install-docker"></a><span data-ttu-id="412ce-125">Docker yükleyin</span><span class="sxs-lookup"><span data-stu-id="412ce-125">Install Docker</span></span>

<span data-ttu-id="412ce-126">Yükleme [Windows için Docker] , Windows tabanlı ağ geçidi Cihazınızda.</span><span class="sxs-lookup"><span data-stu-id="412ce-126">Install [Docker for Windows] on your Windows-based gateway device.</span></span> <span data-ttu-id="412ce-127">Windows Docker Kurulum sırasında ana makine tooshare docker'la üzerinde bir sürücü seçin.</span><span class="sxs-lookup"><span data-stu-id="412ce-127">During Windows Docker setup, select a drive on your host machine tooshare with Docker.</span></span> <span data-ttu-id="412ce-128">Merhaba, aşağıdaki Windows sisteminize Hello D sürücü paylaşımı hali gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="412ce-128">hello following screenshot shows sharing hello D drive on your Windows system:</span></span>

![Docker yükleyin][img-install-docker]

<span data-ttu-id="412ce-130">Adlı bir klasör oluşturun **docker** hello hello kökünde paylaşılan sürücü.</span><span class="sxs-lookup"><span data-stu-id="412ce-130">Then create a folder called **docker** in hello root of hello shared drive.</span></span>
<span data-ttu-id="412ce-131">Docker hello yükledikten sonra da bu adımı gerçekleştirebilirsiniz **ayarları** menüsü.</span><span class="sxs-lookup"><span data-stu-id="412ce-131">You can also perform this step after installing docker from hello **Settings** menu.</span></span>

### <a name="configure-hello-gateway"></a><span data-ttu-id="412ce-132">Merhaba ağ geçidini yapılandırma</span><span class="sxs-lookup"><span data-stu-id="412ce-132">Configure hello gateway</span></span>

1. <span data-ttu-id="412ce-133">Merhaba gereksinim **iothubowner** Azure IOT paketi bağlantı dizesi bağlı Fabrika dağıtım toocomplete hello ağ geçidi dağıtımı.</span><span class="sxs-lookup"><span data-stu-id="412ce-133">You need hello **iothubowner** connection string of your Azure IoT Suite connected factory deployment toocomplete hello gateway deployment.</span></span> <span data-ttu-id="412ce-134">Merhaba, [Azure portal], IOT Hub'hello kaynak grubunda oluşturulan bağlı hello Fabrika çözüm dağıtıldığında tooyour gidin.</span><span class="sxs-lookup"><span data-stu-id="412ce-134">In hello [Azure portal], navigate tooyour IoT Hub in hello resource group created when you deployed hello connected factory solution.</span></span> <span data-ttu-id="412ce-135">Tıklatın **paylaşılan erişim ilkeleri** tooaccess hello **iothubowner** bağlantı dizesi:</span><span class="sxs-lookup"><span data-stu-id="412ce-135">Click **Shared access policies** tooaccess hello **iothubowner** connection string:</span></span>

    ![Hello IOT Hub bağlantı dizesine bulur][img-hub-connection]

    <span data-ttu-id="412ce-137">Kopya hello **bağlantı dizesi--birincil anahtar** değeri.</span><span class="sxs-lookup"><span data-stu-id="412ce-137">Copy hello **Connection string--primary key** value.</span></span>

1. <span data-ttu-id="412ce-138">Merhaba iki ağ geçidi modülleri çalıştırarak Hello ağ geçidi için IOT Hub'ınızı yapılandırma **sonra** ile bir komut isteminden:</span><span class="sxs-lookup"><span data-stu-id="412ce-138">Configure hello gateway for your IoT Hub by running hello two gateway modules **once** from a command prompt with:</span></span>

    `docker run -it --rm -h <ApplicationName> -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v //D/docker:/root/.dotnet/corefx/cryptography/x509stores microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName> "<IoTHubOwnerConnectionString>"`

    `docker run -it --rm -v //D/docker:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -i -c "<IoTHubOwnerConnectionString>" -D /mapped/cs.db`

    * <span data-ttu-id="412ce-139">**&lt;ApplicationName&gt; ** hello biçiminde hello adı toogive tooyour OPC UA yayımcı olan **yayımcı.&lt; tam etki alanı adınızı&gt;**.</span><span class="sxs-lookup"><span data-stu-id="412ce-139">**&lt;ApplicationName&gt;** is hello name toogive tooyour OPC UA Publisher in hello format **publisher.&lt;your fully qualified domain name&gt;**.</span></span> <span data-ttu-id="412ce-140">Örneğin, Fabrika ağ olarak adlandırılır, **myfactorynetwork.com**, hello **ApplicationName** değer **publisher.myfactorynetwork.com**.</span><span class="sxs-lookup"><span data-stu-id="412ce-140">For example, if your factory network is called **myfactorynetwork.com**, hello **ApplicationName** value is **publisher.myfactorynetwork.com**.</span></span>
    * <span data-ttu-id="412ce-141">**&lt;IoTHubOwnerConnectionString&gt; ** hello olan **iothubowner** hello önceki adımda kopyaladığınız bağlantı dizesi.</span><span class="sxs-lookup"><span data-stu-id="412ce-141">**&lt;IoTHubOwnerConnectionString&gt;** is hello **iothubowner** connection string you copied in hello previous step.</span></span> <span data-ttu-id="412ce-142">Bu bağlantı dizesini yalnızca bu adımda kullanılır, aşağıdaki adımları hello gerekmez:</span><span class="sxs-lookup"><span data-stu-id="412ce-142">This connection string is only used in this step, you don’t need it in hello following steps:</span></span>

    <span data-ttu-id="412ce-143">Kullandığınız hello eşlenen D:\\docker klasörü (Merhaba `-v` bağımsız değişkeni) sonraki toopersist hello hello ağ geçidi modülleri kullanan iki X.509 sertifikaları.</span><span class="sxs-lookup"><span data-stu-id="412ce-143">You use hello mapped D:\\docker folder (hello `-v` argument) later toopersist hello two X.509 certificates that hello gateway modules use.</span></span>

### <a name="run-hello-gateway"></a><span data-ttu-id="412ce-144">Merhaba ağ geçidini çalıştırmak</span><span class="sxs-lookup"><span data-stu-id="412ce-144">Run hello gateway</span></span>

1. <span data-ttu-id="412ce-145">Merhaba aşağıdaki komutları kullanarak hello ağ geçidini yeniden başlatın:</span><span class="sxs-lookup"><span data-stu-id="412ce-145">Restart hello gateway using hello following commands:</span></span>

    `docker run -it --rm -h <ApplicationName> --expose 62222 -p 62222:62222 -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/Logs -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v //D/docker:/shared -v //D/docker:/root/.dotnet/corefx/cryptography/x509stores -e _GW_PNFP="/shared/publishednodes.JSON" microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName>`

    `docker run -it --rm -v //D/docker:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -D /mapped/cs.db`

1. <span data-ttu-id="412ce-146">Güvenlik nedenleriyle hello iki X.509 sertifikalarını hello D: kalıcı\\docker klasör hello özel anahtarı içerir.</span><span class="sxs-lookup"><span data-stu-id="412ce-146">For security reasons, hello two X.509 certificates persisted in hello D:\\docker folder contain hello private key.</span></span> <span data-ttu-id="412ce-147">Sınırlamak erişim toothis klasörü toohello kimlik bilgileri (genellikle **Yöneticiler**) toorun hello Docker kapsayıcısı kullanın.</span><span class="sxs-lookup"><span data-stu-id="412ce-147">Limit access toothis folder toohello credentials (typically **Administrators**) you use toorun hello Docker container.</span></span> <span data-ttu-id="412ce-148">Sağ hello D:\\docker klasörü seçin **özellikleri**, ardından **güvenlik**ve ardından **Düzenle**.</span><span class="sxs-lookup"><span data-stu-id="412ce-148">Right-click hello D:\\docker folder, choose **Properties**, then **Security**, and then **Edit**.</span></span> <span data-ttu-id="412ce-149">Vermek **Yöneticiler** tam denetim ve diğerlerinin kaldırın:</span><span class="sxs-lookup"><span data-stu-id="412ce-149">Give **Administrators** full control and remove everyone else:</span></span>

    ![GRANT izinleri tooDocker paylaşımı][img-docker-share]

1. <span data-ttu-id="412ce-151">Ağ bağlantısını doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="412ce-151">Verify network connectivity.</span></span> <span data-ttu-id="412ce-152">Merhaba komutu bir komut isteminden girin `ping publisher.<your fully qualified domain name>` tooping, ağ geçidi.</span><span class="sxs-lookup"><span data-stu-id="412ce-152">From a command prompt, enter hello command `ping publisher.<your fully qualified domain name>` tooping your gateway.</span></span> <span data-ttu-id="412ce-153">Merhaba hedef erişilemediğinde hello IP adresi ve ağ geçidiniz üzerinde ağ geçidi toohello hosts dosyasının adını ekleyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-153">If hello destination is unreachable, add hello IP address and name of your gateway toohello hosts file on your gateway.</span></span> <span data-ttu-id="412ce-154">Merhaba hosts dosyasını hello bulunan **Windows\\System32\\sürücüleri\\vb.** klasör.</span><span class="sxs-lookup"><span data-stu-id="412ce-154">hello hosts file is located in hello **Windows\\System32\\drivers\\etc** folder.</span></span>

1. <span data-ttu-id="412ce-155">Ardından, tooconnect toohello yayımcı hello ağ geçidinde çalıştıran yerel bir OPC UA istemcisi kullanarak deneyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-155">Next, try tooconnect toohello publisher using a local OPC UA client running on hello gateway.</span></span> <span data-ttu-id="412ce-156">OPC UA uç noktası URL'si hello `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span><span class="sxs-lookup"><span data-stu-id="412ce-156">hello OPC UA endpoint URL is `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span></span> <span data-ttu-id="412ce-157">OPC UA istemci yoksa kullanın indirin ve bir [açık kaynak OPC UA istemci].</span><span class="sxs-lookup"><span data-stu-id="412ce-157">If you don't have an OPC UA client, you can download and use an [open-source OPC UA client].</span></span>

1. <span data-ttu-id="412ce-158">Bu yerel testleri başarıyla tamamladıktan sonra toohello Gözat **kendi OPC UA sunucusuna** hello bağlı Fabrika çözüm portalında sayfası.</span><span class="sxs-lookup"><span data-stu-id="412ce-158">When you have successfully completed these local tests, browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="412ce-159">Merhaba yayımcı uç noktasının URL'sini girin (`tcp://publisher.<your fully qualified domain name>:62222`) tıklatıp **Bağlan**.</span><span class="sxs-lookup"><span data-stu-id="412ce-159">Enter hello publisher endpoint URL (`tcp://publisher.<your fully qualified domain name>:62222`) and click **Connect**.</span></span> <span data-ttu-id="412ce-160">Bir sertifika uyarısı almak, ardından tıklatın **devam et.**</span><span class="sxs-lookup"><span data-stu-id="412ce-160">You get a certificate warning, then click **Proceed.**</span></span> <span data-ttu-id="412ce-161">Ardından bu hello bir hata alıyorsunuz yayımcı hello UA Web istemcisi güven değil.</span><span class="sxs-lookup"><span data-stu-id="412ce-161">Next you get an error that hello publisher doesn’t trust hello UA Web Client.</span></span> <span data-ttu-id="412ce-162">tooresolve bu hata, kopyalama hello **UA Web istemcisi** hello sertifikadan **D:\\docker\\reddetti sertifikaları\\sertifikaları** klasörü toohello **D:\\docker\\UA uygulamaları\\sertifikaları** hello ağ geçidinde klasör.</span><span class="sxs-lookup"><span data-stu-id="412ce-162">tooresolve this error, copy hello **UA Web Client** certificate from hello **D:\\docker\\Rejected Certificates\\certs** folder toohello **D:\\docker\\UA Applications\\certs** folder on hello gateway.</span></span> <span data-ttu-id="412ce-163">Toorestart hello ağ geçidinin zorunda değilsiniz.</span><span class="sxs-lookup"><span data-stu-id="412ce-163">You do not need toorestart of hello gateway.</span></span> <span data-ttu-id="412ce-164">Bu adımı yineleyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-164">Repeat this step.</span></span> <span data-ttu-id="412ce-165">Merhaba buluttan toohello ağ geçidi artık bağlanabilir ve hazır tooadd OPC UA sunucuları toohello çözüm demektir.</span><span class="sxs-lookup"><span data-stu-id="412ce-165">You can now connect toohello gateway from hello cloud, and you are ready tooadd OPC UA servers toohello solution.</span></span>

### <a name="add-your-opc-ua-servers"></a><span data-ttu-id="412ce-166">OPC UA sunucularınızı ekleme</span><span class="sxs-lookup"><span data-stu-id="412ce-166">Add your OPC UA servers</span></span>

1. <span data-ttu-id="412ce-167">Toohello Gözat **kendi OPC UA sunucusuna** hello bağlı Fabrika çözüm portalında sayfası.</span><span class="sxs-lookup"><span data-stu-id="412ce-167">Browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="412ce-168">Bağlı Fabrika portal hello ve OPC UA sunucu hello arasında bölüm tooestablish önceki hello olduğu gibi aynı adımları güven hello izleyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-168">Follow hello same steps as in hello preceding section tooestablish trust between hello connected factory portal and hello OPC UA server.</span></span> <span data-ttu-id="412ce-169">Bu adım, karşılıklı güven hello hello sertifika Fabrika portal ve hello OPC UA sunucu bağlı ve bir bağlantı oluşturur oluşturur.</span><span class="sxs-lookup"><span data-stu-id="412ce-169">This step establishes a mutual trust of hello certificates from hello connected factory portal and hello OPC UA server and creates a connection.</span></span>

1. <span data-ttu-id="412ce-170">Merhaba OPC UA düğümleri ağaç OPC UA sunucunuzun gidin, hello OPC düğümleri sağ tıklatın ve seçin **yayımlama**.</span><span class="sxs-lookup"><span data-stu-id="412ce-170">Browse hello OPC UA nodes tree of your OPC UA server, right-click hello OPC nodes, and select **publish**.</span></span> <span data-ttu-id="412ce-171">Bu şekilde yayımlama toowork için OPC UA sunucu hello ve hello yayımcı üzerinde hello olmalıdır aynı ağ.</span><span class="sxs-lookup"><span data-stu-id="412ce-171">For publishing toowork this way, hello OPC UA server and hello publisher must be on hello same network.</span></span> <span data-ttu-id="412ce-172">Diğer bir deyişle, hello tam olarak nitelenmiş etki alanı adı hello publisher'ın ise **publisher.mydomain.com** sonra OPC UA sunucu olması gerekir, örneğin, hello hello tam etki alanı adı **myopcuaserver.mydomain.com**. Kurulumunuzu farklıysa hello bulunan düğümleri toohello publishesnodes.json dosyasını el ile ekleyebilirsiniz **D:\\docker** klasör.</span><span class="sxs-lookup"><span data-stu-id="412ce-172">In other words, if hello fully qualified domain name of hello publisher is **publisher.mydomain.com** then hello fully qualified domain name of hello OPC UA server must be, for example, **myopcuaserver.mydomain.com**. If your setup is different, you can manually add nodes toohello publishesnodes.json file found in hello **D:\\docker** folder.</span></span> <span data-ttu-id="412ce-173">Merhaba publishesnodes.json dosyası otomatik olarak hello üzerinde ilk başarılı oluşturulan bir OPC düğümünün yayımlayın.</span><span class="sxs-lookup"><span data-stu-id="412ce-173">hello publishesnodes.json file is automatically generated on hello first successful publish of an OPC node.</span></span>

1. <span data-ttu-id="412ce-174">Telemetri şimdi hello ağ geçidi aygıttan akar.</span><span class="sxs-lookup"><span data-stu-id="412ce-174">Telemetry now flows from hello gateway device.</span></span> <span data-ttu-id="412ce-175">Merhaba telemetri hello görüntüleyebilirsiniz **Fabrika konumları** hello bağlı Fabrika portal altında görünümünü **yeni Fabrika**.</span><span class="sxs-lookup"><span data-stu-id="412ce-175">You can view hello telemetry in hello **Factory Locations** view of hello connected factory portal under **New Factory**.</span></span>

## <a name="linux-deployment"></a><span data-ttu-id="412ce-176">Linux dağıtımı</span><span class="sxs-lookup"><span data-stu-id="412ce-176">Linux deployment</span></span>

> [!NOTE]
> <span data-ttu-id="412ce-177">Bir ağ geçidi cihazı henüz yoksa, Microsoft ticari bir ağ geçidi ortaklarımızdan birinden satın önerir.</span><span class="sxs-lookup"><span data-stu-id="412ce-177">If you don't yet have a gateway device, Microsoft recommends you buy a commercial gateway from one of our partners.</span></span> <span data-ttu-id="412ce-178">Merhaba ziyaret [Azure IOT cihaz katalog] ağ geçidi cihazların Merhaba ile uyumlu bir listesini Fabrika çözüm bağlandı.</span><span class="sxs-lookup"><span data-stu-id="412ce-178">Visit hello [Azure IoT device catalog] for a list of gateway devices compatible with hello connected factory solution.</span></span> <span data-ttu-id="412ce-179">Merhaba aygıt tooset hello ağ geçidi kurma gelir hello yönergeleri izleyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-179">Follow hello instructions that come with hello device tooset up hello gateway.</span></span> <span data-ttu-id="412ce-180">Alternatif olarak, varolan geçitlerinizin birinde ayarlama yönergeleri toomanually aşağıdaki hello kullanın.</span><span class="sxs-lookup"><span data-stu-id="412ce-180">Alternatively, use hello following instructions toomanually set up one of your existing gateways.</span></span>

<span data-ttu-id="412ce-181">[Docker yükleme] Linux ağ geçidi cihazınız üzerinde.</span><span class="sxs-lookup"><span data-stu-id="412ce-181">[Install Docker] on your Linux gateway device.</span></span>

### <a name="configure-hello-gateway"></a><span data-ttu-id="412ce-182">Merhaba ağ geçidini yapılandırma</span><span class="sxs-lookup"><span data-stu-id="412ce-182">Configure hello gateway</span></span>

1. <span data-ttu-id="412ce-183">Merhaba gereksinim **iothubowner** Azure IOT paketi bağlantı dizesi bağlı Fabrika dağıtım toocomplete hello ağ geçidi dağıtımı.</span><span class="sxs-lookup"><span data-stu-id="412ce-183">You need hello **iothubowner** connection string of your Azure IoT Suite connected factory deployment toocomplete hello gateway deployment.</span></span> <span data-ttu-id="412ce-184">Merhaba, [Azure portal], IOT Hub'hello kaynak grubunda oluşturulan bağlı hello Fabrika çözüm dağıtıldığında tooyour gidin.</span><span class="sxs-lookup"><span data-stu-id="412ce-184">In hello [Azure portal], navigate tooyour IoT Hub in hello resource group created when you deployed hello connected factory solution.</span></span> <span data-ttu-id="412ce-185">Tıklatın **paylaşılan erişim ilkeleri** tooaccess hello **iothubowner** bağlantı dizesi:</span><span class="sxs-lookup"><span data-stu-id="412ce-185">Click **Shared access policies** tooaccess hello **iothubowner** connection string:</span></span>

    ![Hello IOT Hub bağlantı dizesine bulur][img-hub-connection]

    <span data-ttu-id="412ce-187">Kopya hello **bağlantı dizesi--birincil anahtar** değeri.</span><span class="sxs-lookup"><span data-stu-id="412ce-187">Copy hello **Connection string--primary key** value.</span></span>

1. <span data-ttu-id="412ce-188">Merhaba iki ağ geçidi modülleri çalıştırarak Hello ağ geçidi için IOT Hub'ınızı yapılandırma **sonra** ile Kabuğu'ndan:</span><span class="sxs-lookup"><span data-stu-id="412ce-188">Configure hello gateway for your IoT Hub by running hello two gateway modules **once** from a shell with:</span></span>

    `sudo docker run -it --rm -h <ApplicationName> -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/ -v /shared:/root/.dotnet/corefx/cryptography/x509stores microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName> "<IoTHubOwnerConnectionString>"`

    `sudo docker run --rm -it -v /shared:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -i -c "<IoTHubOwnerConnectionString>" -D /mapped/cs.db`

    * <span data-ttu-id="412ce-189">**&lt;ApplicationName&gt; ** OPC UA uygulama hello ağ geçidi oluşturur hello biçiminde hello hello adıdır **yayımcı.&lt; tam etki alanı adınızı&gt;**.</span><span class="sxs-lookup"><span data-stu-id="412ce-189">**&lt;ApplicationName&gt;** is hello name of hello OPC UA application hello gateway creates in hello format **publisher.&lt;your fully qualified domain name&gt;**.</span></span> <span data-ttu-id="412ce-190">Örneğin, **publisher.microsoft.com**.</span><span class="sxs-lookup"><span data-stu-id="412ce-190">For example, **publisher.microsoft.com**.</span></span>
    * <span data-ttu-id="412ce-191">**&lt;IoTHubOwnerConnectionString&gt; ** hello olan **iothubowner** hello önceki adımda kopyaladığınız bağlantı dizesi.</span><span class="sxs-lookup"><span data-stu-id="412ce-191">**&lt;IoTHubOwnerConnectionString&gt;** is hello **iothubowner** connection string you copied in hello previous step.</span></span> <span data-ttu-id="412ce-192">Bu bağlantı dizesini yalnızca bu adımda kullanılır, aşağıdaki adımları hello gerekmez:</span><span class="sxs-lookup"><span data-stu-id="412ce-192">This connection string is only used in this step, you don’t need it in hello following steps:</span></span>

    <span data-ttu-id="412ce-193">Merhaba kullandığınız **/ paylaşılan** klasörü (Merhaba `-v` bağımsız değişkeni) sonraki toopersist hello hello ağ geçidi modülleri kullanan iki X.509 sertifikaları.</span><span class="sxs-lookup"><span data-stu-id="412ce-193">You use hello **/shared** folder (hello `-v` argument) later toopersist hello two X.509 certificates that hello gateway modules use.</span></span>

### <a name="run-hello-gateway"></a><span data-ttu-id="412ce-194">Merhaba ağ geçidini çalıştırmak</span><span class="sxs-lookup"><span data-stu-id="412ce-194">Run hello gateway</span></span>

1. <span data-ttu-id="412ce-195">Merhaba aşağıdaki komutları kullanarak hello ağ geçidini yeniden başlatın:</span><span class="sxs-lookup"><span data-stu-id="412ce-195">Restart hello gateway using hello following commands:</span></span>

    `sudo docker run -it -h <ApplicationName> --expose 62222 -p 62222:62222 –-rm -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/Logs -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v /shared:/shared -v /shared:/root/.dotnet/corefx/cryptography/x509stores -e _GW_PNFP="/shared/publishednodes.JSON" microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName>`

    `sudo docker run -it -v /shared:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -D /mapped/cs.db`

1. <span data-ttu-id="412ce-196">Güvenlik nedenleriyle hello iki X.509 sertifikalarını hello kalıcı **/ paylaşılan** klasör hello özel anahtarı içerir.</span><span class="sxs-lookup"><span data-stu-id="412ce-196">For security reasons, hello two X.509 certificates persisted in hello **/shared** folder contain hello private key.</span></span> <span data-ttu-id="412ce-197">Sınır erişim toothis klasörü toohello toorun kullandığınız kimlik bilgileri Docker kapsayıcısı hello.</span><span class="sxs-lookup"><span data-stu-id="412ce-197">Limit access toothis folder toohello credentials you use toorun hello Docker container.</span></span> <span data-ttu-id="412ce-198">tooset hello izinlerini **kök** yalnızca hello kullanın `chmod` Kabuk hello klasörü komutu.</span><span class="sxs-lookup"><span data-stu-id="412ce-198">tooset hello permissions for **root** only, use hello `chmod` shell command on hello folder.</span></span>

1. <span data-ttu-id="412ce-199">Ağ bağlantısını doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="412ce-199">Verify network connectivity.</span></span> <span data-ttu-id="412ce-200">Bir kabuğundan hello komutu girin `ping publisher.<your fully qualified domain name>` tooping, ağ geçidi.</span><span class="sxs-lookup"><span data-stu-id="412ce-200">From a shell, enter hello command `ping publisher.<your fully qualified domain name>` tooping your gateway.</span></span> <span data-ttu-id="412ce-201">Merhaba hedef erişilemediğinde hello IP adresi ve ağ geçidiniz üzerinde ağ geçidi tooyour hosts dosyasının adını ekleyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-201">If hello destination is unreachable, add hello IP address and name of your gateway tooyour hosts file on your gateway.</span></span> <span data-ttu-id="412ce-202">Merhaba hosts dosyasını hello bulunan **/vb.** klasör.</span><span class="sxs-lookup"><span data-stu-id="412ce-202">hello hosts file is located in hello **/etc** folder.</span></span>

1. <span data-ttu-id="412ce-203">Ardından, tooconnect toohello yayımcı hello ağ geçidinde çalıştıran yerel bir OPC UA istemcisi kullanarak deneyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-203">Next, try tooconnect toohello publisher using a local OPC UA client running on hello gateway.</span></span> <span data-ttu-id="412ce-204">OPC UA uç noktası URL'si hello `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span><span class="sxs-lookup"><span data-stu-id="412ce-204">hello OPC UA endpoint URL is `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span></span> <span data-ttu-id="412ce-205">OPC UA istemci yoksa kullanın indirin ve bir [açık kaynak OPC UA istemci].</span><span class="sxs-lookup"><span data-stu-id="412ce-205">If you don't have an OPC UA client, you can download and use an [open-source OPC UA client].</span></span>

1. <span data-ttu-id="412ce-206">Bu yerel testleri başarıyla tamamladıktan sonra toohello Gözat **kendi OPC UA sunucusuna** hello bağlı Fabrika çözüm portalında sayfası.</span><span class="sxs-lookup"><span data-stu-id="412ce-206">When you have successfully completed these local tests, browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="412ce-207">Merhaba yayımcı uç noktasının URL'sini girin (`tcp://publisher.<your fully qualified domain name>:62222`) tıklatıp **Bağlan**.</span><span class="sxs-lookup"><span data-stu-id="412ce-207">Enter hello publisher endpoint URL (`tcp://publisher.<your fully qualified domain name>:62222`) and click **Connect**.</span></span> <span data-ttu-id="412ce-208">Bir sertifika uyarısı almak, ardından tıklatın **devam et.**</span><span class="sxs-lookup"><span data-stu-id="412ce-208">You get a certificate warning, then click **Proceed.**</span></span> <span data-ttu-id="412ce-209">Ardından bu hello bir hata alıyorsunuz yayımcı hello UA Web istemcisi güven değil.</span><span class="sxs-lookup"><span data-stu-id="412ce-209">Next you get an error that hello publisher doesn’t trust hello UA Web Client.</span></span> <span data-ttu-id="412ce-210">tooresolve bu hata, kopyalama hello **UA Web istemcisi** hello sertifikadan **/paylaşılan/reddedildi sertifikaları/sertifikaları** klasörü toohello **/shared/UA uygulamalar/sertifikaları** Merhaba ağ geçidi klasör.</span><span class="sxs-lookup"><span data-stu-id="412ce-210">tooresolve this error, copy hello **UA Web Client** certificate from hello **/shared/Rejected Certificates/certs** folder toohello **/shared/UA Applications/certs** folder on hello gateway.</span></span> <span data-ttu-id="412ce-211">Toorestart hello ağ geçidinin zorunda değilsiniz.</span><span class="sxs-lookup"><span data-stu-id="412ce-211">You do not need toorestart of hello gateway.</span></span> <span data-ttu-id="412ce-212">Bu adımı yineleyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-212">Repeat this step.</span></span> <span data-ttu-id="412ce-213">Merhaba buluttan toohello ağ geçidi artık bağlanabilir ve hazır tooadd OPC UA sunucuları toohello çözüm demektir.</span><span class="sxs-lookup"><span data-stu-id="412ce-213">You can now connect toohello gateway from hello cloud, and you are ready tooadd OPC UA servers toohello solution.</span></span>

### <a name="add-your-opc-ua-servers"></a><span data-ttu-id="412ce-214">OPC UA sunucularınızı ekleme</span><span class="sxs-lookup"><span data-stu-id="412ce-214">Add your OPC UA servers</span></span>

1. <span data-ttu-id="412ce-215">Toohello Gözat **kendi OPC UA sunucusuna** hello bağlı Fabrika çözüm portalında sayfası.</span><span class="sxs-lookup"><span data-stu-id="412ce-215">Browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="412ce-216">Bağlı Fabrika portal hello ve OPC UA sunucu hello arasında bölüm tooestablish önceki hello olduğu gibi aynı adımları güven hello izleyin.</span><span class="sxs-lookup"><span data-stu-id="412ce-216">Follow hello same steps as in hello preceding section tooestablish trust between hello connected factory portal and hello OPC UA server.</span></span> <span data-ttu-id="412ce-217">Bu adım, karşılıklı güven hello hello sertifika Fabrika portal ve hello OPC UA sunucu bağlı ve bir bağlantı oluşturur oluşturur.</span><span class="sxs-lookup"><span data-stu-id="412ce-217">This step establishes a mutual trust of hello certificates from hello connected factory portal and hello OPC UA server and creates a connection.</span></span>

1. <span data-ttu-id="412ce-218">Merhaba OPC UA düğümleri ağaç OPC UA sunucunuzun gidin, hello OPC düğümleri sağ tıklatın ve seçin **yayımlama**.</span><span class="sxs-lookup"><span data-stu-id="412ce-218">Browse hello OPC UA nodes tree of your OPC UA server, right-click hello OPC nodes, and select **publish**.</span></span> <span data-ttu-id="412ce-219">Bu şekilde yayımlama toowork için OPC UA sunucu hello ve hello yayımcı üzerinde hello olmalıdır aynı ağ.</span><span class="sxs-lookup"><span data-stu-id="412ce-219">For publishing toowork this way, hello OPC UA server and hello publisher must be on hello same network.</span></span> <span data-ttu-id="412ce-220">Diğer bir deyişle, hello tam olarak nitelenmiş etki alanı adı hello publisher'ın ise **publisher.mydomain.com** sonra OPC UA sunucu olması gerekir, örneğin, hello hello tam etki alanı adı **myopcuaserver.mydomain.com**. Kurulumunuzu farklıysa hello bulunan düğümleri toohello publishesnodes.json dosyasını el ile ekleyebilirsiniz **/ paylaşılan** klasör.</span><span class="sxs-lookup"><span data-stu-id="412ce-220">In other words, if hello fully qualified domain name of hello publisher is **publisher.mydomain.com** then hello fully qualified domain name of hello OPC UA server must be, for example, **myopcuaserver.mydomain.com**. If your setup is different, you can manually add nodes toohello publishesnodes.json file found in hello **/shared** folder.</span></span> <span data-ttu-id="412ce-221">Merhaba publishesnodes.json otomatik olarak oluşturulan hello üzerinde ilk başarılı bir OPC düğümünün yayımlayın.</span><span class="sxs-lookup"><span data-stu-id="412ce-221">hello publishesnodes.json is automatically generated on hello first successful publish of an OPC node.</span></span>

1. <span data-ttu-id="412ce-222">Telemetri şimdi hello ağ geçidi aygıttan akar.</span><span class="sxs-lookup"><span data-stu-id="412ce-222">Telemetry now flows from hello gateway device.</span></span> <span data-ttu-id="412ce-223">Merhaba telemetri hello görüntüleyebilirsiniz **Fabrika konumları** hello bağlı Fabrika portal altında görünümünü **yeni Fabrika**.</span><span class="sxs-lookup"><span data-stu-id="412ce-223">You can view hello telemetry in hello **Factory Locations** view of hello connected factory portal under **New Factory**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="412ce-224">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="412ce-224">Next steps</span></span>

<span data-ttu-id="412ce-225">Merhaba bağlı Fabrika hello mimarisi hakkında daha fazla toolearn önceden yapılandırılmış çözümü için bkz: [bağlı Fabrika önceden yapılandırılmış çözüm izlenecek][lnk-walkthrough].</span><span class="sxs-lookup"><span data-stu-id="412ce-225">toolearn more about hello architecture of hello connected factory preconfigured solution, see [Connected factory preconfigured solution walkthrough][lnk-walkthrough].</span></span>

[img-install-docker]: ./media/iot-suite-connected-factory-gateway-deployment/image1.png
[img-hub-connection]: ./media/iot-suite-connected-factory-gateway-deployment/image2.png
[img-docker-share]: ./media/iot-suite-connected-factory-gateway-deployment/image3.png

[Windows için docker]: https://www.docker.com/docker-windows
[Azure IOT cihaz Kataloğu]: https://catalog.azureiotsuite.com/?q=opc
[Azure portal]: http://portal.azure.com/
[açık kaynak OPC UA istemci]: https://github.com/OPCFoundation/UA-.NETStandardLibrary/tree/master/SampleApplications/Samples/Client.Net4
[Docker yükleyin]: https://www.docker.com/community-edition#/download
[lnk-walkthrough]: iot-suite-connected-factory-sample-walkthrough.md
[Azure IoT Edge]: https://github.com/Azure/iot-edge

[lnk-publisher-github]: https://github.com/Azure/iot-edge-opc-publisher
[lnk-publisher-docker]: https://hub.docker.com/r/microsoft/iot-gateway-opc-ua
[lnk-proxy-github]: https://github.com/Azure/iot-edge-opc-proxy
[lnk-proxy-docker]: https://hub.docker.com/r/microsoft/iot-gateway-opc-ua-proxy