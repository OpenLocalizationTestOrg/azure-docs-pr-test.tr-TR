---
title: "Azure'da kullanıcı tanımlı rotalar ve IP İletimi | Microsoft Docs"
description: "Azure'da trafiği ağ sanal gereçlerine iletmek için kullanıcı tanımlı yolları (UDR) ve IP İletimini nasıl yapılandıracağınızı öğrenin."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: c39076c4-11b7-4b46-a904-817503c4b486
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/15/2016
ms.author: jdial
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 6274e0101f6fb0864c8d1efaef7fcde78b8760c3
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="user-defined-routes-and-ip-forwarding"></a><span data-ttu-id="713ed-103">Kullanıcı tanımlı yollar ve IP iletme</span><span class="sxs-lookup"><span data-stu-id="713ed-103">User-defined routes and IP forwarding</span></span>

<span data-ttu-id="713ed-104">Azure'da bir sanal ağa (VNet) sanal makineler (VM'ler) eklediğiniz zaman, VM'lerin birbirleri ile ağ üzerinde otomatik olarak iletişim kurabildiklerini fark edersiniz.</span><span class="sxs-lookup"><span data-stu-id="713ed-104">When you add virtual machines (VMs) to a virtual network (VNet) in Azure, you will notice that the VMs are able to communicate with each other over the network, automatically.</span></span> <span data-ttu-id="713ed-105">VM'ler farklı alt ağlarda bulunsa bile bir ağ geçidini belirtmenize gerek yoktur.</span><span class="sxs-lookup"><span data-stu-id="713ed-105">You do not need to specify a gateway, even though the VMs are in different subnets.</span></span> <span data-ttu-id="713ed-106">Aynı şey VM'lerden genel İnternet'e giden iletişimlerde ve hatta Azure'dan kendi veri merkezinize karma bir bağlantı bulunduğunda şirket içi ağınıza giden iletişimlerde de geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="713ed-106">The same is true for communication from the VMs to the public Internet, and even to your on-premises network when a hybrid connection from Azure to your own datacenter is present.</span></span>

<span data-ttu-id="713ed-107">Bu iletişim akışının mümkün olmasını sağlayan şey, Azure'ın IP trafiğinin nasıl akacağını belirlemek için kullandığı bir dizi sistem yoludur.</span><span class="sxs-lookup"><span data-stu-id="713ed-107">This flow of communication is possible because Azure uses a series of system routes to define how IP traffic flows.</span></span> <span data-ttu-id="713ed-108">Sistem yolları aşağıdaki senaryolarda iletişim akışını denetler:</span><span class="sxs-lookup"><span data-stu-id="713ed-108">System routes control the flow of communication in the following scenarios:</span></span>

* <span data-ttu-id="713ed-109">Aynı alt ağ içinden.</span><span class="sxs-lookup"><span data-stu-id="713ed-109">From within the same subnet.</span></span>
* <span data-ttu-id="713ed-110">Bir sanal ağ içinde bir alt ağdan başka bir alt ağa.</span><span class="sxs-lookup"><span data-stu-id="713ed-110">From a subnet to another within a VNet.</span></span>
* <span data-ttu-id="713ed-111">VM'lerden İnternet'e.</span><span class="sxs-lookup"><span data-stu-id="713ed-111">From VMs to the Internet.</span></span>
* <span data-ttu-id="713ed-112">Bir VPN ağ geçidi yoluyla bir sanal ağdan başka bir sanal ağa.</span><span class="sxs-lookup"><span data-stu-id="713ed-112">From a VNet to another VNet through a VPN gateway.</span></span>
* <span data-ttu-id="713ed-113">Sanal Ağ Eşleme (Hizmet Zinciri) yoluyla bir sanal ağdan başka bir sanal ağa.</span><span class="sxs-lookup"><span data-stu-id="713ed-113">From a VNet to another VNet through VNet Peering (Service Chaining).</span></span>
* <span data-ttu-id="713ed-114">Bir VPN ağ geçidi yoluyla bir sanal ağdan şirket içi ağınıza.</span><span class="sxs-lookup"><span data-stu-id="713ed-114">From a VNet to your on-premises network through a VPN gateway.</span></span>

<span data-ttu-id="713ed-115">Aşağıdaki şekilde bir sanal ağı, iki alt ağı, birkaç VM'yi ve IP trafiğinin akmasını sağlayan sistem yollarını içeren basit bir kurulum gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="713ed-115">The figure below shows a simple setup with a VNet, two subnets, and a few VMs, along with the system routes that allow IP traffic to flow.</span></span>

![Azure'daki sistem yolları](./media/virtual-networks-udr-overview/Figure1.png)

<span data-ttu-id="713ed-117">Sistem yollarının kullanımı dağıtımınız için trafiği otomatik olarak kolaylaştırsa da, bir sanal gereç yoluyla paketlerin yönlendirilmesini denetlemek isteyeceğiniz durumlar vardır.</span><span class="sxs-lookup"><span data-stu-id="713ed-117">Although the use of system routes facilitates traffic automatically for your deployment, there are cases in which you want to control the routing of packets through a virtual appliance.</span></span> <span data-ttu-id="713ed-118">Bunun için paketlerin belirli bir alt ağa akmak yerine bir sonraki atlamada sanal gerecinize gitmelerini belirten ve sanal gereç olarak çalışan VM için IP iletimini etkinleştiren kullanıcı tanımlı yollar oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="713ed-118">You can do so by creating user defined routes that specify the next hop for packets flowing to a specific subnet to go to your virtual appliance instead, and enabling IP forwarding for the VM running as the virtual appliance.</span></span>

<span data-ttu-id="713ed-119">Aşağıdaki şekilde, bir alt ağdan başka bir alt ağa gönderilen paketleri üçüncü bir alt ağdaki sanal gereçten geçmeye zorlayan kullanıcı tanımlı yolların ve IP iletiminin bir örneği gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="713ed-119">The figure below shows an example of user defined routes and IP forwarding to force packets sent to one subnet from another to go through a virtual appliance on a third subnet.</span></span>

![Azure'daki sistem yolları](./media/virtual-networks-udr-overview/Figure2.png)

> [!IMPORTANT]
> <span data-ttu-id="713ed-121">Kullanıcı tanımlı yollar, alt ağdaki herhangi bir kaynaktan (VM’lere eklenen ağ arabirimleri gibi) alt ağdan çıkan trafiğe uygulanır.</span><span class="sxs-lookup"><span data-stu-id="713ed-121">User-defined routes are applied to traffic leaving a subnet from any resource (such as network interfaces attached to VMs) in the subnet.</span></span> <span data-ttu-id="713ed-122">Örneğin, İnternet’ten alt ağa trafiğin nasıl girdiğini belirtmek için rotalar oluşturamazsınız.</span><span class="sxs-lookup"><span data-stu-id="713ed-122">You cannot create routes to specify how traffic enters a subnet from the Internet, for instance.</span></span> <span data-ttu-id="713ed-123">Trafiği ilettiğiniz gereç, trafiğin kaynaklandığı alt ağda yer alamaz.</span><span class="sxs-lookup"><span data-stu-id="713ed-123">The appliance you are forwarding traffic to cannot be in the same subnet where the traffic originates.</span></span> <span data-ttu-id="713ed-124">Gereçleriniz için her zaman ayrı bir alt ağ oluşturun.</span><span class="sxs-lookup"><span data-stu-id="713ed-124">Always create a separate subnet for your appliances.</span></span> 
> 
> 

## <a name="route-resource"></a><span data-ttu-id="713ed-125">Yol kaynağı</span><span class="sxs-lookup"><span data-stu-id="713ed-125">Route resource</span></span>
<span data-ttu-id="713ed-126">Paketler, fiziksel ağdaki her düğümde tanımlanan bir yol tablosu temel alınarak bir TCP/IP ağı üzerinden yönlendirilir.</span><span class="sxs-lookup"><span data-stu-id="713ed-126">Packets are routed over a TCP/IP network based on a route table defined at each node on the physical network.</span></span> <span data-ttu-id="713ed-127">Yol tablosu, hedef IP adresine göre paketlerin nereye iletileceğine karar veren bir tekil yollar koleksiyonudur.</span><span class="sxs-lookup"><span data-stu-id="713ed-127">A route table is a collection of individual routes used to decide where to forward packets based on the destination IP address.</span></span> <span data-ttu-id="713ed-128">Bir yol aşağıdakilerden oluşur:</span><span class="sxs-lookup"><span data-stu-id="713ed-128">A route consists of the following:</span></span>

| <span data-ttu-id="713ed-129">Özellik</span><span class="sxs-lookup"><span data-stu-id="713ed-129">Property</span></span> | <span data-ttu-id="713ed-130">Açıklama</span><span class="sxs-lookup"><span data-stu-id="713ed-130">Description</span></span> | <span data-ttu-id="713ed-131">Kısıtlamalar</span><span class="sxs-lookup"><span data-stu-id="713ed-131">Constraints</span></span> | <span data-ttu-id="713ed-132">Dikkat edilmesi gerekenler</span><span class="sxs-lookup"><span data-stu-id="713ed-132">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="713ed-133">Adres Ön Eki</span><span class="sxs-lookup"><span data-stu-id="713ed-133">Address Prefix</span></span> |<span data-ttu-id="713ed-134">Yolun uygulandığı hedef CIDR'si, ör. 10.1.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="713ed-134">The destination CIDR to which the route applies, such as 10.1.0.0/16.</span></span> |<span data-ttu-id="713ed-135">Genel İnternet, Azure sanal ağı veya şirket içi veri merkezi üzerindeki adresleri temsil eden geçerli bir CIDR aralığı olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="713ed-135">Must be a valid CIDR range representing addresses on the public Internet, Azure virtual network, or on-premises datacenter.</span></span> |<span data-ttu-id="713ed-136">**Adres ön ekinin** **Nexthop adresini** içermediğinden emin olun, aksi halde kaynaktan bir sonraki atlamaya giden paketleriniz hedefe hiç varmadan bir döngüye girer.</span><span class="sxs-lookup"><span data-stu-id="713ed-136">Make sure the **Address prefix** does not contain the address for the **Next hop address**, otherwise your packets will enter in a loop going from the source to the next hop without ever reaching the destination.</span></span> |
| <span data-ttu-id="713ed-137">Sonraki atlama türü</span><span class="sxs-lookup"><span data-stu-id="713ed-137">Next hop type</span></span> |<span data-ttu-id="713ed-138">Paketin gönderilmesi gereken Azure atlama türü.</span><span class="sxs-lookup"><span data-stu-id="713ed-138">The type of Azure hop the packet should be sent to.</span></span> |<span data-ttu-id="713ed-139">Aşağıdaki değerlerden biri olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="713ed-139">Must be one of the following values:</span></span> <br/> <span data-ttu-id="713ed-140">**Sanal Ağ**.</span><span class="sxs-lookup"><span data-stu-id="713ed-140">**Virtual Network**.</span></span> <span data-ttu-id="713ed-141">Yerel sanal ağı temsil eder.</span><span class="sxs-lookup"><span data-stu-id="713ed-141">Represents the local virtual network.</span></span> <span data-ttu-id="713ed-142">Örneğin, aynı sanal ağ içinde 10.1.0.0/16 ve 10.2.0.0/16 şeklinde iki alt ağınız varsa yol tablosundaki her alt ağ yolunun bir sonraki atlama değeri *Sanal Ağ* olur.</span><span class="sxs-lookup"><span data-stu-id="713ed-142">For instance, if you have two subnets, 10.1.0.0/16 and 10.2.0.0/16 in the same virtual network, the route for each subnet in the route table will have a next hop value of *Virtual Network*.</span></span> <br/> <span data-ttu-id="713ed-143">**Sanal Ağ Geçidi**.</span><span class="sxs-lookup"><span data-stu-id="713ed-143">**Virtual Network Gateway**.</span></span> <span data-ttu-id="713ed-144">Azure S2S VPN Gateway'i temsil eder.</span><span class="sxs-lookup"><span data-stu-id="713ed-144">Represents an Azure S2S VPN Gateway.</span></span> <br/> <span data-ttu-id="713ed-145">**İnternet**.</span><span class="sxs-lookup"><span data-stu-id="713ed-145">**Internet**.</span></span> <span data-ttu-id="713ed-146">Azure Altyapısı tarafından sağlanan varsayılan İnternet ağ geçidini temsil eder.</span><span class="sxs-lookup"><span data-stu-id="713ed-146">Represents the default Internet gateway provided by the Azure Infrastructure.</span></span> <br/> <span data-ttu-id="713ed-147">**Sanal Gereç**.</span><span class="sxs-lookup"><span data-stu-id="713ed-147">**Virtual Appliance**.</span></span> <span data-ttu-id="713ed-148">Azure sanal ağınıza eklediğiniz sanal gereci temsil eder.</span><span class="sxs-lookup"><span data-stu-id="713ed-148">Represents a virtual appliance you added to your Azure virtual network.</span></span> <br/> <span data-ttu-id="713ed-149">**None**.</span><span class="sxs-lookup"><span data-stu-id="713ed-149">**None**.</span></span> <span data-ttu-id="713ed-150">Bir kara deliği temsil eder.</span><span class="sxs-lookup"><span data-stu-id="713ed-150">Represents a black hole.</span></span> <span data-ttu-id="713ed-151">Bir kara deliğe iletilen paketler aktarılmaz.</span><span class="sxs-lookup"><span data-stu-id="713ed-151">Packets forwarded to a black hole will not be forwarded at all.</span></span> |<span data-ttu-id="713ed-152">Trafiği bir VM veya Azure Load Balancer iç IP adresine yönlendirmek için **Sanal Gereç** kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="713ed-152">Consider using **Virtual Appliance** to direct traffic to a VM or Azure Load Balancer internal IP address.</span></span>  <span data-ttu-id="713ed-153">Bu tür, aşağıda belirtilen şekilde bir IP adresinin belirtilmesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="713ed-153">This type allows the specification of an IP address as described below.</span></span> <span data-ttu-id="713ed-154">Paketlerin belirli bir hedefe akmasını durdurmak için bir **None** türünü kullanmayı değerlendirin.</span><span class="sxs-lookup"><span data-stu-id="713ed-154">Consider using a **None** type to stop packets from flowing to a given destination.</span></span> |
| <span data-ttu-id="713ed-155">Sonraki atlama adresi</span><span class="sxs-lookup"><span data-stu-id="713ed-155">Next hop address</span></span> |<span data-ttu-id="713ed-156">Sonraki atlama adresi, paketlerin iletilmesi gereken IP adresini içerir.</span><span class="sxs-lookup"><span data-stu-id="713ed-156">The next hop address contains the IP address packets should be forwarded to.</span></span> <span data-ttu-id="713ed-157">Yalnızca sonraki atlama türünün *Sanal Gereç* olduğu yollarda sonraki atlama değerlerine izin verilir.</span><span class="sxs-lookup"><span data-stu-id="713ed-157">Next hop values are only allowed in routes where the next hop type is *Virtual Appliance*.</span></span> |<span data-ttu-id="713ed-158">Bir **Sanal Ağ Geçidi**’nden geçmeden Kullanıcı Tanımlı Yolun uygulandığı Sanal Ağ içerisinde erişilebilir bir IP adresi olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="713ed-158">Must be an IP address that is reachable within the Virtual Network where the User Defined Route is applied, without going through a **Virtual Network Gateway**.</span></span> <span data-ttu-id="713ed-159">IP adresi, uygulandığı Sanal Ağ üzerinde veya eşlenmiş bir Sanal Ağ üzerinde olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="713ed-159">The IP address has to be on the same Virtual Network where it is applied, or on a peered Virtual Network.</span></span> |<span data-ttu-id="713ed-160">IP adresi bir VM'yi temsil ediyorsa Azure'da VM için [IP iletimini](#IP-forwarding) etkinleştirdiğinizden emin olun.</span><span class="sxs-lookup"><span data-stu-id="713ed-160">If the IP address represents a VM, make sure you enable [IP forwarding](#IP-forwarding) in Azure for the VM.</span></span> <span data-ttu-id="713ed-161">IP adresi, Azure Load Balancer'ın iç IP adresini temsil ediyorsa, yük dengeleme yapmak istediğiniz her bağlantı noktasına karşılık gelen bir yük dengeleme kuralına sahip olduğunuzdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="713ed-161">If the IP address represents the internal IP address of Azure Load Balancer, make sure you have a matching load balancing rule for each port you wish to load balance.</span></span>|

<span data-ttu-id="713ed-162">Azure PowerShell’de "NextHopType" değerlerinin bazıları farklı adlara sahiptir:</span><span class="sxs-lookup"><span data-stu-id="713ed-162">In Azure PowerShell some of the "NextHopType" values have different names:</span></span>

* <span data-ttu-id="713ed-163">Sanal Ağ VnetLocal şeklindedir</span><span class="sxs-lookup"><span data-stu-id="713ed-163">Virtual Network is VnetLocal</span></span>
* <span data-ttu-id="713ed-164">Sanal Ağ Geçidi VirtualNetworkGateway şeklindedir</span><span class="sxs-lookup"><span data-stu-id="713ed-164">Virtual Network Gateway is VirtualNetworkGateway</span></span>
* <span data-ttu-id="713ed-165">Sanal Gereç VirtualAppliance şeklindedir</span><span class="sxs-lookup"><span data-stu-id="713ed-165">Virtual Appliance is VirtualAppliance</span></span>
* <span data-ttu-id="713ed-166">İnternet, İnternet’tir</span><span class="sxs-lookup"><span data-stu-id="713ed-166">Internet is Internet</span></span>
* <span data-ttu-id="713ed-167">None, None şeklindedir</span><span class="sxs-lookup"><span data-stu-id="713ed-167">None is None</span></span>

### <a name="system-routes"></a><span data-ttu-id="713ed-168">Sistem yolları</span><span class="sxs-lookup"><span data-stu-id="713ed-168">System routes</span></span>
<span data-ttu-id="713ed-169">Bir sanal ağda oluşturulan her alt ağ, aşağıdaki sistem yolu kurallarını içeren bir yol tablosu ile otomatik olarak ilişkilendirilir:</span><span class="sxs-lookup"><span data-stu-id="713ed-169">Every subnet created in a virtual network is automatically associated with a route table that contains the following system route rules:</span></span>

* <span data-ttu-id="713ed-170">**Yerel Sanal Ağ Kuralı**: Bu kural bir sanal ağdaki her alt ağ için otomatik olarak oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="713ed-170">**Local Vnet Rule**: This rule is automatically created for every subnet in a virtual network.</span></span> <span data-ttu-id="713ed-171">Sanal ağ içindeki VM'ler arasında doğrudan bir bağlantı olduğunu ve ara sonraki atlama bulunmadığını belirtir.</span><span class="sxs-lookup"><span data-stu-id="713ed-171">It specifies that there is a direct link between the VMs in the VNet and there is no intermediate next hop.</span></span>
* <span data-ttu-id="713ed-172">**Şirket İçi Kuralı**: Bu kural şirket içi adres aralığına giden tüm trafiğe uygulanır ve sonraki atlama hedefi olarak VPN ağ geçidini kullanır.</span><span class="sxs-lookup"><span data-stu-id="713ed-172">**On-premises Rule**: This rule applies to all traffic destined to the on-premises address range and uses VPN gateway as the next hop destination.</span></span>
* <span data-ttu-id="713ed-173">**İnternet Kuralı**: Bu kural, genel İnternet'e (adres ön eki: 0.0.0.0/0) giden tüm trafiği işler ve İnternet'e giden tüm trafik için sonraki durak olarak İnternet ağ geçidi altyapısını kullanır.</span><span class="sxs-lookup"><span data-stu-id="713ed-173">**Internet Rule**: This rule handles all traffic destined to the public Internet (address prefix 0.0.0.0/0) and uses the infrastructure internet gateway as the next hop for all traffic destined to the Internet.</span></span>

### <a name="user-defined-routes"></a><span data-ttu-id="713ed-174">Kullanıcı tanımlı yollar</span><span class="sxs-lookup"><span data-stu-id="713ed-174">User-defined routes</span></span>
<span data-ttu-id="713ed-175">Çoğu ortam için ihtiyaç duyacağınız tek şey, Azure'da zaten tanımlanmış olan sistem yollarıdır.</span><span class="sxs-lookup"><span data-stu-id="713ed-175">For most environments you will only need the system routes already defined by Azure.</span></span> <span data-ttu-id="713ed-176">Ancak belirli durumlarda bir yol tablosu oluşturmanız ve bir veya daha fazla yol eklemeniz gerekebilir, örneğin:</span><span class="sxs-lookup"><span data-stu-id="713ed-176">However, you may need to create a route table and add one or more routes in specific cases, such as:</span></span>

* <span data-ttu-id="713ed-177">Şirket içi ağınız yoluyla İnternet'e zorlamalı tünel uygulama.</span><span class="sxs-lookup"><span data-stu-id="713ed-177">Force tunneling to the Internet via your on-premises network.</span></span>
* <span data-ttu-id="713ed-178">Azure ortamınızda sanal gereçleri kullanma.</span><span class="sxs-lookup"><span data-stu-id="713ed-178">Use of virtual appliances in your Azure environment.</span></span>

<span data-ttu-id="713ed-179">Yukarıdaki senaryolarda bir yol tablosu oluşturmanız ve buna kullanıcı tanımlı yollar eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="713ed-179">In the scenarios above, you will have to create a route table and add user defined routes to it.</span></span> <span data-ttu-id="713ed-180">Birden fazla yol tablonuz olabilir ve bir yol tablosu bir veya daha fazla alt ağ ile ilişkilendirilebilir.</span><span class="sxs-lookup"><span data-stu-id="713ed-180">You can have multiple route tables, and the same route table can be associated to one or more subnets.</span></span> <span data-ttu-id="713ed-181">Bununla birlikte her alt ağ yalnızca tek bir yol tablosu ile ilişkilendirilebilir.</span><span class="sxs-lookup"><span data-stu-id="713ed-181">And each subnet can only be associated to a single route table.</span></span> <span data-ttu-id="713ed-182">Bir alt ağda bulunan tüm VM'ler ve bulut hizmetleri bu alt ağ ile ilişkilendirilen yol tablosunu kullanır.</span><span class="sxs-lookup"><span data-stu-id="713ed-182">All VMs and cloud services in a subnet use the route table associated to that subnet.</span></span>

<span data-ttu-id="713ed-183">Yol tablosu bir alt ağ ile ilişkilendirilene kadar alt ağlar sistem yollarına bağımlıdır.</span><span class="sxs-lookup"><span data-stu-id="713ed-183">Subnets rely on system routes until a route table is associated to the subnet.</span></span> <span data-ttu-id="713ed-184">Bir ilişki oluşturulduğu zaman, hem kullanıcı tanımlı yollar hem de sistem yolları arasında En Uzun Ön Ek Eşleşmesi (LPM) temel alınarak yönlendirme uygulanır.</span><span class="sxs-lookup"><span data-stu-id="713ed-184">Once an association exists, routing is done based on Longest Prefix Match (LPM) among both user defined routes and system routes.</span></span> <span data-ttu-id="713ed-185">Aynı LPM eşleşmesine sahip birden fazla yol bulunuyorsa yol aşağıdaki sırayla ve kaynağına göre seçilir:</span><span class="sxs-lookup"><span data-stu-id="713ed-185">If there is more than one route with the same LPM match then a route is selected based on its origin in the following order:</span></span>

1. <span data-ttu-id="713ed-186">Kullanıcı tanımlı yol</span><span class="sxs-lookup"><span data-stu-id="713ed-186">User defined route</span></span>
2. <span data-ttu-id="713ed-187">BGP yolu (ExpressRoute kullanıldığında)</span><span class="sxs-lookup"><span data-stu-id="713ed-187">BGP route (when ExpressRoute is used)</span></span>
3. <span data-ttu-id="713ed-188">Sistem yolu</span><span class="sxs-lookup"><span data-stu-id="713ed-188">System route</span></span>

<span data-ttu-id="713ed-189">Kullanıcı tanımlı yolların nasıl oluşturulacağını öğrenmek için bkz. [Azure'da Yollar Oluşturma ve IP İletimini Etkinleştirme](virtual-network-create-udr-arm-template.md).</span><span class="sxs-lookup"><span data-stu-id="713ed-189">To learn how to create user defined routes, see [How to Create Routes and Enable IP Forwarding in Azure](virtual-network-create-udr-arm-template.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="713ed-190">Kullanıcı tanımlı yollar yalnızca Azure VM'leri ve bulut hizmetleri için uygulanır.</span><span class="sxs-lookup"><span data-stu-id="713ed-190">User defined routes are only applied to Azure VMs and cloud services.</span></span> <span data-ttu-id="713ed-191">Örneğin, şirket içi ağınız ve Azure arasında bir güvenlik duvarı sanal gereci eklemek isterseniz Azure yol tablolarınız için şirket içi adres alanına giden tüm trafiği sanal gerece ileten bir yol oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="713ed-191">For instance, if you want to add a firewall virtual appliance between your on-premises network and Azure, you will have to create a user defined route for your Azure route tables that forwards all traffic going to the on-premises address space to the virtual appliance.</span></span> <span data-ttu-id="713ed-192">Şirket içinden gelen tüm trafiği sanal gereç aracılığıyla Azure'a iletmek için GatewaySubnet'e kullanıcı tanımlı bir yol da (UDR) ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="713ed-192">You can also add a user defined route (UDR) to the GatewaySubnet to forward all traffic from on-premises to Azure through the virtual appliance.</span></span> <span data-ttu-id="713ed-193">Bu, kısa süre önce yapılan bir eklemedir.</span><span class="sxs-lookup"><span data-stu-id="713ed-193">This is a recent addition.</span></span>
> 
> 

### <a name="bgp-routes"></a><span data-ttu-id="713ed-194">BGP yolları</span><span class="sxs-lookup"><span data-stu-id="713ed-194">BGP routes</span></span>
<span data-ttu-id="713ed-195">Şirket içi ağınız ve Azure arasında bir ExpressRoute bağlantınız varsa BGP'yi etkinleştirerek şirket içi ağınızdan Azure'a giden yollar yayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="713ed-195">If you have an ExpressRoute connection between your on-premises network and Azure, you can enable BGP to propagate routes from your on-premises network to Azure.</span></span> <span data-ttu-id="713ed-196">Bu BGP yolları, her Azure alt ağında yer alan sistem yollarıyla ve kullanıcı tanımlı yollarla aynı şekilde kullanılır.</span><span class="sxs-lookup"><span data-stu-id="713ed-196">These BGP routes are used in the same way as system routes and user defined routes in each Azure subnet.</span></span> <span data-ttu-id="713ed-197">Daha fazla bilgi için bkz. [ExpressRoute'a Giriş](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="713ed-197">For more information see [ExpressRoute Introduction](../expressroute/expressroute-introduction.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="713ed-198">Şirket içi ağınızda zorlamalı tünel kullanmak üzere Azure ortamınızı yapılandırabilirsiniz, bunun için sonraki atlama olarak VPN ağ geçidini kullanan 0.0.0.0/0 alt ağı için kullanıcı tanımlı bir yol oluşturun.</span><span class="sxs-lookup"><span data-stu-id="713ed-198">You can configure your Azure environment to use force tunneling through your on-premises network by creating a user defined route for subnet 0.0.0.0/0 that uses the VPN gateway as the next hop.</span></span> <span data-ttu-id="713ed-199">Ancak bu işlem yalnızca ExpressRoute yerine bir VPN ağ geçidini kullandığınız zaman çalışır.</span><span class="sxs-lookup"><span data-stu-id="713ed-199">However, this only works if you are using a VPN gateway, not ExpressRoute.</span></span> <span data-ttu-id="713ed-200">ExpressRoute için zorlamalı tünel BGP yoluyla yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="713ed-200">For ExpressRoute, forced tunneling is configured through BGP.</span></span>
> 
> 

## <a name="ip-forwarding"></a><span data-ttu-id="713ed-201">IP iletimi</span><span class="sxs-lookup"><span data-stu-id="713ed-201">IP forwarding</span></span>
<span data-ttu-id="713ed-202">Yukarıda açıklanan şekilde, kullanıcı tanımlı bir yol oluşturmanın temel nedenlerinden biri de trafiği bir sanal gerece iletmektir.</span><span class="sxs-lookup"><span data-stu-id="713ed-202">As described above, one of the main reasons to create a user defined route is to forward traffic to a virtual appliance.</span></span> <span data-ttu-id="713ed-203">Sanal gereç, güvenlik duvarı veya NAT cihazı gibi ağ trafiğini işlemek için kullanılan bir uygulamayı çalıştıran bir VM'den fazlası değildir.</span><span class="sxs-lookup"><span data-stu-id="713ed-203">A virtual appliance is nothing more than a VM that runs an application used to handle network traffic in some way, such as a firewall or a NAT device.</span></span>

<span data-ttu-id="713ed-204">Bu sanal gereç VM'si, kendisine yönelik olmayan gelen trafiği alabilmelidir.</span><span class="sxs-lookup"><span data-stu-id="713ed-204">This virtual appliance VM must be able to receive incoming traffic that is not addressed to itself.</span></span> <span data-ttu-id="713ed-205">Bir VM'nin başka hedeflere yönelik trafiği alabilmesine izin vermek için VM'de IP İletimini etkinleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="713ed-205">To allow a VM to receive traffic addressed to other destinations, you must enable IP Forwarding for the VM.</span></span> <span data-ttu-id="713ed-206">Bu ayar konuk işletim sisteminin değil, Azure'ın bir ayarıdır.</span><span class="sxs-lookup"><span data-stu-id="713ed-206">This is an Azure setting, not a setting in the guest operating system.</span></span>

## <a name="next-steps"></a><span data-ttu-id="713ed-207">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="713ed-207">Next steps</span></span>
* <span data-ttu-id="713ed-208">[Resource Manager dağıtım modelinde yollar oluşturmayı](virtual-network-create-udr-arm-template.md) ve bunları alt ağlar ile ilişkilendirmeyi öğrenin.</span><span class="sxs-lookup"><span data-stu-id="713ed-208">Learn how to [create routes in the Resource Manager deployment model](virtual-network-create-udr-arm-template.md) and associate them to subnets.</span></span> 
* <span data-ttu-id="713ed-209">[Klasik dağıtım modelinde yollar oluşturmayı](virtual-network-create-udr-classic-ps.md) ve bunları alt ağlar ile ilişkilendirmeyi öğrenin.</span><span class="sxs-lookup"><span data-stu-id="713ed-209">Learn how to [create routes in the classic deployment model](virtual-network-create-udr-classic-ps.md) and associate them to subnets.</span></span>

