---
title: "aaaUser tanımlı yollar ve IP iletimi azure'da | Microsoft Docs"
description: "Azure'da sanal gereçler toonetwork tooconfigure kullanıcı tanımlı yolları (UDR) ve IP iletimi tooforward nasıl trafiği öğrenin."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: c39076c4-11b7-4b46-a904-817503c4b486
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/15/2016
ms.author: jdial
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f1f1d46166d5a7c776f472b7ade1354d943ece10
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="user-defined-routes-and-ip-forwarding"></a><span data-ttu-id="2bd8e-103">Kullanıcı tanımlı yollar ve IP iletme</span><span class="sxs-lookup"><span data-stu-id="2bd8e-103">User-defined routes and IP forwarding</span></span>

<span data-ttu-id="2bd8e-104">Azure'da sanal makine (VM) tooa sanal ağ (VNet) eklediğinizde, hello VM'ler hello ağ üzerinden birbirleriyle mümkün toocommunicate otomatik olarak olduğunu fark edeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-104">When you add virtual machines (VMs) tooa virtual network (VNet) in Azure, you will notice that hello VMs are able toocommunicate with each other over hello network, automatically.</span></span> <span data-ttu-id="2bd8e-105">Merhaba VM'ler olsa da farklı alt ağlarda bir ağ geçidi toospecify gerekmez.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-105">You do not need toospecify a gateway, even though hello VMs are in different subnets.</span></span> <span data-ttu-id="2bd8e-106">Merhaba aynı hello VM'ler toohello gelen iletişimi için doğru ortak Internet ve Azure tooyour karma bağlantısından sahip olduğunda datacenter varsa bile tooyour şirket içi ağ.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-106">hello same is true for communication from hello VMs toohello public Internet, and even tooyour on-premises network when a hybrid connection from Azure tooyour own datacenter is present.</span></span>

<span data-ttu-id="2bd8e-107">Azure bir dizi IP trafiğinin nasıl akacağını sistem yolları toodefine kullandığından bu iletişim akışını mümkündür.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-107">This flow of communication is possible because Azure uses a series of system routes toodefine how IP traffic flows.</span></span> <span data-ttu-id="2bd8e-108">Sistem yolları senaryoları aşağıdaki hello iletişiminde hello akışını denetler:</span><span class="sxs-lookup"><span data-stu-id="2bd8e-108">System routes control hello flow of communication in hello following scenarios:</span></span>

* <span data-ttu-id="2bd8e-109">Aynı alt ağ içinden hello.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-109">From within hello same subnet.</span></span>
* <span data-ttu-id="2bd8e-110">Bir sanal ağ içindeki bir alt ağ tooanother.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-110">From a subnet tooanother within a VNet.</span></span>
* <span data-ttu-id="2bd8e-111">Sanal makineleri toohello ' Internet.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-111">From VMs toohello Internet.</span></span>
* <span data-ttu-id="2bd8e-112">Bir VNet tooanother sanal ağ VPN ağ geçidi üzerinden.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-112">From a VNet tooanother VNet through a VPN gateway.</span></span>
* <span data-ttu-id="2bd8e-113">Bir VNet tooanother VNet eşlemesi (hizmet zincirleme) aracılığıyla VNet.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-113">From a VNet tooanother VNet through VNet Peering (Service Chaining).</span></span>
* <span data-ttu-id="2bd8e-114">VNet tooyour şirket içi ağ üzerinden bir VPN ağ geçidi üzerinden.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-114">From a VNet tooyour on-premises network through a VPN gateway.</span></span>

<span data-ttu-id="2bd8e-115">Aşağıdaki Hello şekilde VNet, iki alt ağ ve birkaç VM'yi hello içeren basit bir kurulum IP trafiğinin tooflow izin sistem yolları gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-115">hello figure below shows a simple setup with a VNet, two subnets, and a few VMs, along with hello system routes that allow IP traffic tooflow.</span></span>

![Azure'daki sistem yolları](./media/virtual-networks-udr-overview/Figure1.png)

<span data-ttu-id="2bd8e-117">Sistem yolları Hello kullanımını trafiği dağıtımınız için otomatik olarak kolaylaştırsa da, toocontrol hello bir sanal gereç yoluyla paketlerin yönlendirilmesini istediğiniz durumlar vardır.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-117">Although hello use of system routes facilitates traffic automatically for your deployment, there are cases in which you want toocontrol hello routing of packets through a virtual appliance.</span></span> <span data-ttu-id="2bd8e-118">Bu nedenle, kullanıcı tanımlı yollar oluşturarak tooa belirli alt toogo tooyour sanal gereç yerine akan paketlerde için sonraki atlama hello belirtebilirsiniz ve IP iletme için hello hello sanal gereç olarak çalışan VM.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-118">You can do so by creating user defined routes that specify hello next hop for packets flowing tooa specific subnet toogo tooyour virtual appliance instead, and enabling IP forwarding for hello VM running as hello virtual appliance.</span></span>

<span data-ttu-id="2bd8e-119">Kullanıcı tanımlı yollar örneğini aşağıdaki şekilde Hello gösterir ve tooforce paketleri iletme IP tooone alt üçüncü bir alt ağdaki sanal gereç aracılığıyla başka bir toogo gönderilir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-119">hello figure below shows an example of user defined routes and IP forwarding tooforce packets sent tooone subnet from another toogo through a virtual appliance on a third subnet.</span></span>

![Azure'daki sistem yolları](./media/virtual-networks-udr-overview/Figure2.png)

> [!IMPORTANT]
> <span data-ttu-id="2bd8e-121">Kullanıcı tanımlı yolların (ağ arabirimleri tooVMs bağlı gibi) bir alt ağ hello alt ağda herhangi bir kaynağa bırakarak uygulanan tootraffic edilir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-121">User-defined routes are applied tootraffic leaving a subnet from any resource (such as network interfaces attached tooVMs) in hello subnet.</span></span> <span data-ttu-id="2bd8e-122">Yollar toospecify oluşturulamıyor nasıl trafiği bir alt ağ Internet hello örneği için girer.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-122">You cannot create routes toospecify how traffic enters a subnet from hello Internet, for instance.</span></span> <span data-ttu-id="2bd8e-123">trafik toocannot iletme hello Gereci olması hello hello trafiğin kaynaklandığı aynı alt ağ.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-123">hello appliance you are forwarding traffic toocannot be in hello same subnet where hello traffic originates.</span></span> <span data-ttu-id="2bd8e-124">Gereçleriniz için her zaman ayrı bir alt ağ oluşturun.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-124">Always create a separate subnet for your appliances.</span></span> 
> 
> 

## <a name="route-resource"></a><span data-ttu-id="2bd8e-125">Yol kaynağı</span><span class="sxs-lookup"><span data-stu-id="2bd8e-125">Route resource</span></span>
<span data-ttu-id="2bd8e-126">Paketler hello fiziksel ağdaki her düğümde tanımlanan bir yol tablosu temel bir TCP/IP ağı üzerinden yönlendirilir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-126">Packets are routed over a TCP/IP network based on a route table defined at each node on hello physical network.</span></span> <span data-ttu-id="2bd8e-127">Bir yol tablosu tek tek rota koleksiyonu toodecide nerede tooforward paketleri hello hedef sunucudaki IP adresi tabanlı kullanılır.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-127">A route table is a collection of individual routes used toodecide where tooforward packets based on hello destination IP address.</span></span> <span data-ttu-id="2bd8e-128">Bir rota hello şunlardan oluşur:</span><span class="sxs-lookup"><span data-stu-id="2bd8e-128">A route consists of hello following:</span></span>

| <span data-ttu-id="2bd8e-129">Özellik</span><span class="sxs-lookup"><span data-stu-id="2bd8e-129">Property</span></span> | <span data-ttu-id="2bd8e-130">Açıklama</span><span class="sxs-lookup"><span data-stu-id="2bd8e-130">Description</span></span> | <span data-ttu-id="2bd8e-131">Kısıtlamalar</span><span class="sxs-lookup"><span data-stu-id="2bd8e-131">Constraints</span></span> | <span data-ttu-id="2bd8e-132">Dikkat edilmesi gerekenler</span><span class="sxs-lookup"><span data-stu-id="2bd8e-132">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="2bd8e-133">Adres Ön Eki</span><span class="sxs-lookup"><span data-stu-id="2bd8e-133">Address Prefix</span></span> |<span data-ttu-id="2bd8e-134">Merhaba hedef CIDR toowhich hello rota 10.1.0.0/16 gibi uygulanır.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-134">hello destination CIDR toowhich hello route applies, such as 10.1.0.0/16.</span></span> |<span data-ttu-id="2bd8e-135">Merhaba üzerindeki adresleri temsil eden geçerli bir CIDR aralığı olmalıdır genel Internet, Azure sanal ağı veya şirket içi veri merkezi.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-135">Must be a valid CIDR range representing addresses on hello public Internet, Azure virtual network, or on-premises datacenter.</span></span> |<span data-ttu-id="2bd8e-136">Merhaba emin olun **adres ön eki** hello için başlangıç adresi içermiyor **sonraki atlama adresi**, aksi takdirde paketlerinizi hello kaynak toohello sonraki atlama hiç varmadan bir döngüye girer Merhaba hedef.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-136">Make sure hello **Address prefix** does not contain hello address for hello **Next hop address**, otherwise your packets will enter in a loop going from hello source toohello next hop without ever reaching hello destination.</span></span> |
| <span data-ttu-id="2bd8e-137">Sonraki atlama türü</span><span class="sxs-lookup"><span data-stu-id="2bd8e-137">Next hop type</span></span> |<span data-ttu-id="2bd8e-138">Azure atlama hello paket Hello türü gönderilmesi.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-138">hello type of Azure hop hello packet should be sent to.</span></span> |<span data-ttu-id="2bd8e-139">Değerleri aşağıdaki hello biri olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="2bd8e-139">Must be one of hello following values:</span></span> <br/> <span data-ttu-id="2bd8e-140">**Sanal Ağ**.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-140">**Virtual Network**.</span></span> <span data-ttu-id="2bd8e-141">Merhaba yerel sanal ağı temsil eder.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-141">Represents hello local virtual network.</span></span> <span data-ttu-id="2bd8e-142">Örneğin, iki alt ağlarınız varsa, 10.1.0.0/16 ve 10.2.0.0/16 içinde Merhaba aynı sanal ağ, hello rota hello yol tablosundaki her alt ağ için bir sonraki atlama değeri olacaktır *sanal ağ*.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-142">For instance, if you have two subnets, 10.1.0.0/16 and 10.2.0.0/16 in hello same virtual network, hello route for each subnet in hello route table will have a next hop value of *Virtual Network*.</span></span> <br/> <span data-ttu-id="2bd8e-143">**Sanal Ağ Geçidi**.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-143">**Virtual Network Gateway**.</span></span> <span data-ttu-id="2bd8e-144">Azure S2S VPN Gateway'i temsil eder.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-144">Represents an Azure S2S VPN Gateway.</span></span> <br/> <span data-ttu-id="2bd8e-145">**İnternet**.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-145">**Internet**.</span></span> <span data-ttu-id="2bd8e-146">Merhaba varsayılan Internet ağ geçidi Hello Azure altyapısı tarafından sağlanan temsil eder.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-146">Represents hello default Internet gateway provided by hello Azure Infrastructure.</span></span> <br/> <span data-ttu-id="2bd8e-147">**Sanal Gereç**.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-147">**Virtual Appliance**.</span></span> <span data-ttu-id="2bd8e-148">Azure sanal ağı tooyour eklediğiniz sanal Gereci temsil eder.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-148">Represents a virtual appliance you added tooyour Azure virtual network.</span></span> <br/> <span data-ttu-id="2bd8e-149">**None**.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-149">**None**.</span></span> <span data-ttu-id="2bd8e-150">Bir kara deliği temsil eder.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-150">Represents a black hole.</span></span> <span data-ttu-id="2bd8e-151">Tooa kara delik iletilen paketler hiç iletilir değil.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-151">Packets forwarded tooa black hole will not be forwarded at all.</span></span> |<span data-ttu-id="2bd8e-152">Kullanmayı **sanal gereç** toodirect trafiği tooa VM veya Azure yük dengeleyici iç IP adresi.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-152">Consider using **Virtual Appliance** toodirect traffic tooa VM or Azure Load Balancer internal IP address.</span></span>  <span data-ttu-id="2bd8e-153">Bu tür bir IP adresi aşağıda açıklandığı gibi hello belirtimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-153">This type allows hello specification of an IP address as described below.</span></span> <span data-ttu-id="2bd8e-154">Kullanmayı bir **hiçbiri** hedef verilen boyunca tooa toostop paketler yazın.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-154">Consider using a **None** type toostop packets from flowing tooa given destination.</span></span> |
| <span data-ttu-id="2bd8e-155">Sonraki atlama adresi</span><span class="sxs-lookup"><span data-stu-id="2bd8e-155">Next hop address</span></span> |<span data-ttu-id="2bd8e-156">Merhaba sonraki atlama adresi paketlerin iletilmesi gereken hello IP adresini içerir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-156">hello next hop address contains hello IP address packets should be forwarded to.</span></span> <span data-ttu-id="2bd8e-157">Sonraki atlama değerlerine yalnızca sonraki atlama türü hello olduğu yollarda izin *sanal gereç*.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-157">Next hop values are only allowed in routes where hello next hop type is *Virtual Appliance*.</span></span> |<span data-ttu-id="2bd8e-158">Hello burada hello kullanıcı tanımlı yol uygulanır, oluşturulmak olmadan sanal ağ içinde erişilebilir bir IP adresi olmalıdır bir **sanal ağ geçidi**.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-158">Must be an IP address that is reachable within hello Virtual Network where hello User Defined Route is applied, without going through a **Virtual Network Gateway**.</span></span> <span data-ttu-id="2bd8e-159">Başlangıç IP adresi toobe aynı sanal ağ uygulandığı durumlarda hello veya eşlenmiş bir sanal ağ var.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-159">hello IP address has toobe on hello same Virtual Network where it is applied, or on a peered Virtual Network.</span></span> |<span data-ttu-id="2bd8e-160">Başlangıç IP adresi bir VM'yi temsil ediyorsa, etkinleştirdiğinizden emin olun [IP iletimini](#IP-forwarding) azure'da hello VM için.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-160">If hello IP address represents a VM, make sure you enable [IP forwarding](#IP-forwarding) in Azure for hello VM.</span></span> <span data-ttu-id="2bd8e-161">Merhaba IP adresini temsil hello iç IP adresi Azure yük dengeleyici, değişiklik yaparsanız eşleşen bir Yük Dengeleme kuralı her bağlantı noktası için sahip olduğunuzdan emin tooload Bakiye istiyor.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-161">If hello IP address represents hello internal IP address of Azure Load Balancer, make sure you have a matching load balancing rule for each port you wish tooload balance.</span></span>|

<span data-ttu-id="2bd8e-162">Azure PowerShell'de bazı hello "NextHopType" değerlerinden farklı adlara sahip:</span><span class="sxs-lookup"><span data-stu-id="2bd8e-162">In Azure PowerShell some of hello "NextHopType" values have different names:</span></span>

* <span data-ttu-id="2bd8e-163">Sanal Ağ VnetLocal şeklindedir</span><span class="sxs-lookup"><span data-stu-id="2bd8e-163">Virtual Network is VnetLocal</span></span>
* <span data-ttu-id="2bd8e-164">Sanal Ağ Geçidi VirtualNetworkGateway şeklindedir</span><span class="sxs-lookup"><span data-stu-id="2bd8e-164">Virtual Network Gateway is VirtualNetworkGateway</span></span>
* <span data-ttu-id="2bd8e-165">Sanal Gereç VirtualAppliance şeklindedir</span><span class="sxs-lookup"><span data-stu-id="2bd8e-165">Virtual Appliance is VirtualAppliance</span></span>
* <span data-ttu-id="2bd8e-166">İnternet, İnternet’tir</span><span class="sxs-lookup"><span data-stu-id="2bd8e-166">Internet is Internet</span></span>
* <span data-ttu-id="2bd8e-167">None, None şeklindedir</span><span class="sxs-lookup"><span data-stu-id="2bd8e-167">None is None</span></span>

### <a name="system-routes"></a><span data-ttu-id="2bd8e-168">Sistem yolları</span><span class="sxs-lookup"><span data-stu-id="2bd8e-168">System routes</span></span>
<span data-ttu-id="2bd8e-169">Bir sanal ağda oluşturulan her alt ağ hello aşağıdaki sistem yolu kurallarını içeren bir yol tablosu ile otomatik olarak ilişkilendirilir:</span><span class="sxs-lookup"><span data-stu-id="2bd8e-169">Every subnet created in a virtual network is automatically associated with a route table that contains hello following system route rules:</span></span>

* <span data-ttu-id="2bd8e-170">**Yerel Sanal Ağ Kuralı**: Bu kural bir sanal ağdaki her alt ağ için otomatik olarak oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-170">**Local Vnet Rule**: This rule is automatically created for every subnet in a virtual network.</span></span> <span data-ttu-id="2bd8e-171">Merhaba VNet içinde hello VM'ler arasında doğrudan bağlantı yoktur ve Ara sonraki atlama olduğunu belirtir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-171">It specifies that there is a direct link between hello VMs in hello VNet and there is no intermediate next hop.</span></span>
* <span data-ttu-id="2bd8e-172">**Şirket içi kuralı**: Bu kural tooall hedefleyen trafiğe toohello şirket içi adres aralığı uygular ve VPN ağ geçidi hello sonraki atlama hedefi olarak kullanır.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-172">**On-premises Rule**: This rule applies tooall traffic destined toohello on-premises address range and uses VPN gateway as hello next hop destination.</span></span>
* <span data-ttu-id="2bd8e-173">**Internet kuralı**: Bu kural tüm giden trafiğe toohello işleme ortak Internet (adres öneki 0.0.0.0/0) ve hello olarak kullandığı hello altyapı internet ağ geçidi sonraki tüm giden trafiğe toohello için Internet atlama.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-173">**Internet Rule**: This rule handles all traffic destined toohello public Internet (address prefix 0.0.0.0/0) and uses hello infrastructure internet gateway as hello next hop for all traffic destined toohello Internet.</span></span>

### <a name="user-defined-routes"></a><span data-ttu-id="2bd8e-174">Kullanıcı tanımlı yollar</span><span class="sxs-lookup"><span data-stu-id="2bd8e-174">User-defined routes</span></span>
<span data-ttu-id="2bd8e-175">Çoğu ortam için Azure'da zaten tanımlanmış hello sistem yolları yalnızca gerekir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-175">For most environments you will only need hello system routes already defined by Azure.</span></span> <span data-ttu-id="2bd8e-176">Ancak, bir yol tablosu toocreate gerekir ve gibi belirli durumlarda, bir veya daha fazla yol eklemek:</span><span class="sxs-lookup"><span data-stu-id="2bd8e-176">However, you may need toocreate a route table and add one or more routes in specific cases, such as:</span></span>

* <span data-ttu-id="2bd8e-177">Şirket içi ağınız üzerinden tünel toohello Internet zorlar.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-177">Force tunneling toohello Internet via your on-premises network.</span></span>
* <span data-ttu-id="2bd8e-178">Azure ortamınızda sanal gereçleri kullanma.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-178">Use of virtual appliances in your Azure environment.</span></span>

<span data-ttu-id="2bd8e-179">Merhaba yukarıdaki senaryolarda bir yol tablosu toocreate sahip ve kullanıcı tanımlı yollar tooit ekleyin.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-179">In hello scenarios above, you will have toocreate a route table and add user defined routes tooit.</span></span> <span data-ttu-id="2bd8e-180">Birden fazla yol tablonuz olabilir ve hello aynı yol tablosu ilişkili tooone veya daha fazla alt ağlar olabilir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-180">You can have multiple route tables, and hello same route table can be associated tooone or more subnets.</span></span> <span data-ttu-id="2bd8e-181">Ve her alt ağ yalnızca ilişkili tooa tek yol tablosu olabilir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-181">And each subnet can only be associated tooa single route table.</span></span> <span data-ttu-id="2bd8e-182">Tüm VM'ler ve bulut Hizmetleri bir alt ağdaki hello rota ilişkili tablo toothat alt kullanın.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-182">All VMs and cloud services in a subnet use hello route table associated toothat subnet.</span></span>

<span data-ttu-id="2bd8e-183">Bir yol tablosu ilişkili toohello alt kadar alt ağlar sistem yollarına bağımlıdır.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-183">Subnets rely on system routes until a route table is associated toohello subnet.</span></span> <span data-ttu-id="2bd8e-184">Bir ilişki oluşturulduğu zaman, hem kullanıcı tanımlı yollar hem de sistem yolları arasında En Uzun Ön Ek Eşleşmesi (LPM) temel alınarak yönlendirme uygulanır.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-184">Once an association exists, routing is done based on Longest Prefix Match (LPM) among both user defined routes and system routes.</span></span> <span data-ttu-id="2bd8e-185">Varsa aynı LPM eşleşen bir rota seçili sonra hello sahip birden fazla yol sırasının Merhaba, özgün temel:</span><span class="sxs-lookup"><span data-stu-id="2bd8e-185">If there is more than one route with hello same LPM match then a route is selected based on its origin in hello following order:</span></span>

1. <span data-ttu-id="2bd8e-186">Kullanıcı tanımlı yol</span><span class="sxs-lookup"><span data-stu-id="2bd8e-186">User defined route</span></span>
2. <span data-ttu-id="2bd8e-187">BGP yolu (ExpressRoute kullanıldığında)</span><span class="sxs-lookup"><span data-stu-id="2bd8e-187">BGP route (when ExpressRoute is used)</span></span>
3. <span data-ttu-id="2bd8e-188">Sistem yolu</span><span class="sxs-lookup"><span data-stu-id="2bd8e-188">System route</span></span>

<span data-ttu-id="2bd8e-189">toolearn toocreate kullanıcı tanımlı yollar, nasıl bkz [nasıl tooCreate yönlendirir ve azure'da IP iletimini etkinleştirmeniz](virtual-network-create-udr-arm-template.md).</span><span class="sxs-lookup"><span data-stu-id="2bd8e-189">toolearn how toocreate user defined routes, see [How tooCreate Routes and Enable IP Forwarding in Azure](virtual-network-create-udr-arm-template.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2bd8e-190">Kullanıcı tanımlı yollar yalnızca uygulanan tooAzure VM'ler olan ve bulut Hizmetleri.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-190">User defined routes are only applied tooAzure VMs and cloud services.</span></span> <span data-ttu-id="2bd8e-191">Tooadd şirket içi ağınız ve Azure arasında bir güvenlik duvarı sanal Gereci isterseniz, örneğin, toocreate toohello şirket içi adres alanı toohello sanal giden tüm trafiği ileten bir kullanıcı tanımlı yol Azure yol tablolarınız için gerekir Gereci.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-191">For instance, if you want tooadd a firewall virtual appliance between your on-premises network and Azure, you will have toocreate a user defined route for your Azure route tables that forwards all traffic going toohello on-premises address space toohello virtual appliance.</span></span> <span data-ttu-id="2bd8e-192">Ayrıca, bir kullanıcı rota (UDR) toohello GatewaySubnet tooforward hello sanal gereç yoluyla şirket içi tooAzure gelen tüm trafiği tanımlanan ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-192">You can also add a user defined route (UDR) toohello GatewaySubnet tooforward all traffic from on-premises tooAzure through hello virtual appliance.</span></span> <span data-ttu-id="2bd8e-193">Bu, kısa süre önce yapılan bir eklemedir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-193">This is a recent addition.</span></span>
> 
> 

### <a name="bgp-routes"></a><span data-ttu-id="2bd8e-194">BGP yolları</span><span class="sxs-lookup"><span data-stu-id="2bd8e-194">BGP routes</span></span>
<span data-ttu-id="2bd8e-195">Şirket içi ağınız ve Azure arasında bir ExpressRoute bağlantınız varsa, şirket içi ağ tooAzure BGP toopropagate yollarını etkinleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-195">If you have an ExpressRoute connection between your on-premises network and Azure, you can enable BGP toopropagate routes from your on-premises network tooAzure.</span></span> <span data-ttu-id="2bd8e-196">Bu BGP yolları hello kullanılan aynı şekilde sistem yollarıyla ve kullanıcı tanımlı yollar her Azure alt.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-196">These BGP routes are used in hello same way as system routes and user defined routes in each Azure subnet.</span></span> <span data-ttu-id="2bd8e-197">Daha fazla bilgi için bkz. [ExpressRoute'a Giriş](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="2bd8e-197">For more information see [ExpressRoute Introduction](../expressroute/expressroute-introduction.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2bd8e-198">Şirket içi ağınızdan hello sonraki atlama olarak hello VPN ağ geçidini kullanan 0.0.0.0/0 alt ağ için bir kullanıcı tanımlı yol oluşturarak tünel Azure ortamı toouse ekibinizin yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-198">You can configure your Azure environment toouse force tunneling through your on-premises network by creating a user defined route for subnet 0.0.0.0/0 that uses hello VPN gateway as hello next hop.</span></span> <span data-ttu-id="2bd8e-199">Ancak bu işlem yalnızca ExpressRoute yerine bir VPN ağ geçidini kullandığınız zaman çalışır.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-199">However, this only works if you are using a VPN gateway, not ExpressRoute.</span></span> <span data-ttu-id="2bd8e-200">ExpressRoute için zorlamalı tünel BGP yoluyla yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-200">For ExpressRoute, forced tunneling is configured through BGP.</span></span>
> 
> 

## <a name="ip-forwarding"></a><span data-ttu-id="2bd8e-201">IP iletimi</span><span class="sxs-lookup"><span data-stu-id="2bd8e-201">IP forwarding</span></span>
<span data-ttu-id="2bd8e-202">Merhaba nedenler toocreate birini yukarıda açıklandığı gibi bir kullanıcı tanımlı yol tooforward trafiği tooa sanal gereç özelliğidir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-202">As described above, one of hello main reasons toocreate a user defined route is tooforward traffic tooa virtual appliance.</span></span> <span data-ttu-id="2bd8e-203">Bir sanal gereç kullanılan uygulama toohandle ağ trafiğinin bir güvenlik duvarı veya NAT cihazı gibi herhangi bir şekilde çalışan bir VM'den fazla bir şey değildir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-203">A virtual appliance is nothing more than a VM that runs an application used toohandle network traffic in some way, such as a firewall or a NAT device.</span></span>

<span data-ttu-id="2bd8e-204">Bu sanal gereç VM olan mümkün tooreceive gelen trafiği olmalıdır tooitself ele değil.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-204">This virtual appliance VM must be able tooreceive incoming traffic that is not addressed tooitself.</span></span> <span data-ttu-id="2bd8e-205">tooallow VM tooreceive trafik tooother hedefleri ele, IP iletimi hello VM için etkinleştirmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-205">tooallow a VM tooreceive traffic addressed tooother destinations, you must enable IP Forwarding for hello VM.</span></span> <span data-ttu-id="2bd8e-206">Bu ayar, bir ayar değildir hello konuk işletim sistemindeki bir Azure olur.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-206">This is an Azure setting, not a setting in hello guest operating system.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2bd8e-207">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="2bd8e-207">Next steps</span></span>
* <span data-ttu-id="2bd8e-208">Nasıl çok öğrenin[hello Resource Manager dağıtım modelinde yollar oluşturmayı](virtual-network-create-udr-arm-template.md) ve toosubnets ilişkilendirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-208">Learn how too[create routes in hello Resource Manager deployment model](virtual-network-create-udr-arm-template.md) and associate them toosubnets.</span></span> 
* <span data-ttu-id="2bd8e-209">Nasıl çok öğrenin[hello Klasik dağıtım modelinde yollar oluşturmayı](virtual-network-create-udr-classic-ps.md) ve toosubnets ilişkilendirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2bd8e-209">Learn how too[create routes in hello classic deployment model](virtual-network-create-udr-classic-ps.md) and associate them toosubnets.</span></span>

