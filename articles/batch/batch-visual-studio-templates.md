---
title: "Visual Studio Proje şablonları - Azure batch çözümleriyle oluşturmaya başlayın | Microsoft Docs"
description: "Visual Studio Proje şablonları uygulamak ve Azure Batch işlem yoğunluklu iş yüklerini çalıştırmak nasıl yardımcı olabileceğini öğrenin."
services: batch
documentationcenter: .net
author: fayora
manager: timlt
editor: 
ms.assetid: 5e041ae2-25af-4882-a79e-3aa63c4bfb20
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 02/27/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: da77ce827c65deb18d9d84ce5cf768d89788e205
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="use-visual-studio-project-templates-to-jump-start-batch-solutions"></a><span data-ttu-id="c8054-103">Batch çözümleri hızla başlatmak için Visual Studio Proje şablonları kullanın</span><span class="sxs-lookup"><span data-stu-id="c8054-103">Use Visual Studio project templates to jump-start Batch solutions</span></span>

<span data-ttu-id="c8054-104">**İş Yöneticisi** ve **görev işlemci Visual Studio şablonları** toplu işlemi için uygulamak ve en az çaba ile toplu işlem yoğunluklu iş yüklerini çalıştırmak için yardımcı olması için kod sağlar.</span><span class="sxs-lookup"><span data-stu-id="c8054-104">The **Job Manager** and **Task Processor Visual Studio templates** for Batch provide code to help you to implement and run your compute-intensive workloads on Batch with the least amount of effort.</span></span> <span data-ttu-id="c8054-105">Bu belge, bu şablonları açıklar ve bunları nasıl kullanacağınızı yönelik yönergeler sağlanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c8054-105">This document describes these templates and provides guidance for how to use them.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c8054-106">Bu makalede, yalnızca bu iki şablonlarını ilgili bilgileri açıklar ve Batch hizmeti ve ilgili temel kavramları hakkında bilgi sahibi olduğunuzu varsayar: havuzlar, işlem düğümleri, işler ve görevler, iş yöneticisi görevleri, ortam değişkenleri ve diğer ilgili bilgi.</span><span class="sxs-lookup"><span data-stu-id="c8054-106">This article discusses only information applicable to these two templates, and assumes that you are familiar with the Batch service and key concepts related to it: pools, compute nodes, jobs and tasks, job manager tasks, environment variables, and other relevant information.</span></span> <span data-ttu-id="c8054-107">Daha fazla bilgi bulabilirsiniz [Azure Batch temel bilgileri](batch-technical-overview.md), [geliştiriciler için Batch özelliklerine genel bakış](batch-api-basics.md), ve [.NET için Azure Batch kitaplığını kullanmaya başlama](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="c8054-107">You can find more information in [Basics of Azure Batch](batch-technical-overview.md), [Batch feature overview for developers](batch-api-basics.md), and [Get started with the Azure Batch library for .NET](batch-dotnet-get-started.md).</span></span>
> 
> 

## <a name="high-level-overview"></a><span data-ttu-id="c8054-108">Yüksek düzey genel bakış</span><span class="sxs-lookup"><span data-stu-id="c8054-108">High-level overview</span></span>
<span data-ttu-id="c8054-109">İş Yöneticisi ve görev işlemci şablonları iki yararlı bileşenleri oluşturmak için kullanılabilir:</span><span class="sxs-lookup"><span data-stu-id="c8054-109">The Job Manager and Task Processor templates can be used to create two useful components:</span></span>

* <span data-ttu-id="c8054-110">Bir işi bağımsız olarak, paralel olarak çalıştırılabilir birden çok görev içine ayırabilirsiniz iş Bölümlendirici uygulayan bir iş yöneticisi görevi.</span><span class="sxs-lookup"><span data-stu-id="c8054-110">A job manager task that implements a job splitter that can break a job down into multiple tasks that can run independently, in parallel.</span></span>
* <span data-ttu-id="c8054-111">Ön işleme ve bir uygulama komut satırı sonrası işleme gerçekleştirmek için kullanılan bir görev işlemci.</span><span class="sxs-lookup"><span data-stu-id="c8054-111">A task processor that can be used to perform pre-processing and post-processing around an application command line.</span></span>

<span data-ttu-id="c8054-112">Örneğin, bir filmi işleme senaryosunda, iş Bölümlendirici tek film iş yüzlerce veya binlerce tek tek çerçeveler ayrı ayrı işlemek ayrı görevlerin kapatmanız.</span><span class="sxs-lookup"><span data-stu-id="c8054-112">For example, in a movie rendering scenario, the job splitter would turn a single movie job into hundreds or thousands of separate tasks that would process individual frames separately.</span></span> <span data-ttu-id="c8054-113">Buna bağlı olarak, görev işlemci işleme uygulaması çağıracaktır ve her işlemek için gerekli tüm bağımlı işlemler çerçeve yanı sıra (örneğin, bir depolama konumuna işlenmiş çerçeve kopyalama) ek eylemleri gerçekleştirin.</span><span class="sxs-lookup"><span data-stu-id="c8054-113">Correspondingly, the task processor would invoke the rendering application and all dependent processes that are needed to render each frame, as well as perform any additional actions (for example, copying the rendered frame to a storage location).</span></span>

> [!NOTE]
> <span data-ttu-id="c8054-114">Her ikisi de veya işlem işinizin ve tercihlerinize gereksinimlerine bağlı olarak bunlardan yalnızca birini kullanmak seçebilmeniz İş Yöneticisi ve görev işlemci şablonları birbirinden bağımsızdır.</span><span class="sxs-lookup"><span data-stu-id="c8054-114">The Job Manager and Task Processor templates are independent of each other, so you can choose to use both, or only one of them, depending on the requirements of your compute job and on your preferences.</span></span>
> 
> 

<span data-ttu-id="c8054-115">Aşağıdaki çizimde gösterildiği gibi bu şablonları kullanan bir işlem iş üç aşamanın gidin:</span><span class="sxs-lookup"><span data-stu-id="c8054-115">As shown in the diagram below, a compute job that uses these templates will go through three stages:</span></span>

1. <span data-ttu-id="c8054-116">İstemci kodu (örneğin, uygulama, web hizmeti, vb.) bir iş belirten kendi iş yöneticisi görevi gibi iş Yöneticisi programı Azure Batch hizmetine gönderir.</span><span class="sxs-lookup"><span data-stu-id="c8054-116">The client code (e.g., application, web service, etc.) submits a job to the Batch service on Azure, specifying as its job manager task the job manager program.</span></span>
2. <span data-ttu-id="c8054-117">Batch hizmeti bir işlem düğümünde iş yöneticisi görevi çalıştırır ve birçok gerektiği gibi parametreleri ve iş Bölümlendirici kod teknik özelliklerine göre işlem düğümleri gibi iş Bölümlendirici üzerinde görev işlemci görevler, belirtilen sayıda başlatır.</span><span class="sxs-lookup"><span data-stu-id="c8054-117">The Batch service runs the job manager task on a compute node and the job splitter launches the specified number of task processor tasks, on as many compute nodes as required, based on the parameters and specifications in the job splitter code.</span></span>
3. <span data-ttu-id="c8054-118">Görev işlemci görevler bağımsız olarak, girdi verilerini işlemek, çıktı verileri oluşturmak için paralel olarak çalışır.</span><span class="sxs-lookup"><span data-stu-id="c8054-118">The task processor tasks run independently, in parallel, to process the input data and generate the output data.</span></span>

![İstemci kodu Batch hizmeti ile nasıl etkileşim kurduğunu gösteren diyagram][diagram01]

## <a name="prerequisites"></a><span data-ttu-id="c8054-120">Ön koşullar</span><span class="sxs-lookup"><span data-stu-id="c8054-120">Prerequisites</span></span>
<span data-ttu-id="c8054-121">Toplu işlem şablonlarını kullanmak için aşağıdakiler gerekir:</span><span class="sxs-lookup"><span data-stu-id="c8054-121">To use the Batch templates, you will need the following:</span></span>

* <span data-ttu-id="c8054-122">Visual Studio 2015 yüklü bir bilgisayar.</span><span class="sxs-lookup"><span data-stu-id="c8054-122">A computer with Visual Studio 2015 installed.</span></span> <span data-ttu-id="c8054-123">Toplu işlem şablonları, şu anda yalnızca Visual Studio 2015 için desteklenir.</span><span class="sxs-lookup"><span data-stu-id="c8054-123">Batch templates are currently only supported for Visual Studio 2015.</span></span>
* <span data-ttu-id="c8054-124">Kullanılabilir toplu şablonları [Visual Studio Galerisi] [ vs_gallery] Visual Studio uzantıları olarak.</span><span class="sxs-lookup"><span data-stu-id="c8054-124">The Batch templates, which are available from the [Visual Studio Gallery][vs_gallery] as Visual Studio extensions.</span></span> <span data-ttu-id="c8054-125">Şablonları almak için iki yolu vardır:</span><span class="sxs-lookup"><span data-stu-id="c8054-125">There are two ways to get the templates:</span></span>
  
  * <span data-ttu-id="c8054-126">Kullanarak şablonları yüklemek **Uzantılar ve güncelleştirmeler** Visual Studio iletişim kutusunda (daha fazla bilgi için bkz: [bulma ve Visual Studio uzantılarını kullanarak][vs_find_use_ext]).</span><span class="sxs-lookup"><span data-stu-id="c8054-126">Install the templates using the **Extensions and Updates** dialog box in Visual Studio (for more information, see [Finding and Using Visual Studio Extensions][vs_find_use_ext]).</span></span> <span data-ttu-id="c8054-127">İçinde **Uzantılar ve güncelleştirmeler** iletişim kutusuna, aramak ve aşağıdaki iki uzantıları indirin:</span><span class="sxs-lookup"><span data-stu-id="c8054-127">In the **Extensions and Updates** dialog box, search and download the following two extensions:</span></span>
    
    * <span data-ttu-id="c8054-128">Azure toplu iş yöneticisi işi Bölümlendirici ile</span><span class="sxs-lookup"><span data-stu-id="c8054-128">Azure Batch Job Manager with Job Splitter</span></span>
    * <span data-ttu-id="c8054-129">Azure Batch görev işlemci</span><span class="sxs-lookup"><span data-stu-id="c8054-129">Azure Batch Task Processor</span></span>
  * <span data-ttu-id="c8054-130">Visual Studio için çevrimiçi galeriden belirlemeniz: [Microsoft Azure toplu işlem proje şablonları][vs_gallery_templates]</span><span class="sxs-lookup"><span data-stu-id="c8054-130">Download the templates from the online gallery for Visual Studio: [Microsoft Azure Batch Project Templates][vs_gallery_templates]</span></span>
* <span data-ttu-id="c8054-131">Kullanmayı planlıyorsanız, [uygulama paketleri](batch-application-packages.md) İş Yöneticisi'ni dağıtmak için özellik ve görev işlemci toplu işlem düğümleri, bir depolama hesabı toplu işlem hesabınıza bağlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8054-131">If you plan to use the [Application Packages](batch-application-packages.md) feature to deploy the job manager and task processor to the Batch compute nodes, you need to link a storage account to your Batch account.</span></span>

## <a name="preparation"></a><span data-ttu-id="c8054-132">Hazırlama</span><span class="sxs-lookup"><span data-stu-id="c8054-132">Preparation</span></span>
<span data-ttu-id="c8054-133">Bu kod, İş Yöneticisi ve görev işlemci programlar arasında paylaşmak kolaylaştırabilir olduğundan iş yöneticisi olarak görev işlemcinizin içerebilir bir çözüm oluşturmanızı öneririz.</span><span class="sxs-lookup"><span data-stu-id="c8054-133">We recommend creating a solution that can contain your job manager as well as your task processor, because this can make it easier to share code between your job manager and task processor programs.</span></span> <span data-ttu-id="c8054-134">Bu çözüm oluşturmak için aşağıdaki adımları izleyin:</span><span class="sxs-lookup"><span data-stu-id="c8054-134">To create this solution, follow these steps:</span></span>

1. <span data-ttu-id="c8054-135">Visual Studio'yu açın ve seçin **dosya** > **yeni** > **proje**.</span><span class="sxs-lookup"><span data-stu-id="c8054-135">Open Visual Studio and select **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="c8054-136">Altında **şablonları**, genişletin **diğer proje türleri**, tıklatın **Visual Studio çözümleri**ve ardından **boş çözüm**.</span><span class="sxs-lookup"><span data-stu-id="c8054-136">Under **Templates**, expand **Other Project Types**, click **Visual Studio Solutions**, and then select **Blank Solution**.</span></span>
3. <span data-ttu-id="c8054-137">Uygulamanız ve bu çözümü (örneğin, "LitwareBatchTaskPrograms") amacını açıklayan bir ad yazın.</span><span class="sxs-lookup"><span data-stu-id="c8054-137">Type a name that describes your application and the purpose of this solution (e.g., "LitwareBatchTaskPrograms").</span></span>
4. <span data-ttu-id="c8054-138">Yeni bir çözüm oluşturmak için tıklatın **Tamam**.</span><span class="sxs-lookup"><span data-stu-id="c8054-138">To create the new solution, click **OK**.</span></span>

## <a name="job-manager-template"></a><span data-ttu-id="c8054-139">İş Yöneticisi şablonu</span><span class="sxs-lookup"><span data-stu-id="c8054-139">Job Manager template</span></span>
<span data-ttu-id="c8054-140">İş Yöneticisi şablonu, aşağıdaki eylemleri gerçekleştirebilirsiniz bir iş yöneticisi görevi uygulamak için yardımcı olur:</span><span class="sxs-lookup"><span data-stu-id="c8054-140">The Job Manager template helps you to implement a job manager task that can perform the following actions:</span></span>

* <span data-ttu-id="c8054-141">Bir iş birden çok görevlere bölün.</span><span class="sxs-lookup"><span data-stu-id="c8054-141">Split a job into multiple tasks.</span></span>
* <span data-ttu-id="c8054-142">Toplu olarak çalıştırmak için bu görevler gönderebilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-142">Submit those tasks to run on Batch.</span></span>

> [!NOTE]
> <span data-ttu-id="c8054-143">İş Yöneticisi görevleri hakkında daha fazla bilgi için bkz: [geliştiriciler için Batch özelliklerine genel bakış](batch-api-basics.md#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="c8054-143">For more information about job manager tasks, see [Batch feature overview for developers](batch-api-basics.md#job-manager-task).</span></span>
> 
> 

### <a name="create-a-job-manager-using-the-template"></a><span data-ttu-id="c8054-144">Şablonu kullanarak bir iş yöneticisi oluşturma</span><span class="sxs-lookup"><span data-stu-id="c8054-144">Create a Job Manager using the template</span></span>
<span data-ttu-id="c8054-145">Bir iş yöneticisi daha önce oluşturduğunuz çözüme eklemek için aşağıdaki adımları izleyin:</span><span class="sxs-lookup"><span data-stu-id="c8054-145">To add a job manager to the solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="c8054-146">Var olan çözümünüzü Visual Studio'da açın.</span><span class="sxs-lookup"><span data-stu-id="c8054-146">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="c8054-147">Çözüm Gezgini'nde çözüme sağ tıklayın, **Ekle** > **yeni proje**.</span><span class="sxs-lookup"><span data-stu-id="c8054-147">In Solution Explorer, right-click the solution, click **Add** > **New Project**.</span></span>
3. <span data-ttu-id="c8054-148">Altında **Visual C#**, tıklatın **bulut**ve ardından **Azure toplu iş yöneticisi işi Bölümlendirici ile**.</span><span class="sxs-lookup"><span data-stu-id="c8054-148">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Job Manager with Job Splitter**.</span></span>
4. <span data-ttu-id="c8054-149">Uygulamanızı açıklayan ve bu projeyi (örneğin, İş Yöneticisi tanımlayan bir ad yazın "LitwareJobManager").</span><span class="sxs-lookup"><span data-stu-id="c8054-149">Type a name that describes your application and identifies this project as the job manager (e.g. "LitwareJobManager").</span></span>
5. <span data-ttu-id="c8054-150">Projeyi oluşturmak için tıklatın **Tamam**.</span><span class="sxs-lookup"><span data-stu-id="c8054-150">To create the project, click **OK**.</span></span>
6. <span data-ttu-id="c8054-151">Son olarak, tüm başvurulan NuGet paketleri yüklenemedi ve onu değiştirmeye başlamadan önce projenin geçerli olduğunu doğrulamak için Visual Studio zorlamak için projeyi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="c8054-151">Finally, build the project to force Visual Studio to load all referenced NuGet packages and to verify that the project is valid before you start modifying it.</span></span>

### <a name="job-manager-template-files-and-their-purpose"></a><span data-ttu-id="c8054-152">İş Yöneticisi şablon dosyalarını ve amaçları</span><span class="sxs-lookup"><span data-stu-id="c8054-152">Job Manager template files and their purpose</span></span>
<span data-ttu-id="c8054-153">İş Yöneticisi şablonunu kullanarak bir proje oluşturduğunuzda, kod dosyaları üç grupları oluşturur:</span><span class="sxs-lookup"><span data-stu-id="c8054-153">When you create a project using the Job Manager template, it generates three groups of code files:</span></span>

* <span data-ttu-id="c8054-154">Ana program dosyası (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="c8054-154">The main program file (Program.cs).</span></span> <span data-ttu-id="c8054-155">Bu program giriş noktası ve en üst düzey özel durum işleme içerir.</span><span class="sxs-lookup"><span data-stu-id="c8054-155">This contains the program entry point and top-level exception handling.</span></span> <span data-ttu-id="c8054-156">Normalde bu değişiklik gerekmez.</span><span class="sxs-lookup"><span data-stu-id="c8054-156">You shouldn't normally need to modify this.</span></span>
* <span data-ttu-id="c8054-157">Framework dizini.</span><span class="sxs-lookup"><span data-stu-id="c8054-157">The Framework directory.</span></span> <span data-ttu-id="c8054-158">Bu görevler ekleme toplu iş, vb. parametreleri açmak İş Yöneticisi program – 'ortak' çalışmanın sorumlu dosyalarını içerir. Normalde bu dosyalarda değişiklik gerekmez.</span><span class="sxs-lookup"><span data-stu-id="c8054-158">This contains the files responsible for the 'boilerplate' work done by the job manager program – unpacking parameters, adding tasks to the Batch job, etc. You shouldn't normally need to modify these files.</span></span>
* <span data-ttu-id="c8054-159">İş Bölümlendirici dosyası (JobSplitter.cs).</span><span class="sxs-lookup"><span data-stu-id="c8054-159">The job splitter file (JobSplitter.cs).</span></span> <span data-ttu-id="c8054-160">Bir işi görevlere bölmek için uygulamaya özgü mantığınızı yerleştireceğiniz budur.</span><span class="sxs-lookup"><span data-stu-id="c8054-160">This is where you will put your application-specific logic for splitting a job into tasks.</span></span>

<span data-ttu-id="c8054-161">Elbette mantığı bölme iş karmaşıklığına bağlı olarak, iş Bölümlendirici kodu desteklemek için gerektiği gibi ek dosyaları ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-161">Of course you can add additional files as required to support your job splitter code, depending on the complexity of the job splitting logic.</span></span>

<span data-ttu-id="c8054-162">Şablon ayrıca .csproj dosya, app.config, packages.config, vb. gibi standart .NET proje dosyalarını oluşturur.</span><span class="sxs-lookup"><span data-stu-id="c8054-162">The template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="c8054-163">Bu bölümde rest farklı dosya ve kendi kod yapısını ve her sınıf yaptığı açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c8054-163">The rest of this section describes the different files and their code structure, and explains what each class does.</span></span>

![İş Yöneticisi şablonu çözümünü gösteren Visual Studio Çözüm Gezgini][solution_explorer01]

<span data-ttu-id="c8054-165">**Framework dosyaları**</span><span class="sxs-lookup"><span data-stu-id="c8054-165">**Framework files**</span></span>

* <span data-ttu-id="c8054-166">`Configuration.cs`: Batch hesabı ayrıntıları, bağlantılı depolama hesabı kimlik bilgileri, iş ve görev bilgileri ve iş parametreleri gibi iş yapılandırma verilerinin yüklenmesini yalıtır.</span><span class="sxs-lookup"><span data-stu-id="c8054-166">`Configuration.cs`: Encapsulates the loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="c8054-167">Ayrıca, Configuration.EnvironmentVariable sınıfı aracılığıyla toplu tanımlı ortam değişkenlerini (toplu belgelerinde görevler için ortam ayarları bakın) erişim sağlar.</span><span class="sxs-lookup"><span data-stu-id="c8054-167">It also provides access to Batch-defined environment variables (see Environment settings for tasks, in the Batch documentation) via the Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="c8054-168">`IConfiguration.cs`: Birim testi sahte veya sahte yapılandırma nesnesi kullanarak, iş Bölümlendirici olan yapılandırma sınıf uyarlamasını soyutlar.</span><span class="sxs-lookup"><span data-stu-id="c8054-168">`IConfiguration.cs`: Abstracts the implementation of the Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="c8054-169">`JobManager.cs`: İş Yöneticisi program bileşenlerinin düzenler.</span><span class="sxs-lookup"><span data-stu-id="c8054-169">`JobManager.cs`: Orchestrates the components of the job manager program.</span></span> <span data-ttu-id="c8054-170">İş Bölümlendirici çağırma ve görevi göndereni iş Bölümlendirici tarafından döndürülen görevleri gönderme iş Bölümlendirici başlatmak için sorumludur.</span><span class="sxs-lookup"><span data-stu-id="c8054-170">It is responsible for the initializing the job splitter, invoking the job splitter, and dispatching the tasks returned by the job splitter to the task submitter.</span></span>
* <span data-ttu-id="c8054-171">`JobManagerException.cs`: Sonlandırmak İş Yöneticisi gerektiren bir hatayı temsil eder.</span><span class="sxs-lookup"><span data-stu-id="c8054-171">`JobManagerException.cs`: Represents an error that requires the job manager to terminate.</span></span> <span data-ttu-id="c8054-172">JobManagerException belirli tanılama bilgileri sonlandırma bir parçası olarak burada sağlanabilir 'beklenen' hataları kaydırmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="c8054-172">JobManagerException is used to wrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>
* <span data-ttu-id="c8054-173">`TaskSubmitter.cs`: Bu sınıf, toplu işlem işi Bölümlendirici tarafından döndürülen görevleri ekleme ile sorumludur.</span><span class="sxs-lookup"><span data-stu-id="c8054-173">`TaskSubmitter.cs`: This class is responsible to adding tasks returned by the job splitter to the Batch job.</span></span> <span data-ttu-id="c8054-174">JobManager sınıfı toplamalar görev dizisini verimli ancak zamanında ekleme işlemi, iş için toplu içine sonra çağırır TaskSubmitter.SubmitTasks arka plan iş parçacığında her toplu işlemi için.</span><span class="sxs-lookup"><span data-stu-id="c8054-174">The JobManager class aggregates the sequence of tasks into batches for efficient but timely addition to the job, then calls TaskSubmitter.SubmitTasks on a background thread for each batch.</span></span>

<span data-ttu-id="c8054-175">**İş Bölümlendirici**</span><span class="sxs-lookup"><span data-stu-id="c8054-175">**Job Splitter**</span></span>

<span data-ttu-id="c8054-176">`JobSplitter.cs`: Bu sınıf, iş görevleri bölmek için uygulamaya özgü mantığı içerir.</span><span class="sxs-lookup"><span data-stu-id="c8054-176">`JobSplitter.cs`: This class contains application-specific logic for splitting the job into tasks.</span></span> <span data-ttu-id="c8054-177">Framework yöntem bunları döndürür gibi projeye ekler görevleri bir dizi elde etmek için JobSplitter.Split yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="c8054-177">The framework invokes the JobSplitter.Split method to obtain a sequence of tasks, which it adds to the job as the method returns them.</span></span> <span data-ttu-id="c8054-178">Bu Burada, iş mantığı ekleme sınıftır.</span><span class="sxs-lookup"><span data-stu-id="c8054-178">This is the class where you will inject the logic of your job.</span></span> <span data-ttu-id="c8054-179">İş bölüm istediğiniz görevleri temsil eden CloudTask örnekleri bir dizi döndürülecek Split yöntemini uygulayın.</span><span class="sxs-lookup"><span data-stu-id="c8054-179">Implement the Split method to return a sequence of CloudTask instances representing the tasks into which you want to partition the job.</span></span>

<span data-ttu-id="c8054-180">**Standart .NET komut satırı proje dosyaları**</span><span class="sxs-lookup"><span data-stu-id="c8054-180">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="c8054-181">`App.config`: Standart .NET uygulama yapılandırma dosyası.</span><span class="sxs-lookup"><span data-stu-id="c8054-181">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="c8054-182">`Packages.config`: Standart NuGet paket bağımlılık dosyası.</span><span class="sxs-lookup"><span data-stu-id="c8054-182">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="c8054-183">`Program.cs`: Program giriş noktası ve en üst düzey özel durum işleme içerir.</span><span class="sxs-lookup"><span data-stu-id="c8054-183">`Program.cs`: Contains the program entry point and top-level exception handling.</span></span>

### <a name="implementing-the-job-splitter"></a><span data-ttu-id="c8054-184">İş Bölümlendirici uygulama</span><span class="sxs-lookup"><span data-stu-id="c8054-184">Implementing the job splitter</span></span>
<span data-ttu-id="c8054-185">İş Yöneticisi şablonu projeyi açtığınızda, projenin varsayılan olarak açık JobSplitter.cs dosyayı sahip olur.</span><span class="sxs-lookup"><span data-stu-id="c8054-185">When you open the Job Manager template project, the project will have the JobSplitter.cs file open by default.</span></span> <span data-ttu-id="c8054-186">Aşağıdaki Split() yöntemi Göster kullanarak, iş yükü görevler için bölünmüş mantığı uygulayabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="c8054-186">You can implement the split logic for the tasks in your workload by using the Split() method show below:</span></span>

```csharp
/// <summary>
/// Gets the tasks into which to split the job. This is where you inject
/// your application-specific logic for decomposing the job into tasks.
///
/// The job manager framework invokes the Split method for you; you need
/// only to implement it, not to call it yourself. Typically, your
/// implementation should return tasks lazily, for example using a C#
/// iterator and the "yield return" statement; this allows tasks to be added
/// and to start running while splitting is still in progress.
/// </summary>
/// <returns>The tasks to be added to the job. Tasks are added automatically
/// by the job manager framework as they are returned by this method.</returns>
public IEnumerable<CloudTask> Split()
{
    // Your code for the split logic goes here.
    int startFrame = Convert.ToInt32(_parameters["StartFrame"]);
    int endFrame = Convert.ToInt32(_parameters["EndFrame"]);

    for (int i = startFrame; i <= endFrame; i++)
    {
        yield return new CloudTask("myTask" + i, "cmd /c dir");
    }
}
```

> [!NOTE]
> <span data-ttu-id="c8054-187">Açıklamalı bölümünde `Split()` mantığı ekleyerek değiştirmenizi işleriniz farklı görevlere bölmek için yönelik İş Yöneticisi şablonu kodu yalnızca bölümünü bir yöntemdir.</span><span class="sxs-lookup"><span data-stu-id="c8054-187">The annotated section in the `Split()` method is the only section of the Job Manager template code that is intended for you to modify by adding the logic to split your jobs into different tasks.</span></span> <span data-ttu-id="c8054-188">Farklı bir şablon bölümünü değiştirmek istiyorsanız, lütfen familiarized toplu nasıl çalıştığı ile olduğundan emin olun ve bazılarını deneyin [toplu kod örnekleri][github_samples].</span><span class="sxs-lookup"><span data-stu-id="c8054-188">If you want to modify a different section of the template, please ensure you are familiarized with how Batch works, and try out a few of the [Batch code samples][github_samples].</span></span>
> 
> 

<span data-ttu-id="c8054-189">Split() uygulamanıza erişimi:</span><span class="sxs-lookup"><span data-stu-id="c8054-189">Your Split() implementation has access to:</span></span>

* <span data-ttu-id="c8054-190">İş parametresi aracılığıyla `_parameters` alan.</span><span class="sxs-lookup"><span data-stu-id="c8054-190">The job parameters, via the `_parameters` field.</span></span>
* <span data-ttu-id="c8054-191">Aracılığıyla işi temsil eden CloudJob nesnesi `_job` alan.</span><span class="sxs-lookup"><span data-stu-id="c8054-191">The CloudJob object representing the job, via the `_job` field.</span></span>
* <span data-ttu-id="c8054-192">İş Yöneticisi görevi aracılığıyla temsil eden CloudTask nesnesi `_jobManagerTask` alan.</span><span class="sxs-lookup"><span data-stu-id="c8054-192">The CloudTask object representing the job manager task, via the `_jobManagerTask` field.</span></span>

<span data-ttu-id="c8054-193">`Split()` Uygulama doğrudan işe görev ekleme gerekmez.</span><span class="sxs-lookup"><span data-stu-id="c8054-193">Your `Split()` implementation does not need to add tasks to the job directly.</span></span> <span data-ttu-id="c8054-194">Bunun yerine, kodunuzu CloudTask nesnelerinin bir dizisi döndürmelidir ve bu projeye otomatik olarak iş Bölümlendirici çağırma framework sınıfları tarafından eklenir.</span><span class="sxs-lookup"><span data-stu-id="c8054-194">Instead, your code should return a sequence of CloudTask objects, and these will be added to the job automatically by the framework classes that invoke the job splitter.</span></span> <span data-ttu-id="c8054-195">Kullanım C# ' ın yineleyici için ortak olan (`yield return`) başlatmak hesaplanacak tüm görevler için bekleyen yerine mümkün olan en kısa sürede çalışan görevler böylece iş ayırıcılar uygulama özelliği.</span><span class="sxs-lookup"><span data-stu-id="c8054-195">It's common to use C#'s iterator (`yield return`) feature to implement job splitters as this allows the tasks to start running as soon as possible rather than waiting for all tasks to be calculated.</span></span>

<span data-ttu-id="c8054-196">**İş Bölümlendirici hatası**</span><span class="sxs-lookup"><span data-stu-id="c8054-196">**Job splitter failure**</span></span>

<span data-ttu-id="c8054-197">İş Bölümlendirici hatayla karşılaşırsa ya da gerekir:</span><span class="sxs-lookup"><span data-stu-id="c8054-197">If your job splitter encounters an error, it should either:</span></span>

* <span data-ttu-id="c8054-198">C# kullanarak dizisi sonlandırmak `yield break` deyimi, hangi durumda İş Yöneticisi işleneceğini başarılı olarak; veya</span><span class="sxs-lookup"><span data-stu-id="c8054-198">Terminate the sequence using the C# `yield break` statement, in which case the job manager will be treated as successful; or</span></span>
* <span data-ttu-id="c8054-199">Bir özel durum, bu durumda İş Yöneticisi throw başarısız olarak kabul edilir ve istemci yapılandırmasına bağlı olarak denenen).</span><span class="sxs-lookup"><span data-stu-id="c8054-199">Throw an exception, in which case the job manager will be treated as failed and may be retried depending on how the client has configured it).</span></span>

<span data-ttu-id="c8054-200">Her iki durumda da zaten iş Bölümlendirici tarafından döndürülen ve toplu işlem eklenen herhangi bir görevi çalıştırmak uygun olacaktır.</span><span class="sxs-lookup"><span data-stu-id="c8054-200">In both cases, any tasks already returned by the job splitter and added to the Batch job will be eligible to run.</span></span> <span data-ttu-id="c8054-201">Bunun olmasını istemiyorsanız, olabilir:</span><span class="sxs-lookup"><span data-stu-id="c8054-201">If you don't want this to happen, then you could:</span></span>

* <span data-ttu-id="c8054-202">İş iş Bölümlendirici döndürmeden önce sonlandırma</span><span class="sxs-lookup"><span data-stu-id="c8054-202">Terminate the job before returning from the job splitter</span></span>
* <span data-ttu-id="c8054-203">Bunu dönmeden önce tüm görev koleksiyon formüle (diğer bir deyişle, dönüş bir `ICollection<CloudTask>` veya `IList<CloudTask>` bir C# yineleyici kullanarak, iş Bölümlendirici uygulamak yerine)</span><span class="sxs-lookup"><span data-stu-id="c8054-203">Formulate the entire task collection before returning it (that is, return an `ICollection<CloudTask>` or `IList<CloudTask>` instead of implementing your job splitter using a C# iterator)</span></span>
* <span data-ttu-id="c8054-204">Görev bağımlılıkları İş Yöneticisi başarılı tamamlanma bağımlı olan tüm görevleri yapmak için kullanın</span><span class="sxs-lookup"><span data-stu-id="c8054-204">Use task dependencies to make all tasks depend on the successful completion of the job manager</span></span>

<span data-ttu-id="c8054-205">**İş Yöneticisi'ni yeniden deneme**</span><span class="sxs-lookup"><span data-stu-id="c8054-205">**Job manager retries**</span></span>

<span data-ttu-id="c8054-206">İş Yöneticisi başarısız olursa, istemci yeniden deneme ayarlarına bağlı olarak Batch hizmeti tarafından denenen.</span><span class="sxs-lookup"><span data-stu-id="c8054-206">If the job manager fails, it may be retried by the Batch service depending on the client retry settings.</span></span> <span data-ttu-id="c8054-207">Framework işe görevler eklediğinde, zaten mevcut herhangi bir görevi yoksayar genel olarak, güvenli olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="c8054-207">In general, this is safe, because when the framework adds tasks to the job, it ignores any tasks that already exist.</span></span> <span data-ttu-id="c8054-208">Ancak, görevleri hesaplama pahalı ise, projeye eklenmiş olan görevleri yeniden hesaplanması maliyetini tabi getirmek istemeyen; yeniden çalıştırın ve aynı görevle kimlikleri oluşturmak için kesin değildir, buna karşılık, ardından 'çoğaltmaları Yoksay' davranışı ilkenin etkisini gösterip değil.</span><span class="sxs-lookup"><span data-stu-id="c8054-208">However, if calculating tasks is expensive, you may not wish to incur the cost of recalculating tasks that have already been added to the job; conversely, if the re-run is not guaranteed to generate the same task IDs then the 'ignore duplicates' behavior will not kick in.</span></span> <span data-ttu-id="c8054-209">Bu durumlarda zaten yapılmış ve bu, örneğin görevleri elde etmek üzere başlatmadan önce bir CloudJob.ListTasks gerçekleştirerek kullanmamasını iş algılamak için iş Bölümlendirici tasarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8054-209">In these cases you should design your job splitter to detect the work that has already been done and not repeat it, for example by performing a CloudJob.ListTasks before starting to yield tasks.</span></span>

### <a name="exit-codes-and-exceptions-in-the-job-manager-template"></a><span data-ttu-id="c8054-210">Çıkış kodları ve İş Yöneticisi şablonunda özel durumlar</span><span class="sxs-lookup"><span data-stu-id="c8054-210">Exit codes and exceptions in the Job Manager template</span></span>
<span data-ttu-id="c8054-211">Çıkış kodları ve özel durumları program çalıştırmanın sonucunu belirlemek için bir mekanizma sağlar ve programın yürütülmesi ile herhangi bir sorunu belirlemek için yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-211">Exit codes and exceptions provide a mechanism to determine the outcome of running a program, and they can help to identify any problems with the execution of the program.</span></span> <span data-ttu-id="c8054-212">İş Yöneticisi şablon çıkış kodları ve bu bölümde açıklanan özel durumları uygular.</span><span class="sxs-lookup"><span data-stu-id="c8054-212">The Job Manager template implements the exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="c8054-213">İş Yöneticisi şablonla uygulanan bir iş yöneticisi görevi üç olası çıkış kodlarını döndürebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="c8054-213">A job manager task that is implemented with the Job Manager template can return three possible exit codes:</span></span>

| <span data-ttu-id="c8054-214">Kod</span><span class="sxs-lookup"><span data-stu-id="c8054-214">Code</span></span> | <span data-ttu-id="c8054-215">Açıklama</span><span class="sxs-lookup"><span data-stu-id="c8054-215">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c8054-216">0</span><span class="sxs-lookup"><span data-stu-id="c8054-216">0</span></span> |<span data-ttu-id="c8054-217">İş Yöneticisi başarıyla tamamlandı.</span><span class="sxs-lookup"><span data-stu-id="c8054-217">The job manager completed successfully.</span></span> <span data-ttu-id="c8054-218">İş Bölümlendirici kodunuzu tamamlanıncaya kadar çalıştırılmış ve tüm görevler projeye eklendi.</span><span class="sxs-lookup"><span data-stu-id="c8054-218">Your job splitter code ran to completion, and all tasks were added to the job.</span></span> |
| <span data-ttu-id="c8054-219">1</span><span class="sxs-lookup"><span data-stu-id="c8054-219">1</span></span> |<span data-ttu-id="c8054-220">İş Yöneticisi görevi program 'beklenen' bir parçası olarak bir özel durum ile başarısız oldu.</span><span class="sxs-lookup"><span data-stu-id="c8054-220">The job manager task failed with an exception in an 'expected' part of the program.</span></span> <span data-ttu-id="c8054-221">Özel durum JobManagerException tanılama bilgileri ile çevrilmiştir ve mümkün olduğunda hata çözümü için öneriler.</span><span class="sxs-lookup"><span data-stu-id="c8054-221">The exception was translated to a JobManagerException with diagnostic information and, where possible, suggestions for resolving the failure.</span></span> |
| <span data-ttu-id="c8054-222">2</span><span class="sxs-lookup"><span data-stu-id="c8054-222">2</span></span> |<span data-ttu-id="c8054-223">İş Yöneticisi görevi 'beklenmeyen' bir özel durumla başarısız oldu.</span><span class="sxs-lookup"><span data-stu-id="c8054-223">The job manager task failed with an 'unexpected' exception.</span></span> <span data-ttu-id="c8054-224">Standart çıktıya özel durum günlüğe kaydedildi, ancak İş Yöneticisi ek tanılama ya da düzeltme bilgileri ekleyemedi.</span><span class="sxs-lookup"><span data-stu-id="c8054-224">The exception was logged to standard output, but the job manager was unable to add any additional diagnostic or remediation information.</span></span> |

<span data-ttu-id="c8054-225">Hatadan önce iş yöneticisi görevi başarısız olması durumunda, bazı görevler hala hizmete eklenmemiş olabilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-225">In the case of job manager task failure, some tasks may still have been added to the service before the error occurred.</span></span> <span data-ttu-id="c8054-226">Bu görevleri normal olarak çalışır.</span><span class="sxs-lookup"><span data-stu-id="c8054-226">These tasks will run as normal.</span></span> <span data-ttu-id="c8054-227">"İş Bölümlendirici hatası" yukarıda bu kod yolu hakkında bilgi için bkz.</span><span class="sxs-lookup"><span data-stu-id="c8054-227">See "Job Splitter Failure" above for discussion of this code path.</span></span>

<span data-ttu-id="c8054-228">Özel durumlar tarafından döndürülen tüm bilgileri stdout.txt ve stderr.txt dosyalarına yazılır.</span><span class="sxs-lookup"><span data-stu-id="c8054-228">All the information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="c8054-229">Daha fazla bilgi için bkz: [işleme hatası](batch-api-basics.md#error-handling).</span><span class="sxs-lookup"><span data-stu-id="c8054-229">For more information, see [Error Handling](batch-api-basics.md#error-handling).</span></span>

### <a name="client-considerations"></a><span data-ttu-id="c8054-230">İstemci değerlendirmeleri</span><span class="sxs-lookup"><span data-stu-id="c8054-230">Client considerations</span></span>
<span data-ttu-id="c8054-231">Bu bölümde, bu şablona dayalı bir iş yöneticisi çağrılırken, bazı istemci uygulama gereksinimleri açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c8054-231">This section describes some client implementation requirements when invoking a job manager based on this template.</span></span> <span data-ttu-id="c8054-232">Bkz: [parametreleri ve ortam değişkenleri istemci kodundan geçirmek nasıl](#pass-environment-settings) parametreleri ve ortam ayarlarını geçirme hakkında bilgi.</span><span class="sxs-lookup"><span data-stu-id="c8054-232">See [How to pass parameters and environment variables from the client code](#pass-environment-settings) for details on passing parameters and environment settings.</span></span>

<span data-ttu-id="c8054-233">**Zorunlu kimlik bilgileri**</span><span class="sxs-lookup"><span data-stu-id="c8054-233">**Mandatory credentials**</span></span>

<span data-ttu-id="c8054-234">Azure Batch işe görev ekleme için iş yöneticisi görevi Azure Batch hesabı URL'si ve anahtar gerektirir.</span><span class="sxs-lookup"><span data-stu-id="c8054-234">In order to add tasks to the Azure Batch job, the job manager task requires your Azure Batch account URL and key.</span></span> <span data-ttu-id="c8054-235">Bu ortam değişkenleri YOUR_BATCH_URL ve YOUR_BATCH_KEY adlı geçmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="c8054-235">You must pass these in environment variables named YOUR_BATCH_URL and YOUR_BATCH_KEY.</span></span> <span data-ttu-id="c8054-236">Bu İş Yöneticisi'nde görev ortam ayarları ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-236">You can set these in the Job Manager task environment settings.</span></span> <span data-ttu-id="c8054-237">Örneğin, C# istemci olarak:</span><span class="sxs-lookup"><span data-stu-id="c8054-237">For example, in a C# client:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    new EnvironmentSetting("YOUR_BATCH_URL", "https://account.region.batch.azure.com"),
    new EnvironmentSetting("YOUR_BATCH_KEY", "{your_base64_encoded_account_key}"),
};
```
<span data-ttu-id="c8054-238">**Depolama kimlik bilgileri**</span><span class="sxs-lookup"><span data-stu-id="c8054-238">**Storage credentials**</span></span>

<span data-ttu-id="c8054-239">Genellikle, istemci (a) çoğu iş yöneticileri açıkça bağlantılı depolama hesabına erişim gerekmez ve (b bağlantılı depolama hesabı genellikle tüm görevleri olarak sağlanan olduğundan iş yöneticisi görevi bağlantılı depolama hesabı kimlik bilgilerini sağlamak üzere gerekmez bir İş için ortak ortamı ayarı.</span><span class="sxs-lookup"><span data-stu-id="c8054-239">Typically, the client does not need to provide the linked storage account credentials to the job manager task because (a) most job managers do not need to explicitly access the linked storage account and (b) the linked storage account is often provided to all tasks as a common environment setting for the job.</span></span> <span data-ttu-id="c8054-240">Daha sonra ortak ortam ayarları aracılığıyla bağlantılı depolama hesabı sağlama değil ve İş Yöneticisi bağlı depolama alanına erişimi gerektiriyorsa, bağlantılı depolama kimlik bilgilerini aşağıdaki gibi sağlamanız:</span><span class="sxs-lookup"><span data-stu-id="c8054-240">If you are not providing the linked storage account via the common environment settings, and the job manager requires access to linked storage, then you should supply the linked storage credentials as follows:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    /* other environment settings */
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="c8054-241">**İş Yöneticisi görevi ayarları**</span><span class="sxs-lookup"><span data-stu-id="c8054-241">**Job manager task settings**</span></span>

<span data-ttu-id="c8054-242">İstemci iş yöneticisi ayarlamalısınız *killJobOnCompletion* bayrağını **false**.</span><span class="sxs-lookup"><span data-stu-id="c8054-242">The client should set the job manager *killJobOnCompletion* flag to **false**.</span></span>

<span data-ttu-id="c8054-243">İstemcinin ayarlamak için genellikle güvenlidir *runExclusive* için **false**.</span><span class="sxs-lookup"><span data-stu-id="c8054-243">It is usually safe for the client to set *runExclusive* to **false**.</span></span>

<span data-ttu-id="c8054-244">İstemcinin kullanması gereken *resourceFiles* veya *applicationPackageReferences* işi koleksiyonu işlem düğümüne dağıtılmış manager yürütülebilir (ve gerekli DLL'leri).</span><span class="sxs-lookup"><span data-stu-id="c8054-244">The client should use the *resourceFiles* or *applicationPackageReferences* collection to have the job manager executable (and its required DLLs) deployed to the compute node.</span></span>

<span data-ttu-id="c8054-245">Başarısız olursa varsayılan olarak, İş Yöneticisi denenecek değil.</span><span class="sxs-lookup"><span data-stu-id="c8054-245">By default, the job manager will not be retried if it fails.</span></span> <span data-ttu-id="c8054-246">İş Yöneticisi mantığınızı bağlı olarak, istemci yeniden deneme aracılığıyla etkinleştirmek isteyebilirsiniz *kısıtlamaları*/*maxTaskRetryCount*.</span><span class="sxs-lookup"><span data-stu-id="c8054-246">Depending on your job manager logic, the client may want to enable retries via *constraints*/*maxTaskRetryCount*.</span></span>

<span data-ttu-id="c8054-247">**Proje ayarları**</span><span class="sxs-lookup"><span data-stu-id="c8054-247">**Job settings**</span></span>

<span data-ttu-id="c8054-248">Görev bağımlılıkları ile iş Bölümlendirici yayar, istemci iş usesTaskDependencies true olarak ayarlanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="c8054-248">If the job splitter emits tasks with dependencies, the client must set the job's usesTaskDependencies to true.</span></span>

<span data-ttu-id="c8054-249">İş Bölümlendirici model işlerinin ne iş Bölümlendirici oluşturur üzerine görevler eklemek istediğiniz istemciler için olağan dışı.</span><span class="sxs-lookup"><span data-stu-id="c8054-249">In the job splitter model, it is unusual for clients to wish to add tasks to jobs over and above what the job splitter creates.</span></span> <span data-ttu-id="c8054-250">İstemci bu nedenle normal iş ayarlamalısınız *onAllTasksComplete* için **terminatejob**.</span><span class="sxs-lookup"><span data-stu-id="c8054-250">The client should therefore normally set the job's *onAllTasksComplete* to **terminatejob**.</span></span>

## <a name="task-processor-template"></a><span data-ttu-id="c8054-251">Görev işlemci şablonu</span><span class="sxs-lookup"><span data-stu-id="c8054-251">Task Processor template</span></span>
<span data-ttu-id="c8054-252">Bir görev işlemci şablonu, aşağıdaki eylemleri gerçekleştirebilirsiniz görev işlemci uygulamak için yardımcı olur:</span><span class="sxs-lookup"><span data-stu-id="c8054-252">A Task Processor template helps you to implement a task processor that can perform the following actions:</span></span>

* <span data-ttu-id="c8054-253">Her toplu iş görevi tarafından çalıştırmak için gerekli bilgilerini ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="c8054-253">Set up the information required by each Batch task to run.</span></span>
* <span data-ttu-id="c8054-254">Her toplu iş görevi tarafından istenen tüm eylemler çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="c8054-254">Run all actions required by each Batch task.</span></span>
* <span data-ttu-id="c8054-255">Görev çıktıları kalıcı depoya kaydedin.</span><span class="sxs-lookup"><span data-stu-id="c8054-255">Save task outputs to persistent storage.</span></span>

<span data-ttu-id="c8054-256">Görev işlemci toplu olarak görevleri çalıştırmak için gerekli değildir, ancak görev işlemci kullanımının önemli bir avantajı, bir konumda bulunan tüm görev yürütme eylemlerini uygulamak için bir sarmalayıcı sağlamasıdır.</span><span class="sxs-lookup"><span data-stu-id="c8054-256">Although a task processor is not required to run tasks on Batch, the key advantage of using a task processor is that it provides a wrapper to implement all task execution actions in one location.</span></span> <span data-ttu-id="c8054-257">Örneğin, her görevin bağlamında çeşitli uygulamalar çalıştırmanız gerekiyorsa ya da kopyalama gerekiyorsa tamamladıktan sonra kalıcı depolama alanına veri her görev.</span><span class="sxs-lookup"><span data-stu-id="c8054-257">For example, if you need to run several applications in the context of each task, or if you need to copy data to persistent storage after completing each task.</span></span>

<span data-ttu-id="c8054-258">Görev işlemcisi tarafından gerçekleştirilen eylemler, basit veya karmaşık, olarak ve birçok veya olarak az sayıda İş yükünüzün gerektirdiği olabilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-258">The actions performed by the task processor can be as simple or complex, and as many or as few, as required by your workload.</span></span> <span data-ttu-id="c8054-259">Ayrıca, bir görev işlemci halinde tüm görev eylemleri uygulayarak, taşımalarına güncelleştirebilir veya Eylemler uygulamalara veya iş yükü gereksinimlerini değişikliklere göre ekleyin.</span><span class="sxs-lookup"><span data-stu-id="c8054-259">Additionally, by implementing all task actions into one task processor, you can readily update or add actions based on changes to applications or workload requirements.</span></span> <span data-ttu-id="c8054-260">Ancak, bazı durumlarda Örneğin hızlı bir şekilde basit bir komut satırından başlatılan bir iş çalışmadığı zaman gereksiz karmaşıklık ekleyebilirsiniz gibi en iyi çözüm, uygulamanız için bir görev işlemci olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-260">However, in some cases a task processor might not be the optimal solution for your implementation as it can add unnecessary complexity, for example when running jobs that can be quickly started from a simple command line.</span></span>

### <a name="create-a-task-processor-using-the-template"></a><span data-ttu-id="c8054-261">Şablonu kullanarak bir görev işlemcisi oluşturma</span><span class="sxs-lookup"><span data-stu-id="c8054-261">Create a Task Processor using the template</span></span>
<span data-ttu-id="c8054-262">Bir görev işlemci daha önce oluşturduğunuz çözüme eklemek için aşağıdaki adımları izleyin:</span><span class="sxs-lookup"><span data-stu-id="c8054-262">To add a task processor to the solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="c8054-263">Var olan çözümünüzü Visual Studio'da açın.</span><span class="sxs-lookup"><span data-stu-id="c8054-263">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="c8054-264">Çözüm Gezgini'nde çözüme sağ tıklayın, **Ekle**ve ardından **yeni proje**.</span><span class="sxs-lookup"><span data-stu-id="c8054-264">In Solution Explorer, right-click the solution, click **Add**, and then click **New Project**.</span></span>
3. <span data-ttu-id="c8054-265">Altında **Visual C#**, tıklatın **bulut**ve ardından **Azure Batch görev İşlemci**.</span><span class="sxs-lookup"><span data-stu-id="c8054-265">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Task Processor**.</span></span>
4. <span data-ttu-id="c8054-266">Uygulamanızı açıklayan ve bu projeyi (örneğin görev işlemci olarak tanımlayan bir ad yazın "LitwareTaskProcessor").</span><span class="sxs-lookup"><span data-stu-id="c8054-266">Type a name that describes your application and identifies this project as the task processor (e.g. "LitwareTaskProcessor").</span></span>
5. <span data-ttu-id="c8054-267">Projeyi oluşturmak için tıklatın **Tamam**.</span><span class="sxs-lookup"><span data-stu-id="c8054-267">To create the project, click **OK**.</span></span>
6. <span data-ttu-id="c8054-268">Son olarak, tüm başvurulan NuGet paketleri yüklenemedi ve onu değiştirmeye başlamadan önce projenin geçerli olduğunu doğrulamak için Visual Studio zorlamak için projeyi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="c8054-268">Finally, build the project to force Visual Studio to load all referenced NuGet packages and to verify that the project is valid before you start modifying it.</span></span>

### <a name="task-processor-template-files-and-their-purpose"></a><span data-ttu-id="c8054-269">Görev işlemci şablon dosyalarını ve amaçları</span><span class="sxs-lookup"><span data-stu-id="c8054-269">Task Processor template files and their purpose</span></span>
<span data-ttu-id="c8054-270">Görev işlemci şablonu kullanarak bir proje oluşturduğunuzda, kod dosyaları üç grupları oluşturur:</span><span class="sxs-lookup"><span data-stu-id="c8054-270">When you create a project using the task processor template, it generates three groups of code files:</span></span>

* <span data-ttu-id="c8054-271">Ana program dosyası (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="c8054-271">The main program file (Program.cs).</span></span> <span data-ttu-id="c8054-272">Bu program giriş noktası ve en üst düzey özel durum işleme içerir.</span><span class="sxs-lookup"><span data-stu-id="c8054-272">This contains the program entry point and top-level exception handling.</span></span> <span data-ttu-id="c8054-273">Normalde bu değişiklik gerekmez.</span><span class="sxs-lookup"><span data-stu-id="c8054-273">You shouldn't normally need to modify this.</span></span>
* <span data-ttu-id="c8054-274">Framework dizini.</span><span class="sxs-lookup"><span data-stu-id="c8054-274">The Framework directory.</span></span> <span data-ttu-id="c8054-275">Bu görevler ekleme toplu iş, vb. parametreleri açmak İş Yöneticisi program – 'ortak' çalışmanın sorumlu dosyalarını içerir. Normalde bu dosyalarda değişiklik gerekmez.</span><span class="sxs-lookup"><span data-stu-id="c8054-275">This contains the files responsible for the 'boilerplate' work done by the job manager program – unpacking parameters, adding tasks to the Batch job, etc. You shouldn't normally need to modify these files.</span></span>
* <span data-ttu-id="c8054-276">Görev işlemcisi dosyasını (TaskProcessor.cs).</span><span class="sxs-lookup"><span data-stu-id="c8054-276">The task processor file (TaskProcessor.cs).</span></span> <span data-ttu-id="c8054-277">Bir görev (genellikle çağırarak varolan çalıştırılabilir) yürütmek, uygulamaya özgü mantığınızı yerleştireceğiniz budur.</span><span class="sxs-lookup"><span data-stu-id="c8054-277">This is where you will put your application-specific logic for executing a task (typically by calling out to an existing executable).</span></span> <span data-ttu-id="c8054-278">Ek veri indirme veya sonuç dosyalarını karşıya yükleme gibi ön ve işlem sonrası kodu da buraya ekleyin.</span><span class="sxs-lookup"><span data-stu-id="c8054-278">Pre- and post-processing code, such as downloading additional data or uploading result files, also goes here.</span></span>

<span data-ttu-id="c8054-279">Elbette mantığı bölme iş karmaşıklığına bağlı olarak, görev işlemci kodu desteklemek için gerektiği gibi ek dosyaları ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-279">Of course you can add additional files as required to support your task processor code, depending on the complexity of the job splitting logic.</span></span>

<span data-ttu-id="c8054-280">Şablon ayrıca .csproj dosya, app.config, packages.config, vb. gibi standart .NET proje dosyalarını oluşturur.</span><span class="sxs-lookup"><span data-stu-id="c8054-280">The template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="c8054-281">Bu bölümde rest farklı dosya ve kendi kod yapısını ve her sınıf yaptığı açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c8054-281">The rest of this section describes the different files and their code structure, and explains what each class does.</span></span>

![Görev işlemci şablon çözümünü gösteren Visual Studio Çözüm Gezgini][solution_explorer02]

<span data-ttu-id="c8054-283">**Framework dosyaları**</span><span class="sxs-lookup"><span data-stu-id="c8054-283">**Framework files**</span></span>

* <span data-ttu-id="c8054-284">`Configuration.cs`: Batch hesabı ayrıntıları, bağlantılı depolama hesabı kimlik bilgileri, iş ve görev bilgileri ve iş parametreleri gibi iş yapılandırma verilerinin yüklenmesini yalıtır.</span><span class="sxs-lookup"><span data-stu-id="c8054-284">`Configuration.cs`: Encapsulates the loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="c8054-285">Ayrıca, Configuration.EnvironmentVariable sınıfı aracılığıyla toplu tanımlı ortam değişkenlerini (toplu belgelerinde görevler için ortam ayarları bakın) erişim sağlar.</span><span class="sxs-lookup"><span data-stu-id="c8054-285">It also provides access to Batch-defined environment variables (see Environment settings for tasks, in the Batch documentation) via the Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="c8054-286">`IConfiguration.cs`: Birim testi sahte veya sahte yapılandırma nesnesi kullanarak, iş Bölümlendirici olan yapılandırma sınıf uyarlamasını soyutlar.</span><span class="sxs-lookup"><span data-stu-id="c8054-286">`IConfiguration.cs`: Abstracts the implementation of the Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="c8054-287">`TaskProcessorException.cs`: Sonlandırmak İş Yöneticisi gerektiren bir hatayı temsil eder.</span><span class="sxs-lookup"><span data-stu-id="c8054-287">`TaskProcessorException.cs`: Represents an error that requires the job manager to terminate.</span></span> <span data-ttu-id="c8054-288">TaskProcessorException belirli tanılama bilgileri sonlandırma bir parçası olarak burada sağlanabilir 'beklenen' hataları kaydırmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="c8054-288">TaskProcessorException is used to wrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>

<span data-ttu-id="c8054-289">**Görev işlemci**</span><span class="sxs-lookup"><span data-stu-id="c8054-289">**Task Processor**</span></span>

* <span data-ttu-id="c8054-290">`TaskProcessor.cs`: Görev çalıştırır.</span><span class="sxs-lookup"><span data-stu-id="c8054-290">`TaskProcessor.cs`: Runs the task.</span></span> <span data-ttu-id="c8054-291">Framework TaskProcessor.Run yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="c8054-291">The framework invokes the TaskProcessor.Run method.</span></span> <span data-ttu-id="c8054-292">Bu burada göreviniz uygulamaya özgü mantığını Ekle sınıftır.</span><span class="sxs-lookup"><span data-stu-id="c8054-292">This is the class where you will inject the application-specific logic of your task.</span></span> <span data-ttu-id="c8054-293">Run yöntemi uygulayın:</span><span class="sxs-lookup"><span data-stu-id="c8054-293">Implement the Run method to:</span></span>
  * <span data-ttu-id="c8054-294">Ayrıştırma ve herhangi bir görev parametre doğrulama</span><span class="sxs-lookup"><span data-stu-id="c8054-294">Parse and validate any task parameters</span></span>
  * <span data-ttu-id="c8054-295">Çağrılacak istediğiniz herhangi bir dış programı için komut satırı oluştur</span><span class="sxs-lookup"><span data-stu-id="c8054-295">Compose the command line for any external program you want to invoke</span></span>
  * <span data-ttu-id="c8054-296">Hata ayıklama amacıyla gerektirebilecek herhangi tanılama bilgileri günlüğe kaydet</span><span class="sxs-lookup"><span data-stu-id="c8054-296">Log any diagnostic information you may require for debugging purposes</span></span>
  * <span data-ttu-id="c8054-297">Bu komut satırını kullanarak bir işlem Başlat</span><span class="sxs-lookup"><span data-stu-id="c8054-297">Start a process using that command line</span></span>
  * <span data-ttu-id="c8054-298">Çıkış işlemini bekle</span><span class="sxs-lookup"><span data-stu-id="c8054-298">Wait for the process to exit</span></span>
  * <span data-ttu-id="c8054-299">Başarılı veya başarısız olup olmadığı belirlenemiyor işlem çıkış kodu yakalama</span><span class="sxs-lookup"><span data-stu-id="c8054-299">Capture the exit code of the process to determine if it succeeded or failed</span></span>
  * <span data-ttu-id="c8054-300">Kalıcı depoya tutmak istediğiniz tüm çıktı dosyaları kaydedin</span><span class="sxs-lookup"><span data-stu-id="c8054-300">Save any output files you want to keep to persistent storage</span></span>

<span data-ttu-id="c8054-301">**Standart .NET komut satırı proje dosyaları**</span><span class="sxs-lookup"><span data-stu-id="c8054-301">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="c8054-302">`App.config`: Standart .NET uygulama yapılandırma dosyası.</span><span class="sxs-lookup"><span data-stu-id="c8054-302">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="c8054-303">`Packages.config`: Standart NuGet paket bağımlılık dosyası.</span><span class="sxs-lookup"><span data-stu-id="c8054-303">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="c8054-304">`Program.cs`: Program giriş noktası ve en üst düzey özel durum işleme içerir.</span><span class="sxs-lookup"><span data-stu-id="c8054-304">`Program.cs`: Contains the program entry point and top-level exception handling.</span></span>

## <a name="implementing-the-task-processor"></a><span data-ttu-id="c8054-305">Görev işlemci uygulama</span><span class="sxs-lookup"><span data-stu-id="c8054-305">Implementing the task processor</span></span>
<span data-ttu-id="c8054-306">Görev işlemci şablon projeyi açtığınızda, projenin varsayılan olarak açık TaskProcessor.cs dosyayı sahip olur.</span><span class="sxs-lookup"><span data-stu-id="c8054-306">When you open the Task Processor template project, the project will have the TaskProcessor.cs file open by default.</span></span> <span data-ttu-id="c8054-307">Aşağıda gösterilen Run() yöntemi kullanarak, iş yükü görevleri çalıştırma mantığını uygulayabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="c8054-307">You can implement the run logic for the tasks in your workload by using the Run() method shown below:</span></span>

```csharp
/// <summary>
/// Runs the task processing logic. This is where you inject
/// your application-specific logic for decomposing the job into tasks.
///
/// The task processor framework invokes the Run method for you; you need
/// only to implement it, not to call it yourself. Typically, your
/// implementation will execute an external program (from resource files or
/// an application package), check the exit code of that program and
/// save output files to persistent storage.
/// </summary>
public async Task<int> Run()

{
    try
    {
        //Your code for the task processor goes here.
        var command = $"compare {_parameters["Frame1"]} {_parameters["Frame2"]} compare.gif";
        using (var process = Process.Start($"cmd /c {command}"))
        {
            process.WaitForExit();
            var taskOutputStorage = new TaskOutputStorage(
            _configuration.StorageAccount,
            _configuration.JobId,
            _configuration.TaskId
            );
            await taskOutputStorage.SaveAsync(
            TaskOutputKind.TaskOutput,
            @"..\stdout.txt",
            @"stdout.txt"
            );
            return process.ExitCode;
        }
    }
    catch (Exception ex)
    {
        throw new TaskProcessorException(
        $"{ex.GetType().Name} exception in run task processor: {ex.Message}",
        ex
        );
    }
}
```
> [!NOTE]
> <span data-ttu-id="c8054-308">Run() yöntemi açıklamalı bölümünde, görevler için çalışma mantığı, iş yükü ekleyerek değiştirmeye yönelik görev işlemci şablonu kodu yalnızca bölümüdür.</span><span class="sxs-lookup"><span data-stu-id="c8054-308">The annotated section in the Run() method is the only section of the Task Processor template code that is intended for you to modify by adding the run logic for the tasks in your workload.</span></span> <span data-ttu-id="c8054-309">Şablonu farklı bir bölümünü değiştirmek istiyorsanız, Lütfen ilk önce toplu toplu belgelerini gözden geçirin ve toplu kod örnekleri birkaç çalışırken işleyişi ile edinin.</span><span class="sxs-lookup"><span data-stu-id="c8054-309">If you want to modify a different section of the template, please first familiarize yourself with how Batch works by reviewing the Batch documentation and trying out a few of the Batch code samples.</span></span>
> 
> 

<span data-ttu-id="c8054-310">Run() yöntemi sonuçları kaydetme ve son olarak bir çıkış kodu ile döndürme tüm işlemin tamamlanması beklenirken bir veya daha fazla işlemlerini başlatma komut satırı başlatmaktan sorumludur.</span><span class="sxs-lookup"><span data-stu-id="c8054-310">The Run() method is responsible for launching the command line, starting one or more processes, waiting for all process to complete, saving the results, and finally returning with an exit code.</span></span> <span data-ttu-id="c8054-311">Burada görevleriniz için işleme mantığı uygulamanız Run() yöntemidir.</span><span class="sxs-lookup"><span data-stu-id="c8054-311">The Run() method is where you implement the processing logic for your tasks.</span></span> <span data-ttu-id="c8054-312">Görev işlemci framework Run() yöntemi sizin için çağırır; çağrısını kendiniz gerekmez.</span><span class="sxs-lookup"><span data-stu-id="c8054-312">The task processor framework invokes the Run() method for you; you do not need to call it yourself.</span></span>

<span data-ttu-id="c8054-313">Run() uygulamanıza erişimi:</span><span class="sxs-lookup"><span data-stu-id="c8054-313">Your Run() implementation has access to:</span></span>

* <span data-ttu-id="c8054-314">Görev parametrelerini aracılığıyla `_parameters` alan.</span><span class="sxs-lookup"><span data-stu-id="c8054-314">The task parameters, via the `_parameters` field.</span></span>
* <span data-ttu-id="c8054-315">İş ve görev kimlikleri aracılığıyla `_jobId` ve `_taskId` alanları.</span><span class="sxs-lookup"><span data-stu-id="c8054-315">The job and task ids, via the `_jobId` and `_taskId` fields.</span></span>
* <span data-ttu-id="c8054-316">Görev yapılandırması aracılığıyla `_configuration` alan.</span><span class="sxs-lookup"><span data-stu-id="c8054-316">The task configuration, via the `_configuration` field.</span></span>

<span data-ttu-id="c8054-317">**Görev hatası**</span><span class="sxs-lookup"><span data-stu-id="c8054-317">**Task failure**</span></span>

<span data-ttu-id="c8054-318">Hata durumunda bir özel durum atma tarafından Run() yöntemi çıkabilirsiniz ancak bu üst düzey özel durum işleyici Görev çıkış kodu denetiminde durumda bırakır.</span><span class="sxs-lookup"><span data-stu-id="c8054-318">In case of failure, you can exit the Run() method by throwing an exception, but this leaves the top level exception handler in control of the task exit code.</span></span> <span data-ttu-id="c8054-319">Çıkış kodu hatası, farklı türlerde tanılama amacıyla örneğin ayırabilmesi veya çünkü bazı modu hatası iş sonlanmalıdır ve diğerleri vermemelisiniz denetlemeye ihtiyacınız varsa, daha sonra Run() yöntemi sıfır olmayan döndürerek çıkılması gerekiyor çıkış kodu.</span><span class="sxs-lookup"><span data-stu-id="c8054-319">If you need to control the exit code so that you can distinguish different types of failure, for example for diagnostic purposes or because some failure modes should terminate the job and others should not, then you should exit the Run() method by returning a non-zero exit code.</span></span> <span data-ttu-id="c8054-320">Bu görev çıkış kodu olur.</span><span class="sxs-lookup"><span data-stu-id="c8054-320">This becomes the task exit code.</span></span>

### <a name="exit-codes-and-exceptions-in-the-task-processor-template"></a><span data-ttu-id="c8054-321">Çıkış kodları ve görev işlemci şablonunda özel durumlar</span><span class="sxs-lookup"><span data-stu-id="c8054-321">Exit codes and exceptions in the Task Processor template</span></span>
<span data-ttu-id="c8054-322">Çıkış kodları ve özel durumları program çalıştırmanın sonucunu belirlemek için bir mekanizma sağlar ve bunlar herhangi bir programın yürütülmesini sorunu tanımlamaya yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-322">Exit codes and exceptions provide a mechanism to determine the outcome of running a program, and they can help identify any problems with the execution of the program.</span></span> <span data-ttu-id="c8054-323">Görev işlemci şablon çıkış kodları ve bu bölümde açıklanan özel durumları uygular.</span><span class="sxs-lookup"><span data-stu-id="c8054-323">The Task Processor template implements the exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="c8054-324">Görev işlemci şablonla uygulanan bir işlemci görevi üç olası çıkış kodlarını döndürebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="c8054-324">A task processor task that is implemented with the Task Processor template can return three possible exit codes:</span></span>

| <span data-ttu-id="c8054-325">Kod</span><span class="sxs-lookup"><span data-stu-id="c8054-325">Code</span></span> | <span data-ttu-id="c8054-326">Açıklama</span><span class="sxs-lookup"><span data-stu-id="c8054-326">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c8054-327">[Process.ExitCode][process_exitcode]</span><span class="sxs-lookup"><span data-stu-id="c8054-327">[Process.ExitCode][process_exitcode]</span></span> |<span data-ttu-id="c8054-328">Görev işlemci tamamlanıncaya kadar verdi.</span><span class="sxs-lookup"><span data-stu-id="c8054-328">The task processor ran to completion.</span></span> <span data-ttu-id="c8054-329">Bu, çağrılan programın yalnızca başarılı – olduğunu göstermez Not görev işlemci başarıyla çağrılır ve özel durumlar olmadan tüm sonrası işleme yapılır.</span><span class="sxs-lookup"><span data-stu-id="c8054-329">Note that this does not imply that the program you invoked was successful – only that the task processor invoked it successfully and performed any post-processing without exceptions.</span></span> <span data-ttu-id="c8054-330">Çıkış kodu anlamını çağrılan programa bağlıdır: çıkış kodu 0 program başarılı ve başarısız program herhangi bir çıkış kodu anlamına gelir genellikle anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="c8054-330">The meaning of the exit code depends on the invoked program – typically exit code 0 means the program succeeded and any other exit code means the program failed.</span></span> |
| <span data-ttu-id="c8054-331">1</span><span class="sxs-lookup"><span data-stu-id="c8054-331">1</span></span> |<span data-ttu-id="c8054-332">Görev işlemci program 'beklenen' bir parçası olarak bir özel durum ile başarısız oldu.</span><span class="sxs-lookup"><span data-stu-id="c8054-332">The task processor failed with an exception in an 'expected' part of the program.</span></span> <span data-ttu-id="c8054-333">Özel durum için çevrilmiştir bir `TaskProcessorException` tanılama bilgileriyle ve mümkün olduğunda hata çözümü için öneriler.</span><span class="sxs-lookup"><span data-stu-id="c8054-333">The exception was translated to a `TaskProcessorException` with diagnostic information and, where possible, suggestions for resolving the failure.</span></span> |
| <span data-ttu-id="c8054-334">2</span><span class="sxs-lookup"><span data-stu-id="c8054-334">2</span></span> |<span data-ttu-id="c8054-335">Görev İşlemci 'beklenmeyen' bir özel durumla başarısız oldu.</span><span class="sxs-lookup"><span data-stu-id="c8054-335">The task processor failed with an 'unexpected' exception.</span></span> <span data-ttu-id="c8054-336">Standart çıktıya özel durum günlüğe kaydedildi, ancak görev işlemci ek tanılama ya da düzeltme bilgileri ekleyemedi.</span><span class="sxs-lookup"><span data-stu-id="c8054-336">The exception was logged to standard output, but the task processor was unable to add any additional diagnostic or remediation information.</span></span> |

> [!NOTE]
> <span data-ttu-id="c8054-337">Programın, çağırma modu belirli hatası belirtmek için çıkış kodları 1 ve 2 kullanıyorsa, ardından çıkış kodunu 1 ve 2 görev İşlemci hataları için belirsiz kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="c8054-337">If the program you invoke uses exit codes 1 and 2 to indicate specific failure modes, then using exit codes 1 and 2 for task processor errors is ambiguous.</span></span> <span data-ttu-id="c8054-338">Program.cs dosyasının özel durumlarda düzenleyerek farklı çıkış kodları için bu görev işlemci hata kodları değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-338">You can change these task processor error codes to distinctive exit codes by editing the exception cases in the Program.cs file.</span></span>
> 
> 

<span data-ttu-id="c8054-339">Özel durumlar tarafından döndürülen tüm bilgileri stdout.txt ve stderr.txt dosyalarına yazılır.</span><span class="sxs-lookup"><span data-stu-id="c8054-339">All the information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="c8054-340">Daha fazla bilgi için işleme hatası, toplu belgelerine bakın.</span><span class="sxs-lookup"><span data-stu-id="c8054-340">For more information, see Error Handling, in the Batch documentation.</span></span>

### <a name="client-considerations"></a><span data-ttu-id="c8054-341">İstemci değerlendirmeleri</span><span class="sxs-lookup"><span data-stu-id="c8054-341">Client considerations</span></span>
<span data-ttu-id="c8054-342">**Depolama kimlik bilgileri**</span><span class="sxs-lookup"><span data-stu-id="c8054-342">**Storage credentials**</span></span>

<span data-ttu-id="c8054-343">Görev işlemcinizin çıkarır, örneğin dosya kuralları Yardımcısı kitaplığı kullanarak kalıcı hale getirmek için Azure blob depolama kullanır sonra erişmesi gereken *ya da* bulut depolama hesabının kimlik bilgilerini *veya* blob paylaşılan erişim imzası (SAS) içeren bir kapsayıcı URL.</span><span class="sxs-lookup"><span data-stu-id="c8054-343">If your task processor uses Azure blob storage to persist outputs, for example using the file conventions helper library, then it needs access to *either* the cloud storage account credentials *or* a blob container URL that includes a shared access signature (SAS).</span></span> <span data-ttu-id="c8054-344">Şablon ortak ortam değişkenleri aracılığıyla kimlik bilgilerini sağlamak için destek içerir.</span><span class="sxs-lookup"><span data-stu-id="c8054-344">The template includes support for providing credentials via common environment variables.</span></span> <span data-ttu-id="c8054-345">İstemci depolama kimlik bilgilerini aşağıdaki gibi geçirebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="c8054-345">Your client can pass the storage credentials as follows:</span></span>

```csharp
job.CommonEnvironmentSettings = new [] {
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="c8054-346">Depolama hesabı TaskProcessor sınıfında sonra kullanılabilir `_configuration.StorageAccount` özelliği.</span><span class="sxs-lookup"><span data-stu-id="c8054-346">The storage account is then available in the TaskProcessor class via the `_configuration.StorageAccount` property.</span></span>

<span data-ttu-id="c8054-347">Kapsayıcı URL'si ile SAS kullanmayı tercih ederseniz, bu da bir iş ortak ortamı ayarı aracılığıyla geçirebilirsiniz ancak görev işlemci şablonu şu anda bu için yerleşik destek içermez.</span><span class="sxs-lookup"><span data-stu-id="c8054-347">If you prefer to use a container URL with SAS, you can also pass this via an job common environment setting, but the task processor template does not currently include built-in support for this.</span></span>

<span data-ttu-id="c8054-348">**Depolama Kurulumu**</span><span class="sxs-lookup"><span data-stu-id="c8054-348">**Storage setup**</span></span>

<span data-ttu-id="c8054-349">İstemci veya iş yöneticisi görevi işe Görev eklemeden önce gereken görevleri tarafından herhangi bir kapsayıcıdaki oluşturmanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-349">It is recommended that the client or job manager task create any containers required by tasks before adding the tasks to the job.</span></span> <span data-ttu-id="c8054-350">Bu, bir kapsayıcı URL'si ile SAS kullanırsanız, bu nedenle bir URL kapsayıcı oluşturma izni içermez zorunludur.</span><span class="sxs-lookup"><span data-stu-id="c8054-350">This is mandatory if you use a container URL with SAS, as such a URL does not include permission to create the container.</span></span> <span data-ttu-id="c8054-351">Depolama hesabı kimlik bilgileri, geçirdiğiniz olsa bile CloudBlobContainer.CreateIfNotExistsAsync kapsayıcısında arama yapmak zorunda her görev kaydeder önerilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-351">It is recommended even if you pass storage account credentials, as it saves every task having to call CloudBlobContainer.CreateIfNotExistsAsync on the container.</span></span>

## <a name="pass-parameters-and-environment-variables"></a><span data-ttu-id="c8054-352">Parametreleri ve ortam değişkenleri</span><span class="sxs-lookup"><span data-stu-id="c8054-352">Pass parameters and environment variables</span></span>
### <a name="pass-environment-settings"></a><span data-ttu-id="c8054-353">Geçişi ortam ayarları</span><span class="sxs-lookup"><span data-stu-id="c8054-353">Pass environment settings</span></span>
<span data-ttu-id="c8054-354">Bir istemci iş yöneticisi görevi ortam ayarları biçiminde bilgi geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-354">A client can pass information to the job manager task in the form of environment settings.</span></span> <span data-ttu-id="c8054-355">Bu bilgi işlem iş parçası olarak çalışacak görev işlemci görevler oluştururken iş yöneticisi görevi tarafından sonra kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-355">This information can then be used by the job manager task when generating the task processor tasks that will run as part of the compute job.</span></span> <span data-ttu-id="c8054-356">Ortam ayarları geçirebilirsiniz bilgileri örnekleri şunlardır:</span><span class="sxs-lookup"><span data-stu-id="c8054-356">Examples of the information that you can pass as environment settings are:</span></span>

* <span data-ttu-id="c8054-357">Depolama hesabı adı ve hesap anahtarları</span><span class="sxs-lookup"><span data-stu-id="c8054-357">Storage account name and account keys</span></span>
* <span data-ttu-id="c8054-358">Batch hesabı URL'si</span><span class="sxs-lookup"><span data-stu-id="c8054-358">Batch account URL</span></span>
* <span data-ttu-id="c8054-359">Toplu işlem hesabı anahtarı</span><span class="sxs-lookup"><span data-stu-id="c8054-359">Batch account key</span></span>

<span data-ttu-id="c8054-360">Batch hizmetini kullanarak bir iş yöneticisi görevi ortam ayarlarını geçirmek için basit bir mekanizma sahip `EnvironmentSettings` özelliğinde [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span><span class="sxs-lookup"><span data-stu-id="c8054-360">The Batch service has a simple mechanism to pass environment settings to a job manager task by using the `EnvironmentSettings` property in [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span></span>

<span data-ttu-id="c8054-361">Örneğin, almak için `BatchClient` örneği bir toplu işlem hesabı için ortam değişkenleri istemciden kod URL ve toplu işlem hesabı için paylaşılan anahtar kimlik bilgileri olarak geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-361">For example, to get the `BatchClient` instance for a Batch account, you can pass as environment variables from the client code the URL and shared key credentials for the Batch account.</span></span> <span data-ttu-id="c8054-362">Benzer şekilde, Batch hesabına bağlantılı depolama hesabına erişmek için depolama hesabı adı ve depolama hesabı anahtarı ortam değişkenleri olarak geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-362">Likewise, to access the storage account that is linked to the Batch account, you can pass the storage account name and the storage account key as environment variables.</span></span>

### <a name="pass-parameters-to-the-job-manager-template"></a><span data-ttu-id="c8054-363">İş Yöneticisi şablon parametreleri</span><span class="sxs-lookup"><span data-stu-id="c8054-363">Pass parameters to the Job Manager template</span></span>
<span data-ttu-id="c8054-364">Çoğu durumda, iş yöneticisi görevi işlem bölme iş denetlemek veya iş için görevler yapılandırmak için iş başına parametreleri geçirmek kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="c8054-364">In many cases, it's useful to pass per-job parameters to the job manager task, either to control the job splitting process or to configure the tasks for the job.</span></span> <span data-ttu-id="c8054-365">İş Yöneticisi görevinin kaynak dosyası olarak parameters.json adlı bir JSON dosyası karşıya yükleyerek bunu yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-365">You can do this by uploading a JSON file named parameters.json as a resource file for the job manager task.</span></span> <span data-ttu-id="c8054-366">Parametreleri sonra kullanılabilir hale gelebilir `JobSplitter._parameters` İş Yöneticisi şablonunda alan.</span><span class="sxs-lookup"><span data-stu-id="c8054-366">The parameters can then become available in the `JobSplitter._parameters` field in the Job Manager template.</span></span>

> [!NOTE]
> <span data-ttu-id="c8054-367">Yerleşik parametre işleyicisi yalnızca dize-dize sözlükler destekler.</span><span class="sxs-lookup"><span data-stu-id="c8054-367">The built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="c8054-368">Parametre değerleri karmaşık JSON değerleri geçirmek istiyorsanız, bunları dizeleri olarak geçirmek ve iş Bölümlendirici ayrıştırma veya framework'ün değiştirmek gerekir `Configuration.GetJobParameters` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="c8054-368">If you want to pass complex JSON values as parameter values, you will need to pass these as strings and parse them in the job splitter, or modify the framework's `Configuration.GetJobParameters` method.</span></span>
> 
> 

### <a name="pass-parameters-to-the-task-processor-template"></a><span data-ttu-id="c8054-369">Görev işlemci şablon parametreleri</span><span class="sxs-lookup"><span data-stu-id="c8054-369">Pass parameters to the Task Processor template</span></span>
<span data-ttu-id="c8054-370">Ayrıca, görev işlemci şablonu kullanılarak uygulanan ayrı görevlere parametreleri geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-370">You can also pass parameters to individual tasks implemented using the Task Processor template.</span></span> <span data-ttu-id="c8054-371">İş Yöneticisi şablonla gibi adlı bir kaynak dosyasını görev işlemci şablonu arar</span><span class="sxs-lookup"><span data-stu-id="c8054-371">Just as with the job manager template, the task processor template looks for a resource file named</span></span>

<span data-ttu-id="c8054-372">Parameters.JSON ve bulduğu IF parametreleri sözlüğü olarak yükler.</span><span class="sxs-lookup"><span data-stu-id="c8054-372">parameters.json, and if found it loads it as the parameters dictionary.</span></span> <span data-ttu-id="c8054-373">Birkaç parametreleri görev işlemci görevlere geçirmek nasıl ilgili seçenekleri şunlardır:</span><span class="sxs-lookup"><span data-stu-id="c8054-373">There are a couple of options for how to pass parameters to the task processor tasks:</span></span>

* <span data-ttu-id="c8054-374">İş parametrelerini JSON yeniden kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c8054-374">Reuse the job parameters JSON.</span></span> <span data-ttu-id="c8054-375">Bu, iyi yalnızca parametreleri (örneğin, bir işleme yükseklik ve genişlik için) iş genelinde olanları ise çalışır.</span><span class="sxs-lookup"><span data-stu-id="c8054-375">This works well if the only parameters are job-wide ones (for example, a render height and width).</span></span> <span data-ttu-id="c8054-376">Bu, bir CloudTask iş Bölümlendirici oluştururken yapmak için İş Yöneticisi görev ResourceFiles parameters.json kaynak dosya nesnesine başvuru Ekle (`JobSplitter._jobManagerTask.ResourceFiles`) CloudTask'ın ResourceFiles koleksiyonuna.</span><span class="sxs-lookup"><span data-stu-id="c8054-376">To do this, when creating a CloudTask in the job splitter, add a reference to the parameters.json resource file object from the job manager task's ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) to the CloudTask's ResourceFiles collection.</span></span>
* <span data-ttu-id="c8054-377">Oluştur ve bir görev özgü parameters.json belge iş Bölümlendirici yürütme bir parçası olarak yüklemek ve görevin kaynak dosyaları koleksiyonundaki bu blob başvurusu.</span><span class="sxs-lookup"><span data-stu-id="c8054-377">Generate and upload a task-specific parameters.json document as part of job splitter execution, and reference that blob in the task's resource files collection.</span></span> <span data-ttu-id="c8054-378">Farklı görevler farklı parametreler varsa, bu gereklidir.</span><span class="sxs-lookup"><span data-stu-id="c8054-378">This is necessary if different tasks have different parameters.</span></span> <span data-ttu-id="c8054-379">Bir örnek çerçeve dizini parametre olarak göreve geçirildiği 3B işleme senaryo olabilir.</span><span class="sxs-lookup"><span data-stu-id="c8054-379">An example might be a 3D rendering scenario where the frame index is passed to the task as a parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="c8054-380">Yerleşik parametre işleyicisi yalnızca dize-dize sözlükler destekler.</span><span class="sxs-lookup"><span data-stu-id="c8054-380">The built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="c8054-381">Parametre değerleri karmaşık JSON değerleri geçirmek istiyorsanız, bunları dizeleri olarak geçirmek ve görev işlemcide ayrıştırma veya framework'ün değiştirmek gerekir `Configuration.GetTaskParameters` yöntemi.</span><span class="sxs-lookup"><span data-stu-id="c8054-381">If you want to pass complex JSON values as parameter values, you will need to pass these as strings and parse them in the task processor, or modify the framework's `Configuration.GetTaskParameters` method.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="c8054-382">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="c8054-382">Next steps</span></span>
### <a name="persist-job-and-task-output-to-azure-storage"></a><span data-ttu-id="c8054-383">Azure Storage iş ve Görev çıkış Sürdür</span><span class="sxs-lookup"><span data-stu-id="c8054-383">Persist job and task output to Azure Storage</span></span>
<span data-ttu-id="c8054-384">Batch çözümü geliştirme yararlı bir diğer araç [Azure toplu işlem dosyası kuralları][nuget_package].</span><span class="sxs-lookup"><span data-stu-id="c8054-384">Another helpful tool in Batch solution development is [Azure Batch File Conventions][nuget_package].</span></span> <span data-ttu-id="c8054-385">Bu .NET sınıf kitaplığı (şu anda önizlemede), Batch .NET uygulamalarında kolayca depolamak ve görev çıktıları için ve Azure depolama biriminden almak için kullanın.</span><span class="sxs-lookup"><span data-stu-id="c8054-385">Use this .NET class library (currently in preview) in your Batch .NET applications to easily store and retrieve task outputs to and from Azure Storage.</span></span> <span data-ttu-id="c8054-386">[Azure toplu işlem iş ve görev çıktısı kalıcı](batch-task-output.md) kitaplığı ve kullanım tam bir irdelemesi içerir.</span><span class="sxs-lookup"><span data-stu-id="c8054-386">[Persist Azure Batch job and task output](batch-task-output.md) contains a full discussion of the library and its usage.</span></span>

### <a name="batch-forum"></a><span data-ttu-id="c8054-387">Toplu işlem Forumu</span><span class="sxs-lookup"><span data-stu-id="c8054-387">Batch Forum</span></span>
<span data-ttu-id="c8054-388">[Azure toplu işlem Forumu] [ forum] MSDN'de toplu ele almaktadır ve hizmet hakkında sorular sormak için iyi bir yerdir.</span><span class="sxs-lookup"><span data-stu-id="c8054-388">The [Azure Batch Forum][forum] on MSDN is a great place to discuss Batch and ask questions about the service.</span></span> <span data-ttu-id="c8054-389">HEAD üzerinde üzerinden faydalı "Yapışkan" gönderiler için ve Batch çözümlerinizi derleme sırasında çıktıkları anda sorularınızı gönderin.</span><span class="sxs-lookup"><span data-stu-id="c8054-389">Head on over for helpful "sticky" posts, and post your questions as they arise while you build your Batch solutions.</span></span>

[forum]: https://social.msdn.microsoft.com/forums/azure/en-US/home?forum=azurebatch
[net_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.jobmanagertask.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[nuget_package]: https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files
[process_exitcode]: https://msdn.microsoft.com/library/system.diagnostics.process.exitcode.aspx
[vs_gallery]: https://visualstudiogallery.msdn.microsoft.com/
[vs_gallery_templates]: https://go.microsoft.com/fwlink/?linkid=820714
[vs_find_use_ext]: https://msdn.microsoft.com/library/dd293638.aspx

[diagram01]: ./media/batch-visual-studio-templates/diagram01.png
[solution_explorer01]: ./media/batch-visual-studio-templates/solution_explorer01.png
[solution_explorer02]: ./media/batch-visual-studio-templates/solution_explorer02.png
