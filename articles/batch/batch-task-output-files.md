---
title: "aaaPersist iş ve görev çıktısını tooAzure depolama hello Azure Batch hizmeti API'si ile | Microsoft Docs"
description: "Nasıl tooAzure depolama toouse Batch hizmeti API'si toopersist toplu görevi ve iş çıktısını öğrenin."
services: batch
author: tamram
manager: timlt
editor: 
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 06/16/2017
ms.author: tamram
ms.openlocfilehash: 71b3f7c0dda2d2a9d8eb3eef83229873c70ca22c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="persist-task-data-tooazure-storage-with-hello-batch-service-api"></a><span data-ttu-id="a223b-103">Görev veri tooAzure depolama hello Batch hizmeti API'si Sürdür</span><span class="sxs-lookup"><span data-stu-id="a223b-103">Persist task data tooAzure Storage with hello Batch service API</span></span>

[!INCLUDE [batch-task-output-include](../../includes/batch-task-output-include.md)]

<span data-ttu-id="a223b-104">Merhaba Batch hizmeti API'si 2017-05-01 sürümünden başlayarak, görevler ve havuzları hello sanal makine yapılandırması ile çalışan iş yöneticisi görevleri için kalıcı çıkış veri tooAzure depolama destekler.</span><span class="sxs-lookup"><span data-stu-id="a223b-104">Starting with version 2017-05-01, hello Batch service API supports persisting output data tooAzure Storage for tasks and job manager tasks that run on pools with hello virtual machine configuration.</span></span> <span data-ttu-id="a223b-105">Bir görev eklediğinizde, hello görevin çıkış hello hedefi olarak Azure Storage'da kapsayıcı belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a223b-105">When you add a task, you can specify a container in Azure Storage as hello destination for hello task's output.</span></span> <span data-ttu-id="a223b-106">Batch hizmeti hello sonra hello görev tamamlandığında, herhangi bir çıktı veri toothat kapsayıcısına yazar.</span><span class="sxs-lookup"><span data-stu-id="a223b-106">hello Batch service then writes any output data toothat container when hello task is complete.</span></span>

<span data-ttu-id="a223b-107">Bir avantajı toousing hello Batch hizmeti API toopersist görev çıktısını görev hello toomodify Merhaba uygulaması gerekiyor mu olduğunu çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="a223b-107">An advantage toousing hello Batch service API toopersist task output is that you do not need toomodify hello application that hello task is running.</span></span> <span data-ttu-id="a223b-108">Bunun yerine, birkaç basit değişiklikler tooyour istemci uygulaması ile Merhaba görevin çıktısı hello görev oluşturur hello kod devam edebilir.</span><span class="sxs-lookup"><span data-stu-id="a223b-108">Instead, with a few simple modifications tooyour client application, you can persist hello task's output from within hello code that creates hello task.</span></span>   

## <a name="when-do-i-use-hello-batch-service-api-toopersist-task-output"></a><span data-ttu-id="a223b-109">Merhaba Batch hizmeti API'si toopersist görev çıktısını kullandığınızda?</span><span class="sxs-lookup"><span data-stu-id="a223b-109">When do I use hello Batch service API toopersist task output?</span></span>

<span data-ttu-id="a223b-110">Azure Batch birden fazla tek yönlü toopersist görev çıktısını sağlar.</span><span class="sxs-lookup"><span data-stu-id="a223b-110">Azure Batch provides more than one way toopersist task output.</span></span> <span data-ttu-id="a223b-111">Merhaba Batch hizmeti API'si kullanılarak en iyi uygun toothese senaryolar kullanışlı bir yaklaşım şöyledir:</span><span class="sxs-lookup"><span data-stu-id="a223b-111">Using hello Batch service API is a convenient approach that's best suited toothese scenarios:</span></span>

- <span data-ttu-id="a223b-112">İstemci uygulamanızı içinde görevin çalıştığı Merhaba uygulaması değiştirmeden toowrite kod toopersist görev çıktısını istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="a223b-112">You want toowrite code toopersist task output from within your client application, without modifying hello application that your task is running.</span></span>
- <span data-ttu-id="a223b-113">Toplu iş görevleri ve iş yöneticisi görevleri hello sanal makine yapılandırması ile oluşturulan havuzlarında toopersist çıkışı istiyor.</span><span class="sxs-lookup"><span data-stu-id="a223b-113">You want toopersist output from Batch tasks and job manager tasks in pools created with hello virtual machine configuration.</span></span>
- <span data-ttu-id="a223b-114">Toopersist çıkış tooan Azure depolama kapsayıcısının rasgele bir ada sahip istiyor.</span><span class="sxs-lookup"><span data-stu-id="a223b-114">You want toopersist output tooan Azure Storage container with an arbitrary name.</span></span>
- <span data-ttu-id="a223b-115">Toopersist çıkış tooan Azure depolama kapsayıcısının according toohello adlı istediğiniz [toplu iş dosyası kuralları standart](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="a223b-115">You want toopersist output tooan Azure Storage container named according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> 

<span data-ttu-id="a223b-116">Senaryonuz Yukarıda listelenenler farklıysa, farklı bir yaklaşım tooconsider gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="a223b-116">If your scenario differs from those listed above, you may need tooconsider a different approach.</span></span> <span data-ttu-id="a223b-117">Örneğin, Hello Görev yürütülürken hello Batch hizmeti API'si akış çıkışı tooAzure depolama şu anda desteklemiyor.</span><span class="sxs-lookup"><span data-stu-id="a223b-117">For example, hello Batch service API does not currently support streaming output tooAzure Storage while hello task is running.</span></span> <span data-ttu-id="a223b-118">toostream çıkışı, hello toplu iş dosyası kuralları kitaplığı, .NET için kullanılabilir kullanmayı düşünün.</span><span class="sxs-lookup"><span data-stu-id="a223b-118">toostream output, consider using hello Batch File Conventions library, available for .NET.</span></span> <span data-ttu-id="a223b-119">Diğer diller için kendi çözüm tooimplement gerekir.</span><span class="sxs-lookup"><span data-stu-id="a223b-119">For other languages, you'll need tooimplement your own solution.</span></span> <span data-ttu-id="a223b-120">Kalıcı görev çıktısı için diğer seçenekleri hakkında daha fazla bilgi için bkz: [kalan iş ve görev çıktısını tooAzure depolama](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="a223b-120">For more information on other options for persisting task output, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span> 

## <a name="create-a-container-in-azure-storage"></a><span data-ttu-id="a223b-121">Azure Storage'da kapsayıcı oluşturma</span><span class="sxs-lookup"><span data-stu-id="a223b-121">Create a container in Azure Storage</span></span>

<span data-ttu-id="a223b-122">tooAzure depolama toopersist görev çıktısı, toocreate çıkış dosyalarınızı hello hedefi olarak hizmet veren bir kapsayıcı gerekir.</span><span class="sxs-lookup"><span data-stu-id="a223b-122">toopersist task output tooAzure Storage, you'll need toocreate a container that serves as hello destination for your output files.</span></span> <span data-ttu-id="a223b-123">İşinizi göndermeden önce göreviniz, tercihen çalıştırmadan önce hello kapsayıcı oluşturun.</span><span class="sxs-lookup"><span data-stu-id="a223b-123">Create hello container before you run your task, preferably before you submit your job.</span></span> <span data-ttu-id="a223b-124">toocreate hello kapsayıcı, kullanım hello uygun Azure Storage istemci kitaplığı veya SDK.</span><span class="sxs-lookup"><span data-stu-id="a223b-124">toocreate hello container, use hello appropriate Azure Storage client library or SDK.</span></span> <span data-ttu-id="a223b-125">Azure depolama API'leri hakkında daha fazla bilgi için bkz: Merhaba [Azure Storage belgeleri](https://docs.microsoft.com/azure/storage/).</span><span class="sxs-lookup"><span data-stu-id="a223b-125">For more information about Azure Storage APIs, see hello [Azure Storage documentation](https://docs.microsoft.com/azure/storage/).</span></span>

<span data-ttu-id="a223b-126">Uygulamanızı C# dilinde yazıyorsanız, örneğin, hello kullan [.NET için Azure Storage istemci Kitaplığı](https://www.nuget.org/packages/WindowsAzure.Storage/).</span><span class="sxs-lookup"><span data-stu-id="a223b-126">For example, if you are writing your application in C#, use hello [Azure Storage client library for .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span></span> <span data-ttu-id="a223b-127">örnekte gösterildiği nasıl aşağıdaki hello toocreate bir kapsayıcı:</span><span class="sxs-lookup"><span data-stu-id="a223b-127">hello following example shows how toocreate a container:</span></span>

```csharp
CloudBlobContainer container = storageAccount.CreateCloudBlobClient().GetContainerReference(containerName);
await conainer.CreateIfNotExists();
```

## <a name="get-a-shared-access-signature-for-hello-container"></a><span data-ttu-id="a223b-128">Merhaba kapsayıcı için bir paylaşılan erişim imzası Al</span><span class="sxs-lookup"><span data-stu-id="a223b-128">Get a shared access signature for hello container</span></span>

<span data-ttu-id="a223b-129">Merhaba kapsayıcısı oluşturduktan sonra yazma erişimi toohello kapsayıcısı ile paylaşılan erişim imzası (SAS) alın.</span><span class="sxs-lookup"><span data-stu-id="a223b-129">After you create hello container, get a shared access signature (SAS) with write access toohello container.</span></span> <span data-ttu-id="a223b-130">Bir SAS atanmış erişim toohello kapsayıcı sağlar.</span><span class="sxs-lookup"><span data-stu-id="a223b-130">A SAS provides delegated access toohello container.</span></span> <span data-ttu-id="a223b-131">Merhaba SAS izinleri ve belirli bir zaman aralığı içinde belirtilen bir kümesiyle erişim verir.</span><span class="sxs-lookup"><span data-stu-id="a223b-131">hello SAS grants access with a specified set of permissions and over a specified time interval.</span></span> <span data-ttu-id="a223b-132">Merhaba Batch hizmeti bir SAS yazma izinleri toowrite Görev çıkış toohello kapsayıcısı ile gerekir.</span><span class="sxs-lookup"><span data-stu-id="a223b-132">hello Batch service needs a SAS with write permissions toowrite task output toohello container.</span></span> <span data-ttu-id="a223b-133">SAS hakkında daha fazla bilgi için bkz: [kullanarak paylaşılan erişim imzaları \(SAS\) Azure storage'da](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="a223b-133">For more information about SAS, see [Using shared access signatures \(SAS\) in Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>

<span data-ttu-id="a223b-134">Hello Azure depolama API'leri kullanılarak bir SAS aldığınızda, hello API bir SAS belirteci dize döndürür.</span><span class="sxs-lookup"><span data-stu-id="a223b-134">When you get a SAS using hello Azure Storage APIs, hello API returns a SAS token string.</span></span> <span data-ttu-id="a223b-135">Bu belirteç dizesini hello SAS hello izinleri ve hangi hello SAS geçerli hello aralıkta dahil olmak üzere, tüm parametrelerinin içerir.</span><span class="sxs-lookup"><span data-stu-id="a223b-135">This token string includes all parameters of hello SAS, including hello permissions and hello interval over which hello SAS is valid.</span></span> <span data-ttu-id="a223b-136">toouse hello SAS tooaccess Azure storage'da kapsayıcı, tooappend hello SAS belirteci dize toohello kaynak URI'si gerekir.</span><span class="sxs-lookup"><span data-stu-id="a223b-136">toouse hello SAS tooaccess a container in Azure Storage, you need tooappend hello SAS token string toohello resource URI.</span></span> <span data-ttu-id="a223b-137">Merhaba birlikte Hello kaynak URI'si, SAS belirteci eklenmiş, kimliği doğrulanmış erişim tooAzure depolama sağlar.</span><span class="sxs-lookup"><span data-stu-id="a223b-137">hello resource URI, together with hello appended SAS token, provides authenticated access tooAzure Storage.</span></span>

<span data-ttu-id="a223b-138">Merhaba aşağıdaki örnekte nasıl tooget salt yazılır SAS belirteci hello kapsayıcısı için dize gösterir, ardından hello SAS toohello kapsayıcı URI ekler:</span><span class="sxs-lookup"><span data-stu-id="a223b-138">hello following example shows how tooget a write-only SAS token string for hello container, then appends hello SAS toohello container URI:</span></span>

```csharp
string containerSasToken = container.GetSharedAccessSignature(new SharedAccessBlobPolicy()
{
    SharedAccessExpiryTime = DateTimeOffset.UtcNow.AddDays(1),
    Permissions = SharedAccessBlobPermissions.Write
});

string containerSasUrl = container.Uri.AbsoluteUri + containerSasToken; 
```

## <a name="specify-output-files-for-task-output"></a><span data-ttu-id="a223b-139">Görev çıktısı için çıktı dosyaları belirtin</span><span class="sxs-lookup"><span data-stu-id="a223b-139">Specify output files for task output</span></span>

<span data-ttu-id="a223b-140">bir görev için toospecify çıktı dosyaları bir koleksiyonunu oluşturmak [ÇıktıDosyası](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) nesneleri ve toohello atayın [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) hello görev oluşturduğunuzda özelliği.</span><span class="sxs-lookup"><span data-stu-id="a223b-140">toospecify output files for a task, create a collection of [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objects and assign it toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) property when you create hello task.</span></span> 

<span data-ttu-id="a223b-141">Merhaba aşağıdaki .NET kod örneğinde adlı rastgele sayılar tooa dosyası yazan bir görev oluşturur `output.txt`.</span><span class="sxs-lookup"><span data-stu-id="a223b-141">hello following .NET code example creates a task that writes random numbers tooa file named `output.txt`.</span></span> <span data-ttu-id="a223b-142">Merhaba örnek bir çıktı dosyası oluşturur `output.txt` toobe toohello kapsayıcı yazılır.</span><span class="sxs-lookup"><span data-stu-id="a223b-142">hello example creates an output file for `output.txt` toobe written toohello container.</span></span> <span data-ttu-id="a223b-143">Merhaba örneği hello dosya desenle eşleşen tüm günlük dosyalarını için çıktı dosyaları da oluşturur `std*.txt` (_örneğin_, `stdout.txt` ve `stderr.txt`).</span><span class="sxs-lookup"><span data-stu-id="a223b-143">hello example also creates output files for any log files that match hello file pattern `std*.txt` (_e.g._, `stdout.txt` and `stderr.txt`).</span></span> <span data-ttu-id="a223b-144">Merhaba kapsayıcı URL'si hello oluşturulduğu SAS önceden hello kapsayıcısı gerektirir.</span><span class="sxs-lookup"><span data-stu-id="a223b-144">hello container URL requires hello SAS that was created previously for hello container.</span></span> <span data-ttu-id="a223b-145">Merhaba Batch hizmeti hello SAS tooauthenticate erişim toohello kapsayıcı kullanır:</span><span class="sxs-lookup"><span data-stu-id="a223b-145">hello Batch service uses hello SAS tooauthenticate access toohello container:</span></span> 

```csharp
new CloudTask(taskId, "cmd /v:ON /c \"echo off && set && (FOR /L %i IN (1,1,100000) DO (ECHO !RANDOM!)) > output.txt\"")
{
    OutputFiles = new List<OutputFile>
    {
        new OutputFile(
            filePattern: @"..\std*.txt",
            destination: new OutputFileDestination(
         new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId)),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
        new OutputFile(
            filePattern: @"output.txt",
            destination: 
         new OutputFileDestination(new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId + @"\output.txt")),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
}
```

### <a name="specify-a-file-pattern-for-matching"></a><span data-ttu-id="a223b-146">Eşleşen bir dosya düzeni belirtme</span><span class="sxs-lookup"><span data-stu-id="a223b-146">Specify a file pattern for matching</span></span>

<span data-ttu-id="a223b-147">Bir çıkış dosyası belirttiğinizde, hello kullanabilirsiniz [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) özelliği toospecify eşleşen bir dosya deseni.</span><span class="sxs-lookup"><span data-stu-id="a223b-147">When you specify an output file, you can use hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) property toospecify a file pattern for matching.</span></span> <span data-ttu-id="a223b-148">Merhaba dosya deseni sıfır dosyaları, tek bir dosya veya bir başlangıç görevi tarafından oluşturulan dosyaları kümesini eşleşmiyor olabilir.</span><span class="sxs-lookup"><span data-stu-id="a223b-148">hello file pattern may match zero files, a single file, or a set of files that are created by hello task.</span></span>

<span data-ttu-id="a223b-149">Merhaba **FilePattern** özelliğini destekleyen standart dosya sistemi joker karakterler gibi `*` (özyinelemeli olmayan eşleşen için) ve `**` (özyinelemeli eşleşen için).</span><span class="sxs-lookup"><span data-stu-id="a223b-149">hello **FilePattern** property supports standard filesystem wildcards such as `*` (for non-recursive matches) and `**` (for recursive matches).</span></span> <span data-ttu-id="a223b-150">Örneğin, hello Yukarıdaki örnek kod hello dosya düzeni toomatch belirtir `std*.txt` yinelemeli olmayan:</span><span class="sxs-lookup"><span data-stu-id="a223b-150">For example, hello code sample above specifies hello file pattern toomatch `std*.txt` non-recursively:</span></span> 

`filePattern: @"..\std*.txt"`

<span data-ttu-id="a223b-151">tooupload tek bir dosya ile joker dosya düzeni belirtin.</span><span class="sxs-lookup"><span data-stu-id="a223b-151">tooupload a single file, specify a file pattern with no wildcards.</span></span> <span data-ttu-id="a223b-152">Örneğin, hello Yukarıdaki örnek kod hello dosya düzeni toomatch belirtir `output.txt`:</span><span class="sxs-lookup"><span data-stu-id="a223b-152">For example, hello code sample above specifies hello file pattern toomatch `output.txt`:</span></span>

`filePattern: @"output.txt"`

### <a name="specify-an-upload-condition"></a><span data-ttu-id="a223b-153">Bir karşıya yükleme koşulu belirtin</span><span class="sxs-lookup"><span data-stu-id="a223b-153">Specify an upload condition</span></span>

<span data-ttu-id="a223b-154">Merhaba [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) özelliği verir koşullu çıktı dosyaları karşıya yükleme.</span><span class="sxs-lookup"><span data-stu-id="a223b-154">hello [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) property permits conditional uploading of output files.</span></span> <span data-ttu-id="a223b-155">Başarısız olursa yaygın bir senaryo tooupload bir hello görev başarılı olursa dosyaları kümesini ve farklı bir dosya kümesi ' dir.</span><span class="sxs-lookup"><span data-stu-id="a223b-155">A common scenario is tooupload one set of files if hello task succeeds, and a different set of files if it fails.</span></span> <span data-ttu-id="a223b-156">Örneğin, yalnızca hello görev başarısız olur ve sıfır olmayan çıkış kodu ile çıkar tooupload ayrıntılı günlük dosyalarını isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a223b-156">For example, you may want tooupload verbose log files only when hello task fails and exits with a nonzero exit code.</span></span> <span data-ttu-id="a223b-157">Benzer şekilde, yalnızca hello görev başarılı olursa, bu dosyaları veya hello görev başarısız olursa eksik olabileceğinden tooupload sonuç dosyalarını isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a223b-157">Similarly, you may want tooupload result files only if hello task succeeds, as those files may be missing or incomplete if hello task fails.</span></span>

<span data-ttu-id="a223b-158">Merhaba Yukarıdaki kod örneğini ayarlar hello **UploadCondition** özelliği çok**Net_offline_option**.</span><span class="sxs-lookup"><span data-stu-id="a223b-158">hello code sample above sets hello **UploadCondition** property too**TaskCompletion**.</span></span> <span data-ttu-id="a223b-159">Bu ayar, başlangıç görevleri tamamlandıktan sonra bağımsız olarak hello hello çıkış kodu değerini karşıya toobe o hello dosyadır belirtir.</span><span class="sxs-lookup"><span data-stu-id="a223b-159">This setting specifies that hello file is toobe uploaded after hello tasks completes, regardless of hello value of hello exit code.</span></span> 

`uploadCondition: OutputFileUploadCondition.TaskCompletion`

<span data-ttu-id="a223b-160">Diğer ayarlar için bkz: hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span><span class="sxs-lookup"><span data-stu-id="a223b-160">For other settings, see hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span></span>

### <a name="disambiguate-files-with-hello-same-name"></a><span data-ttu-id="a223b-161">Merhaba dosyalarıyla belirsizliğini ortadan kaldırmak aynı adı</span><span class="sxs-lookup"><span data-stu-id="a223b-161">Disambiguate files with hello same name</span></span>

<span data-ttu-id="a223b-162">bir İşte Hello görevleri hello sahip dosyalar oluşturabilir aynı adı.</span><span class="sxs-lookup"><span data-stu-id="a223b-162">hello tasks in a job may produce files that have hello same name.</span></span> <span data-ttu-id="a223b-163">Örneğin, `stdout.txt` ve `stderr.txt` bir işlemde çalışan her görev için oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="a223b-163">For example, `stdout.txt` and `stderr.txt` are created for every task that runs in a job.</span></span> <span data-ttu-id="a223b-164">Her görev kendi içeriğinde çalıştığından, bu dosyaları hello düğümün dosya sisteminde çakışmadığından.</span><span class="sxs-lookup"><span data-stu-id="a223b-164">Because each task runs in its own context, these files don't conflict on hello node's file system.</span></span> <span data-ttu-id="a223b-165">Ancak, birden çok görevleri tooa paylaşılan kapsayıcı dosyalarından karşıya yüklediğinizde, hello toodisambiguate dosyalarıyla gerekir aynı adı.</span><span class="sxs-lookup"><span data-stu-id="a223b-165">However, when you upload files from multiple tasks tooa shared container, you'll need toodisambiguate files with hello same name.</span></span>

<span data-ttu-id="a223b-166">Merhaba [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) özelliği, hello hedef blob veya sanal dizinde çıktı dosyalarını belirtir.</span><span class="sxs-lookup"><span data-stu-id="a223b-166">hello [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) property specifies hello destination blob or virtual directory for output files.</span></span> <span data-ttu-id="a223b-167">Merhaba kullanabilirsiniz **yolu** özelliği tooname hello blob veya sanal dizin çıktı ile aynı adı benzersiz olarak Azure Storage'da adlı hello dosyaları şekilde.</span><span class="sxs-lookup"><span data-stu-id="a223b-167">You can use hello **Path** property tooname hello blob or virtual directory in such a way that output files with hello same name are uniquely named in Azure Storage.</span></span> <span data-ttu-id="a223b-168">Merhaba yolunda Hello görev kimliği'ni kullanarak bir en iyi yolu tooensure benzersiz adlar olduğu ve kolayca dosyaları tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="a223b-168">Using hello task ID in hello path is a good way tooensure unique names and easily identify files.</span></span>

<span data-ttu-id="a223b-169">Merhaba, **FilePattern** özelliğini tooa joker karakter ifadesini ayarlayın, sonra hello desenle eşleşen tüm dosyaları hello tarafından belirtilen karşıya yüklenen toohello sanal dizini olan **yolu** özelliği.</span><span class="sxs-lookup"><span data-stu-id="a223b-169">If hello **FilePattern** property is set tooa wildcard expression, then all files that match hello pattern are uploaded toohello virtual directory specified by hello **Path** property.</span></span> <span data-ttu-id="a223b-170">Örneğin, hello kapsayıcı ise `mycontainer`, hello görev kimliği `mytask`, ve hello dosya deseni `..\std*.txt`, mutlak URI toohello çıktı dosyalarını Azure storage'da benzer olacaktır hello:</span><span class="sxs-lookup"><span data-stu-id="a223b-170">For example, if hello container is `mycontainer`, hello task ID is `mytask`, and hello file pattern is `..\std*.txt`, then hello absolute URIs toohello output files in Azure Storage will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/mytask/stderr.txt
https://myaccount.blob.core.windows.net/mycontainer/mytask/stdout.txt
```

<span data-ttu-id="a223b-171">Merhaba, **FilePattern** özellik kümesi toomatch tek bir dosya adı, joker karakterler içermediğinden anlamına gelir, sonra hello değerini hello **yolu** özelliği hello tam blob adını belirtir .</span><span class="sxs-lookup"><span data-stu-id="a223b-171">If hello **FilePattern** property is set toomatch a single file name, meaning it does not contain any wildcard characters, then hello value of hello **Path** property specifies hello fully qualified blob name.</span></span> <span data-ttu-id="a223b-172">Adlandırma çakışmaları birden fazla görevden tek bir dosya ile öngörüyorsanız, hello hello sanal dizin adını hello dosya adı toodisambiguate bir parçası olarak bu dosyaları içerir.</span><span class="sxs-lookup"><span data-stu-id="a223b-172">If you anticipate naming conflicts with a single file from multiple tasks, then include hello name of hello virtual directory as part of hello file name toodisambiguate those files.</span></span> <span data-ttu-id="a223b-173">Örneğin, kümesi hello **yolu** özellik tooinclude hello görev kimliği, hello sınırlayıcı karakter (genellikle bir eğik çizgi) ve hello dosya adı:</span><span class="sxs-lookup"><span data-stu-id="a223b-173">For example, set hello **Path** property tooinclude hello task ID, hello delimiter character (typically a forward slash), and hello file name:</span></span>

`path: taskId + @"/output.txt"`

<span data-ttu-id="a223b-174">Merhaba mutlak URI toohello çıkış dosyaları için bir dizi görevi şuna benzeyecektir:</span><span class="sxs-lookup"><span data-stu-id="a223b-174">hello absolute URIs toohello output files for a set of tasks will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/task1/output.txt
https://myaccount.blob.core.windows.net/mycontainer/task2/output.txt
```

<span data-ttu-id="a223b-175">Azure depolama alanında sanal dizinleri hakkında daha fazla bilgi için bkz: [hello BLOB'ları bir kapsayıcıda listelemek](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span><span class="sxs-lookup"><span data-stu-id="a223b-175">For more information about virtual directories in Azure Storage, see [List hello blobs in a container](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span></span>


## <a name="diagnose-file-upload-errors"></a><span data-ttu-id="a223b-176">Dosya karşıya yükleme hatalarını tanılama</span><span class="sxs-lookup"><span data-stu-id="a223b-176">Diagnose file upload errors</span></span>

<span data-ttu-id="a223b-177">Çıktı karşıya yükleme dosyaları tooAzure depolama başarısız olduysa hello görev toohello taşır **tamamlandı** durumu ve hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) özelliği ayarlanmış.</span><span class="sxs-lookup"><span data-stu-id="a223b-177">If uploading output files tooAzure Storage fails, then hello task moves toohello **Completed** state and hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) property is set.</span></span> <span data-ttu-id="a223b-178">Merhaba inceleyin **FailureInformation** özelliği toodetermine hangi hata oluştu.</span><span class="sxs-lookup"><span data-stu-id="a223b-178">Examine hello **FailureInformation** property toodetermine what error occurred.</span></span> <span data-ttu-id="a223b-179">Örneğin, dosya karşıya yükleme sırasında hello kapsayıcı bulunamazsa oluşan bir hata şöyledir:</span><span class="sxs-lookup"><span data-stu-id="a223b-179">For example, here is an error that occurs on file upload if hello container cannot be found:</span></span> 

```
Category: UserError
Code: FileUploadContainerNotFound
Message: One of hello specified Azure container(s) was not found while attempting tooupload an output file
```

<span data-ttu-id="a223b-180">İki günlük dosyaları toohello işlem düğümü, her dosya karşıya yükleme toplu Yazar `fileuploadout.txt` ve `fileuploaderr.txt`.</span><span class="sxs-lookup"><span data-stu-id="a223b-180">On every file upload, Batch writes two log files toohello compute node, `fileuploadout.txt` and `fileuploaderr.txt`.</span></span> <span data-ttu-id="a223b-181">Bu günlük dosyaları toolearn belirli hata hakkında daha fazla inceleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a223b-181">You can examine these log files toolearn more about a specific failure.</span></span> <span data-ttu-id="a223b-182">Merhaba görev kendisini çalıştırılamadı çünkü burada hello dosya karşıya yükleme hiçbir zaman, örneğin denendi durumlarda, sonra bu günlük dosyaları mevcut olmaz.</span><span class="sxs-lookup"><span data-stu-id="a223b-182">In cases where hello file upload was never attempted, for example because hello task itself couldn’t run, then these log files will not exist.</span></span>

## <a name="diagnose-file-upload-performance"></a><span data-ttu-id="a223b-183">Dosya karşıya yükleme performansı tanılama</span><span class="sxs-lookup"><span data-stu-id="a223b-183">Diagnose file upload performance</span></span>

<span data-ttu-id="a223b-184">Merhaba `fileuploadout.txt` dosya karşıya yükleme ilerleme durumu günlüğe kaydeder.</span><span class="sxs-lookup"><span data-stu-id="a223b-184">hello `fileuploadout.txt` file logs upload progress.</span></span> <span data-ttu-id="a223b-185">Bu dosya toolearn ne kadar süreyle dosyanızı karşıya yükleme hakkında daha fazla sürüyor inceleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a223b-185">You can examine this file toolearn more about how long your file uploads are taking.</span></span> <span data-ttu-id="a223b-186">Tooupload performans, hello hedef kapsayıcı hello olup hello düğümün, diğer hello düğümünde etkinliği hello karşıya yükleme, başlangıç zamanında hello boyutu da dahil olmak üzere birçok faktörlere olduğunu aklınızda bulundurun hello Batch havuzu aynı bölgede, kaç tane düğümleri olan Depolama hesabı aynı saat ve benzeri hello toohello yükleniyor.</span><span class="sxs-lookup"><span data-stu-id="a223b-186">Keep in mind that there are many contributing factors tooupload performance, including hello size of hello node, other activity on hello node at hello time of hello upload, whether hello target container is in hello same region as hello Batch pool, how many nodes are uploading toohello storage account at hello same time, and so on.</span></span>

## <a name="use-hello-batch-service-api-with-hello-batch-file-conventions-standard"></a><span data-ttu-id="a223b-187">Toplu iş dosyası kuralları standart hello ile Merhaba Batch hizmeti API'si kullanın</span><span class="sxs-lookup"><span data-stu-id="a223b-187">Use hello Batch service API with hello Batch File Conventions standard</span></span>

<span data-ttu-id="a223b-188">Görev çıktısı hello Batch hizmeti API'si ile kalıcı, hedef kapsayıcı adı verebilirsiniz ve istediğiniz ancak blobları.</span><span class="sxs-lookup"><span data-stu-id="a223b-188">When you persist task output with hello Batch service API, you can name your destination container and blobs however you like.</span></span> <span data-ttu-id="a223b-189">Tooname de seçebilirsiniz bunları toohello göre [toplu iş dosyası kuralları standart](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="a223b-189">You can also choose tooname them according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> <span data-ttu-id="a223b-190">Merhaba dosyası kuralları standart hello Hedef kapsayıcıyı ve Azure storage'da bir blob hello iş ve görev hello adlarına göre verilen çıktı dosyası hello adları belirler.</span><span class="sxs-lookup"><span data-stu-id="a223b-190">hello File Conventions standard determines hello names of hello destination container and blob in Azure Storage for a given output file based on hello names of hello job and task.</span></span> <span data-ttu-id="a223b-191">Merhaba dosyası kuralları standart çıktı dosyalarını adlandırma için kullandığınız sonra çıktı dosyalarınızı hello görüntülenmek için kullanılabilir [Azure portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="a223b-191">If you do use hello File Conventions standard for naming output files, then your output files are available for viewing in hello [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="a223b-192">C# ' ta geliştiriyorsanız hello yerleşik hello yöntemlerini kullanabilirsiniz [.NET için toplu iş dosyası kuralları Kitaplığı](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span><span class="sxs-lookup"><span data-stu-id="a223b-192">If you are developing in C#, you can use hello methods built into hello [Batch File Conventions library for .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span></span> <span data-ttu-id="a223b-193">Bu kitaplık sizin için doğru kapsayıcıları ve blob yolları adlı hello oluşturur.</span><span class="sxs-lookup"><span data-stu-id="a223b-193">This library creates hello properly named containers and blob paths for you.</span></span> <span data-ttu-id="a223b-194">Örneğin, hello API tooget hello için doğru bir adı hello iş adına göre hello kapsayıcı çağırabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="a223b-194">For example, you can call hello API tooget hello correct name for hello container, based on hello job name:</span></span>

```csharp
string containerName = job.OutputStorageContainerName();
```

<span data-ttu-id="a223b-195">Merhaba kullanabilirsiniz [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) yöntemi tooreturn kullanılan toowrite toohello kapsayıcı paylaşılan erişim imzası (SAS) URL.</span><span class="sxs-lookup"><span data-stu-id="a223b-195">You can use hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) method tooreturn a shared access signature (SAS) URL that is used toowrite toohello container.</span></span> <span data-ttu-id="a223b-196">Ardından bu SAS toohello geçirebilirsiniz [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) Oluşturucusu.</span><span class="sxs-lookup"><span data-stu-id="a223b-196">You can then pass this SAS toohello [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) constructor.</span></span>

<span data-ttu-id="a223b-197">C# dışındaki bir dilde geliştiriyorsanız tooimplement hello dosyası kuralları standart kendiniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="a223b-197">If you are developing in a language other than C#, you will need tooimplement hello File Conventions standard yourself.</span></span>

## <a name="code-sample"></a><span data-ttu-id="a223b-198">Kod örneği</span><span class="sxs-lookup"><span data-stu-id="a223b-198">Code sample</span></span>

<span data-ttu-id="a223b-199">Merhaba [PersistOutputs] [ github_persistoutputs] örnek proje hello biridir [Azure Batch kod örnekleri] [ github_samples] github'da.</span><span class="sxs-lookup"><span data-stu-id="a223b-199">hello [PersistOutputs][github_persistoutputs] sample project is one of hello [Azure Batch code samples][github_samples] on GitHub.</span></span> <span data-ttu-id="a223b-200">Bu Visual Studio çözümü nasıl toodurable depolama toouse hello toplu istemci kitaplığı için .NET toopersist görev çıktısını gösterir.</span><span class="sxs-lookup"><span data-stu-id="a223b-200">This Visual Studio solution demonstrates how toouse hello Batch client library for .NET toopersist task output toodurable storage.</span></span> <span data-ttu-id="a223b-201">toorun hello örnek, şu adımları izleyin:</span><span class="sxs-lookup"><span data-stu-id="a223b-201">toorun hello sample, follow these steps:</span></span>

1. <span data-ttu-id="a223b-202">Açık hello projesinde **Visual Studio 2015 veya daha yeni**.</span><span class="sxs-lookup"><span data-stu-id="a223b-202">Open hello project in **Visual Studio 2015 or newer**.</span></span>
2. <span data-ttu-id="a223b-203">Batch ve Storage eklemek **hesabının kimlik bilgilerini** çok**AccountSettings.settings** hello öğesini kullanıma alın projesinde.</span><span class="sxs-lookup"><span data-stu-id="a223b-203">Add your Batch and Storage **account credentials** too**AccountSettings.settings** in hello Microsoft.Azure.Batch.Samples.Common project.</span></span>
3. <span data-ttu-id="a223b-204">**Yapı** (ancak çalışmaz) hello çözümü.</span><span class="sxs-lookup"><span data-stu-id="a223b-204">**Build** (but do not run) hello solution.</span></span> <span data-ttu-id="a223b-205">İstenirse herhangi bir NuGet paketinin geri yükleyin.</span><span class="sxs-lookup"><span data-stu-id="a223b-205">Restore any NuGet packages if prompted.</span></span>
4. <span data-ttu-id="a223b-206">Kullanım hello Azure portal tooupload bir [uygulama paketi](batch-application-packages.md) için **PersistOutputsTask**.</span><span class="sxs-lookup"><span data-stu-id="a223b-206">Use hello Azure portal tooupload an [application package](batch-application-packages.md) for **PersistOutputsTask**.</span></span> <span data-ttu-id="a223b-207">Merhaba dahil `PersistOutputsTask.exe` ve bağımlı derlemeleri hello .zip paketindeki kümesi hello uygulama kimliği çok "PersistOutputsTask" ve hello uygulama Paket sürümü "1.0" çok.</span><span class="sxs-lookup"><span data-stu-id="a223b-207">Include hello `PersistOutputsTask.exe` and its dependent assemblies in hello .zip package, set hello application ID too"PersistOutputsTask", and hello application package version too"1.0".</span></span>
5. <span data-ttu-id="a223b-208">**Başlat** (Çalıştır) hello **PersistOutputs** projesi.</span><span class="sxs-lookup"><span data-stu-id="a223b-208">**Start** (run) hello **PersistOutputs** project.</span></span>
6. <span data-ttu-id="a223b-209">İstendiğinde toochoose hello Kalıcılık teknolojisi toouse çalışan hello örnek girdiğinizde **2** hello Batch hizmeti API'si toopersist görev çıktısını kullanarak toorun hello örnek.</span><span class="sxs-lookup"><span data-stu-id="a223b-209">When prompted toochoose hello persistence technology toouse for running hello sample, enter **2** toorun hello sample using hello Batch service API toopersist task output.</span></span>
7. <span data-ttu-id="a223b-210">İsterseniz, girme hello örnek yeniden çalıştırmak **3** toopersist çıktı hello Batch hizmeti API'si ve toohello standart dosya kurallarına göre tooname hello hedef kapsayıcı ve blob yolu.</span><span class="sxs-lookup"><span data-stu-id="a223b-210">If desired, run hello sample again, entering **3** toopersist output with hello Batch service API, and also tooname hello destination container and blob path according toohello File Conventions standard.</span></span>

## <a name="next-steps"></a><span data-ttu-id="a223b-211">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="a223b-211">Next steps</span></span>

- <span data-ttu-id="a223b-212">.NET için kalıcı görev çıktısını hello dosyası kuralları Kitaplığı hakkında daha fazla bilgi için bkz: [iş ve görev veri tooAzure depolama hello toplu iş dosyası kuralları kitaplığı için .NET toopersist kalıcı ](batch-task-output-file-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="a223b-212">For more information on persisting task output with hello File Conventions library for .NET, see [Persist job and task data tooAzure Storage with hello Batch File Conventions library for .NET toopersist ](batch-task-output-file-conventions.md).</span></span>
- <span data-ttu-id="a223b-213">Azure Batch kalıcı çıktı verileri için diğer yaklaşımlar hakkında daha fazla bilgi için bkz: [kalan iş ve görev çıktısını tooAzure depolama](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="a223b-213">For information on other approaches for persisting output data in Azure Batch, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span>

[github_persistoutputs]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/PersistOutputs
[github_samples]: https://github.com/Azure/azure-batch-samples
