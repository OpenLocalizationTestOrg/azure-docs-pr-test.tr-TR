---
title: "Azure MFA sunucusu yükseltme | Microsoft Docs"
description: "Adımlar ve Azure multi-Factor Authentication sunucusu daha yeni bir sürüme yükseltmek için yönergeler."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 50bb8ac3-5559-4d8b-a96a-799a74978b14
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/16/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: 6e4e09f8539aad56f92ad9137f4a6b9eb0d82370
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="upgrade-to-the-latest-azure-multi-factor-authentication-server"></a><span data-ttu-id="bf50a-103">En son Azure multi-Factor Authentication Sunucusu'na yükseltme</span><span class="sxs-lookup"><span data-stu-id="bf50a-103">Upgrade to the latest Azure Multi-Factor Authentication Server</span></span>

<span data-ttu-id="bf50a-104">Bu makalede Azure çok faktörlü kimlik doğrulama (MFA) sunucusu v6.0 yükseltme sürecini veya daha yüksek aracılığıyla anlatılmaktadır.</span><span class="sxs-lookup"><span data-stu-id="bf50a-104">This article walks you through the process of upgrading Azure Multi-Factor Authentication (MFA) Server v6.0 or higher.</span></span> <span data-ttu-id="bf50a-105">PhoneFactor Aracısı'nın eski bir sürümüne yükseltme yapmanız oluştuysa, [PhoneFactor Aracısı'nı Azure multi-Factor Authentication Sunucusu'na yükseltme](multi-factor-authentication-get-started-server-upgrade.md).</span><span class="sxs-lookup"><span data-stu-id="bf50a-105">If you need to upgrade an old version of the PhoneFactor Agent, refer to [Upgrade the PhoneFactor Agent to Azure Multi-Factor Authentication Server](multi-factor-authentication-get-started-server-upgrade.md).</span></span>

<span data-ttu-id="bf50a-106">V6.x veya v7.x eski veya yeni yükseltiyorsanız, tüm bileşenler için .NET 4.5 .NET 2. 0 ' değiştirin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-106">If you're upgrading from v6.x or older to v7.x or newer, all components change from .NET 2.0 to .NET 4.5.</span></span> <span data-ttu-id="bf50a-107">Tüm bileşenler için Microsoft Visual C++ 2015 Redistributable Update 1 veya daha yüksek de gerekir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-107">All components also require Microsoft Visual C++ 2015 Redistributable Update 1 or higher.</span></span> <span data-ttu-id="bf50a-108">Bunlar zaten yüklü değilse MFA sunucusu Yükleyici bu bileşenlerin x86 hem x64 sürümlerini yükler.</span><span class="sxs-lookup"><span data-stu-id="bf50a-108">The MFA Server installer installs both the x86 and x64 versions of these components if they aren't already installed.</span></span> <span data-ttu-id="bf50a-109">Kullanıcı Portalı ve mobil uygulama Web hizmeti ayrı sunucularda çalıştırırsanız, bu bileşenlerin yükseltmeden önce bu paketleri yüklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-109">If the User Portal and Mobile App Web Service run on separate servers, you need to install those packages before upgrading those components.</span></span> <span data-ttu-id="bf50a-110">En son Microsoft Visual C++ 2015 Redistributable güncelleştirmesi için arama yapabilirsiniz [Microsoft Download Center](https://www.microsoft.com/en-us/download/).</span><span class="sxs-lookup"><span data-stu-id="bf50a-110">You can search for the latest Microsoft Visual C++ 2015 Redistributable update on the [Microsoft Download Center](https://www.microsoft.com/en-us/download/).</span></span> 

## <a name="install-the-latest-version-of-azure-mfa-server"></a><span data-ttu-id="bf50a-111">Azure MFA sunucusu en son sürümünü yükleyin</span><span class="sxs-lookup"><span data-stu-id="bf50a-111">Install the latest version of Azure MFA Server</span></span>

1. <span data-ttu-id="bf50a-112">Konusundaki yönergeleri kullanın [Azure multi-Factor Authentication Sunucusu'nu indirmek](multi-factor-authentication-get-started-server.md#download-the-azure-multi-factor-authentication-server) Azure MFA sunucusu en son sürümünü almak için.</span><span class="sxs-lookup"><span data-stu-id="bf50a-112">Use the instructions in [Download the Azure Multi-Factor Authentication Server](multi-factor-authentication-get-started-server.md#download-the-azure-multi-factor-authentication-server) to get the latest version of the Azure MFA Server.</span></span>
2. <span data-ttu-id="bf50a-113">MFA sunucusu veri dosyasındaki C:\Program Files\Multi-Factor Authentication (varsayılan yükleme konumu varsayılarak) Server\Data\PhoneFactor.pfdata ana MFA sunucunuzda konumunda bulunan bir yedeğini alın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-113">Make a backup of the MFA Server data file located at C:\Program Files\Multi-Factor Authentication Server\Data\PhoneFactor.pfdata (assuming the default install location) on your master MFA Server.</span></span>
3. <span data-ttu-id="bf50a-114">Yüksek kullanılabilirlik için birden çok sunucu çalıştırırsanız, MFA sunucusu kimlik doğrulaması ve böylece yükseltiyorsanız sunucularına trafiği göndermeye Durdur istemci sistemleri değiştirin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-114">If you run multiple servers for high availability, change the client systems that authenticate to the MFA Server so that they stop sending traffic to the servers that are upgrading.</span></span> <span data-ttu-id="bf50a-115">Bir yük dengeleyici kullanırsanız, MFA sunucusu yük dengeleyiciden kaldırın, yükseltme yapın ve ardından sunucu grubuna geri ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-115">If you use a load balancer, remove a MFA Server from the load balancer, do the upgrade, and then add the server back into the farm.</span></span>
4. <span data-ttu-id="bf50a-116">Yeni Yükleyici her MFA sunucusunda çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-116">Run the new installer on each MFA Server.</span></span> <span data-ttu-id="bf50a-117">Eski veri dosyasındaki Yöneticisi tarafından çoğaltılmasını okuyabilir bağımlı sunucular ilk yükseltin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-117">Upgrade subordinate servers first because they can read the old data file being replicated by the master.</span></span> 

  <span data-ttu-id="bf50a-118">Yükleyiciyi çalıştırmadan önce geçerli MFA sunucusu kaldırmanız gerekmez.</span><span class="sxs-lookup"><span data-stu-id="bf50a-118">You do not need to uninstall your current MFA Server before running the installer.</span></span> <span data-ttu-id="bf50a-119">Yükleyici bir yerinde yükseltme gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-119">The installer performs an in-place upgrade.</span></span> <span data-ttu-id="bf50a-120">Aynı konuma (örneğin, C:\Program Files\Multi-Factor Authentication Server) yüklenmesini sağlayabilir yükleme yolunun önceki yüklemesinin kayıt defterinden kayıt.</span><span class="sxs-lookup"><span data-stu-id="bf50a-120">The installation path is picked up from the registry from the previous installation, so it installs in the same location (for example, C:\Program Files\Multi-Factor Authentication Server).</span></span> 
  
5. <span data-ttu-id="bf50a-121">Microsoft Visual C++ 2015 Redistributable bir güncelleştirme paketini yüklemek için istenirse isteğini kabul edin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-121">If you're prompted to install a Microsoft Visual C++ 2015 Redistributable update package, accept the prompt.</span></span> <span data-ttu-id="bf50a-122">Paket x86 hem x64 sürümleri yüklenir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-122">Both the x86 and x64 versions of the package are installed.</span></span>
5. <span data-ttu-id="bf50a-123">Web hizmeti SDK'sı kullanıyorsanız, yeni Web hizmeti SDK'sı yüklemeniz istenir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-123">If you use the Web Service SDK, you are prompted to install the new Web Service SDK.</span></span> <span data-ttu-id="bf50a-124">Yeni Web hizmeti SDK'sı yüklediğinizde, sanal dizin adını önceden yüklenmiş sanal dizin (örneğin, Phonefactorwebservicesdk) eşleştiğinden emin olun.</span><span class="sxs-lookup"><span data-stu-id="bf50a-124">When you install the new Web Service SDK, make sure that the virtual directory name matches the previously installed virtual directory (for example, MultiFactorAuthWebServiceSdk).</span></span>
6. <span data-ttu-id="bf50a-125">Tüm bağımlı sunucularında adımları yineleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-125">Repeat the steps on all subordinate servers.</span></span> <span data-ttu-id="bf50a-126">Yeni ana olmasını ast birini Yükselt sonra eski ana sunucuyu yükseltin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-126">Promote one of the subordinates to be the new master, then upgrade the old master server.</span></span> 

## <a name="upgrade-the-user-portal"></a><span data-ttu-id="bf50a-127">Kullanıcı Portalı yükseltme</span><span class="sxs-lookup"><span data-stu-id="bf50a-127">Upgrade the User Portal</span></span>

1. <span data-ttu-id="bf50a-128">Kullanıcı Portalı yükleme konumunu (örneğin, C:\inetpub\wwwroot\MultiFactorAuth) sanal dizinde bulunan web.config dosyasının yedeğini alın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-128">Make a backup of the web.config file that is in the virtual directory of the User Portal installation location (for example, C:\inetpub\wwwroot\MultiFactorAuth).</span></span> <span data-ttu-id="bf50a-129">Varsayılan tema için herhangi bir değişiklik yapıldıysa, App_Themes\Default klasörünün yanı sıra bir yedeğini alın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-129">If any changes were made to the default theme, make a backup of the App_Themes\Default folder as well.</span></span> <span data-ttu-id="bf50a-130">Varsayılan klasör bir kopyasını oluşturun ve varsayılan tema değiştirmek daha yeni bir tema oluşturmak daha iyidir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-130">It is better to create a copy of the Default folder and create a new theme than to change the Default theme.</span></span>
2. <span data-ttu-id="bf50a-131">Kullanıcı Portalı diğer MFA sunucusu bileşenleri ile aynı sunucuda çalışıyorsa, MFA sunucusu yükleme, Kullanıcı Portalı'nı güncelleştirmek ister.</span><span class="sxs-lookup"><span data-stu-id="bf50a-131">If the User Portal runs on the same server as the other MFA Server components, the MFA Server installation prompts you to update the User Portal.</span></span> <span data-ttu-id="bf50a-132">İstemini kabul etmek ve kullanıcı portalı güncelleştirmesini yükleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-132">Accept the prompt and install the User Portal update.</span></span> <span data-ttu-id="bf50a-133">Sanal dizin adını önceden yüklenmiş sanal dizin (örneğin, MultiFactorAuth) eşleşip eşleşmediğini denetleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-133">Check that the virtual directory name matches the previously installed virtual directory (for example, MultiFactorAuth).</span></span>
3. <span data-ttu-id="bf50a-134">Kullanıcı Portalı'nı kendi sunucusundaysa, MFA sunuculardan birinin yükleme konumundan multifactorauthenticationuserportalsetup64.msi dosyasını dosyasını kopyalayın ve kullanıcı portalı web sunucuya yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-134">If the User Portal is on its own server, copy the MultiFactorAuthenticationUserPortalSetup64.msi file from the install location of one of the MFA Servers and put it onto the User Portal web server.</span></span> <span data-ttu-id="bf50a-135">Yükleyiciyi çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-135">Run the installer.</span></span> 

  <span data-ttu-id="bf50a-136">Belirten bir hata oluşursa, "Microsoft Visual C++ 2015 Redistributable Update 1 veya daha yüksek gereklidir" yükleyip en son güncelleştirme paketinden [Microsoft Download Center](https://www.microsoft.com/download/).</span><span class="sxs-lookup"><span data-stu-id="bf50a-136">If an error occurs stating, "Microsoft Visual C++ 2015 Redistributable Update 1 or higher is required," download and install the latest update package from the [Microsoft Download Center](https://www.microsoft.com/download/).</span></span> <span data-ttu-id="bf50a-137">X86 hem x64 sürümlerini yükleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-137">Install both the x86 and x64 versions.</span></span>

4. <span data-ttu-id="bf50a-138">Güncelleştirilmiş Kullanıcı Portalı yazılım yüklendikten sonra yeni web.config dosyasına ile 1. adımda yaptığınız web.config yedekleme karşılaştırın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-138">After the updated User Portal software is installed, compare the web.config backup you made in step 1 with the new web.config file.</span></span> <span data-ttu-id="bf50a-139">Yeni özniteliklere yeni web.config dosyasında yoksa, yedekleme web.config üzerine yeni bir sanal dizine kopyalayın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-139">If no new attributes exist in the new web.config, copy your backup web.config into the virtual directory to overwrite the new one.</span></span> <span data-ttu-id="bf50a-140">Başka bir seçenek kopyalayıp appSettings değerleri ve Web hizmeti SDK URL'si yedekleme dosyasından yeni özelliği web.config dosyasına yapıştırın oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="bf50a-140">Another option is to copy/paste the appSettings values and the Web Service SDK URL from the backup file into the new web.config.</span></span>

<span data-ttu-id="bf50a-141">Birden çok sunucu üzerinde kullanıcı portalı varsa, bunların tümünün yüklemesinde yineleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-141">If you have the User Portal on multiple servers, repeat the installation on all of them.</span></span> 


## <a name="upgrade-the-mobile-app-web-service"></a><span data-ttu-id="bf50a-142">Mobil uygulama Web Hizmeti'ni yükseltme</span><span class="sxs-lookup"><span data-stu-id="bf50a-142">Upgrade the Mobile App Web Service</span></span>

1. <span data-ttu-id="bf50a-143">Mobil uygulama Web hizmeti yükleme konumu (örneğin, C:\inetpub\wwwroot\app veya C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService) sanal dizinde bulunan web.config dosyasının yedeğini alın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-143">Make a backup of the web.config file that is in the virtual directory of the Mobile App Web Service installation location (for example, C:\inetpub\wwwroot\app or C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService).</span></span>
2. <span data-ttu-id="bf50a-144">MFA sunucuları yükleme konumundan multifactorauthenticationmobileappwebservicesetup64.msi dosyasını dosyasını kopyalayın ve mobil uygulama kayıt web sunucuya yerleştirin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-144">Copy the MultiFactorAuthenticationMobileAppWebServiceSetup64.msi file from the install location of the MFA Servers and put it onto the Mobile App registration web server.</span></span>
3. <span data-ttu-id="bf50a-145">Yükleyiciyi çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-145">Run the installer.</span></span> 

  <span data-ttu-id="bf50a-146">Microsoft Visual C++ 2015 Redistributable Update 1 veya daha yüksek gerekli olduğunu bildiren bir hata meydana gelirse, yükleyip en son güncelleştirme paketinden [Microsoft Download Center](https://www.microsoft.com/download/).</span><span class="sxs-lookup"><span data-stu-id="bf50a-146">If an error occurs stating that Microsoft Visual C++ 2015 Redistributable Update 1 or higher is required, download and install the latest update package from the [Microsoft Download Center](https://www.microsoft.com/download/).</span></span> <span data-ttu-id="bf50a-147">X86 hem x64 sürümlerini yükleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-147">Install both the x86 and x64 versions.</span></span>

4. <span data-ttu-id="bf50a-148">Güncelleştirilmiş mobil uygulama Web hizmeti yazılım yüklendikten sonra yeni web.config dosyasına ile 1. adımda yedeklenen web.config dosyasını karşılaştırın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-148">After the updated Mobile App Web Service software installs, compare the web.config file that was backed up in step 1 with the new web.config file.</span></span> <span data-ttu-id="bf50a-149">Yeni öznitelik yeni web.config dosyasında yoksa, kaydedilen web.config sanal dizine kopyalayın ve yeni bir üzerine yazma.</span><span class="sxs-lookup"><span data-stu-id="bf50a-149">If no new attributes exist in the new web.config, you can copy your saved web.config back into the virtual directory and overwrite the new one.</span></span> <span data-ttu-id="bf50a-150">Başka bir seçenek kopyalayıp appSettings değerleri ve Web hizmeti SDK URL'si yedekleme dosyasından yeni özelliği web.config dosyasına yapıştırın oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="bf50a-150">Another option is to copy/paste the appSettings values and the Web Service SDK URL from the backup file into the new web.config.</span></span>

<span data-ttu-id="bf50a-151">Mobil uygulama Web hizmeti birden fazla sunucuda varsa, bunların tümünün yüklemesinde yineleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-151">If you have the Mobile App Web Service on multiple servers, repeat the installation on all of them.</span></span> 

## <a name="upgrade-the-ad-fs-adapters"></a><span data-ttu-id="bf50a-152">AD FS bağdaştırıcısı yükseltme</span><span class="sxs-lookup"><span data-stu-id="bf50a-152">Upgrade the AD FS Adapters</span></span>


### <a name="if-mfa-runs-on-different-servers-than-ad-fs"></a><span data-ttu-id="bf50a-153">MFA ADFS değerinden farklı sunucularda çalışıyorsa</span><span class="sxs-lookup"><span data-stu-id="bf50a-153">If MFA runs on different servers than AD FS</span></span>

<span data-ttu-id="bf50a-154">Multi-Factor Authentication sunucusu, AD FS sunucularından ayrı olarak çalıştırırsanız, bu yönergeler yalnızca geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-154">These instructions only apply if you run Multi-Factor Authentication Server separately from your AD FS servers.</span></span> <span data-ttu-id="bf50a-155">Her iki hizmet aynı sunucu üzerinde çalıştırıyorsanız, bu bölüm atlayın ve yükleme adımları gidin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-155">If both services run on the same servers, skip this section and go to the installation steps.</span></span> 

1. <span data-ttu-id="bf50a-156">AD FS'de kaydedildiği MultiFactorAuthenticationAdfsAdapter.config dosyasının bir kopyasını kaydedin veya aşağıdaki PowerShell komutunu kullanarak yapılandırmayı dışarı aktarma: `Export-AdfsAuthenticationProviderConfigurationData -Name [adapter name] -FilePath [path to config file]`.</span><span class="sxs-lookup"><span data-stu-id="bf50a-156">Save a copy of the MultiFactorAuthenticationAdfsAdapter.config file that was registered in AD FS, or export the configuration using the following PowerShell command: `Export-AdfsAuthenticationProviderConfigurationData -Name [adapter name] -FilePath [path to config file]`.</span></span> <span data-ttu-id="bf50a-157">Bağdaştırıcı adı "WindowsAzureMultiFactorAuthentication" veya "AzureMfaServerAuthentication" daha önce yüklenmiş bağlı olarak sürümüdür.</span><span class="sxs-lookup"><span data-stu-id="bf50a-157">The adapter name is either "WindowsAzureMultiFactorAuthentication" or "AzureMfaServerAuthentication" depending on the version previously installed.</span></span>
2. <span data-ttu-id="bf50a-158">Aşağıdaki dosyaları MFA sunucusu yükleme konumundan AD FS sunucularına kopyalayın:</span><span class="sxs-lookup"><span data-stu-id="bf50a-158">Copy the following files from the MFA Server installation location to the AD FS servers:</span></span>

  - <span data-ttu-id="bf50a-159">MultiFactorAuthenticationAdfsAdapterSetup64.msi</span><span class="sxs-lookup"><span data-stu-id="bf50a-159">MultiFactorAuthenticationAdfsAdapterSetup64.msi</span></span>
  - <span data-ttu-id="bf50a-160">Register-MultiFactorAuthenticationAdfsAdapter.ps1</span><span class="sxs-lookup"><span data-stu-id="bf50a-160">Register-MultiFactorAuthenticationAdfsAdapter.ps1</span></span>
  - <span data-ttu-id="bf50a-161">Unregister-MultiFactorAuthenticationAdfsAdapter.ps1</span><span class="sxs-lookup"><span data-stu-id="bf50a-161">Unregister-MultiFactorAuthenticationAdfsAdapter.ps1</span></span>
  - <span data-ttu-id="bf50a-162">MultiFactorAuthenticationAdfsAdapter.config</span><span class="sxs-lookup"><span data-stu-id="bf50a-162">MultiFactorAuthenticationAdfsAdapter.config</span></span>

3. <span data-ttu-id="bf50a-163">Ekleyerek Register-MultiFactorAuthenticationAdfsAdapter.ps1 betiğini düzenleyin `-ConfigurationFilePath [path]` sonuna `Register-AdfsAuthenticationProvider` komutu.</span><span class="sxs-lookup"><span data-stu-id="bf50a-163">Edit the Register-MultiFactorAuthenticationAdfsAdapter.ps1 script by adding `-ConfigurationFilePath [path]` to the end of the `Register-AdfsAuthenticationProvider` command.</span></span> <span data-ttu-id="bf50a-164">Değiştir *[path]* MultiFactorAuthenticationAdfsAdapter.config tam yolu ile dosya veya yapılandırma dosyasını dışarı önceki adımda.</span><span class="sxs-lookup"><span data-stu-id="bf50a-164">Replace *[path]* with the full path to the MultiFactorAuthenticationAdfsAdapter.config file or the configuration file exported in the previous step.</span></span> 

  <span data-ttu-id="bf50a-165">Eski yapılandırma dosyası eşleşip eşleşmediğini görmek için yeni MultiFactorAuthenticationAdfsAdapter.config öznitelikleri denetleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-165">Check the attributes in the new MultiFactorAuthenticationAdfsAdapter.config to see if they match the old config file.</span></span> <span data-ttu-id="bf50a-166">Öznitelik eklenmiş veya yeni sürümde kaldırılmış, öznitelik değerleri eski yapılandırma dosyasından yeni bir kopyalayın. veya eşleştirmek için eski yapılandırma dosyasını değiştirin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-166">If any attributes were added or removed in the new version, copy the attribute values from the old configuration file to the new one or modify the old configuration file to match.</span></span>

### <a name="install-new-ad-fs-adapters"></a><span data-ttu-id="bf50a-167">Yeni AD FS bağdaştırıcısı yükleme</span><span class="sxs-lookup"><span data-stu-id="bf50a-167">Install new AD FS adapters</span></span>

> [!IMPORTANT] 
> <span data-ttu-id="bf50a-168">Kullanıcılarınız, bu bölümün adım 3-8 sırasında iki aşamalı doğrulamayı gerçekleştirmek için gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-168">Your users will not be required to perform two-step verification during steps 3-8 of this section.</span></span> <span data-ttu-id="bf50a-169">Birden çok kümelerde yapılandırılmış AD FS varsa, Kaldır, yükseltme ve kesinti süresini önlemek için diğer kümeleri bağımsız olarak gruptaki her küme geri yükleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bf50a-169">If you have AD FS configured in multiple clusters, you can remove, upgrade, and restore each cluster in the farm independently of the other clusters to avoid downtime.</span></span>

1. <span data-ttu-id="bf50a-170">Bazı AD FS sunucuları grubundan kaldırın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-170">Remove some AD FS servers from the farm.</span></span> <span data-ttu-id="bf50a-171">Diğer düğümler çalışırken bu sunucuları güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-171">Update these servers while the others are still running.</span></span>
2. <span data-ttu-id="bf50a-172">AD FS grubundan kaldırıldı her bir sunucuda yeni AD FS Bağdaştırıcısı'nı yükleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-172">Install the new AD FS adapter on each server removed from the AD FS farm.</span></span> <span data-ttu-id="bf50a-173">MFA sunucusu her AD FS sunucusunda yüklüyse, MFA sunucusu yönetim UX güncelleştirebilirsiniz</span><span class="sxs-lookup"><span data-stu-id="bf50a-173">If the MFA Server is installed on each AD FS server, you can update through the MFA Server admin UX.</span></span> <span data-ttu-id="bf50a-174">Aksi takdirde MultiFactorAuthenticationAdfsAdapterSetup64.msi çalıştırarak güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-174">Otherwise, update by running MultiFactorAuthenticationAdfsAdapterSetup64.msi.</span></span> 

  <span data-ttu-id="bf50a-175">Belirten bir hata oluşursa, "Microsoft Visual C++ 2015 Redistributable Update 1 veya daha yüksek gereklidir" yükleyip en son güncelleştirme paketinden [Microsoft Download Center](https://www.microsoft.com/download/).</span><span class="sxs-lookup"><span data-stu-id="bf50a-175">If an error occurs stating, "Microsoft Visual C++ 2015 Redistributable Update 1 or higher is required," download and install the latest update package from the [Microsoft Download Center](https://www.microsoft.com/download/).</span></span> <span data-ttu-id="bf50a-176">X86 hem x64 sürümlerini yükleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-176">Install both the x86 and x64 versions.</span></span>

3. <span data-ttu-id="bf50a-177">Git **AD FS** > **kimlik doğrulama ilkeleri** > **genel çok faktörlü kimlik doğrulama ilkesini Düzenle**.</span><span class="sxs-lookup"><span data-stu-id="bf50a-177">Go to **AD FS** > **Authentication Policies** > **Edit Global MultiFactor Authentication Policy**.</span></span> <span data-ttu-id="bf50a-178">İşaretini **WindowsAzureMultiFactorAuthentication** veya **AzureMFAServerAuthentication** (bağlı olarak yüklenen geçerli sürüm).</span><span class="sxs-lookup"><span data-stu-id="bf50a-178">Uncheck **WindowsAzureMultiFactorAuthentication** or **AzureMFAServerAuthentication** (depending on the current version installed).</span></span> 

  <span data-ttu-id="bf50a-179">Bu adım tamamlandıktan sonra MFA sunucusu üzerinden iki aşamalı doğrulamayı adım 8 tamamlanana kadar bu AD FS kümede kullanılabilir değil.</span><span class="sxs-lookup"><span data-stu-id="bf50a-179">Once this step is complete, two-step verification through MFA Server is not available in this AD FS cluster until you complete step 8.</span></span>

4. <span data-ttu-id="bf50a-180">AD FS bağdaştırıcısı eski sürümü Unregister-MultiFactorAuthenticationAdfsAdapter.ps1 PowerShell betiğini çalıştırarak kaydını silin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-180">Unregister the older version of the AD FS adapter by running the Unregister-MultiFactorAuthenticationAdfsAdapter.ps1 PowerShell script.</span></span> <span data-ttu-id="bf50a-181">Emin *-Name* parametresi ("WindowsAzureMultiFactorAuthentication" veya "AzureMFAServerAuthentication"), 3. adımda görüntülenen adı ile eşleşen.</span><span class="sxs-lookup"><span data-stu-id="bf50a-181">Ensure that the *-Name* parameter (either “WindowsAzureMultiFactorAuthentication” or "AzureMFAServerAuthentication") matches the name that was displayed in step 3.</span></span> <span data-ttu-id="bf50a-182">Merkezi bir yapılandırma olduğundan bu aynı AD FS kümesindeki tüm sunucular için geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-182">This applies to all servers in the same AD FS cluster since there is a central configuration.</span></span>
5. <span data-ttu-id="bf50a-183">Yeni AD FS Bağdaştırıcısı'nı Register-MultiFactorAuthenticationAdfsAdapter.ps1 PowerShell betiğini çalıştırarak kaydedin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-183">Register the new AD FS adapter by running the Register-MultiFactorAuthenticationAdfsAdapter.ps1 PowerShell script.</span></span> <span data-ttu-id="bf50a-184">Merkezi bir yapılandırma olduğundan bu aynı AD FS kümesindeki tüm sunucular için geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="bf50a-184">This applies to all servers in the same AD FS cluster since there is a central configuration.</span></span>
6. <span data-ttu-id="bf50a-185">AD FS grubundan kaldırıldı her bir sunucuda AD FS hizmetini yeniden başlatın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-185">Restart the AD FS service on each server removed from the AD FS farm.</span></span>
7. <span data-ttu-id="bf50a-186">Güncelleştirilmiş sunucusu AD FS grubunu ekleyin ve diğer sunucuları grubundan kaldırın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-186">Add the updated servers back to the AD FS farm and remove the other servers from the farm.</span></span>
8. <span data-ttu-id="bf50a-187">Git **AD FS** > **kimlik doğrulama ilkeleri** > **genel çok faktörlü kimlik doğrulama ilkesini Düzenle**.</span><span class="sxs-lookup"><span data-stu-id="bf50a-187">Go to **AD FS** > **Authentication Policies** > **Edit Global MultiFactor Authentication Policy**.</span></span> <span data-ttu-id="bf50a-188">Denetleme **AzureMfaServerAuthentication**.</span><span class="sxs-lookup"><span data-stu-id="bf50a-188">Check **AzureMfaServerAuthentication**.</span></span>
9. <span data-ttu-id="bf50a-189">Şimdi AD FS grubundan kaldırıldı sunucuları güncelleştirme 2. adımı yineleyin ve bu sunucular üzerinde AD FS hizmetini yeniden başlatın.</span><span class="sxs-lookup"><span data-stu-id="bf50a-189">Repeat step 2 to update the servers now removed from the AD FS farm and restart the AD FS service on those servers.</span></span>
10. <span data-ttu-id="bf50a-190">Bu sunucular, AD FS grubuna geri ekleyin.</span><span class="sxs-lookup"><span data-stu-id="bf50a-190">Add those servers back into the AD FS farm.</span></span>

## <a name="next-steps"></a><span data-ttu-id="bf50a-191">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="bf50a-191">Next steps</span></span>

- <span data-ttu-id="bf50a-192">Örnekleri alın [Azure çok faktörlü kimlik doğrulama ve üçüncü taraf VPN ile Gelişmiş senaryolar](multi-factor-authentication-advanced-vpn-configurations.md)</span><span class="sxs-lookup"><span data-stu-id="bf50a-192">Get examples of [Advanced scenarios with Azure Multi-Factor Authentication and third-party VPNs](multi-factor-authentication-advanced-vpn-configurations.md)</span></span>

- [<span data-ttu-id="bf50a-193">MFA sunucusu Windows Server Active Directory ile eşitleme</span><span class="sxs-lookup"><span data-stu-id="bf50a-193">Synchronize MFA Server with Windows Server Active Directory</span></span>](multi-factor-authentication-get-started-server-dirint.md)

- <span data-ttu-id="bf50a-194">[Windows kimlik doğrulamasını yapılandırmak](multi-factor-authentication-get-started-server-windows.md) uygulamalarınız için</span><span class="sxs-lookup"><span data-stu-id="bf50a-194">[Configure Windows Authentication](multi-factor-authentication-get-started-server-windows.md) for your applications</span></span>
