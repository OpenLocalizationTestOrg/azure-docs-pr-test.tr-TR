---
title: "Bir çok kiracılı SaaS uygulamasında birçok Azure SQL veritabanı performansını izleme | Microsoft Docs"
description: "İzleme ve veritabanları ve Azure SQL veritabanı Wingtip SaaS uygulama havuzlarında performansını yönetme"
keywords: "sql veritabanı öğreticisi"
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: 42f727aa40e744916b1a8adf634c10d55880bef0
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 08/03/2017
---
# <a name="monitor-performance-of-the-wingtip-saas-application"></a><span data-ttu-id="aa4dc-104">Wingtip SaaS uygulama performansını izleme</span><span class="sxs-lookup"><span data-stu-id="aa4dc-104">Monitor performance of the Wingtip SaaS application</span></span>

<span data-ttu-id="aa4dc-105">Bu öğretici kapsamında, SaaS uygulamalarında kullanılan birkaç önemli performans yönetim senaryolarını ele alınan dizelerle.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-105">In this tutorial, several key performance management scenarios used in SaaS applications are explored.</span></span> <span data-ttu-id="aa4dc-106">Tüm Kiracı veritabanları arasında etkinliği benzetimi için bir yük oluşturucuyu kullanarak yerleşik izleme ve SQL veritabanı ve esnek havuzlar özelliklerini uyarı gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-106">Using a load generator to simulate activity across all tenant databases, the built-in monitoring and alerting features of SQL Database and elastic pools are demonstrated.</span></span>

<span data-ttu-id="aa4dc-107">Wingtip SaaS uygulaması her salonundan (Kiracı) kendi veritabanına sahip olduğu bir kiracı tek veri modeli kullanır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-107">The Wingtip SaaS app uses a single-tenant data model, where each venue (tenant) has their own database.</span></span> <span data-ttu-id="aa4dc-108">Birçok SaaS uygulaması gibi, beklenen kiracı iş yükü düzeni öngörülemez ve düzensizdir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-108">Like many SaaS applications, the anticipated tenant workload pattern is unpredictable and sporadic.</span></span> <span data-ttu-id="aa4dc-109">Diğer bir deyişle, bilet satışı herhangi bir zamanda gerçekleşebilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-109">In other words, ticket sales may occur at any time.</span></span> <span data-ttu-id="aa4dc-110">Bu tipik veritabanı kullanım düzeninden yararlanmak için kiracı veritabanları elastik veritabanı havuzlarına dağıtılır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-110">To take advantage of this typical database usage pattern, tenant databases are deployed into elastic database pools.</span></span> <span data-ttu-id="aa4dc-111">Elastik havuzlar, kaynakları çok sayıda veritabanı arasında paylaştırarak çözüm maliyetini en iyi duruma getirir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-111">Elastic pools optimize the cost of a solution by sharing resources across many databases.</span></span> <span data-ttu-id="aa4dc-112">Bu düzen türü ile yüklerin havuzlar arasında makul bir şekilde dengelendiğinden emin olmak için veritabanı ve havuz kaynak kullanımının izlenmesi önemlidir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-112">With this type of pattern, it's important to monitor database and pool resource usage to ensure that loads are reasonably balanced across pools.</span></span> <span data-ttu-id="aa4dc-113">Ayrıca, her bir veritabanının yeterli kaynağa sahip olduğundan ve havuzların [eDTU](sql-database-what-is-a-dtu.md) sınırına ulaşmadığından emin olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-113">You also need to ensure that individual databases have adequate resources, and that pools are not hitting their [eDTU](sql-database-what-is-a-dtu.md) limits.</span></span> <span data-ttu-id="aa4dc-114">Bu öğreticide, veritabanı ve havuzları izleyip yönetme yollarını ve iş yükündeki değişikliklere yanıt olarak nasıl düzeltici işlem yapılacağını incelenmektedir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-114">This tutorial explores ways to monitor and manage databases and pools, and how to take corrective action in response to variations in workload.</span></span>

<span data-ttu-id="aa4dc-115">Bu öğreticide şunların nasıl yapıldığını öğreneceksiniz:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-115">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="aa4dc-116">Sağlanan bir yük oluşturucuyu çalıştırarak kiracı veritabanlarındaki kullanımın benzetimini gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="aa4dc-116">Simulate usage on the tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="aa4dc-117">Yükteki artışa yanıt veren kiracı veritabanlarını izleme</span><span class="sxs-lookup"><span data-stu-id="aa4dc-117">Monitor the tenant databases as they respond to the increase in load</span></span>
> * <span data-ttu-id="aa4dc-118">Artan veritabanı yüküne yanıt olarak Elastik havuzun ölçeğini artırma</span><span class="sxs-lookup"><span data-stu-id="aa4dc-118">Scale up the Elastic pool in response to the increased database load</span></span>
> * <span data-ttu-id="aa4dc-119">Veritabanı etkinliğinin yükünü dengelemek üzere ikinci bir Elastik havuz sağlama</span><span class="sxs-lookup"><span data-stu-id="aa4dc-119">Provision a second Elastic pool to load balance database activity</span></span>


<span data-ttu-id="aa4dc-120">Bu öğreticiyi tamamlamak için aşağıdaki ön koşulların karşılandığından emin olun:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-120">To complete this tutorial, make sure the following prerequisites are completed:</span></span>

* <span data-ttu-id="aa4dc-121">Wingtip SaaS uygulaması dağıtılır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-121">The Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="aa4dc-122">Beş dakikadan daha kısa bir süre içinde dağıtmak için bkz: [dağıtma ve Wingtip SaaS uygulamasına keşfedin.](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="aa4dc-122">To deploy in less than five minutes, see [Deploy and explore the Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="aa4dc-123">Azure PowerShell’in yüklendiğinden.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-123">Azure PowerShell is installed.</span></span> <span data-ttu-id="aa4dc-124">Ayrıntılar için bkz. [Azure PowerShell’i kullanmaya başlama](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="aa4dc-124">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-to-saas-performance-management-patterns"></a><span data-ttu-id="aa4dc-125">SaaS performans yönetim desenleri giriş</span><span class="sxs-lookup"><span data-stu-id="aa4dc-125">Introduction to SaaS performance management patterns</span></span>

<span data-ttu-id="aa4dc-126">Veritabanı performans yönetimi, performans verilerini derleyip çözümlemeyi ve ardından uygulamanız için kabul edilebilir bir yanıt süresi sağlamak için parametreleri ayarlayarak bu verilere yanıt vermeyi içerir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-126">Managing database performance consists of compiling and analyzing performance data, and then reacting to this data by adjusting parameters to maintain an acceptable response time for your application.</span></span> <span data-ttu-id="aa4dc-127">Elastik veritabanı havuzları birden çok kiracıyı barındırdığında, öngörülemez iş yükü içeren bir veritabanı grubu için kaynakları sağlama ve yönetmenin uygun maliyetli bir yolunu sunar.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-127">When hosting multiple tenants, Elastic database pools are a cost-effective way to provide and manage resources for a group of databases with unpredictable workloads.</span></span> <span data-ttu-id="aa4dc-128">Bazı iş yükü düzenlerinde iki S3 veritabanı bile tek bir havuzda yönetilebilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-128">With certain workload patterns, as few as two S3 databases can benefit from being managed in a pool.</span></span>

![medya](./media/sql-database-saas-tutorial-performance-monitoring/app-diagram.png)

<span data-ttu-id="aa4dc-130">Havuzları ve havuzları, veritabanları, kabul edilebilir performans aralıklara kalırlar emin olmak için izlenmelidir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-130">Pools, and the databases in pools, should be monitored to ensure they stay within acceptable ranges of performance.</span></span> <span data-ttu-id="aa4dc-131">Havuz edtu'larını genel iş yükü için uygun olduğundan emin olduktan tüm veritabanlarının toplam iş yükü gereksinimlerini karşılamak için havuzu yapılandırmasını ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-131">Tune the pool configuration to meet the needs of the aggregate workload of all databases, ensuring that the pool eDTUs are appropriate for the overall workload.</span></span> <span data-ttu-id="aa4dc-132">Veritabanı başına en düşük ve veritabanı başına en yüksek eDTU değerlerini, uygulamanıza özel gereksinimler için uygun değerlere ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-132">Adjust the per-database min and per-database max eDTU values to appropriate values for your specific application requirements.</span></span>

### <a name="performance-management-strategies"></a><span data-ttu-id="aa4dc-133">Uygulama performansı stratejileri</span><span class="sxs-lookup"><span data-stu-id="aa4dc-133">Performance management strategies</span></span>

* <span data-ttu-id="aa4dc-134">El ile performansını izlemek zorunda kalmamak için en etkili **veritabanları veya havuzları dışında normal aralıkları parazit durumlarda tetikleyen uyarıları ayarlama**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-134">To avoid having to manually monitor performance, it’s most effective to **set alerts that trigger when databases or pools stray out of normal ranges**.</span></span>
* <span data-ttu-id="aa4dc-135">Bir havuzun toplam performans düzeyindeki kısa vadeli dalgalanmalara yanıt vermek için **havuz eDTU düzeyinin ölçeği artırılabilir veya azaltılabilir**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-135">To respond to short-term fluctuations in the aggregate performance level of a pool, the **pool eDTU level can be scaled up or down**.</span></span> <span data-ttu-id="aa4dc-136">Bu dalgalanma düzenli veya öngörülebilir aralıklarla gerçekleşiyorsa, **havuz ölçeklendirmesi otomatik olarak gerçekleşecek şekilde zamanlanabilir**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-136">If this fluctuation occurs on a regular or predictable basis, **scaling the pool can be scheduled to occur automatically**.</span></span> <span data-ttu-id="aa4dc-137">Örneğin, iş yükünüzün hafif olduğunu bildiğiniz gece veya hafta sonları gibi zamanlarda ölçeği azaltabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-137">For example, scale down when you know your workload is light, maybe overnight, or during weekends.</span></span>
* <span data-ttu-id="aa4dc-138">Daha uzun vadeli dalgalanmalara ya da veritabanı sayısındaki değişikliklere yanıt vermek için, **tek veritabanları diğer havuzlara taşınabilir**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-138">To respond to longer-term fluctuations, or changes in the number of databases, **individual databases can be moved into other pools**.</span></span>
* <span data-ttu-id="aa4dc-139">Yanıt vermesi için kısa vadeli artırır *tek tek* veritabanı yük **tek veritabanlarını dışında bir havuzu alınır ve bir bireysel performans düzeyi atanan**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-139">To respond to short term increases in *individual* database load **individual databases can be taken out of a pool and assigned an individual performance level**.</span></span> <span data-ttu-id="aa4dc-140">Yükü azaldıktan sonra veritabanını havuza döndürebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-140">Once the load is reduced, the database can then be returned to the pool.</span></span> <span data-ttu-id="aa4dc-141">Bu önceden bilindiğinde veritabanları pre-emptively veritabanı her zaman, gereken kaynak bulunduğundan emin olun ve havuzdaki diğer veritabanlarına üzerindeki etkiyi önlemek için taşınabilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-141">When this is known in advance, databases can be moved pre-emptively to ensure the database always has the resources it needs, and to avoid impact on other databases in the pool.</span></span> <span data-ttu-id="aa4dc-142">Popüler bir etkinlik için bilet satışı yoğunluğu yaşanan bir mekanda olduğu gibi bu gereksinim öngörülebildiği takdirde bu yönetim davranışı uygulamayla tümleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-142">If this requirement is predictable, such as a venue experiencing a rush of ticket sales for a popular event, then this management behavior can be integrated into the application.</span></span>

<span data-ttu-id="aa4dc-143">[Azure portalı](https://portal.azure.com), çoğu kaynak üzerinde yerleşik izleme ve uyarı özelliği sağlar.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-143">The [Azure portal](https://portal.azure.com) provides built-in monitoring and alerting on most resources.</span></span> <span data-ttu-id="aa4dc-144">SQL Veritabanı için veritabanı ve havuzlarda izleme ve uyarı özellikleri kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-144">For SQL Database, monitoring and alerting is available on databases and pools.</span></span> <span data-ttu-id="aa4dc-145">Bu yerleşik izleme ve uyarma kaynak özgü kaynakları küçük sayılar için uygundur ancak birçok kaynaklarla çalışırken çok uygun değil.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-145">This built-in monitoring and alerting is resource-specific, so it's convenient to use for small numbers of resources, but is not very convenient when working with many resources.</span></span>

<span data-ttu-id="aa4dc-146">Burada çalıştığınız birçok reources ile yüksek hacimli senaryolar için [günlük analizi (OMS)](sql-database-saas-tutorial-log-analytics.md) kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-146">For high-volume scenarios where you're working with many reources, [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) can be used.</span></span> <span data-ttu-id="aa4dc-147">Verilmiş tanılama günlüklerini ve günlük analizi çalışma alanındaki toplanan telemetri üzerinden analytics sağlayan ayrı bir Azure hizmet budur.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-147">This is a separate Azure service that provides analytics over emitted diagnostic logs and telemetry gathered in a log analytics workspace.</span></span> <span data-ttu-id="aa4dc-148">Günlük analizi telemetri birçok Hizmetleri'nden toplayabilir ve sorgu ve uyarıları ayarlamak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-148">Log Analytics can collect telemetry from many services and be used to query and set alerts.</span></span>

## <a name="get-the-wingtip-application-source-code-and-scripts"></a><span data-ttu-id="aa4dc-149">Wingtip uygulama kaynak koduna ve komut dosyaları alma</span><span class="sxs-lookup"><span data-stu-id="aa4dc-149">Get the Wingtip application source code and scripts</span></span>

<span data-ttu-id="aa4dc-150">Wingtip SaaS komut dosyalarını ve uygulama kaynak koduna kullanılabilir olan [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github depo.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-150">The Wingtip SaaS scripts and application source code are available in the [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="aa4dc-151">[Wingtip SaaS komut dosyalarını karşıdan yüklemek için adımları](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="aa4dc-151">[Steps to download the Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="provision-additional-tenants"></a><span data-ttu-id="aa4dc-152">Ek kiracılar sağlama</span><span class="sxs-lookup"><span data-stu-id="aa4dc-152">Provision additional tenants</span></span>

<span data-ttu-id="aa4dc-153">Havuzlar yalnızca iki adet S3 veritabanı ile uygun maliyetli olabilse de, havuzdaki veritabanı sayısı arttıkça ortalama etki daha uygun maliyetli olur.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-153">While pools can be cost-effective with just two S3 databases, the more databases that are in the pool the more cost-effective the averaging effect becomes.</span></span> <span data-ttu-id="aa4dc-154">Performans izleme ve yönetiminin ölçeklenerek nasıl çalıştığını anlamak için bu öğreticide en az 20 veritabanınızın dağıtılmış olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-154">For a good understanding of how performance monitoring and management works at scale, this tutorial requires you have at least 20 databases deployed.</span></span>

<span data-ttu-id="aa4dc-155">Önceki bir öğreticide kiracılar toplu zaten sağlandı, geçin [tüm Kiracı veritabanları benzetim kullanımı](#simulate-usage-on-all-tenant-databases) bölümü.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-155">If you already provisioned a batch of tenants in a prior tutorial, skip to the [Simulate usage on all tenant databases](#simulate-usage-on-all-tenant-databases) section.</span></span>

1. <span data-ttu-id="aa4dc-156">Aç... \\Modülleri öğrenme\\performans izleme ve Yönetim\\*Demo PerformanceMonitoringAndManagement.ps1* içinde *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-156">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in the *PowerShell ISE*.</span></span> <span data-ttu-id="aa4dc-157">Bu öğretici sırasında birkaç senaryo çalıştıracağından bu betiği açık tutun.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-157">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="aa4dc-158">**$DemoScenario** = **1**, **Kiracı grubu sağlama** değerini ayarlayın</span><span class="sxs-lookup"><span data-stu-id="aa4dc-158">Set **$DemoScenario** = **1**, **Provision a batch of tenants**</span></span>
1. <span data-ttu-id="aa4dc-159">Betiği çalıştırmak için **F5**'e basın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-159">Press **F5** to run the script.</span></span>

<span data-ttu-id="aa4dc-160">Bu betik, beş dakikadan daha kısa bir süre içinde 17 kiracı dağıtır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-160">The script will deploy 17 tenants in less than five minutes.</span></span>

<span data-ttu-id="aa4dc-161">*Yeni TenantBatch* komut dosyası kullanan bir iç içe ya da bağlantılı dizi [Resource Manager](../azure-resource-manager/index.md) veritabanını kopyalar, varsayılan kiracılar, toplu oluşturmak şablonlar **basetenantdb**yeni Kiracı veritabanları oluşturmak için katalog sunucusunda ardından bunlar kataloğunda kaydeder ve son olarak bunları Kiracı adı ve salonundan türü ile başlatır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-161">The *New-TenantBatch* script uses a nested or linked set of [Resource Manager](../azure-resource-manager/index.md) templates that create a batch of tenants, which by default copies the database **basetenantdb** on the catalog server to create the new tenant databases, then registers these in the catalog, and finally initializes them with the tenant name and venue type.</span></span> <span data-ttu-id="aa4dc-162">Bu uygulamayı yeni bir kiracı hazırlar yolu ile tutarlıdır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-162">This is consistent with the way the app provisions a new tenant.</span></span> <span data-ttu-id="aa4dc-163">Yapılan değişiklikler *basetenantdb* bundan sonra sağlanan yeni kiracılar için uygulanır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-163">Any changes made to *basetenantdb* are applied to any new tenants provisioned thereafter.</span></span> <span data-ttu-id="aa4dc-164">Bkz: [şema yönetimi öğretici](sql-database-saas-tutorial-schema-management.md) şema değişiklikleri yapma görmek için *varolan* Kiracı veritabanları (de dahil olmak üzere *basetenantdb* veritabanı).</span><span class="sxs-lookup"><span data-stu-id="aa4dc-164">See the [Schema Management tutorial](sql-database-saas-tutorial-schema-management.md) to see how to make schema changes to *existing* tenant databases (including the *basetenantdb* database).</span></span>

## <a name="simulate-usage-on-all-tenant-databases"></a><span data-ttu-id="aa4dc-165">Tüm kiracı veritabanlarındaki kullanımın benzetimini gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="aa4dc-165">Simulate usage on all tenant databases</span></span>

<span data-ttu-id="aa4dc-166">*Demo PerformanceMonitoringAndManagement.ps1* tüm Kiracı veritabanları karşı çalışan bir iş yükünü benzetim sağlanan komut dosyasıdır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-166">The *Demo-PerformanceMonitoringAndManagement.ps1* script is provided that simulates a workload running against all tenant databases.</span></span> <span data-ttu-id="aa4dc-167">Yükü, kullanılabilir yük senaryolardan biri, kullanılarak oluşturulur:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-167">The load is generated using one of the available load scenarios:</span></span>

| <span data-ttu-id="aa4dc-168">Tanıtım</span><span class="sxs-lookup"><span data-stu-id="aa4dc-168">Demo</span></span> | <span data-ttu-id="aa4dc-169">Senaryo</span><span class="sxs-lookup"><span data-stu-id="aa4dc-169">Scenario</span></span> |
|:--|:--|
| <span data-ttu-id="aa4dc-170">2</span><span class="sxs-lookup"><span data-stu-id="aa4dc-170">2</span></span> | <span data-ttu-id="aa4dc-171">Normal yoğunlukta yük (yaklaşık 40 DTU) oluşturma</span><span class="sxs-lookup"><span data-stu-id="aa4dc-171">Generate normal intensity load (approx. 40 DTU)</span></span> |
| <span data-ttu-id="aa4dc-172">3</span><span class="sxs-lookup"><span data-stu-id="aa4dc-172">3</span></span> | <span data-ttu-id="aa4dc-173">Veritabanı başına daha uzun ve daha sık artışla yük oluşturma</span><span class="sxs-lookup"><span data-stu-id="aa4dc-173">Generate load with longer and more frequent bursts per database</span></span>|
| <span data-ttu-id="aa4dc-174">4</span><span class="sxs-lookup"><span data-stu-id="aa4dc-174">4</span></span> | <span data-ttu-id="aa4dc-175">Veritabanı başına daha yüksek DTU veri bloğu (yaklaşık 80 DTU) ile yük oluşturma</span><span class="sxs-lookup"><span data-stu-id="aa4dc-175">Generate load with higher DTU bursts per database (approx. 80 DTU)</span></span>|
| <span data-ttu-id="aa4dc-176">5</span><span class="sxs-lookup"><span data-stu-id="aa4dc-176">5</span></span> | <span data-ttu-id="aa4dc-177">Tek bir kiracı üzerinde normal yük ve yoğun yük oluşturma (yaklaşık 95 DTU)</span><span class="sxs-lookup"><span data-stu-id="aa4dc-177">Generate a normal load plus a high load on a single tenant (approx. 95 DTU)</span></span>|
| <span data-ttu-id="aa4dc-178">6</span><span class="sxs-lookup"><span data-stu-id="aa4dc-178">6</span></span> | <span data-ttu-id="aa4dc-179">Birden çok havuzda dengesiz yük oluşturma</span><span class="sxs-lookup"><span data-stu-id="aa4dc-179">Generate unbalanced load across multiple pools</span></span>|

<span data-ttu-id="aa4dc-180">Yük oluşturucu her kiracı veritabanına *yapay* bir yalnızca CPU yükü uygular.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-180">The load generator applies a *synthetic* CPU-only load to every tenant database.</span></span> <span data-ttu-id="aa4dc-181">Oluşturucu her kiracı veritabanı için yükü oluşturan saklı yordamı düzenli olarak çağıran bir iş başlatır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-181">The generator starts a job for each tenant database, which calls a stored procedure periodically that generates the load.</span></span> <span data-ttu-id="aa4dc-182">Yük düzeyleri (eDTU cinsinden), süresi ve aralıkları tüm veritabanlarında farklıdır ve öngörülemez kiracı etkinliğini benzetimi gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-182">The load levels (in eDTUs), duration, and intervals are varied across all databases, simulating unpredictable tenant activity.</span></span>

1. <span data-ttu-id="aa4dc-183">Aç... \\Modülleri öğrenme\\performans izleme ve Yönetim\\*Demo PerformanceMonitoringAndManagement.ps1* içinde *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-183">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in the *PowerShell ISE*.</span></span> <span data-ttu-id="aa4dc-184">Bu öğretici sırasında birkaç senaryo çalıştıracağından bu betiği açık tutun.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-184">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="aa4dc-185">Ayarlama **$DemoScenario** = **2**, *Generate normal yoğunluğu yük*.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-185">Set **$DemoScenario** = **2**, *Generate normal intensity load*.</span></span>
1. <span data-ttu-id="aa4dc-186">Bir yükü tüm kiracı veritabanlarınıza uygulamak için **F5** tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-186">Press **F5** to apply a load to all your tenant databases.</span></span>

<span data-ttu-id="aa4dc-187">Wingtip bir SaaS uygulaması ve bir SaaS uygulaması gerçek yükü genellikle durumlarıyla ve tahmin edilemez.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-187">Wingtip is a SaaS app, and the real-world load on a SaaS app is typically sporadic and unpredictable.</span></span> <span data-ttu-id="aa4dc-188">Yük oluşturucu, bunun benzetimini gerçekleştirmek için kiracılar genelinde dağıtılan rastgele yük oluşturur.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-188">To simulate this, the load generator produces a randomized load distributed across all tenants.</span></span> <span data-ttu-id="aa4dc-189">Birkaç dakika kadar 3-5 dakika aşağıdaki bölümlerde yük izlemek denemeden önce yük oluşturucuyu çalıştırmak çıkmaya, yük düzeni için gereklidir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-189">Several minutes are needed for the load pattern to emerge, so run the load generator for 3-5 minutes before attempting to monitor the load in the following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="aa4dc-190">Yük oluşturucu, yerel PowerShell oturumunuzda bir dizi iş çalıştırıyor.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-190">The load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="aa4dc-191">*Demo-PerformanceMonitoringAndManagement.ps1* sekmesini açık tutun!</span><span class="sxs-lookup"><span data-stu-id="aa4dc-191">Keep the *Demo-PerformanceMonitoringAndManagement.ps1* tab open!</span></span> <span data-ttu-id="aa4dc-192">Sekmeyi kapatırsanız veya makineyi askıya alırsanız, yük oluşturucu durur.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-192">If you close the tab, or suspend your machine, the load generator stops.</span></span> <span data-ttu-id="aa4dc-193">Yük Oluşturucu kaldığı bir *iş çağırma* ürettiği burada oluşturucunun başlatıldıktan sonra sağlanan yeni kiracılar yük durumu.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-193">The load generator remains in a *job-invoking* state where it generates load on any new tenants that are provisioned after the generator is started.</span></span> <span data-ttu-id="aa4dc-194">Kullanım *Ctrl-C* yeni işleri çağırma durdurun ve komut dosyası çıkmak için.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-194">Use *Ctrl-C* to stop invoking new jobs and exit the script.</span></span> <span data-ttu-id="aa4dc-195">Yük Oluşturucu, ancak yalnızca var olan kiracılar çalışmaya devam eder.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-195">The load generator will continue to run, but only on existing tenants.</span></span>

## <a name="monitor-resource-usage-using-the-azure-portal"></a><span data-ttu-id="aa4dc-196">Azure portalını kullanarak kaynak kullanımını izleme</span><span class="sxs-lookup"><span data-stu-id="aa4dc-196">Monitor resource usage using the Azure portal</span></span>

<span data-ttu-id="aa4dc-197">Uygulanmakta olan yük sonuçları kaynak kullanımını izlemek için Kiracı veritabanları içeren havuzu portalına açın:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-197">To monitor the resource usage that results from the load being applied, open the portal to the pool containing the tenant databases:</span></span>

1. <span data-ttu-id="aa4dc-198">Açık [Azure portal](https://portal.azure.com) ve *tenants1 -&lt;kullanıcı&gt;*  sunucu.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-198">Open the [Azure portal](https://portal.azure.com) and browse to the *tenants1-&lt;USER&gt;* server.</span></span>
1. <span data-ttu-id="aa4dc-199">Aşağı kaydırıp elastik havuzları bulun ve **Pool1**’e tıklayın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-199">Scroll down and locate elastic pools and click **Pool1**.</span></span> <span data-ttu-id="aa4dc-200">Bu havuz o ana kadar oluşturulmuş tüm kiracı veritabanlarını içerir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-200">This pool contains all the tenant databases created so far.</span></span>

<span data-ttu-id="aa4dc-201">Gözlemlemek **esnek Havuz izleme** ve **esnek veritabanı izleme** grafik.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-201">Observe the **Elastic pool monitoring** and **Elastic database monitoring** charts.</span></span>

<span data-ttu-id="aa4dc-202">Havuza ait kaynak kullanımı havuzdaki tüm veritabanları için birleşik veritabanı kullanımı ' dir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-202">The pool's resource utilization is the aggregate database utilization for all databases in the pool.</span></span> <span data-ttu-id="aa4dc-203">Veritabanı grafik beş yeni veritabanları gösterir:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-203">The database chart shows the five hottest databases:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/pool1.png)

<span data-ttu-id="aa4dc-204">Havuz üst beş ötesinde ek veritabanları olduğundan havuzu kullanımı üst beş veritabanları grafikte yansıtılmaz etkinliğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-204">Because there are additional databases in the pool beyond the top five, the pool utilization shows activity that is not reflected in the top five databases chart.</span></span> <span data-ttu-id="aa4dc-205">Ek ayrıntılar için tıklatın **veritabanı kaynak kullanımını**:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-205">For additional details, click **Database Resource Utilization**:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/database-utilization.png)


## <a name="set-performance-alerts-on-the-pool"></a><span data-ttu-id="aa4dc-206">Havuzda performans uyarılarını ayarlama</span><span class="sxs-lookup"><span data-stu-id="aa4dc-206">Set performance alerts on the pool</span></span>

<span data-ttu-id="aa4dc-207">Bir uyarı üzerinde tetikler havuzu Ayarla \>şekilde % 75 kullanımı:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-207">Set an alert on the pool that triggers on \>75% utilization as follows:</span></span>

1. <span data-ttu-id="aa4dc-208">[Azure portalında](https://portal.azure.com) *Pool1*’i (*tenants1-\<user\>* sunucusunda) açın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-208">Open *Pool1* (on the *tenants1-\<user\>* server) in the [Azure portal](https://portal.azure.com).</span></span>
1. <span data-ttu-id="aa4dc-209">**Uyarı Kuralları**ve ardından **+ Uyarı ekle**’ye tıklayın:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-209">Click **Alert Rules**, and then click **+ Add alert**:</span></span>

   ![uyarı ekle](media/sql-database-saas-tutorial-performance-monitoring/add-alert.png)

1. <span data-ttu-id="aa4dc-211">**Yüksek DTU** gibi bir ad belirtin,</span><span class="sxs-lookup"><span data-stu-id="aa4dc-211">Provide a name, such as **High DTU**,</span></span>
1. <span data-ttu-id="aa4dc-212">Aşağıdaki değerleri ayarlayın:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-212">Set the following values:</span></span>
   * <span data-ttu-id="aa4dc-213">**Ölçüm = eDTU yüzdesi**</span><span class="sxs-lookup"><span data-stu-id="aa4dc-213">**Metric = eDTU percentage**</span></span>
   * <span data-ttu-id="aa4dc-214">**Koşul = büyüktür**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-214">**Condition = greater than**.</span></span>
   * <span data-ttu-id="aa4dc-215">**Eşik = 75**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-215">**Threshold = 75**.</span></span>
   * <span data-ttu-id="aa4dc-216">**Süre = Son 30 dakika boyunca**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-216">**Period = Over the last 30 minutes**.</span></span>
1. <span data-ttu-id="aa4dc-217">Bir e-posta adresi ekleyin *ek yönetici email(s)* kutusuna ve tıklatın **Tamam**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-217">Add an email address to the *Additional administrator email(s)* box and click **OK**.</span></span>

   ![uyarı ayarlama](media/sql-database-saas-tutorial-performance-monitoring/alert-rule.png)


## <a name="scale-up-a-busy-pool"></a><span data-ttu-id="aa4dc-219">Meşgul bir havuzun ölçeğini artırma</span><span class="sxs-lookup"><span data-stu-id="aa4dc-219">Scale up a busy pool</span></span>

<span data-ttu-id="aa4dc-220">Bir havuzdaki toplam yük düzeyi havuzu kapasitesini aşacak bir noktaya yükselir ve %100 eDTU kullanımına ulaşırsa, bağımsız veritabanı performansı etkilenir ve havuzdaki tüm veritabanları için sorgu yanıt süreleri yavaşlayabilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-220">If the aggregate load level increases on a pool to the point that it maxes out the pool and reaches 100% eDTU usage, then individual database performance is affected, potentially slowing query response times for all databases in the pool.</span></span>

<span data-ttu-id="aa4dc-221">**Kısa vadeli**, ek kaynaklar sağlamak için kuyruğunu ölçekleme veya (bunları havuzlarını veya havuza dışında bir tek başına hizmet katmanına taşıma) havuzdan veritabanı kaldırma göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-221">**Short term**, consider scaling up the pool to provide additional resources, or removing databases from the pool (moving them to other pools, or out of the pool to a stand-alone service tier).</span></span>

<span data-ttu-id="aa4dc-222">**Uzun vadeli**, sorguları en iyi duruma getirme göz önünde bulundurun veya dizin veritabanı performansını iyileştirmek için kullanım.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-222">**Longer term**, consider optimizing queries or index usage to improve database performance.</span></span> <span data-ttu-id="aa4dc-223">Uygulamanın performans sorunlarına karşı duyarlılığına bağlı olarak, bir havuzun ölçeğini havuz %100 eDTU kullanımına ulaşmadan artırmak idealdir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-223">Depending on the application's sensitivity to performance issues its best practice to scale a pool up before it reaches 100% eDTU usage.</span></span> <span data-ttu-id="aa4dc-224">Sizi önceden uyarması için bir uyarı ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-224">Use an alert to warn you in advance.</span></span>

<span data-ttu-id="aa4dc-225">Oluşturucu tarafından üretilen yükü artırarak meşgul bir havuzun benzetimini gerçekleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-225">You can simulate a busy pool by increasing the load produced by the generator.</span></span> <span data-ttu-id="aa4dc-226">Daha sık ve için artık, veri bloğu için veritabanlarını tek veritabanlarını gereksinimlerini değiştirmeden artan Havuzu'ndaki toplam yük neden oluyor.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-226">Causing the databases to burst more frequently, and for longer, increasing the aggregate load on the pool without changing the requirements of the individual databases.</span></span> <span data-ttu-id="aa4dc-227">Havuz ölçeğini, portaldan veya PowerShell’den kolayca artırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-227">Scaling up the pool is easily done in the portal or from PowerShell.</span></span> <span data-ttu-id="aa4dc-228">Bu alıştırmada portal kullanılmaktadır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-228">This exercise uses the portal.</span></span>

1. <span data-ttu-id="aa4dc-229">Her bir veritabanı için gereken en büyük yükü değiştirmeden toplam yükün yoğunluğunu artırmak üzere *$DemoScenario* = **3**, _Veritabanı başına daha uzun ve daha sık artışla yük oluşturma_ değerini ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-229">Set *$DemoScenario* = **3**, _Generate load with longer and more frequent bursts per database_ to increase the intensity of the aggregate load on the pool without changing the peak load required by each database.</span></span>
1. <span data-ttu-id="aa4dc-230">Bir yükü tüm kiracı veritabanlarınıza uygulamak için **F5** tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-230">Press **F5** to apply a load to all your tenant databases.</span></span>

1. <span data-ttu-id="aa4dc-231">Git **Pool1** Azure portalında.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-231">Go to **Pool1** in the Azure portal.</span></span>

<span data-ttu-id="aa4dc-232">Üst grafik artan havuz eDTU kullanımı izleyin.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-232">Monitor the increased pool eDTU usage on the upper chart.</span></span> <span data-ttu-id="aa4dc-233">Kazandırın yeni daha fazla yük için birkaç dakika sürer ancak max kullanımı isabet Başlat havuzu hızlı bir şekilde görmeniz gerekir ve yeni modele yük steadies gibi hızlı bir şekilde havuzu overloads.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-233">It takes a few minutes for the new higher load to kick in, but you should quickly see the pool start to hit max utilization, and as the load steadies into the new pattern, it rapidly overloads the pool.</span></span>

1. <span data-ttu-id="aa4dc-234">Havuzu oluşturan ölçeklendirmek için tıklatın **havuzu yapılandırma** en üstündeki **Pool1** sayfası.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-234">To scale up the pool, click **Configure pool** at the top of the **Pool1** page.</span></span>
1. <span data-ttu-id="aa4dc-235">Ayarlama **havuz eDTU** ayarını **100**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-235">Adjust the **Pool eDTU** setting to **100**.</span></span> <span data-ttu-id="aa4dc-236">Havuz eDTU değerinin değiştirilmesi, veritabanı başına ayarları değiştirmez (veritabanı başına hala en fazla 50 eDTU’dur).</span><span class="sxs-lookup"><span data-stu-id="aa4dc-236">Changing the pool eDTU does not change the per-database settings (which is still 50 eDTU max per database).</span></span> <span data-ttu-id="aa4dc-237">Veritabanı başına ayarlarını sağ tarafında görebilir **havuzu yapılandırma** sayfası.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-237">You can see the per-database settings on the right side of the **Configure pool** page.</span></span>
1. <span data-ttu-id="aa4dc-238">Tıklatın **kaydetmek** havuzu ölçeklendirme isteği göndermek için.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-238">Click **Save** to submit the request to scale the pool.</span></span>

<span data-ttu-id="aa4dc-239">Geri dönerek **Pool1** > **genel bakış** izleme grafikleri görüntülemek için.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-239">Go back to **Pool1** > **Overview** to view the monitoring charts.</span></span> <span data-ttu-id="aa4dc-240">(Birkaç veritabanları ve rastgele bir yükleme ile bu her zaman biraz zaman çalıştırana kadar conclusively görmek kolay olmasa da) ile daha fazla kaynak havuzu sağlama etkisini izleyin.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-240">Monitor the effect of providing the pool with more resources (although with few databases and a randomized load it’s not always easy to see conclusively until you run for some time).</span></span> <span data-ttu-id="aa4dc-241">Grafiklere bakarken, üst grafikteki %100 değerinin 100 eDTU’yu, alt grafikteki %100 değerinin ise veritabanı başına en yüksek değer hala 50 eDTU olduğundan 50 eDTU’yu temsil ettiğini aklınızda bulundurun.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-241">While you are looking at the charts bear in mind that 100% on the upper chart now represents 100 eDTUs, while on the lower chart 100% is still 50 eDTUs as the per-database max is still 50 eDTUs.</span></span>

<span data-ttu-id="aa4dc-242">İşlem boyunca veritabanları çevrimiçi ve tam olarak kullanılabilir durumdadır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-242">Databases remain online and fully available throughout the process.</span></span> <span data-ttu-id="aa4dc-243">Her veritabanının yeni havuz eDTU değeriyle etkinleştirilmeye hazır olduğu son anda tüm etkin bağlantılar kesilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-243">At the last moment as each database is ready to be enabled with the new pool eDTU, any active connections are broken.</span></span> <span data-ttu-id="aa4dc-244">Kesilen bağlantıları yeniden denemek için her zaman uygulama kodunun yazılması gerekir, böylece ölçeği artırılmış havuzda veritabanına yeniden bağlanılır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-244">Application code should always be written to retry dropped connections, and so will reconnect to the database in the scaled-up pool.</span></span>

## <a name="load-balance-between-pools"></a><span data-ttu-id="aa4dc-245">Havuzları arasında Yük Dengelemesi</span><span class="sxs-lookup"><span data-stu-id="aa4dc-245">Load balance between pools</span></span>

<span data-ttu-id="aa4dc-246">Havuz ölçeğini artırmanın alternatif bir yolu, ikinci bir havuz oluşturup veritabanlarını bu havuza taşımak ve iki havuz arasındaki yükü dengelemektir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-246">As an alternative to scaling up the pool, create a second pool and move databases into it to balance the load between the two pools.</span></span> <span data-ttu-id="aa4dc-247">Bunu yapmak için yeni havuzun birinci havuzla aynı sunucuda oluşturulması gerekir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-247">To do this the new pool must be created on the same server as the first.</span></span>

1. <span data-ttu-id="aa4dc-248">İçinde [Azure portal](https://portal.azure.com), açık **tenants1 -&lt;kullanıcı&gt;**  sunucu.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-248">In the [Azure portal](https://portal.azure.com), open the **tenants1-&lt;USER&gt;** server.</span></span>
1. <span data-ttu-id="aa4dc-249">Tıklatın **+ yeni havuz** geçerli sunucuda bir havuzu oluşturmak için.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-249">Click **+ New pool** to create a pool on the current server.</span></span>
1. <span data-ttu-id="aa4dc-250">Üzerinde **esnek veritabanı havuzu** şablonu:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-250">On the **Elastic database pool** template:</span></span>

    1. <span data-ttu-id="aa4dc-251">Ayarlama **adı** için *Pool2*.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-251">Set **Name** to *Pool2*.</span></span>
    1. <span data-ttu-id="aa4dc-252">Fiyatlandırma katmanını **Standart Havuz** olarak bırakın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-252">Leave the pricing tier as **Standard Pool**.</span></span>
    1. <span data-ttu-id="aa4dc-253">**Havuzu yapılandır**'a tıklayın,</span><span class="sxs-lookup"><span data-stu-id="aa4dc-253">Click **Configure pool**,</span></span>
    1. <span data-ttu-id="aa4dc-254">Ayarlama **havuz eDTU** için *50 eDTU*.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-254">Set **Pool eDTU** to *50 eDTU*.</span></span>
    1. <span data-ttu-id="aa4dc-255">Tıklatın **eklemek veritabanları** eklenebilir sunucusundaki veritabanlarının listesini görmek için *Pool2*.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-255">Click **Add databases** to see a list of databases on the server that can be added to *Pool2*.</span></span>
    1. <span data-ttu-id="aa4dc-256">Bu yeni havuzuna taşıyın ve ardından 10 istediğiniz veritabanlarını seçin **seçin**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-256">Select any 10 databases to move these to the new pool, and then click **Select**.</span></span> <span data-ttu-id="aa4dc-257">Yük Oluşturucu çalışır durumda, hizmet performansı profilinizi varsayılan 50 eDTU boyutundan daha büyük bir havuzu gerektirir ve bir 100 eDTU ayarı ile başlayan önerir zaten bilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-257">If you've been running the load generator, the service already knows that your performance profile requires a larger pool than the default 50 eDTU size and recommends starting with a 100 eDTU setting.</span></span>

    ![Öneri](media/sql-database-saas-tutorial-performance-monitoring/configure-pool.png)

    1. <span data-ttu-id="aa4dc-259">Bu öğretici için varsayılan 50 Edtu bırakın ve tıklatın **seçin** yeniden.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-259">For this tutorial, leave the default at 50 eDTUs, and click **Select** again.</span></span>
    1. <span data-ttu-id="aa4dc-260">Seçin **Tamam** yeni havuzu oluşturun ve içine seçilen veritabanlarını taşımak için.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-260">Select **OK** to create the new pool and to move the selected databases into it.</span></span>

<span data-ttu-id="aa4dc-261">Havuz oluşturma ve veritabanlarını taşıma birkaç dakika sürer.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-261">Creating the pool and moving the databases takes a few minutes.</span></span> <span data-ttu-id="aa4dc-262">Veritabanları, kadar çok son şu anda çevrimiçi ve tam olarak erişilebilir kalırlar taşınırken, bu noktada açık olan bağlantıları kapanır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-262">As databases are moved they remain online and fully accessible until the very last moment, at which point any open connections are closed.</span></span> <span data-ttu-id="aa4dc-263">Bazı yeniden deneme mantığı sahip olduğu sürece, istemciler yeni havuz veritabanına bağlanır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-263">As long as you have some retry logic, clients will then connect to the database in the new pool.</span></span>

<span data-ttu-id="aa4dc-264">Gözat **Pool2** (üzerinde *tenants1* sunucu) havuzunu açar ve kendi performansını izlemek için.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-264">Browse to **Pool2** (on the *tenants1* server) to open the pool and monitor its performance.</span></span> <span data-ttu-id="aa4dc-265">Göremiyorsanız, tamamlamak için yeni havuzu sağlama için bekleyin.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-265">If you don't see it, wait for provisioning of the new pool to complete.</span></span>

<span data-ttu-id="aa4dc-266">Artık kaynak kullanımının gördüğünüz *Pool1* bıraktı ve *Pool2* şimdi benzer şekilde yüklenir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-266">You now see that resource usage on *Pool1* has dropped and that *Pool2* is now similarly loaded.</span></span>

## <a name="manage-performance-of-a-single-database"></a><span data-ttu-id="aa4dc-267">Tek bir veritabanının performansını yönetme</span><span class="sxs-lookup"><span data-stu-id="aa4dc-267">Manage performance of a single database</span></span>

<span data-ttu-id="aa4dc-268">Bir havuzdaki tek bir veritabanı sürekli yüksek bir yük altındaysa, havuz yapılandırmasına bağlı olarak, havuzdaki kaynaklara yön vermeye ve diğer veritabanlarını etkilemeye eğilimli olabilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-268">If a single database in a pool experiences a sustained high load, depending on the pool configuration, it may tend to dominate the resources in the pool and impact other databases.</span></span> <span data-ttu-id="aa4dc-269">Etkinlik için bir süre devam etmek olasılığı varsa, veritabanını geçici olarak havuzu dışında taşınabilir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-269">If the activity is likely to continue for some time, the database can be temporarily moved out of the pool.</span></span> <span data-ttu-id="aa4dc-270">Bu gerekir ve diğer veritabanlarından yalıtır ek kaynaklar veritabanı sağlar.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-270">This allows the database to have the extra resources it needs, and isolates it from the other databases.</span></span>

<span data-ttu-id="aa4dc-271">Bu alıştırmada, popüler bir konser için biletler satışa çıktığında yüksek bir yükle karşılaşan Contoso Konser Salonu etkisinin benzetimi gerçekleştirilmektedir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-271">This exercise simulates the effect of Contoso Concert Hall experiencing a high load when tickets go on sale for a popular concert.</span></span>

1. <span data-ttu-id="aa4dc-272">Aç... \\ *Demo PerformanceMonitoringAndManagement.ps1* komut dosyası.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-272">Open the …\\*Demo-PerformanceMonitoringAndManagement.ps1* script.</span></span>
1. <span data-ttu-id="aa4dc-273">**$DemoScenario = 5, Tek bir kiracı üzerinde normal yük ve yoğun yük oluşturma (yaklaşık 95 DTU)** ayarını yapın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-273">Set **$DemoScenario = 5, Generate a normal load plus a high load on a single tenant (approx. 95 DTU).**</span></span>
1. <span data-ttu-id="aa4dc-274">**$SingleTenantDatabaseName = contosoconcerthall** değerini ayarlayın</span><span class="sxs-lookup"><span data-stu-id="aa4dc-274">Set **$SingleTenantDatabaseName = contosoconcerthall**</span></span>
1. <span data-ttu-id="aa4dc-275">**F5**’i kullanarak betiği yürütün.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-275">Execute the script using **F5**.</span></span>


1. <span data-ttu-id="aa4dc-276">İçinde [Azure portal](https://portal.azure.com) açmak **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-276">In the [Azure portal](https://portal.azure.com) open **Pool1**.</span></span>
1. <span data-ttu-id="aa4dc-277">İnceleme **esnek Havuz izleme** grafik ve artan havuz eDTU kullanımı için bakın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-277">Inspect the **Elastic pool monitoring** chart and look for the increased pool eDTU usage.</span></span> <span data-ttu-id="aa4dc-278">Bir veya iki dakika sonra, daha yüksek olan yük etkisini göstermeye başlar ve havuzun %100 kullanıma ulaştığını görürsünüz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-278">After a minute or two, the higher load should start to kick in, and you should quickly see that the pool hits 100% utilization.</span></span>
1. <span data-ttu-id="aa4dc-279">İnceleme **esnek veritabanı izleme** son bir saat içindeki yeni veritabanları gösteren görüntü.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-279">Inspect the **Elastic database monitoring** display which shows the hottest databases in the past hour.</span></span> <span data-ttu-id="aa4dc-280">*Contosoconcerthall* veritabanı yakında görünmelidir beş yeni veritabanları biri olarak.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-280">The *contosoconcerthall* database should soon appear as one of the five hottest databases.</span></span>
1. <span data-ttu-id="aa4dc-281">**Esnek veritabanı izleme'yi tıklatın** **grafik** ve açar **veritabanı kaynak kullanımını** burada izleyebilirsiniz herhangi bir veritabanı sayfası.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-281">**Click on the Elastic database monitoring** **chart** and it opens the **Database Resource Utilization** page where you can monitor any of the databases.</span></span> <span data-ttu-id="aa4dc-282">Bu görüntü için ayırmanıza olanak tanır *contosoconcerthall* veritabanı.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-282">This lets you isolate the display for the *contosoconcerthall* database.</span></span>
1. <span data-ttu-id="aa4dc-283">Veritabanları listesinden tıklatın **contosoconcerthall**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-283">From the list of databases, click **contosoconcerthall**.</span></span>
1. <span data-ttu-id="aa4dc-284">Tıklatın **fiyatlandırma Katmanı (Ölçek Dtu'lar)** açmak için **performansını yapılandırın** veritabanı için bir tek başına performans düzeyi ayarlayabileceğiniz sayfa.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-284">Click **Pricing Tier (scale DTUs)** to open the **Configure performance** page where you can set a stand-alone performance level for the database.</span></span>
1. <span data-ttu-id="aa4dc-285">Standart katmanındaki ölçeklendirme seçeneklerini açmak için **Standart** sekmesine tıklayın.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-285">Click on the **Standard** tab to open the scale options in the Standard tier.</span></span>
1. <span data-ttu-id="aa4dc-286">Slayt **DTU kaydırıcı** seçmek için sağdaki **100** Dtu'lar.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-286">Slide the **DTU slider** to right to select **100** DTUs.</span></span> <span data-ttu-id="aa4dc-287">Bu hizmet hedefi için karşılık gelen Not **S3**.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-287">Note this corresponds to the service objective, **S3**.</span></span>
1. <span data-ttu-id="aa4dc-288">Tıklatın **Uygula** dışında havuzu veritabanını taşımak ve bunu yapmak için bir *standart S3* veritabanı.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-288">Click **Apply** to move the database out of the pool and make it a *Standard S3* database.</span></span>
1. <span data-ttu-id="aa4dc-289">Ölçeklendirme işlemi tamamlandıktan sonra contosoconcerthall veritabanı üzerindeki etkisini ve esnek havuzu ve veritabanı dikey pencereleri üzerinde Pool1 izleyin.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-289">Once scaling is complete, monitor the effect on the contosoconcerthall database and Pool1 on the elastic pool and database blades.</span></span>

<span data-ttu-id="aa4dc-290">Yüksek yük contosoconcerthall veritabanında subsides sonra hemen kendi maliyetini azaltmak havuzuna döndürmelidir.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-290">Once the high load on the contosoconcerthall database subsides you should promptly return it to the pool to reduce its cost.</span></span> <span data-ttu-id="aa4dc-291">Belirsiz ise, ayarladığınız uyarı veritabanı üzerinde ne zaman olacağını tetiklemek DTU kullanımı veritabanı başına düştüğünde havuzunda maks.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-291">If it’s unclear when that will happen you could set an alert on the database that will trigger when its DTU usage drops below the per-database max on the pool.</span></span> <span data-ttu-id="aa4dc-292">Veritabanını havuza taşıma işlemi 5. alıştırmada açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-292">Moving a database into a pool is described in exercise 5.</span></span>

## <a name="other-performance-management-patterns"></a><span data-ttu-id="aa4dc-293">Diğer Performans Yönetimi Düzenleri</span><span class="sxs-lookup"><span data-stu-id="aa4dc-293">Other Performance Management Patterns</span></span>

<span data-ttu-id="aa4dc-294">**Önleyici ölçeklendirme** incelediniz burada yalıtılmış bir veritabanı ölçeklendirme alıştırmada yukarıdaki aranacak hangi veritabanı biliyorduk.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-294">**Pre-emptive scaling** In the exercise above where you explored how to scale an isolated database, you knew which database to look for.</span></span> <span data-ttu-id="aa4dc-295">Contoso birlikte Hall yönetim yaklaşan bilet satış Wingtips haberdar değilse, veritabanı dışında havuzu pre-emptively taşınmış.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-295">If the management of Contoso Concert Hall had informed Wingtips of the impending ticket sale, the database could have been moved out of the pool pre-emptively.</span></span> <span data-ttu-id="aa4dc-296">Aksi takdirde, neler olduğunu belirlemek için havuz veya veritabanı üzerinde bir uyarı verilmesini isteyebilirdi.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-296">Otherwise, it would likely have required an alert on the pool or the database to spot what was happening.</span></span> <span data-ttu-id="aa4dc-297">Bu durumu, havuzda performans düşüklüğünden şikayetçi olan diğer kiracılardan öğrenmek istemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-297">You wouldn’t want to learn about this from the other tenants in the pool complaining of degraded performance.</span></span> <span data-ttu-id="aa4dc-298">Kiracı ek kaynaklara ne süreyle ihtiyaç duyduğunu öngörebiliyorsa, tanımlanmış bir zamanlamaya göre veritabanını havuz dışına ve sonra tekrar içine taşımak için bir Azure Otomasyonu runbook'u ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-298">And if the tenant can predict how long they will need additional resources you can set up an Azure Automation runbook to move the database out of the pool and then back in again on a defined schedule.</span></span>

<span data-ttu-id="aa4dc-299">**Kiracı self-servis ölçeklendirme** Ölçeklendirme, yönetim API’si aracılığıyla kolayca çağrılan bir görev olduğundan, kiracıya yönelik uygulamanızda kiracı veritabanlarını ölçeklendirme özelliğini kolayca oluşturabilir ve SaaS hizmetinizin bir özelliği olarak sunabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-299">**Tenant self-service scaling** Because scaling is a task easily called via the management API, you can easily build the ability to scale tenant databases into your tenant-facing application, and offer it as a feature of your SaaS service.</span></span> <span data-ttu-id="aa4dc-300">Örneğin, kiracıların ölçek artırma ve azaltma işlemini kendi kendine yönetmesine, belki de doğrudan faturalarına bağlamasına izin verebilirsiniz!</span><span class="sxs-lookup"><span data-stu-id="aa4dc-300">For example, let tenants self-administer scaling up and down, perhaps linked directly to their billing!</span></span>

<span data-ttu-id="aa4dc-301">**Bir havuz kullanım desenlerini eşleştirmek için bir zamanlamaya göre yukarı ve aşağı doğru ölçeklendirme**</span><span class="sxs-lookup"><span data-stu-id="aa4dc-301">**Scaling a pool up and down on a schedule to match usage patterns**</span></span>

<span data-ttu-id="aa4dc-302">Toplu kiracı kullanımının öngörülebilir kullanım düzenlerini takip ettiği durumlarda, belirli bir zamanlamaya göre bir havuzun ölçeğini artırıp azaltmak için Azure Otomasyonu’nu kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-302">Where aggregate tenant usage follows predictable usage patterns, you can use Azure Automation to scale a pool up and down on a schedule.</span></span> <span data-ttu-id="aa4dc-303">Örneğin, kaynak gereksinimlerinde düşüş olduğunu bildiğiniz hafta içi günlerinde havuz ölçeğini akşam 6’dan sonra azaltıp sabah 6’dan önce yeniden artırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="aa4dc-303">For example, scale a pool down after 6pm and up again before 6am on weekdays when you know there is a drop in resource requirements.</span></span>



## <a name="next-steps"></a><span data-ttu-id="aa4dc-304">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="aa4dc-304">Next steps</span></span>

<span data-ttu-id="aa4dc-305">Bu öğreticide şunların nasıl yapıldığını öğreneceksiniz:</span><span class="sxs-lookup"><span data-stu-id="aa4dc-305">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="aa4dc-306">Sağlanan bir yük oluşturucuyu çalıştırarak kiracı veritabanlarındaki kullanımın benzetimini gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="aa4dc-306">Simulate usage on the tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="aa4dc-307">Yükteki artışa yanıt veren kiracı veritabanlarını izleme</span><span class="sxs-lookup"><span data-stu-id="aa4dc-307">Monitor the tenant databases as they respond to the increase in load</span></span>
> * <span data-ttu-id="aa4dc-308">Artan veritabanı yüküne yanıt olarak Elastik havuzun ölçeğini artırma</span><span class="sxs-lookup"><span data-stu-id="aa4dc-308">Scale up the Elastic pool in response to the increased database load</span></span>
> * <span data-ttu-id="aa4dc-309">Veritabanı etkinliğinin yük dengelemesini yapmak üzere ikinci bir Elastik havuz sağlama</span><span class="sxs-lookup"><span data-stu-id="aa4dc-309">Provision a second Elastic pool to load balance the database activity</span></span>

[<span data-ttu-id="aa4dc-310">Tek bir kiracıyı geri yükleme öğreticisi</span><span class="sxs-lookup"><span data-stu-id="aa4dc-310">Restore a single tenant tutorial</span></span>](sql-database-saas-tutorial-restore-single-tenant.md)


## <a name="additional-resources"></a><span data-ttu-id="aa4dc-311">Ek kaynaklar</span><span class="sxs-lookup"><span data-stu-id="aa4dc-311">Additional resources</span></span>

* <span data-ttu-id="aa4dc-312">Ek [derleme Wingtip SaaS uygulama dağıtımı sırasında öğreticileri](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="aa4dc-312">Additional [tutorials that build upon the Wingtip SaaS application deployment](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="aa4dc-313">SQL Elastik havuzları</span><span class="sxs-lookup"><span data-stu-id="aa4dc-313">SQL Elastic pools</span></span>](sql-database-elastic-pool.md)
* [<span data-ttu-id="aa4dc-314">Azure otomasyonu</span><span class="sxs-lookup"><span data-stu-id="aa4dc-314">Azure automation</span></span>](../automation/automation-intro.md)
* <span data-ttu-id="aa4dc-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Log Analytics ayarlama ve kullanma öğreticisi</span><span class="sxs-lookup"><span data-stu-id="aa4dc-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Setting up and using Log Analytics tutorial</span></span>
