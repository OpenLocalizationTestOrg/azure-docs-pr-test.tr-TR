---
title: "Bir Azure SQL veritabanını kopyalama | Microsoft Docs"
description: "Bir Azure SQL veritabanının bir kopyasını oluşturun"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 8c1e3c80b9f24089dc99463d6ea8ae5d0ea7b19d
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="0e7ce-103">Bir Azure SQL veritabanını kopyalama</span><span class="sxs-lookup"><span data-stu-id="0e7ce-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="0e7ce-104">Azure SQL veritabanını aynı sunucuya veya farklı bir sunucu üzerinde var olan bir Azure SQL veritabanı işlemsel olarak tutarlı bir kopyasını oluşturmak için çeşitli yöntemler sağlar.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either the same server or a different server.</span></span> <span data-ttu-id="0e7ce-105">Azure portal, PowerShell veya T-SQL kullanarak bir SQL veritabanı kopyalayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-105">You can copy a SQL database by using the Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="0e7ce-106">Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="0e7ce-106">Overview</span></span>

<span data-ttu-id="0e7ce-107">Bir veritabanı kopyası kopya isteğini zaman itibariyle kaynak veritabanı anlık görüntüsüdür.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-107">A database copy is a snapshot of the source database as of the time of the copy request.</span></span> <span data-ttu-id="0e7ce-108">Aynı sunucuya veya farklı bir sunucu, kendi hizmet katmanını ve performans düzeyi ya da aynı hizmet Katmanı (edition) içindeki farklı performans düzeyi seçebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-108">You can select the same server or a different server, its service tier and performance level, or a different performance level within the same service tier (edition).</span></span> <span data-ttu-id="0e7ce-109">Kopyalama tamamlandıktan sonra tam olarak işlevsel, bağımsız bir veritabanı haline gelir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-109">After the copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="0e7ce-110">Bu noktada, yükseltme veya herhangi bir sürümünü düşürmek.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-110">At this point, you can upgrade or downgrade it to any edition.</span></span> <span data-ttu-id="0e7ce-111">Oturumlar, kullanıcılar ve izinler bağımsız olarak yönetilebilir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-111">The logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-the-database-copy"></a><span data-ttu-id="0e7ce-112">Veritabanı kopyasını oturumlar</span><span class="sxs-lookup"><span data-stu-id="0e7ce-112">Logins in the database copy</span></span>

<span data-ttu-id="0e7ce-113">Bir veritabanı aynı mantıksal sunucusuna kopyaladığınızda, aynı oturum açma bilgileri hem veritabanlarında kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-113">When you copy a database to the same logical server, the same logins can be used on both databases.</span></span> <span data-ttu-id="0e7ce-114">Güvenlik sorumlusu veritabanının kopyalanacak kullandığınız yeni bir veritabanı üzerinde veritabanı sahibi olur.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-114">The security principal you use to copy the database becomes the database owner on the new database.</span></span> <span data-ttu-id="0e7ce-115">Tüm veritabanı kullanıcıları, izinlerini ve bunların güvenlik tanımlayıcılarını (SID'ler) veritabanı kopyası kopyalanır.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-115">All database users, their permissions, and their security identifiers (SIDs) are copied to the database copy.</span></span>  

<span data-ttu-id="0e7ce-116">Farklı bir mantıksal sunucu için bir veritabanı kopyaladığınızda, güvenlik sorumlusu yeni sunucuda yeni bir veritabanı üzerinde veritabanı sahibi olur.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-116">When you copy a database to a different logical server, the security principal on the new server becomes the database owner on the new database.</span></span> <span data-ttu-id="0e7ce-117">Kullanırsanız [bulunan veritabanı kullanıcıları](sql-database-manage-logins.md) kopyalama tamamlandıktan sonra hemen, aynı kimlik bilgileriyle erişebilmesi için veri erişimi için birincil ve ikincil veritabanları her zaman aynı kullanıcı kimlik bilgilerini olduğundan emin olun .</span><span class="sxs-lookup"><span data-stu-id="0e7ce-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both the primary and secondary databases always have the same user credentials, so that after the copy is complete you can immediately access it with the same credentials.</span></span> 

<span data-ttu-id="0e7ce-118">Kullanırsanız [Azure Active Directory](../active-directory/active-directory-whatis.md), tamamen kopyalama kimlik bilgilerini yönetme ihtiyacını ortadan kaldırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate the need for managing credentials in the copy.</span></span> <span data-ttu-id="0e7ce-119">Yeni bir sunucuya veritabanı kopyaladığınızda, oturum açma bilgileri yeni sunucuda bulunmadığı için ancak, oturum açma tabanlı erişim, çalışmayabilir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-119">However, when you copy the database to a new server, the login-based access might not work, because the logins do not exist on the new server.</span></span> <span data-ttu-id="0e7ce-120">Farklı bir mantıksal sunucu için bir veritabanı kopyaladığınızda oturumları yönetme hakkında bilgi edinmek için [olağanüstü durum kurtarma işleminden sonra Azure SQL veritabanı güvenlik yönetme](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-120">To learn about managing logins when you copy a database to a different logical server, see [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="0e7ce-121">Kopyalama başarılı olduktan sonra ve diğer kullanıcıların eşleştirilir önce veritabanı sahibi kopyalama, başlatılan oturum açma için yeni veritabanı oturum açabilir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-121">After the copying succeeds and before other users are remapped, only the login that initiated the copying, the database owner, can log in to the new database.</span></span> <span data-ttu-id="0e7ce-122">Kopyalama işlemi tamamlandıktan sonra oturum açmalar çözümlemek için bkz: [gidermek oturumları](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-122">To resolve logins after the copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-the-azure-portal"></a><span data-ttu-id="0e7ce-123">Azure portalı kullanarak bir veritabanını kopyalama</span><span class="sxs-lookup"><span data-stu-id="0e7ce-123">Copy a database by using the Azure portal</span></span>

<span data-ttu-id="0e7ce-124">Azure portalını kullanarak bir veritabanı kopyalamak için veritabanınızın sayfasını açın ve ardından **kopya**.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-124">To copy a database by using the Azure portal, open the page for your database, and then click **Copy**.</span></span> 

   ![Veritabanı kopyalama](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="0e7ce-126">PowerShell kullanarak bir veritabanını kopyalama</span><span class="sxs-lookup"><span data-stu-id="0e7ce-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="0e7ce-127">PowerShell kullanarak bir veritabanı kopyalamak için kullanın [yeni AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet'i.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-127">To copy a database by using PowerShell, use the [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="0e7ce-128">Bir tam örnek betik için bkz: [bir veritabanını yeni bir sunucuya kopyalama](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-128">For a complete sample script, see [Copy a database to a new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="0e7ce-129">Transact-SQL kullanarak bir veritabanını kopyalama</span><span class="sxs-lookup"><span data-stu-id="0e7ce-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="0e7ce-130">Ana veritabanı sunucu düzeyinde asıl oturum açma veya kopyalamak istediğiniz veritabanı oluşturulan oturum açma ile oturum açın.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-130">Log in to the master database with the server-level principal login or the login that created the database you want to copy.</span></span> <span data-ttu-id="0e7ce-131">Veritabanı başarılı kopyalamak için sunucu düzeyinde sorumlu olmayan oturumlar dbmanager rolünün üyeleri olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-131">For database copying to succeed, logins that are not the server-level principal must be members of the dbmanager role.</span></span> <span data-ttu-id="0e7ce-132">Oturum açmalar ve sunucuya bağlanma hakkında daha fazla bilgi için bkz: [oturumları yönetme](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-132">For more information about logins and connecting to the server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="0e7ce-133">Kaynak veritabanı ile kopyalama işlemini başlatmak [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) deyimi.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-133">Start copying the source database with the [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="0e7ce-134">Bu deyimi yürütme işlemi kopyalama veritabanı başlatır.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-134">Executing this statement initiates the database copying process.</span></span> <span data-ttu-id="0e7ce-135">Veritabanı kopyalama zaman uyumsuz bir işlem olduğundan, veritabanı kopyalama tamamlanmadan önce CREATE DATABASE deyimi döndürür.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-135">Because copying a database is an asynchronous process, the CREATE DATABASE statement returns before the database copying is complete.</span></span>

### <a name="copy-a-sql-database-to-the-same-server"></a><span data-ttu-id="0e7ce-136">Aynı sunucuya bir SQL veritabanını kopyalama</span><span class="sxs-lookup"><span data-stu-id="0e7ce-136">Copy a SQL database to the same server</span></span>
<span data-ttu-id="0e7ce-137">Ana veritabanı sunucu düzeyinde asıl oturum açma veya kopyalamak istediğiniz veritabanı oluşturulan oturum açma ile oturum açın.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-137">Log in to the master database with the server-level principal login or the login that created the database you want to copy.</span></span> <span data-ttu-id="0e7ce-138">Veritabanı başarılı kopyalamak için sunucu düzeyinde sorumlu olmayan oturumlar dbmanager rolünün üyeleri olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-138">For database copying to succeed, logins that are not the server-level principal must be members of the dbmanager role.</span></span>

<span data-ttu-id="0e7ce-139">Bu komut Database1 aynı sunucu üzerinde Database2 adlı yeni bir veritabanına kopyalar.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-139">This command copies Database1 to a new database named Database2 on the same server.</span></span> <span data-ttu-id="0e7ce-140">Veritabanı boyutuna bağlı olarak, kopyalama işleminin tamamlanması biraz zaman alabilir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-140">Depending on the size of your database, the copying operation might take some time to complete.</span></span>

    -- Execute on the master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-to-a-different-server"></a><span data-ttu-id="0e7ce-141">Farklı bir sunucuya bir SQL veritabanını kopyalama</span><span class="sxs-lookup"><span data-stu-id="0e7ce-141">Copy a SQL database to a different server</span></span>

<span data-ttu-id="0e7ce-142">Oluşturulacak yeni veritabanının bulunduğu SQL veritabanı sunucusu hedef sunucunun ana veritabanı için oturum açın.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-142">Log in to the master database of the destination server, the SQL database server where the new database is to be created.</span></span> <span data-ttu-id="0e7ce-143">Kaynak veritabanı kaynak SQL veritabanı sunucusunda veritabanı sahibi olarak aynı adı ve parolanın sahip bir oturum açma kullanın.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-143">Use a login that has the same name and password as the database owner of the source database on the source SQL database server.</span></span> <span data-ttu-id="0e7ce-144">Hedef sunucuda oturum açma de dbmanager rolünün bir üyesi olmanız veya sunucu düzeyinde asıl oturum açma olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-144">The login on the destination server must also be a member of the dbmanager role or be the server-level principal login.</span></span>

<span data-ttu-id="0e7ce-145">Bu komut Database1 Sunucu1 ' Database2 Sunucu2'adlı yeni bir veritabanı kopyalar.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-145">This command copies Database1 on server1 to a new database named Database2 on server2.</span></span> <span data-ttu-id="0e7ce-146">Veritabanı boyutuna bağlı olarak, kopyalama işleminin tamamlanması biraz zaman alabilir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-146">Depending on the size of your database, the copying operation might take some time to complete.</span></span>

    -- Execute on the master database of the target server (server2)
    -- Start copying from Server1 to Server2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-the-progress-of-the-copying-operation"></a><span data-ttu-id="0e7ce-147">Kopyalama işleminin ilerleyişini izleyin</span><span class="sxs-lookup"><span data-stu-id="0e7ce-147">Monitor the progress of the copying operation</span></span>

<span data-ttu-id="0e7ce-148">Kopyalama işlemi sys.databases ve sys.dm_database_copies görünümleri sorgulayarak izleyin.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-148">Monitor the copying process by querying the sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="0e7ce-149">Kopyalama, sürerken **state_desc** yeni veritabanı için sys.databases görünümünün sütunu olarak ayarlanmış **kopyalama**.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-149">While the copying is in progress, the **state_desc** column of the sys.databases view for the new database is set to **COPYING**.</span></span>

* <span data-ttu-id="0e7ce-150">Kopyalama başarısız olursa, **state_desc** yeni veritabanı için sys.databases görünümünün sütunu olarak ayarlanmış **ŞÜPHELENİYORSANIZ**.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-150">If the copying fails, the **state_desc** column of the sys.databases view for the new database is set to **SUSPECT**.</span></span> <span data-ttu-id="0e7ce-151">Yeni veritabanında DROP deyimi yürütün ve daha sonra yeniden deneyin.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-151">Execute the DROP statement on the new database, and try again later.</span></span>
* <span data-ttu-id="0e7ce-152">Kopyalama işlemi başarılı olursa, **state_desc** yeni veritabanı için sys.databases görünümünün sütunu olarak ayarlanmış **çevrimiçi**.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-152">If the copying succeeds, the **state_desc** column of the sys.databases view for the new database is set to **ONLINE**.</span></span> <span data-ttu-id="0e7ce-153">Kopyalama tamamlandıktan ve yeni veritabanı kaynak veritabanı bağımsız olarak değiştirilebilir normal bir veritabanıdır.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-153">The copying is complete, and the new database is a regular database that can be changed independent of the source database.</span></span>

> [!NOTE]
> <span data-ttu-id="0e7ce-154">İşlemi devam ederken kopyalama iptal etmeye karar verirseniz, yürütme [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) deyimi yeni bir veritabanı üzerinde.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-154">If you decide to cancel the copying while it is in progress, execute the [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on the new database.</span></span> <span data-ttu-id="0e7ce-155">Alternatif olarak, kaynak veritabanında DROP DATABASE deyimi yürütme da kopyalama işlemini iptal eder.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-155">Alternatively, executing the DROP DATABASE statement on the source database also cancels the copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="0e7ce-156">Oturum açma bilgileri çözümleyin</span><span class="sxs-lookup"><span data-stu-id="0e7ce-156">Resolve logins</span></span>

<span data-ttu-id="0e7ce-157">Yeni veritabanı hedef sunucuda çevrimiçi olduktan sonra kullanmak [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) kullanıcılara yeni veritabanından hedef sunucuda oturum açmalar yeniden eşlemek için deyimi.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-157">After the new database is online on the destination server, use the [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement to remap the users from the new database to logins on the destination server.</span></span> <span data-ttu-id="0e7ce-158">Sahipsiz kullanıcıların çözümlemek için bkz: [sahipsiz kullanıcıların sorun giderme](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-158">To resolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="0e7ce-159">Ayrıca bkz. [olağanüstü durum kurtarma işleminden sonra Azure SQL veritabanı güvenlik yönetme](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-159">See also [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="0e7ce-160">Yeni veritabanındaki tüm kullanıcıların kaynak veritabanında sahip oldukları izinleri korur.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-160">All users in the new database retain the permissions that they had in the source database.</span></span> <span data-ttu-id="0e7ce-161">Veritabanı kopyasını başlatan kullanıcının yeni veritabanının veritabanı sahibi olur ve yeni bir güvenlik tanımlayıcısı (SID) atanır.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-161">The user who initiated the database copy becomes the database owner of the new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="0e7ce-162">Kopyalama başarılı olduktan sonra ve diğer kullanıcıların eşleştirilir önce veritabanı sahibi kopyalama, başlatılan oturum açma için yeni veritabanı oturum açabilir.</span><span class="sxs-lookup"><span data-stu-id="0e7ce-162">After the copying succeeds and before other users are remapped, only the login that initiated the copying, the database owner, can log in to the new database.</span></span>

<span data-ttu-id="0e7ce-163">Bir veritabanı farklı bir mantıksal sunucusuna kopyaladığınızda, kullanıcılar ve oturumları yönetme hakkında bilgi edinmek için [olağanüstü durum kurtarma işleminden sonra Azure SQL veritabanı güvenlik yönetme](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-163">To learn about managing users and logins when you copy a database to a different logical server, see [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="0e7ce-164">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="0e7ce-164">Next steps</span></span>

* <span data-ttu-id="0e7ce-165">Oturum açma bilgileri hakkında daha fazla bilgi için bkz: [oturumları yönetme](sql-database-manage-logins.md) ve [olağanüstü durum kurtarma işleminden sonra Azure SQL veritabanı güvenlik yönetme](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="0e7ce-166">Bir veritabanı dışarı aktarmak için bkz: [veritabanı için bir BACPAC dışarı](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="0e7ce-166">To export a database, see [Export the database to a BACPAC](sql-database-export.md).</span></span>
