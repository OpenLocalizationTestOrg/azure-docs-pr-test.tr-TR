---
title: "Bulut veritabanlarında dağıtılmış işlemler"
description: "Azure SQL Database esnek veritabanı işlemleri genel bakış"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: f7f1ad3f1933b39a0030a784cae40521254037d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="cb8c1-103">Bulut veritabanlarında dağıtılmış işlemler</span><span class="sxs-lookup"><span data-stu-id="cb8c1-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="cb8c1-104">Esnek veritabanı işlemleri için Azure SQL veritabanı (SQL DB), SQL DB birkaç veritabanlarında span işlemleri çalıştırmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you to run transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="cb8c1-105">Esnek veritabanı işlemleri için SQL DB ADO .NET kullanarak .NET uygulamaları için kullanılabilir ve tanıdık programlama deneyimi kullanarak ile tümleştirmek [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) sınıfları.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with the familiar programming experience using the [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="cb8c1-106">Kitaplık almak için bkz: [.NET Framework 4.6.1 (Web Yükleyicisi)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="cb8c1-106">To get the library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="cb8c1-107">Şirket içinde böyle bir senaryo, Microsoft Dağıtılmış İşlem Düzenleyicisi (MSDTC) çalıştıran genellikle gereklidir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="cb8c1-108">MSDTC Azure hizmet olarak Platform uygulama için kullanılabilir olmadığından, dağıtılmış işlemleri koordine yeteneği artık SQL Veritabanına doğrudan tümleştirilmiştir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, the ability to coordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="cb8c1-109">Uygulamaları dağıtılmış işlemler başlatmak için bir SQL veritabanına bağlanabilir ve veritabanlarından birini saydam dağıtılmış işlem aşağıdaki resimde gösterildiği gibi koordine.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-109">Applications can connect to any SQL Database to launch distributed transactions, and one of the databases will transparently coordinate the distributed transaction, as shown in the following figure.</span></span> 

  ![<span data-ttu-id="cb8c1-110">Dağıtılmış işlemler Azure SQL Database esnek veritabanı işlemleri kullanma</span><span class="sxs-lookup"><span data-stu-id="cb8c1-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="cb8c1-111">Genel senaryolar</span><span class="sxs-lookup"><span data-stu-id="cb8c1-111">Common scenarios</span></span>
<span data-ttu-id="cb8c1-112">Esnek veritabanı işlemleri için SQL DB uygulamaların birkaç farklı SQL veritabanlarında depolanan verileri atomik değişiklik yapmasına olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-112">Elastic database transactions for SQL DB enable applications to make atomic changes to data stored in several different SQL Databases.</span></span> <span data-ttu-id="cb8c1-113">C# ve .NET istemci-tarafı geliştirme deneyimlerinde Önizleme odaklanır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-113">The preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="cb8c1-114">T-SQL kullanarak bir sunucu tarafı deneyimi daha sonraki bir zamana planlanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="cb8c1-115">Esnek veritabanı işlemleri, aşağıdaki senaryolarda hedefler:</span><span class="sxs-lookup"><span data-stu-id="cb8c1-115">Elastic database transactions targets the following scenarios:</span></span>

* <span data-ttu-id="cb8c1-116">Azure çok veritabanı uygulamalarında: farklı veri türleri farklı veritabanlarında bulunan şekilde bu senaryoyla veri dikey SQL DB birkaç veritabanlarında genelinde bölümlenmiş.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="cb8c1-117">Bazı işlemler iki veya daha fazla veritabanlarında tutulur verilerde yapılan değişiklikleri gerektirir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-117">Some operations require changes to data which is kept in two or more databases.</span></span> <span data-ttu-id="cb8c1-118">Uygulama esnek veritabanı işlemleri değişiklikleri veritabanları arasında koordine etmek ve kararlılık sağlamak için kullanır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-118">The application uses elastic database transactions to coordinate the changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="cb8c1-119">Azure parçalı veritabanı uygulamalarında: Bu senaryo ile veri katmanı kullanan [esnek veritabanı istemci Kitaplığı](sql-database-elastic-database-client-library.md) ya da yatay SQL DB içinde birçok veritabanı arasında veri bölümlemek için self-parçalama.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-119">Sharded database applications in Azure: With this scenario, the data tier uses the [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding to horizontally partition the data across many databases in SQL DB.</span></span> <span data-ttu-id="cb8c1-120">Bir belirgin kullanım değişiklikleri kiracılar span zaman parçalı bir çok kiracılı uygulama için atomik değişiklikleri gerçekleştirmek için gereken bir durumdur.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-120">One prominent use case is the need to perform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="cb8c1-121">Örneği için bir kiracı bir aktarımı hem bulunan farklı veritabanlarını başka bir düşünün.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-121">Think for instance of a transfer from one tenant to another, both residing on different databases.</span></span> <span data-ttu-id="cb8c1-122">Hangi sırayla genellikle aynı Kiracı için kullanılan birkaç veritabanları arasında uzatmak bazı atomik işlemleri gerektiği anlamına gelir büyük bir kiracı için kapasite ihtiyaçlarını karşılamak için hassas parçalama buna ikinci bir durumdur.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-122">A second case is fine-grained sharding to accommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs to stretch across several databases used for the same tenant.</span></span> <span data-ttu-id="cb8c1-123">Veritabanları arasında çoğaltılan verilere başvurmak için atomik güncelleştirmeleri buna üçüncü bir durumdur.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-123">A third case is atomic updates to reference data that are replicated across databases.</span></span> <span data-ttu-id="cb8c1-124">Atomik, hizmetteki, işlem bu satırları boyunca önizlemeyi kullanarak birçok veritabanı arasında şimdi Eşgüdümlü.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using the preview.</span></span>
  <span data-ttu-id="cb8c1-125">Esnek veritabanı işlemleri iki aşamalı yürütme veritabanları arasında hareket kararlılık sağlamak için kullanın.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-125">Elastic database transactions use two-phase commit to ensure transaction atomicity across databases.</span></span> <span data-ttu-id="cb8c1-126">Tek bir işlem içinde her defasında 100'den az veritabanları gerektiren işlemler için iyi bir tercihtir olur.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="cb8c1-127">Bu sınırlamaları uygulanmaz ancak bir performans ve başarı oranları bu sınırları aşıldığında düşmesine esnek veritabanı işlemleri için beklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions to suffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="cb8c1-128">Yükleme ve yükseltme</span><span class="sxs-lookup"><span data-stu-id="cb8c1-128">Installation and migration</span></span>
<span data-ttu-id="cb8c1-129">SQL veritabanına esnek veritabanı işlemleri için özellikleri System.Data.dll ve System.Transactions.dll .NET kitaplıklarına Güncelleştirmeler aracılığıyla sağlanır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-129">The capabilities for elastic database transactions in SQL DB are provided through updates to the .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="cb8c1-130">DLL'leri emin olun, iki aşamalı yürütme kararlılık sağlamak üzere gerektiğinde kullanılır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-130">The DLLs ensure that two-phase commit is used where necessary to ensure atomicity.</span></span> <span data-ttu-id="cb8c1-131">Esnek veritabanı işlemleri kullanarak uygulamaları geliştirmeye başlamak için Yükle [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) veya sonraki bir sürümü.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-131">To start developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="cb8c1-132">.NET framework'ün daha eski bir sürümünde çalışan, işlemler için Dağıtılmış bir işlem yükseltmek başarısız olur ve bir özel durum oluşturuldu.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-132">When running on an earlier version of the .NET framework, transactions will fail to promote to a distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="cb8c1-133">Yükleme tamamlandıktan sonra SQL DB bağlantılarla System.Transactions içinde dağıtılmış işlem API'leri kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-133">After installation, you can use the distributed transaction APIs in System.Transactions with connections to SQL DB.</span></span> <span data-ttu-id="cb8c1-134">Bu API'leri kullanarak mevcut MSDTC uygulamalarınız varsa, yalnızca .NET 4.6 için mevcut uygulamalarınızı 4.6.1 yükledikten sonra yeniden Framework.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing the 4.6.1 Framework.</span></span> <span data-ttu-id="cb8c1-135">Projelerinizi .NET 4.6 hedefliyorsanız, otomatik olarak yeni Framework sürümü güncelleştirilmiş DLL'leri kullanır ve SQL DB bağlantıları ile birlikte API çağrılarının dağıtılmış işlem şimdi başarılı olur.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-135">If your projects target .NET 4.6, they will automatically use the updated DLLs from the new Framework version and distributed transaction API calls in combination with connections to SQL DB will now succeed.</span></span>

<span data-ttu-id="cb8c1-136">Esnek veritabanı işlem MSDTC yüklemek gerekmez unutmayın.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="cb8c1-137">Bunun yerine, esnek veritabanı işlemleri doğrudan tarafından ve SQL DB içinde yönetilir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="cb8c1-138">MSDTC dağıtımını dağıtılmış işlemler SQL DB ile kullanmak için gerekli olmadığından bu bulut senaryolarında önemli ölçüde basitleştirir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary to use distributed transactions with SQL DB.</span></span> <span data-ttu-id="cb8c1-139">4. Bölüm esnek veritabanı işlemleri ve bulut uygulamalarınıza Azure ile birlikte gerekli .NET framework dağıtma konusunda daha ayrıntılı olarak açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-139">Section 4 explains in more detail how to deploy elastic database transactions and the required .NET framework together with your cloud applications to Azure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="cb8c1-140">Geliştirme deneyimi</span><span class="sxs-lookup"><span data-stu-id="cb8c1-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="cb8c1-141">Birden çok veritabanı uygulamaları</span><span class="sxs-lookup"><span data-stu-id="cb8c1-141">Multi-database applications</span></span>
<span data-ttu-id="cb8c1-142">Aşağıdaki örnek kod tanıdık programlama deneyimi ile .NET System.Transactions kullanır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-142">The following sample code uses the familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="cb8c1-143">TransactionScope sınıfı .NET ortam bir işlemde oluşturur.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-143">The TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="cb8c1-144">(Bir "ortam" geçerli iş parçacığında bulunan bir işlemdir.) İşlemde tüm bağlantıları TransactionScope içinde açılır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-144">(An “ambient transaction” is one that lives in the current thread.) All connections opened within the TransactionScope participate in the transaction.</span></span> <span data-ttu-id="cb8c1-145">Farklı veritabanlarına katılırsanız, işlem otomatik olarak bir dağıtılmış işlem için yükseltilmiş.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-145">If different databases participate, the transaction is automatically elevated to a distributed transaction.</span></span> <span data-ttu-id="cb8c1-146">İşlem sonucunu bir yürütme belirtmek için tamamlamak için kapsam ayarlayarak denetlenir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-146">The outcome of the transaction is controlled by setting the scope to complete to indicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="cb8c1-147">Parçalı veritabanı uygulamaları</span><span class="sxs-lookup"><span data-stu-id="cb8c1-147">Sharded database applications</span></span>
<span data-ttu-id="cb8c1-148">Esnek veritabanı işlemleri için SQL DB da destek burada esnek veritabanı istemci kitaplığının OpenConnectionForKey yöntemi genişletilmiş veri bağlantıları'nı açmak için kullandığınız dağıtılmış işlemler Eşgüdümleme katmanı.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use the OpenConnectionForKey method of the elastic database client library to open connections for a scaled out data tier.</span></span> <span data-ttu-id="cb8c1-149">Burada, birkaç farklı parçalama anahtar değerleri arasında değişiklikler için işlem tutarlılığı garanti gerektirmelidir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-149">Consider cases where you need to guarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="cb8c1-150">Farklı parçalama anahtar değerleri barındırma parça bağlantıları OpenConnectionForKey kullanarak aracılı.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-150">Connections to the shards hosting the different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="cb8c1-151">İşlem Güvenceleri sağlayarak bir dağıtılmış işlem gerektirir, genel durumda farklı parça bağlantıları olabilir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-151">In the general case, the connections can be to different shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="cb8c1-152">Aşağıdaki kod örneği, bu yaklaşım gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-152">The following code sample illustrates this approach.</span></span> <span data-ttu-id="cb8c1-153">Bu, shardmap adlı bir değişken parça eşleme esnek veritabanı istemci Kitaplığı'ndan temsil etmek için kullanıldığını varsayar:</span><span class="sxs-lookup"><span data-stu-id="cb8c1-153">It assumes that a variable called shardmap is used to represent a shard map from the elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="cb8c1-154">.NET yüklemesi için Azure bulut Hizmetleri</span><span class="sxs-lookup"><span data-stu-id="cb8c1-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="cb8c1-155">Azure birkaç teklifleri .NET uygulamalarını barındırmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-155">Azure provides several offerings to host .NET applications.</span></span> <span data-ttu-id="cb8c1-156">Farklı teklifleri karşılaştırması kullanılabilir [Azure App Service, Cloud Services ve sanal makineler karşılaştırması](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="cb8c1-156">A comparison of the different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="cb8c1-157">Konuk işletim sistemi sunumun .NET 4.6.1 esnek işlemleri için gereken daha küçükse 4.6.1 için konuk işletim sistemini yükseltme yapmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-157">If the guest OS of the offering is smaller than .NET 4.6.1 required for elastic transactions, you need to upgrade the guest OS to 4.6.1.</span></span> 

<span data-ttu-id="cb8c1-158">Azure uygulama hizmetleri için konuk işletim sistemi yükseltmeleri şu anda desteklenmemektedir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-158">For Azure App Services, upgrades to the guest OS are currently not supported.</span></span> <span data-ttu-id="cb8c1-159">Azure Virtual Machines için yalnızca VM oturum ve en son .NET framework için yükleyiciyi çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-159">For Azure Virtual Machines, simply log into the VM and run the installer for the latest .NET framework.</span></span> <span data-ttu-id="cb8c1-160">Azure bulut Hizmetleri için başlangıç görevleri, dağıtımınızın daha yeni bir .NET sürüm yüklemesine eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-160">For Azure Cloud Services, you need to include the installation of a newer .NET version into the startup tasks of your deployment.</span></span> <span data-ttu-id="cb8c1-161">Kavramlar ve adımlar belgelenmiştir [bir bulut hizmet rolü .NET yükleme](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="cb8c1-161">The concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="cb8c1-162">.NET 4.6.1 yükleyici .NET 4.6 için Azure bulut hizmetlerine Yükleyici daha önyükleme işlemi sırasında daha fazla geçici depolama alanı gerektirebilir unutmayın.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-162">Note that the installer for .NET 4.6.1 may require more temporary storage during the bootstrapping process on Azure cloud services than the installer for .NET 4.6.</span></span> <span data-ttu-id="cb8c1-163">Yüklemenin başarılı olmak için Azure bulut hizmetinize LocalResources bölüm ve ortam ayarları, başlangıç görevinin ServiceDefinition.csdef dosyanızdaki geçici depolama artırmak aşağıdaki örnekte gösterildiği gibi gerekir:</span><span class="sxs-lookup"><span data-stu-id="cb8c1-163">To ensure a successful installation, you need to increase temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in the LocalResources section and the environment settings of your startup task, as shown in the following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="cb8c1-164">Birden çok sunucudaki işlemleri</span><span class="sxs-lookup"><span data-stu-id="cb8c1-164">Transactions across multiple servers</span></span>
<span data-ttu-id="cb8c1-165">Esnek veritabanı işlemleri, Azure SQL veritabanında mantıksal farklı sunucular arasında desteklenir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="cb8c1-166">Mantıksal sunucu sınırları işlemler arası olduğunda, Katılımcı sunucular ilk karşılıklı iletişim ilişkisi girilmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-166">When transactions cross logical server boundaries, the participating servers first need to be entered into a mutual communication relationship.</span></span> <span data-ttu-id="cb8c1-167">İletişim ilişki kurulduktan sonra iki sunuculardan herhangi biri herhangi bir veritabanında diğer sunucusundan veritabanlarıyla esnek işlemlerde yer alabilir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-167">Once the communication relationship has been established, any database in any of the two servers can participate in elastic transactions with databases from the other server.</span></span> <span data-ttu-id="cb8c1-168">İkiden fazla mantıksal sunucularının genişleme işlemleri ile iletişim ilişkisi mantıksal sunucularının herhangi bir çifti için yerinde olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-168">With transactions spanning more than two logical servers, a communication relationship needs to be in place for any pair of logical servers.</span></span>

<span data-ttu-id="cb8c1-169">Esnek veritabanı işlemleri için sunucular arası iletişim ilişkilerini yönetmek için aşağıdaki PowerShell cmdlet'lerini kullanın:</span><span class="sxs-lookup"><span data-stu-id="cb8c1-169">Use the following PowerShell cmdlets to manage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="cb8c1-170">**AzureRmSqlServerCommunicationLink yeni**: Azure SQL DB mantıksal iki sunucu arasında yeni bir iletişim ilişki oluşturmak için bu cmdlet'i kullanın.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet to create a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="cb8c1-171">Her iki sunucuyu diğer sunucusuyla işlemler başlatabilir yani simetrik ilişkidir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-171">The relationship is symmetric which means both servers can initiate transactions with the other server.</span></span>
* <span data-ttu-id="cb8c1-172">**Get-AzureRmSqlServerCommunicationLink**: Varolan iletişimi ilişkileri ve özellikleri almak için bu cmdlet'i kullanın.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet to retrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="cb8c1-173">**Remove-AzureRmSqlServerCommunicationLink**: varolan bir iletişim ilişkiyi kaldırmak için bu cmdlet'i kullanın.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet to remove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="cb8c1-174">İşlem durumunu izleme</span><span class="sxs-lookup"><span data-stu-id="cb8c1-174">Monitoring transaction status</span></span>
<span data-ttu-id="cb8c1-175">Dinamik Yönetim görünümlerini (Dmv'leri) SQL DB durumunu izleyin ve ilerleme durumunu, devam eden esnek veritabanı işlemleri için kullanın.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-175">Use Dynamic Management Views (DMVs) in SQL DB to monitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="cb8c1-176">İşlemler için ilgili tüm Dmv'leri SQL DB dağıtılmış işlemlere ilgilidir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-176">All DMVs related to transactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="cb8c1-177">Karşılık gelen listesini Dmv'leri burada bulabilirsiniz: [işlem ilgili dinamik yönetim görünümlerini ve işlevleri (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="cb8c1-177">You can find the corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="cb8c1-178">Bu Dmv'leri özellikle yararlı olur:</span><span class="sxs-lookup"><span data-stu-id="cb8c1-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="cb8c1-179">**sys.DM\_tran\_etkin\_işlemleri**: geçerli durumda etkin işlemlerin ve durumlarını listeler.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="cb8c1-180">UOW (iş birimi) sütun aynı dağıtılmış işlem ait farklı alt işlemleri tanımlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-180">The UOW (Unit Of Work) column can identify the different child transactions that belong to the same distributed transaction.</span></span> <span data-ttu-id="cb8c1-181">Tüm işlemler aynı dağıtılmış işlem dahilinde aynı UOW değeri taşır.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-181">All transactions within the same distributed transaction carry the same UOW value.</span></span> <span data-ttu-id="cb8c1-182">Bkz: [DMV belgelerine](https://msdn.microsoft.com/library/ms174302.aspx) daha fazla ayrıntı için.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-182">See the [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="cb8c1-183">**sys.DM\_tran\_veritabanı\_işlemleri**: işlem günlüğünde yerleştirme gibi işlemleri hakkında ek bilgi sağlar.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of the transaction in the log.</span></span> <span data-ttu-id="cb8c1-184">Bkz: [DMV belgelerine](https://msdn.microsoft.com/library/ms186957.aspx) daha fazla ayrıntı için.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-184">See the [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="cb8c1-185">**sys.DM\_tran\_kilitleri**: şu anda devam eden işlemler tarafından tutulan kilitleri hakkında bilgi sağlar.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-185">**sys.dm\_tran\_locks**: Provides information about the locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="cb8c1-186">Bkz: [DMV belgelerine](https://msdn.microsoft.com/library/ms190345.aspx) daha fazla ayrıntı için.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-186">See the [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="cb8c1-187">Sınırlamalar</span><span class="sxs-lookup"><span data-stu-id="cb8c1-187">Limitations</span></span>
<span data-ttu-id="cb8c1-188">Aşağıdaki sınırlamalar şu anda SQL veritabanına esnek veritabanı işlemleri için geçerlidir:</span><span class="sxs-lookup"><span data-stu-id="cb8c1-188">The following limitations currently apply to elastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="cb8c1-189">Yalnızca işlemleri SQL DB veritabanları arasında desteklenir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="cb8c1-190">Diğer [X / açmak XA](https://en.wikipedia.org/wiki/X/Open_XA) kaynak sağlayıcıları ve veritabanları SQL DB dışına esnek veritabanı işlemleri katılmak olamaz.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="cb8c1-191">Esnek veritabanı işlemleri arasında şirket içinde SQL Server ve Azure SQL veritabanları uzatma edilemez olduğunu anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="cb8c1-192">Şirket içi dağıtılmış işlemler için MSDTC kullanmaya devam edin.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-192">For distributed transactions on premises, continue to use MSDTC.</span></span> 
* <span data-ttu-id="cb8c1-193">Yalnızca istemci Eşgüdümlü işlemleri bir .NET uygulamasında desteklenir.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="cb8c1-194">T-SQL BEGIN TRANSACTION dağıtılmış gibi sunucu tarafı desteği, planlanmış, ancak henüz kullanılamıyor.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="cb8c1-195">WCF hizmetleri üzerinden işlemleri desteklenmez.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="cb8c1-196">Örneğin, bir işlem yürüten bir WCF Hizmeti yöntemine sahip.</span><span class="sxs-lookup"><span data-stu-id="cb8c1-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="cb8c1-197">Bir işlem kapsamı içinde çağrı kapsayan başarısız olur olarak bir [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="cb8c1-197">Enclosing the call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="cb8c1-198">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="cb8c1-198">Next steps</span></span>
<span data-ttu-id="cb8c1-199">Sorular için lütfen bize üzerinde ulaşmak [SQL veritabanı Forumu](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) ve özellik istekler için lütfen bunları Ekle [SQL veritabanı geri bildirim Forumunda](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="cb8c1-199">For questions, please reach out to us on the [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them to the [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



