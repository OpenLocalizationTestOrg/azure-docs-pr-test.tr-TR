---
title: "Tasarım Azure SQL veritabanı kullanarak yüksek oranda kullanılabilir hizmet | Microsoft Docs"
description: "Uygulama tasarımı için Azure SQL veritabanı kullanarak yüksek oranda kullanılabilir hizmetler hakkında bilgi edinin."
keywords: "Bulut olağanüstü durum kurtarma, olağanüstü durum kurtarma çözümleri, uygulama veri yedekleme, coğrafi çoğaltma, iş sürekliliği planlama"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: e8a346ac-dd08-41e7-9685-46cebca04582
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-management
ms.date: 04/21/2017
ms.author: sashan
ms.openlocfilehash: 40fe0ae04eb94322356ed19773512e3bc383639c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/11/2017
---
# <a name="designing-highly-available-services-using-azure-sql-database"></a><span data-ttu-id="e8e7d-104">Azure SQL veritabanı kullanarak yüksek oranda kullanılabilir hizmetler tasarlama</span><span class="sxs-lookup"><span data-stu-id="e8e7d-104">Designing highly available services using Azure SQL Database</span></span>

<span data-ttu-id="e8e7d-105">Derleme ve Azure SQL veritabanı yüksek oranda kullanılabilir hizmetleri dağıtma, kullandığınız [yük devretme grupları ve etkin coğrafi çoğaltma](sql-database-geo-replication-overview.md) bölgesel arızalara ve geri dönülemez kesintileri esnekliği sağlar ve Hızlı Kurtarma etkinleştirmek için ikincil veritabanları.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-105">When building and deploying highly available services on Azure SQL Database, you use [failover groups and active geo-replication](sql-database-geo-replication-overview.md) to provide resilience to regional failures and catastrophic outages and enable fast recovery to the secondary databases.</span></span> <span data-ttu-id="e8e7d-106">Bu makale üzerinde ortak uygulama düzenleri odaklanır ve avantajları ve dengelemeler hedefleme, hizmet düzeyi sözleşmesi uygulama dağıtım gereksinimlerine bağlı olarak her seçenekle ele almaktadır trafiği gecikme ve maliyetlerin.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-106">This article focuses on common application patterns and discusses the benefits and trade-offs of each option depending on the application deployment requirements, the service level agreement you are targeting, traffic latency, and costs.</span></span> <span data-ttu-id="e8e7d-107">Esnek havuzlar etkin coğrafi çoğaltma hakkında daha fazla bilgi için bkz: [esnek havuz olağanüstü durum kurtarma stratejilerini](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="e8e7d-107">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

## <a name="design-pattern-1-active-passive-deployment-for-cloud-disaster-recovery-with-a-co-located-database"></a><span data-ttu-id="e8e7d-108">Tasarım deseni 1: Aktif-Pasif dağıtım birlikte bulunan bir veritabanı ile bulut olağanüstü durum kurtarma</span><span class="sxs-lookup"><span data-stu-id="e8e7d-108">Design pattern 1: Active-passive deployment for cloud disaster recovery with a co-located database</span></span>
<span data-ttu-id="e8e7d-109">Bu seçenek aşağıdaki özelliklere sahip uygulamalar için uygundur:</span><span class="sxs-lookup"><span data-stu-id="e8e7d-109">This option is best suited for applications with the following characteristics:</span></span>

* <span data-ttu-id="e8e7d-110">Tek bir Azure bölgesindeki etkin örneği</span><span class="sxs-lookup"><span data-stu-id="e8e7d-110">Active instance in a single Azure region</span></span>
* <span data-ttu-id="e8e7d-111">Veri okuma-yazma (RW) erişimi güçlü bağımlılığı</span><span class="sxs-lookup"><span data-stu-id="e8e7d-111">Strong dependency on read-write (RW) access to data</span></span>
* <span data-ttu-id="e8e7d-112">Bölgeler arası bağlantı web uygulaması ve veritabanı arasındaki gecikme süresi ve trafik maliyet nedeniyle kabul edilebilir değil</span><span class="sxs-lookup"><span data-stu-id="e8e7d-112">Cross-region connectivity between the web application and the database is not acceptable due to latency and traffic cost</span></span>    

<span data-ttu-id="e8e7d-113">Bu durumda, uygulama dağıtım topolojisi tüm uygulama bileşenleri etkilendiğini ve yük devretme birimi olarak gerektiğinde bölgesel afetler işlemek için optimize edilmiştir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-113">In this case, the application deployment topology is optimized for handling regional disasters when all application components are impacted and need to failover as a unit.</span></span> <span data-ttu-id="e8e7d-114">Coğrafi artıklık için uygulama mantığını ve veritabanı başka bir bölgeye çoğaltılır, ancak normal koşullar altında uygulama iş yükü için kullanılmaz.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-114">For geographic redundancy, the application logic and the database are replicated to another region but they are not used for the application workload under the normal conditions.</span></span> <span data-ttu-id="e8e7d-115">İkincil bölge uygulamada bir ikincil veritabanına SQL bağlantı dizesi kullanmak için yapılandırılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-115">The application in the secondary region should be configured to use a SQL connection string to the secondary database.</span></span> <span data-ttu-id="e8e7d-116">Trafik Yöneticisi kullanmak üzere ayarlandı [yük devretme yönlendirme yöntemini](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="e8e7d-116">Traffic manager is set up to use [failover routing method](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span></span>  

> [!NOTE]
> <span data-ttu-id="e8e7d-117">[Azure trafik Yöneticisi](../traffic-manager/traffic-manager-overview.md) bu makalede yalnızca gösterim amacıyla kullanılmıştır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-117">[Azure traffic manager](../traffic-manager/traffic-manager-overview.md) is used throughout this article for illustration purposes only.</span></span> <span data-ttu-id="e8e7d-118">Yük devretme yönlendirme yöntemini destekleyen hiçbir yük dengeleme çözümü kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-118">You can use any load-balancing solution that supports failover routing method.</span></span>    
>

<span data-ttu-id="e8e7d-119">Aşağıdaki diyagramda bu yapılandırma bir kesinti önce gösterir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-119">The following diagram shows this configuration before an outage.</span></span>

![SQL Database coğrafi çoğaltma yapılandırması.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-1.png)

<span data-ttu-id="e8e7d-122">Birincil bölgede kesinti sonrasında, SQL veritabanı hizmetinin birincil veritabanı erişilebilir değil ve otomatik yük devretme İlkesi parametrelere bağlı olarak ikincil veritabanı için bir yük devretme tetiklemek algılar.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-122">After an outage in the primary region, the SQL Database service detects that the primary database is not accessible and trigger a failover to the secondary database based on the parameters of the automatic failover policy.</span></span> <span data-ttu-id="e8e7d-123">Uygulama SLA bağlı olarak, kesinti algılanmasını ve yük devretme kendisi arasında bir yetkisiz kullanım süresi yapılandırmak karar verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-123">Depending on your application SLA, you can decide to configure a grace period between the detection of the outage and the failover itself.</span></span> <span data-ttu-id="e8e7d-124">Yetkisiz kullanım süresi yapılandırma burada kesinti yıkıcı ve kullanılabilirlik bölgede hızlı bir şekilde geri yüklenemez durumlarda veri kaybı riskini azaltır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-124">Configuring a grace period reduces the risk of data loss to the cases where the outage is catastrophic and availability in the region cannot be quickly restored.</span></span> <span data-ttu-id="e8e7d-125">Yük devretme grubu veritabanının yük devretmeyi tetikler önce uç nokta yük devretme trafik Yöneticisi tarafından başlatılır, web uygulaması veritabanına yeniden mümkün değildir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-125">If the endpoint failover is initiated by the traffic manager before the failover group triggers the failover of the database, the web application is not able to reconnect to the database.</span></span> <span data-ttu-id="e8e7d-126">Veritabanı yük devretme tamamlandıktan hemen sonra uygulamanın otomatik olarak yeniden denemesi başarılı olur.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-126">The application’s attempt to reconnect automatically succeeds as soon as the database failover completes.</span></span> 

> [!NOTE]
> <span data-ttu-id="e8e7d-127">Uygulama ve veritabanlarının tam olarak Eşgüdümlü yük devretme elde etmek için izleme yönteminizi insanlara ve web uygulama uç ve veritabanlarını el ile yük devretme kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-127">To achieve fully coordinated failover of the application and the databases, you should devise your own monitoring method and use manual failover of the web application endpoints and the databases.</span></span>
>

<span data-ttu-id="e8e7d-128">Uygulama uç noktaları ve veritabanı için yük devretme işlemi tamamlandıktan sonra uygulama B bölgede kullanıcı isteklerini işleme yeniden başlar ve birincil veritabanı artık B. bölgede olduğundan veritabanı ile birlikte bulunan kalacak Bu senaryo aşağıdaki çizimde gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-128">After the failover of both the application’s endpoints and the database completes, the application will re-start processing the user requests in the region B and will remain co-located with the database because the primary database is now in region B. This scenario is illustrated in the following diagram.</span></span> <span data-ttu-id="e8e7d-129">Tüm diyagramlarındaki Kesiksiz çizgi etkin bağlantıları göstermek, noktalı çizgiler askıya alınmış bağlantıları gösterir ve eylem Tetikleyicileri Durma işareti gösterir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-129">In all diagrams, solid lines indicate active connections, dotted lines indicate suspended connections, and stop signs indicate action triggers.</span></span>

![Coğrafi çoğaltma: Yük devretme ikincil veritabanına.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-2.png)

<span data-ttu-id="e8e7d-132">İkincil bölge'de bir kesinti oluşursa, birincil ve ikincil veritabanı arasındaki çoğaltma bağlantısını askıya alındı ancak birincil veritabanı etkilenmez çünkü yük devretme tetiklenmez.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-132">If an outage happens in the secondary region, the replication link between the primary and the secondary database is suspended but the failover is not triggered because the primary database is not impacted.</span></span> <span data-ttu-id="e8e7d-133">Uygulama kullanılabilirliği bu durumda, değiştirilmez ancak uygulama gösterilen çalışır ve bu nedenle durumda yüksek risk art arda iki bölgeler başarısız.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-133">The application's availability is not changed in this case, but the application operates exposed and therefore at higher risk in case both regions fail in succession.</span></span>

> [!NOTE]
> <span data-ttu-id="e8e7d-134">Olağanüstü durum kurtarma için iki bölgede uygulama dağıtımı sınırlı yapılandırmayla öneririz.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-134">For disaster recovery we recommend the configuration with application deployment limited to two regions.</span></span> <span data-ttu-id="e8e7d-135">Azure farklı coğrafyalara çoğunu yalnızca iki bölgede sahip olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-135">This is because most of the Azure geographies have only two regions.</span></span> <span data-ttu-id="e8e7d-136">Bu yapılandırma, uygulamanızın hem bölgeler bir eşzamanlı geri dönülemez hatasından koruma sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-136">This configuration will not protect your application from a simultaneous catastrophic failure of both regions.</span></span>  <span data-ttu-id="e8e7d-137">Bu tür bir hatanın olası olayda, veritabanlarınızı üçüncü bölge kullanarak kurtarabilirsiniz [coğrafi geri yükleme işlemi](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="e8e7d-137">In an unlikely event of such a failure, you can recover your databases in a third region using [geo-restore operation](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span>
>

<span data-ttu-id="e8e7d-138">Kesinti azaltıldığından sonra ikincil veritabanı otomatik olarak birincil ile yeniden eşitler.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-138">Once the outage is mitigated, the secondary database will automatically re-synchronize with the primary.</span></span> <span data-ttu-id="e8e7d-139">Eşitleme sırasında birincil performansını eşitlenmesi için gereken veri miktarı bağlı olarak biraz etkilenebilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-139">During synchronization, performance of the primary could be slightly impacted depending on the amount of data that needs to be synchronized.</span></span> <span data-ttu-id="e8e7d-140">Aşağıdaki diyagram, kesinti ikincil bölge içinde gösterir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-140">The following diagram illustrates an outage in the secondary region.</span></span>

![İkincil veritabanının birincil ile eşitlenmiş.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-3.png)

<span data-ttu-id="e8e7d-143">Anahtar **avantajları** bu tasarım modeli şunlardır:</span><span class="sxs-lookup"><span data-stu-id="e8e7d-143">The key **advantages** of this design pattern are:</span></span>

* <span data-ttu-id="e8e7d-144">Aynı web uygulamasını hem bölgeler herhangi bir bölgeye özgü yapılandırma ve yük devretmeyi tepki vermek için ilave bir mantık olmadan dağıtılır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-144">The same web application is deployed to both regions without any region-specific configuration and no additional logic to react to the failover.</span></span> 
* <span data-ttu-id="e8e7d-145">Yük devretme web uygulaması olarak uygulama performansı etkilenmez ve veritabanı birlikte bulunan her zaman.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-145">The application's performance is not impacted by failover as the web application and the database are always co-located.</span></span>

<span data-ttu-id="e8e7d-146">Ana **kolaylığını** ikincil bölge olarak yedekli uygulama örneğinde yalnızca olağanüstü durum kurtarma için kullanılan.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-146">The main **tradeoff** is that the redundant application instance in the secondary region is only used for disaster recovery.</span></span>

## <a name="design-pattern-2-active-active-deployment-for-application-load-balancing"></a><span data-ttu-id="e8e7d-147">Tasarım deseni 2: uygulama Yük Dengeleme için etkin-etkin dağıtım</span><span class="sxs-lookup"><span data-stu-id="e8e7d-147">Design pattern 2: Active-active deployment for application load balancing</span></span>
<span data-ttu-id="e8e7d-148">Bu bulut olağanüstü durum kurtarma seçeneğini aşağıdaki özelliklere sahip uygulamalar için uygundur:</span><span class="sxs-lookup"><span data-stu-id="e8e7d-148">This cloud disaster recovery option is best suited for applications with the following characteristics:</span></span>

* <span data-ttu-id="e8e7d-149">Veritabanı okuma yazma işlemleri için yüksek oranı</span><span class="sxs-lookup"><span data-stu-id="e8e7d-149">High ratio of database reads to writes</span></span>
* <span data-ttu-id="e8e7d-150">Veritabanı yazma gecikmesi için son kullanıcı deneyimi daha önemli okuma gecikmesi</span><span class="sxs-lookup"><span data-stu-id="e8e7d-150">Database read latency is more critical for the end-user experience than the write latency</span></span> 
* <span data-ttu-id="e8e7d-151">Farklı bir bağlantı dizesi kullanarak, salt okunur mantığı okuma-yazma mantığından ayrılabilir</span><span class="sxs-lookup"><span data-stu-id="e8e7d-151">Read-only logic can be separated from read-write logic by using a different connection string</span></span>
* <span data-ttu-id="e8e7d-152">Salt okunur mantığı en son güncelleştirmeleri ile tam olarak eşitlenmekte olan veriler üzerinde bağlı değildir</span><span class="sxs-lookup"><span data-stu-id="e8e7d-152">Read-only logic does not depend on data being fully synchronized with the latest updates</span></span>  

<span data-ttu-id="e8e7d-153">Bu özelliklere uygulamalarınız varsa, son kullanıcı bağlantıları arasında birden fazla uygulama örneğinin de farklı bölgelerdeki dengelemesini genel son kullanıcı deneyimi önemli ölçüde artırabilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-153">If your applications have these characteristics, load balancing the end-user connections across multiple application instances in different regions can substantially improve the overall end-user experience.</span></span> <span data-ttu-id="e8e7d-154">İki bölgelerinin DR çifti olarak seçilmesi gerekir ve yük devretme grubu bu bölgede veritabanlarını içermelidir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-154">Two of the regions should be selected as the DR pair and the failover group should include the databases in these regions.</span></span> <span data-ttu-id="e8e7d-155">Yük Dengeleme uygulamak için her bölge uygulama etkin bir örneği yük devretme grubunun okuma-yazma dinleyicisi uç noktasına bağlı okuma-yazma (RW) mantığı ile olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-155">To implement load-balancing, each region should have an active instance of the application with the read-write (RW) logic connected to the read-write listener endpoint of the failover group.</span></span> <span data-ttu-id="e8e7d-156">Birincil veritabanında bir kesinti durumunda etkilenip, yük devretme'nin otomatik olarak başlatılan garanti.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-156">It will guarantee that the failover will be automatically initiated if the primary database is impacted by an outage.</span></span> <span data-ttu-id="e8e7d-157">Salt okunur mantık (RO) web uygulaması, bu bölgedeki veritabanına doğrudan bağlanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-157">The read-only logic (RO) in the web application should connect directly to the database in that region.</span></span> <span data-ttu-id="e8e7d-158">Trafik Yöneticisi ayarlanmalıdır kullanmak için [performans yönlendirme](../traffic-manager/traffic-manager-configure-performance-routing-method.md) ile [uç nokta izleme](../traffic-manager/traffic-manager-monitoring.md) her bir uygulama örneği için etkinleştirilmiş.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-158">Traffic manager should be set up to use [performance routing](../traffic-manager/traffic-manager-configure-performance-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for each application instance.</span></span>

<span data-ttu-id="e8e7d-159">#1 deseniyle olduğu gibi benzer bir izleme uygulaması dağıtmayı düşünmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-159">As in pattern #1, you should consider deploying a similar monitoring application.</span></span> <span data-ttu-id="e8e7d-160">Ancak #1 deseniyle izleme uygulama uç nokta yük devretme tetiklemek için sorumlu olmaz.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-160">But unlike pattern #1, the monitoring application will not be responsible for triggering the end-point failover.</span></span>

> [!NOTE]
> <span data-ttu-id="e8e7d-161">Bu deseni birden fazla ikincil veritabanı kullanıyor, ancak ikincil bölge b yalnızca yük devretme için kullanılacak ve yük devretme grubunun bir parçası olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-161">While this pattern uses more than one secondary database, only the secondary in Region B  would be used for failover and should be part of the failover group.</span></span>
>

<span data-ttu-id="e8e7d-162">Trafik Yöneticisi performansı doğrudan kullanıcının coğrafi konuma yakın uygulama örneği için kullanıcı bağlantılar için yönlendirme için yapılandırılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-162">Traffic manager should be configured for performance routing to direct the user connections to the application instance closest to the user's geographic location.</span></span> <span data-ttu-id="e8e7d-163">Aşağıdaki diyagramda bu yapılandırma bir kesinti önce gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-163">The following diagram illustrates this configuration before an outage.</span></span>

![Hiçbir kesinti: performans için en yakın uygulama yönlendirme.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-1.png)

<span data-ttu-id="e8e7d-166">Bir bölgede bir veritabanı kesinti algılanırsa, yük devretme grubu otomatik olarak B. bölgede ikincil bir bölgeye birincil veritabanının yük devretmesi başlatır Okuma-yazma bağlantıları web uygulamasında değil etkilenecek şekilde bölge B okuma-yazma dinleyicisi uç nokta da otomatik olarak güncelleştirilecektir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-166">If a database outage is detected in the region A, the failover group will automatically initiate failover of the primary database in region A to the secondary in region B. It will also automatically update the read-write listener endpoint to region B so read-write connections in the web application will not be impacted.</span></span> <span data-ttu-id="e8e7d-167">Trafik Yöneticisi çevrimdışı son nokta yönlendirme tablosundan dışlayacak ancak geri kalan çevrimiçi örneklerine son kullanıcı trafik yönlendirme devam eder.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-167">The traffic manager will exclude the offline end-point from the routing table but will continue routing the end-user traffic to the remaining online instances.</span></span> <span data-ttu-id="e8e7d-168">Bunlar her zaman aynı bölgede veritabanı üzerine gibi salt okunur SQL bağlantı dizelerini etkilenmiş değil.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-168">The read-only SQL connection strings will not be impacted as they always point to the database in the same region.</span></span> 

<span data-ttu-id="e8e7d-169">Aşağıdaki diyagram, yük devretme sonrasında yeni yapılandırmayı gösterir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-169">The following diagram illustrates the new configuration after the failover.</span></span>

![Yük devretme sonrasında yapılandırması.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-2.png)

<span data-ttu-id="e8e7d-172">İkincil bölgeler birinde kesinti durumunda, trafik Yöneticisi otomatik olarak çevrimdışı uç noktası bu bölgede yönlendirme tablosundan kaldırır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-172">In case of an outage in one of the secondary regions, the traffic manager will automatically remove the offline end-point in that region from the routing table.</span></span> <span data-ttu-id="e8e7d-173">Bu bölgede ikincil veritabanı çoğaltma kanala askıya alınır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-173">The replication channel to the secondary database in that region will be suspended.</span></span> <span data-ttu-id="e8e7d-174">Kalan bölgeleri Bu senaryoda ek kullanıcı trafiği aldığından sırasında kesinti uygulamanızın performansı etkilenir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-174">Because the remaining regions get additional user traffic in this scenario, the application's performance will be impacted during the outage.</span></span> <span data-ttu-id="e8e7d-175">Kesinti azaltıldığından sonra etkilenen bölgede ikincil veritabanı hemen birincil ile eşitlenir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-175">Once the outage is mitigated, the secondary database in the impacted region will be immediately synchronized with the primary.</span></span> <span data-ttu-id="e8e7d-176">Eşitleme sırasında birincil performansını eşitlenmesi için gereken veri miktarı bağlı olarak biraz etkilenebilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-176">During the synchronization performance of the primary could be slightly impacted depending on the amount of data that needs to be synchronized.</span></span> <span data-ttu-id="e8e7d-177">Aşağıdaki diyagram kesinti B. bölgede gösterir</span><span class="sxs-lookup"><span data-stu-id="e8e7d-177">The following diagram illustrates an outage in region B.</span></span>

![Kesinti ikincil bölge içinde.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-3.png)

<span data-ttu-id="e8e7d-180">Anahtar **avantajı** bu düzeni arasında birden fazla ikincil en iyi son kullanıcı performans elde etmek için uygulama iş yükü ölçeklendirebilirsiniz tasarımdır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-180">The key **advantage** of this design pattern is that you can scale the application workload across multiple secondaries to achieve the optimal end-user performance.</span></span> <span data-ttu-id="e8e7d-181">**Dengelerin** bu seçeneği şunlardır:</span><span class="sxs-lookup"><span data-stu-id="e8e7d-181">The **tradeoffs** of this option are:</span></span>

* <span data-ttu-id="e8e7d-182">Uygulama örnekleri ile veritabanı arasındaki okuma-yazma bağlantıları değişen gecikme süresi ve maliyet gerekir</span><span class="sxs-lookup"><span data-stu-id="e8e7d-182">Read-write connections between the application instances and database have varying latency and cost</span></span>
* <span data-ttu-id="e8e7d-183">Kesinti sırasında uygulama performansı etkilenir</span><span class="sxs-lookup"><span data-stu-id="e8e7d-183">Application performance is impacted during the outage</span></span>

> [!NOTE]
> <span data-ttu-id="e8e7d-184">Benzer bir yaklaşım, raporlama işleri, iş zekası araçları veya yedekleme gibi özelleştirilmiş iş yükleri boşaltmak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-184">A similar approach can be used to offload specialized workloads such as reporting jobs, business intelligence tools, or backups.</span></span> <span data-ttu-id="e8e7d-185">Genellikle, bu iş yükleri önemli veritabanı kaynaklarını tüketebilir bu nedenle, ikincil veritabanlarından birini kendileri için beklenen iş yükü için eşleşen performans düzeyiyle atamanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-185">Typically, these workloads consume significant database resources therefore it is recommended that you designate one of the secondary databases for them with the performance level matched to the anticipated workload.</span></span>
>

## <a name="design-pattern-3-active-passive-deployment-for-data-preservation"></a><span data-ttu-id="e8e7d-186">Tasarım deseni 3: Aktif-Pasif dağıtımı için veri koruma</span><span class="sxs-lookup"><span data-stu-id="e8e7d-186">Design pattern 3: Active-passive deployment for data preservation</span></span>
<span data-ttu-id="e8e7d-187">Bu seçenek aşağıdaki özelliklere sahip uygulamalar için uygundur:</span><span class="sxs-lookup"><span data-stu-id="e8e7d-187">This option is best suited for applications with the following characteristics:</span></span>

* <span data-ttu-id="e8e7d-188">Tüm veri kayıplarını yüksek iş sorununa neden olur.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-188">Any data loss is high business risk.</span></span> <span data-ttu-id="e8e7d-189">Kesinti yıkıcı ise veritabanı yük devretme yalnızca son çare olarak kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-189">The database failover can only be used as a last resort if the outage is catastrophic.</span></span>
* <span data-ttu-id="e8e7d-190">Uygulama işlemlerinin salt okunur ve okuma-yazma modlarını destekler ve "salt okunur modda" bir süre çalışabilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-190">The application supports read-only and read-write modes of operations and can operate in "read-only mode" for a period of time.</span></span>

<span data-ttu-id="e8e7d-191">Okuma-yazma bağlantı zaman aşımı hataları alma başlattığınızda bu modelinde uygulama salt okunur moda geçer.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-191">In this pattern, the application switches to read-only mode when the read-write connections start getting time-out errors.</span></span> <span data-ttu-id="e8e7d-192">Web uygulaması hem bölgelere dağıtılan ve okuma-yazma dinleyicisi uç noktası bağlantısı ve salt okunur dinleyicisi uç noktası için farklı bağlantı içerir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-192">The Web Application is deployed to both regions and include a connection to the read-write listener endpoint and different connection to the read-only listener endpoint.</span></span> <span data-ttu-id="e8e7d-193">Trafik Yöneticisi'ni kullanmak için ayarlanması gereken [yük devretme yönlendirme](../traffic-manager/traffic-manager-configure-failover-routing-method.md) ile [uç nokta izleme](../traffic-manager/traffic-manager-monitoring.md) her bölgede uygulama uç noktası için etkinleştirilmiş.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-193">The Traffic manager should be set up to use [failover routing](../traffic-manager/traffic-manager-configure-failover-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for the application endpoint in each region.</span></span>

<span data-ttu-id="e8e7d-194">Aşağıdaki diyagramda bu yapılandırma bir kesinti önce gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-194">The following diagram illustrates this configuration before an outage.</span></span>

![Yük devretme önce Aktif-Pasif dağıtımı.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-1.png)

<span data-ttu-id="e8e7d-197">Trafik Yöneticisi bir bölge için bir bağlantı hatası algıladığında, bu otomatik olarak kullanıcı trafiğinin B. bölgede uygulama örneğine geçer Bu desen ile veri kaybı yetkisiz kullanım süresi yeterince yüksek bir değere örneğin 24 saat ayarladığınız önemlidir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-197">When the traffic manager detects a connectivity failure to region A, it automatically switches user traffic to the application instance in region B. With this pattern, it is important that you set the grace period with data loss to a sufficiently high value, e.g. 24 hours.</span></span> <span data-ttu-id="e8e7d-198">Bu süre içinde kesinti azaltıldığından, veri kaybı önlenmiş olur sağlayacaktır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-198">It will ensure that data loss is prevented if the outage is mitigated within that time.</span></span> <span data-ttu-id="e8e7d-199">Web uygulaması B bölgede etkinleştirildiğinde okuma-yazma işlemleri başarısız olmaya başlar.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-199">When the Web application in the region B is activated the read-write operations will start failing.</span></span> <span data-ttu-id="e8e7d-200">Bu noktada, salt okunur moda geçmesi.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-200">At that point, it should switch to the read-only mode.</span></span> <span data-ttu-id="e8e7d-201">Bu modda istekleri otomatik olarak ikincil veritabanına yönlendirilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-201">In this mode the requests will be automatically routed to the secondary database.</span></span> <span data-ttu-id="e8e7d-202">Yıkıcı bir hata durumunda hizmet kesintisi yetkisiz kullanım süresi içinde azaltılması gereken değil ve yük devretme grubu yük devretmeyi tetikler.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-202">In the case of a catastrophic failure the outage will not be mitigated within the grace period and the failover group will trigger the failover.</span></span> <span data-ttu-id="e8e7d-203">Sonra okuma-yazma dinleyicisi kullanılabilir olacağı ve başarısız olan çağrılar durdurur.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-203">After that the read-write listener will become available and the calls to it will stop failing.</span></span> <span data-ttu-id="e8e7d-204">Bu tarafından Aşağıdaki diyagramda gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-204">This is illustrated by the following diagram.</span></span>

![Kesinti: Uygulama salt okunur modda.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-2.png)

<span data-ttu-id="e8e7d-207">Kesinti birincil bölge içinde yetkisiz kullanım süresi içinde azaltılan, trafik Yöneticisi bağlantı geri birincil bölgede algılar ve kullanıcı trafiğinin A. bölgede uygulama örneğine geri geçer Bu uygulama örneği sürdürür ve birincil veritabanı A. bölgede kullanarak okuma-yazma modunda çalışır</span><span class="sxs-lookup"><span data-stu-id="e8e7d-207">If the outage in the primary region is mitigated within the grace period, traffic manager detects the restoration of connectivity in the primary region and switches user traffic back to the application instance in region A. That application instance resumes and operates in read-write mode using the primary database in region A.</span></span>

<span data-ttu-id="e8e7d-208">Uygulama uç noktası B bölgede başarısızlığını ve yük devretme grubu anahtarları salt okunur dinleyicisi bölgeye a B bölgede kesinti durumunda, trafik Yöneticisi algılar Bu kesinti için son kullanıcı deneyimi olumsuz etkilemez ancak birincil veritabanı kesinti sırasında sunulur.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-208">In case of an outage in the region B, the traffic manager detects the failure of the application end-point in region B and the failover group switches the read-only listener to region A. This outage does not impact the end-user experience but the primary database will be exposed during the outage.</span></span> <span data-ttu-id="e8e7d-209">Bu tarafından Aşağıdaki diyagramda gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-209">This is illustrated by the following diagram.</span></span>

![Kesinti: İkincil veritabanı.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-3.png)

<span data-ttu-id="e8e7d-212">Kesinti azaltıldığından sonra ikincil veritabanını hemen birincil ile eşitlenir ve salt okunur dinleyicisi B. bölgede ikincil veritabanına geri çevrilir Eşitleme sırasında birincil performansını eşitlenmesi için gereken veri miktarı bağlı olarak biraz etkilenebilir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-212">Once the outage is mitigated, the secondary database is immediately synchronized with the primary and the read-only listener is switched back to the secondary database in region B. During synchronization performance of the primary could be slightly impacted depending on the amount of data that needs to be synchronized.</span></span>

<span data-ttu-id="e8e7d-213">Bu tasarım deseni vardır **avantajları**:</span><span class="sxs-lookup"><span data-stu-id="e8e7d-213">This design pattern has several **advantages**:</span></span>

* <span data-ttu-id="e8e7d-214">Geçici kesintileri sırasında veri kaybı ortadan kaldırır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-214">It avoids data loss during the temporary outages.</span></span>
* <span data-ttu-id="e8e7d-215">Kapalı kalma süresi yalnızca nasıl hızlı bir şekilde trafik Yöneticisi yapılandırılabilir bağlantı hatası algılar üzerinde bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-215">Downtime depends only on how quickly traffic manager detects the connectivity failure, which is configurable.</span></span>

<span data-ttu-id="e8e7d-216">**Kolaylığını** değil:</span><span class="sxs-lookup"><span data-stu-id="e8e7d-216">The **tradeoff** is:</span></span>

* <span data-ttu-id="e8e7d-217">Uygulamanın salt okunur modda çalışabilir olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-217">Application must be able to operate in read-only mode.</span></span>

> [!NOTE]
> <span data-ttu-id="e8e7d-218">Bir kalıcı hizmet kesintisi bölgede olması durumunda, el ile veritabanı yük devretme etkinleştirmek ve veri kaybını kabul edin.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-218">In case of a permanent service outage in the region, you manually activate database failover and accept the data loss.</span></span> <span data-ttu-id="e8e7d-219">Uygulama veritabanı için okuma-yazma erişimi olan ikincil bölge işlevsel olacaktır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-219">The application will be functional in the secondary region with read-write access to the database.</span></span>
>

## <a name="business-continuity-planning-choose-an-application-design-for-cloud-disaster-recovery"></a><span data-ttu-id="e8e7d-220">İş sürekliliği planlama: Bulut olağanüstü durum kurtarma için bir uygulama tasarımı seçin</span><span class="sxs-lookup"><span data-stu-id="e8e7d-220">Business continuity planning: Choose an application design for cloud disaster recovery</span></span>
<span data-ttu-id="e8e7d-221">Özel bulut olağanüstü durum kurtarma stratejiniz birleştirebilir veya en iyi uygulamanızın ihtiyaçlarını karşılamak için bu tasarım desenleri genişletir.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-221">Your specific cloud disaster recovery strategy can combine or extend these design patterns to best meet the needs of your application.</span></span>  <span data-ttu-id="e8e7d-222">Daha önce belirtildiği gibi seçtiğiniz stratejisi müşterileriniz ve uygulama dağıtım topolojisi sunmak isteyebilirsiniz SLA temel alır.</span><span class="sxs-lookup"><span data-stu-id="e8e7d-222">As mentioned earlier, the strategy you choose is based on the SLA you want to offer to your customers and the application deployment topology.</span></span> <span data-ttu-id="e8e7d-223">Kararınızı rehberlik için aşağıdaki tabloda, tahmini veri kaybı tabanlı seçenekleri karşılaştırılmaktadır veya kurtarma noktası hedefi (RPO) ve tahmini kurtarma süresi (Ekle).</span><span class="sxs-lookup"><span data-stu-id="e8e7d-223">To help guide your decision, the following table compares the choices based on the estimated data loss or recovery point objective (RPO) and estimated recovery time (ERT).</span></span>

| <span data-ttu-id="e8e7d-224">düzeni</span><span class="sxs-lookup"><span data-stu-id="e8e7d-224">Pattern</span></span> | <span data-ttu-id="e8e7d-225">RPO</span><span class="sxs-lookup"><span data-stu-id="e8e7d-225">RPO</span></span> | <span data-ttu-id="e8e7d-226">EKLE</span><span class="sxs-lookup"><span data-stu-id="e8e7d-226">ERT</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="e8e7d-227">Aktif-Pasif dağıtım birlikte bulunan veritabanı erişimi olan olağanüstü durum kurtarma</span><span class="sxs-lookup"><span data-stu-id="e8e7d-227">Active-passive deployment for disaster recovery with co-located database access</span></span> |<span data-ttu-id="e8e7d-228">Okuma-yazma erişimi < 5 saniye</span><span class="sxs-lookup"><span data-stu-id="e8e7d-228">Read-write access < 5 sec</span></span> |<span data-ttu-id="e8e7d-229">Hata algılama süresi + DNS TTL</span><span class="sxs-lookup"><span data-stu-id="e8e7d-229">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="e8e7d-230">Uygulama Yük Dengeleme için etkin-etkin dağıtım</span><span class="sxs-lookup"><span data-stu-id="e8e7d-230">Active-active deployment for application load balancing</span></span> |<span data-ttu-id="e8e7d-231">Okuma-yazma erişimi < 5 saniye</span><span class="sxs-lookup"><span data-stu-id="e8e7d-231">Read-write access < 5 sec</span></span> |<span data-ttu-id="e8e7d-232">Hata algılama süresi + DNS TTL</span><span class="sxs-lookup"><span data-stu-id="e8e7d-232">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="e8e7d-233">Veri koruma için Aktif-Pasif dağıtımı</span><span class="sxs-lookup"><span data-stu-id="e8e7d-233">Active-passive deployment for data preservation</span></span> |<span data-ttu-id="e8e7d-234">Salt okunur erişim < 5 saniye</span><span class="sxs-lookup"><span data-stu-id="e8e7d-234">Read-only access < 5 sec</span></span> | <span data-ttu-id="e8e7d-235">Salt okunur erişim = 0</span><span class="sxs-lookup"><span data-stu-id="e8e7d-235">Read-only access = 0</span></span> |
||<span data-ttu-id="e8e7d-236">Okuma-yazma erişimi sıfır =</span><span class="sxs-lookup"><span data-stu-id="e8e7d-236">Read-write access = zero</span></span> | <span data-ttu-id="e8e7d-237">Okuma-yazma erişimi = hatası algılama zamanı + veri kaybı yetkisiz kullanım süresi</span><span class="sxs-lookup"><span data-stu-id="e8e7d-237">Read-write access = Failure detection time + grace period with data loss</span></span> |
|||

## <a name="next-steps"></a><span data-ttu-id="e8e7d-238">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="e8e7d-238">Next steps</span></span>
* <span data-ttu-id="e8e7d-239">Veritabanı Yedeklemeleri otomatik Azure SQL hakkında bilgi edinmek için bkz: [SQL veritabanı otomatik yedeklemeler](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="e8e7d-239">To learn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="e8e7d-240">İş sürekliliğine genel bakış ve senaryolar için bkz: [iş sürekliliğine genel bakış](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="e8e7d-240">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="e8e7d-241">Kurtarma için otomatik yedeklemeler kullanma hakkında bilgi edinmek için bkz: [bir veritabanı hizmeti tarafından başlatılan yedeklerden geri yükleme](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="e8e7d-241">To learn about using automated backups for recovery, see [restore a database from the service-initiated backups](sql-database-recovery-using-backups.md)</span></span>
* <span data-ttu-id="e8e7d-242">Daha hızlı kurtarma seçenekleri hakkında bilgi edinmek için [aktif coğrafi çoğaltma](sql-database-geo-replication-overview.md)</span><span class="sxs-lookup"><span data-stu-id="e8e7d-242">To learn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md)</span></span>  
* <span data-ttu-id="e8e7d-243">Arşivleme için otomatik yedeklemeler kullanma hakkında bilgi edinmek için bkz: [veritabanı kopyalama](sql-database-copy.md)</span><span class="sxs-lookup"><span data-stu-id="e8e7d-243">To learn about using automated backups for archiving, see [database copy](sql-database-copy.md)</span></span>
* <span data-ttu-id="e8e7d-244">Esnek havuzlar etkin coğrafi çoğaltma hakkında daha fazla bilgi için bkz: [esnek havuz olağanüstü durum kurtarma stratejilerini](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="e8e7d-244">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
