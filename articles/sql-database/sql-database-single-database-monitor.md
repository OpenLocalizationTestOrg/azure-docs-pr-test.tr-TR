---
title: "Azure SQL veritabanında aaaMonitoring veritabanı performansı | Microsoft Docs"
description: "Azure araçlarını ve dinamik yönetim görünümlerini kullanarak veritabanınızı izleme hello seçenekleri hakkında bilgi edinin."
keywords: "veritabanı izleme, bulut veritabanı performansı"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: a2e47475-c955-4a8d-a65c-cbef9a6d9b9f
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 01/10/2017
ms.author: carlrab
ms.openlocfilehash: b13771183d4ccf37f58e2fc518b9b14de38212dc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="monitoring-database-performance-in-azure-sql-database"></a><span data-ttu-id="37618-104">Azure SQL Database'de veritabanı performansını izleme</span><span class="sxs-lookup"><span data-stu-id="37618-104">Monitoring database performance in Azure SQL Database</span></span>
<span data-ttu-id="37618-105">Azure SQL veritabanında Hello performansının izlenmesi hello kaynak kullanım göreli toohello düzeyi, seçtiğiniz veritabanı performans izleme ile başlar.</span><span class="sxs-lookup"><span data-stu-id="37618-105">Monitoring hello performance of a SQL database in Azure starts with monitoring hello resource utilization relative toohello level of database performance you choose.</span></span> <span data-ttu-id="37618-106">İzleme yardımcı olur, veritabanınızın gerekenden fazla kapasiteye sahip veya çıkışı kaynak kullanımının çünkü zorlanıyor belirlemek ve ardından saat tooadjust hello performans düzeyi olup olmadığına karar vermek ve [hizmet katmanı](sql-database-service-tiers.md) veritabanınızın.</span><span class="sxs-lookup"><span data-stu-id="37618-106">Monitoring helps you  determine whether your database has excess capacity or is having trouble because resources are maxed out, and then decide whether it's time tooadjust hello performance level and [service tier](sql-database-service-tiers.md) of your database.</span></span> <span data-ttu-id="37618-107">Grafik araçları hello kullanarak veritabanını izleyebilirsiniz [Azure portal](https://portal.azure.com) veya SQL kullanarak [dinamik yönetim görünümlerini](https://msdn.microsoft.com/library/ms188754.aspx).</span><span class="sxs-lookup"><span data-stu-id="37618-107">You can monitor your database using graphical tools in hello [Azure portal](https://portal.azure.com) or using SQL [dynamic management views](https://msdn.microsoft.com/library/ms188754.aspx).</span></span>

## <a name="monitor-databases-using-hello-azure-portal"></a><span data-ttu-id="37618-108">Hello Azure portalını kullanarak veritabanlarını izleme</span><span class="sxs-lookup"><span data-stu-id="37618-108">Monitor databases using hello Azure portal</span></span>
<span data-ttu-id="37618-109">Merhaba, [Azure portal](https://portal.azure.com/), tek veritabanlarının kullanımını veritabanınızı seçip hello tıklayarak izleyebilirsiniz **izleme** grafik.</span><span class="sxs-lookup"><span data-stu-id="37618-109">In hello [Azure portal](https://portal.azure.com/), you can monitor a single database’s utilization by selecting your database and clicking hello **Monitoring** chart.</span></span> <span data-ttu-id="37618-110">Bu işlem sonrasında bir **ölçüm** hello tıklatarak değiştirebilirsiniz penceresi **grafiği Düzenle** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="37618-110">This brings up a **Metric** window that you can change by clicking hello **Edit chart** button.</span></span> <span data-ttu-id="37618-111">Ölçümleri aşağıdaki hello ekleyin:</span><span class="sxs-lookup"><span data-stu-id="37618-111">Add hello following metrics:</span></span>

* <span data-ttu-id="37618-112">CPU yüzdesi</span><span class="sxs-lookup"><span data-stu-id="37618-112">CPU percentage</span></span>
* <span data-ttu-id="37618-113">DTU yüzdesi</span><span class="sxs-lookup"><span data-stu-id="37618-113">DTU percentage</span></span>
* <span data-ttu-id="37618-114">Veri G/Ç yüzdesi</span><span class="sxs-lookup"><span data-stu-id="37618-114">Data IO percentage</span></span>
* <span data-ttu-id="37618-115">Veri boyutu yüzdesi</span><span class="sxs-lookup"><span data-stu-id="37618-115">Database size percentage</span></span>

<span data-ttu-id="37618-116">Bu ölçümleri ekledikten sonra tooview devam edebilirsiniz hello bunları **izleme** hello hakkında daha fazla ayrıntı içeren grafik **ölçüm** penceresi.</span><span class="sxs-lookup"><span data-stu-id="37618-116">Once you’ve added these metrics, you can continue tooview them in hello **Monitoring** chart with more details on hello **Metric** window.</span></span> <span data-ttu-id="37618-117">Dört ölçümün tümü hello ortalama kullanım yüzdesi göreli toohello Göster **DTU** veritabanınızın.</span><span class="sxs-lookup"><span data-stu-id="37618-117">All four metrics show hello average utilization percentage relative toohello **DTU** of your database.</span></span> <span data-ttu-id="37618-118">Merhaba bkz [hizmet katmanları](sql-database-service-tiers.md) makale Dtu'lar hakkında ayrıntılı bilgi için.</span><span class="sxs-lookup"><span data-stu-id="37618-118">See hello [service tiers](sql-database-service-tiers.md) article for details about DTUs.</span></span>

![Hizmet katmanına göre veritabanı performansını izleme.](./media/sql-database-service-tiers/sqldb_service_tier_monitoring.png)

<span data-ttu-id="37618-120">Merhaba performans ölçümleri uyarıları da yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-120">You can also configure alerts on hello performance metrics.</span></span> <span data-ttu-id="37618-121">Merhaba tıklatın **uyarı Ekle** hello düğmesini **ölçüm** penceresi.</span><span class="sxs-lookup"><span data-stu-id="37618-121">Click hello **Add alert** button in hello **Metric** window.</span></span> <span data-ttu-id="37618-122">Merhaba Sihirbazı tooconfigure Uyarınız izleyin.</span><span class="sxs-lookup"><span data-stu-id="37618-122">Follow hello wizard tooconfigure your alert.</span></span> <span data-ttu-id="37618-123">Merhaba ölçümleri belirli bir eşiği aşması veya hello ölçüm belirli bir eşiğin altına düşerse hello seçeneği tooalert sahip.</span><span class="sxs-lookup"><span data-stu-id="37618-123">You have hello option tooalert if hello metrics exceed a certain threshold or if hello metric falls below a certain threshold.</span></span>

<span data-ttu-id="37618-124">Örneğin, hello iş yükü, veritabanı toogrow bekliyorsanız, tooconfigure bir e-posta uyarı seçebilirsiniz, veritabanınızı % 80'hello performans ölçümleri hiçbirinde eriştiğinde.</span><span class="sxs-lookup"><span data-stu-id="37618-124">For example, if you expect hello workload on your database toogrow, you can choose tooconfigure an email alert whenever your database reaches 80% on any of hello performance metrics.</span></span> <span data-ttu-id="37618-125">Ne zaman tooswitch toohello sonraki daha yüksek performans düzeyine sahip olmayabilirsiniz çıkışı erken bir uyarı toofigure olarak kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-125">You can use this as an early warning toofigure out when you might have tooswitch toohello next higher performance level.</span></span>

<span data-ttu-id="37618-126">Merhaba performans ölçümleri mümkün toodowngrade tooa daha düşük performans düzeyine olup olmadıklarını belirlemek de yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="37618-126">hello performance metrics can also help you determine if you are able toodowngrade tooa lower performance level.</span></span> <span data-ttu-id="37618-127">Standart S2 veritabanını kullandığınızı ve veritabanı ortalama hello tüm performans ölçümleri Göster % 10'dan daha fazla belirli bir zamanda kullanmaz varsayalım.</span><span class="sxs-lookup"><span data-stu-id="37618-127">Assume you are using a Standard S2 database and all performance metrics show that hello database on average does not use more than 10% at any given time.</span></span> <span data-ttu-id="37618-128">Merhaba veritabanının standart S1'de iyi çalışır olasıdır.</span><span class="sxs-lookup"><span data-stu-id="37618-128">It is likely that hello database will work well in Standard S1.</span></span> <span data-ttu-id="37618-129">Ancak, ani değişiklik veya dalgalanma hello karar toomove tooa daha düşük performans düzeyine yapmadan önce iş yüklerini farkında olun.</span><span class="sxs-lookup"><span data-stu-id="37618-129">However, be aware of workloads that spike or fluctuate before making hello decision toomove tooa lower performance level.</span></span>

## <a name="monitor-databases-using-dmvs"></a><span data-ttu-id="37618-130">DMV'leri kullanarak veritabanlarını izleme</span><span class="sxs-lookup"><span data-stu-id="37618-130">Monitor databases using DMVs</span></span>
<span data-ttu-id="37618-131">Merhaba hello portalda kullanıma sunulan ölçümler aynı de sistem görünümleri aracılığıyla kullanılabilir: [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) hello mantıksal olarak **ana** veritabanı sunucunuzun ve [sys.dm_db_ resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) hello kullanıcı veritabanında.</span><span class="sxs-lookup"><span data-stu-id="37618-131">hello same metrics that are exposed in hello portal are also available through system views: [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) in hello logical **master** database of your server, and [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) in hello user database.</span></span> <span data-ttu-id="37618-132">Kullanım **sys.resource_stats** daha uzun bir süre toomonitor daha az ayrıntılı veri gerekiyorsa.</span><span class="sxs-lookup"><span data-stu-id="37618-132">Use **sys.resource_stats** if you need toomonitor less granular data across a longer period of time.</span></span> <span data-ttu-id="37618-133">Kullanım **sys.dm_db_resource_stats** toomonitor ihtiyacınız varsa daha küçük bir zaman çerçevesi içinde daha ayrıntılı veri.</span><span class="sxs-lookup"><span data-stu-id="37618-133">Use **sys.dm_db_resource_stats** if you need toomonitor more granular data within a smaller time frame.</span></span> <span data-ttu-id="37618-134">Daha fazla bilgi için bkz. [Azure SQL Database Performans Rehberi](sql-database-single-database-monitor.md#monitor-resource-use).</span><span class="sxs-lookup"><span data-stu-id="37618-134">For more information, see [Azure SQL Database Performance Guidance](sql-database-single-database-monitor.md#monitor-resource-use).</span></span>

> [!NOTE]
> <span data-ttu-id="37618-135">**sys.dm_db_resource_stats**, Web ve İşletme sürümü veritabanlarında (bu sürümler kullanımdan kaldırılmıştır) kullanıldığında boş bir sonuç kümesi getirir.</span><span class="sxs-lookup"><span data-stu-id="37618-135">**sys.dm_db_resource_stats** returns an empty result set when used in Web and Business edition databases, which are retired.</span></span>
>
>

### <a name="monitor-resource-use"></a><span data-ttu-id="37618-136">Kaynak kullanımını izleme</span><span class="sxs-lookup"><span data-stu-id="37618-136">Monitor resource use</span></span>

<span data-ttu-id="37618-137">Kaynak kullanım kullanarak izleyebilirsiniz [SQL veritabanı sorgu performansı öngörüleri](sql-database-query-performance.md) ve [Query Store](https://msdn.microsoft.com/library/dn817826.aspx).</span><span class="sxs-lookup"><span data-stu-id="37618-137">You can monitor resource usage using [SQL Database Query Performance Insight](sql-database-query-performance.md) and [Query Store](https://msdn.microsoft.com/library/dn817826.aspx).</span></span>

<span data-ttu-id="37618-138">Bu iki görünüm kullanarak kullanımı da izleyebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="37618-138">You can also monitor usage using these two views:</span></span>

* [<span data-ttu-id="37618-139">sys.dm_db_resource_stats</span><span class="sxs-lookup"><span data-stu-id="37618-139">sys.dm_db_resource_stats</span></span>](https://msdn.microsoft.com/library/dn800981.aspx)
* [<span data-ttu-id="37618-140">sys.resource_stats</span><span class="sxs-lookup"><span data-stu-id="37618-140">sys.resource_stats</span></span>](https://msdn.microsoft.com/library/dn269979.aspx)

#### <a name="sysdmdbresourcestats"></a><span data-ttu-id="37618-141">sys.dm_db_resource_stats</span><span class="sxs-lookup"><span data-stu-id="37618-141">sys.dm_db_resource_stats</span></span>
<span data-ttu-id="37618-142">Merhaba kullanabilirsiniz [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) her SQL veritabanını görünümünde.</span><span class="sxs-lookup"><span data-stu-id="37618-142">You can use hello [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) view in every SQL database.</span></span> <span data-ttu-id="37618-143">Merhaba **sys.dm_db_resource_stats** görünüm son kaynak kullanım verileri göreli toohello hizmet katmanı gösterir.</span><span class="sxs-lookup"><span data-stu-id="37618-143">hello **sys.dm_db_resource_stats** view shows recent resource use data relative toohello service tier.</span></span> <span data-ttu-id="37618-144">Ortalama CPU, veri g/ç, günlük yazma ve bellek yüzdelerini 15 dakikada kaydedilir ve 1 saat boyunca saklanır.</span><span class="sxs-lookup"><span data-stu-id="37618-144">Average percentages for CPU, data I/O, log writes, and memory are recorded every 15 seconds and are maintained for 1 hour.</span></span>

<span data-ttu-id="37618-145">Bu görünüm kaynak kullanımını daha ayrıntılı bir bakış sağladığından, kullanın **sys.dm_db_resource_stats** tüm geçerli durumu çözümleme için ilk ya da sorun giderme.</span><span class="sxs-lookup"><span data-stu-id="37618-145">Because this view provides a more granular look at resource use, use **sys.dm_db_resource_stats** first for any current-state analysis or troubleshooting.</span></span> <span data-ttu-id="37618-146">Örneğin, bu sorgu hello ortalama ve en yüksek kaynak hello geçerli veritabanı için hello son bir saat gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="37618-146">For example, this query shows hello average and maximum resource use for hello current database over hello past hour:</span></span>

    SELECT  
        AVG(avg_cpu_percent) AS 'Average CPU use in percent',
        MAX(avg_cpu_percent) AS 'Maximum CPU use in percent',
        AVG(avg_data_io_percent) AS 'Average data I/O in percent',
        MAX(avg_data_io_percent) AS 'Maximum data I/O in percent',
        AVG(avg_log_write_percent) AS 'Average log write use in percent',
        MAX(avg_log_write_percent) AS 'Maximum log write use in percent',
        AVG(avg_memory_usage_percent) AS 'Average memory use in percent',
        MAX(avg_memory_usage_percent) AS 'Maximum memory use in percent'
    FROM sys.dm_db_resource_stats;  

<span data-ttu-id="37618-147">Diğer sorgular için hello örneklere bakın [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span><span class="sxs-lookup"><span data-stu-id="37618-147">For other queries, see hello examples in [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span></span>

#### <a name="sysresourcestats"></a><span data-ttu-id="37618-148">sys.resource_stats</span><span class="sxs-lookup"><span data-stu-id="37618-148">sys.resource_stats</span></span>
<span data-ttu-id="37618-149">Merhaba [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) hello görünümünde **ana** veritabanının bulunduğu SQL veritabanınızın belirli hizmet katmanını ve performans düzeyinde hello performansını izlemenize yardımcı olacak ek bilgiler .</span><span class="sxs-lookup"><span data-stu-id="37618-149">hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) view in hello **master** database has additional information that can help you monitor hello performance of your SQL database at its specific service tier and performance level.</span></span> <span data-ttu-id="37618-150">Merhaba veriler her 5 dakikada bir toplanan ve yaklaşık 35 gün boyunca tutulur.</span><span class="sxs-lookup"><span data-stu-id="37618-150">hello data is collected every 5 minutes and is maintained for approximately 35 days.</span></span> <span data-ttu-id="37618-151">Bu görünüm, SQL veritabanınız kaynakları nasıl kullandığını, daha uzun vadeli bir geçmiş analize kullanışlıdır.</span><span class="sxs-lookup"><span data-stu-id="37618-151">This view is useful for a longer-term historical analysis of how your SQL database uses resources.</span></span>

<span data-ttu-id="37618-152">Merhaba aşağıdaki grafik Itanium tabanlı sistemler için hello CPU kaynak kullanımı hello P2 performans düzeyine sahip bir Premium veritabanı için her bir saat için bir hafta içinde gösterir.</span><span class="sxs-lookup"><span data-stu-id="37618-152">hello following graph shows hello CPU resource use for a Premium database with hello P2 performance level for each hour in a week.</span></span> <span data-ttu-id="37618-153">Bu grafik Pazartesi günü başlar, 5 iş günlerini gösterir ve hafta sonu gösterir, hello uygulaması üzerinde çok az olur.</span><span class="sxs-lookup"><span data-stu-id="37618-153">This graph starts on a Monday, shows 5 work days, and then shows a weekend, when much less happens on hello application.</span></span>

![SQL veritabanı kaynak kullanımı](./media/sql-database-performance-guidance/sql_db_resource_utilization.png)

<span data-ttu-id="37618-155">Merhaba verileri, bu veritabanı şu anda en yüksek CPU yükünü sahip yüzde 50'ten sadece CPU kullanımı göreli toohello P2 performans düzeyi (Öğle saati Salı günü).</span><span class="sxs-lookup"><span data-stu-id="37618-155">From hello data, this database currently has a peak CPU load of just over 50 percent CPU use relative toohello P2 performance level (midday on Tuesday).</span></span> <span data-ttu-id="37618-156">CPU hello uygulamanın kaynak profilinde hello baskın faktörü ise, P2 hello iş yükü her zaman hello performans düzeyi tooguarantee uygun doğru olduğunu karar verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-156">If CPU is hello dominant factor in hello application’s resource profile, then you might decide that P2 is hello right performance level tooguarantee that hello workload always fits.</span></span> <span data-ttu-id="37618-157">Zaman içinde bir uygulama toogrow bekliyorsanız, hello uygulama herhangi bir zamanda hello performans düzeyi sınırına ulaştığında değil iyi bir fikir toohave bir ek kaynak arabellek, böylelikle.</span><span class="sxs-lookup"><span data-stu-id="37618-157">If you expect an application toogrow over time, it's a good idea toohave an extra resource buffer so that hello application doesn't ever reach hello performance-level limit.</span></span> <span data-ttu-id="37618-158">Merhaba performans düzeyini artırmak için bir veritabanı yeterli güç tooprocess istekleri özellikle gecikme süresine duyarlı ortamlarında etkili bir şekilde sahip olmadığında ortaya çıkabilir müşteri görünür hataları önlemenize yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="37618-158">If you increase hello performance level, you can help avoid customer-visible errors that might occur when a database doesn't have enough power tooprocess requests effectively, especially in latency-sensitive environments.</span></span> <span data-ttu-id="37618-159">Örnek Web sayfalarını veritabanı çağrılarını hello sonuçlarına dayalı boyar uygulamanın destekleyen bir veritabanıdır.</span><span class="sxs-lookup"><span data-stu-id="37618-159">An example is a database that supports an application that paints webpages based on hello results of database calls.</span></span>

<span data-ttu-id="37618-160">Diğer uygulama türleriyle aynı farklı grafik hello yorumlayabilir.</span><span class="sxs-lookup"><span data-stu-id="37618-160">Other application types might interpret hello same graph differently.</span></span> <span data-ttu-id="37618-161">Örneğin, bir uygulama tooprocess bordro verileri her gün çalışır ve olan hello aynı grafik, "toplu" modelinin bu tür P1 performans düzeyi ince uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-161">For example, if an application tries tooprocess payroll data each day and has hello same chart, this kind of "batch job" model might do fine at a P1 performance level.</span></span> <span data-ttu-id="37618-162">Merhaba P1 performans düzeyi 100 karşılaştırıldığında Dtu'lar too200 Dtu'lar P2 performans düzeyi hello sahiptir.</span><span class="sxs-lookup"><span data-stu-id="37618-162">hello P1 performance level has 100 DTUs compared too200 DTUs at hello P2 performance level.</span></span> <span data-ttu-id="37618-163">Merhaba P1 performans düzeyi hello P2 performans düzeyi yarım hello performansını sağlar.</span><span class="sxs-lookup"><span data-stu-id="37618-163">hello P1 performance level provides half hello performance of hello P2 performance level.</span></span> <span data-ttu-id="37618-164">Bu nedenle, yüzde 50 ' P2 CPU kullanımı yüzde 100 CPU P1 kullanımda eşittir.</span><span class="sxs-lookup"><span data-stu-id="37618-164">So, 50 percent of CPU use in P2 equals 100 percent CPU use in P1.</span></span> <span data-ttu-id="37618-165">Merhaba uygulaması zaman aşımları yoksa, bir iş 2 saat veya 2.5 saat toofinish sürerse bugün bitti olup olmaması önemli değil.</span><span class="sxs-lookup"><span data-stu-id="37618-165">If hello application does not have timeouts, it might not matter if a job takes 2 hours or 2.5 hours toofinish, if it gets done today.</span></span> <span data-ttu-id="37618-166">Bu kategorideki bir uygulama, büyük olasılıkla P1 performans düzeyi kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-166">An application in this category probably can use a P1 performance level.</span></span> <span data-ttu-id="37618-167">Böylece tüm "büyük yoğun" Merhaba troughs birine daha sonra hello gün içinde sığdırmaya kaynak kullanımının düşük olduğunda hello gün sırasında süreler olduğunu hello olayının avantajından yararlanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-167">You can take advantage of hello fact that there are periods of time during hello day when resource use is lower, so that any "big peak" might spill over into one of hello troughs later in hello day.</span></span> <span data-ttu-id="37618-168">Merhaba işleri her gün saat bitirebilirsiniz sürece hello P1 performans düzeyi için bu türden uygulamasının (ve tasarruf) iyi olabilir.</span><span class="sxs-lookup"><span data-stu-id="37618-168">hello P1 performance level might be good for that kind of application (and save money), as long as hello jobs can finish on time each day.</span></span>

<span data-ttu-id="37618-169">Azure SQL veritabanı çıkarır tüketilen hello etkin her veritabanı için kaynak bilgileri **sys.resource_stats** hello görünümünü **ana** her sunucu veritabanında.</span><span class="sxs-lookup"><span data-stu-id="37618-169">Azure SQL Database exposes consumed resource information for each active database in hello **sys.resource_stats** view of hello **master** database in each server.</span></span> <span data-ttu-id="37618-170">Merhaba tablosunda Hello veri için 5 dakikalık aralıklarla toplanır.</span><span class="sxs-lookup"><span data-stu-id="37618-170">hello data in hello table is aggregated for 5-minute intervals.</span></span> <span data-ttu-id="37618-171">Bu verileri neredeyse gerçek zamanlı analiz yerine geçmiş çözümleme için daha yararlı olacak şekilde hello temel, standart ve Premium hizmet katmanları ile Merhaba verileri birden çok 5 dakika tooappear hello tabloda alabilir.</span><span class="sxs-lookup"><span data-stu-id="37618-171">With hello Basic, Standard, and Premium service tiers, hello data can take more than 5 minutes tooappear in hello table, so this data is more useful for historical analysis rather than near-real-time analysis.</span></span> <span data-ttu-id="37618-172">Sorgu hello **sys.resource_stats** toosee hello bir veritabanı ve gerektiğinde istediğiniz hello performans teslim olup hello ayırma seçtiğiniz toovalidate yakın zamandaki geçmişini görüntüle.</span><span class="sxs-lookup"><span data-stu-id="37618-172">Query hello **sys.resource_stats** view toosee hello recent history of a database and toovalidate whether hello reservation you chose delivered hello performance you want when needed.</span></span>

> [!NOTE]
> <span data-ttu-id="37618-173">Bağlı toohello olmalıdır **ana** , mantıksal SQL veritabanı sunucusu tooquery veritabanı **sys.resource_stats** örnek hello içinde.</span><span class="sxs-lookup"><span data-stu-id="37618-173">You must be connected toohello **master** database of your logical SQL database server tooquery **sys.resource_stats** in hello following examples.</span></span>
> 
> 

<span data-ttu-id="37618-174">Bu örnek nasıl hello verileri bu görünümde gösterilen gösterir:</span><span class="sxs-lookup"><span data-stu-id="37618-174">This example shows you how hello data in this view is exposed:</span></span>

    SELECT TOP 10 *
    FROM sys.resource_stats
    WHERE database_name = 'resource1'
    ORDER BY start_time DESC

![Merhaba sys.resource_stats Katalog görünümü](./media/sql-database-performance-guidance/sys_resource_stats.png)

<span data-ttu-id="37618-176">Merhaba sonraki örnek, hello kullanabileceğiniz farklı yolları gösterir **sys.resource_stats** katalog SQL veritabanınız kaynakları nasıl kullandığı hakkında tooget bilgileri görüntüle:</span><span class="sxs-lookup"><span data-stu-id="37618-176">hello next example shows you different ways that you can use hello **sys.resource_stats** catalog view tooget information about how your SQL database uses resources:</span></span>

1. <span data-ttu-id="37618-177">Geçen haftaki kaynak hello adresindeki toolook hello veritabanı userdb1 kullanın, bu sorguyu çalıştırabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="37618-177">toolook at hello past week’s resource use for hello database userdb1, you can run this query:</span></span>
   
        SELECT *
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND
              start_time > DATEADD(day, -7, GETDATE())
        ORDER BY start_time DESC;
2. <span data-ttu-id="37618-178">İş yükünüzün uygun hello performans düzeyine ne kadar iyi tooevaluate, gereksinim duyduğunuz toodrill aşağı hello kaynak ölçümleri her yönden: CPU, okuma, yazma, çalışan sayısı ve oturum sayısı.</span><span class="sxs-lookup"><span data-stu-id="37618-178">tooevaluate how well your workload fits hello performance level, you need toodrill down into each aspect of hello resource metrics: CPU, reads, writes, number of workers, and number of sessions.</span></span> <span data-ttu-id="37618-179">İşte bir düzeltilmiş kullanarak sorgu **sys.resource_stats** tooreport hello ortalama ve en yüksek değerleri bu kaynak ölçümleri:</span><span class="sxs-lookup"><span data-stu-id="37618-179">Here's a revised query using **sys.resource_stats** tooreport hello average and maximum values of these resource metrics:</span></span>
   
        SELECT
            avg(avg_cpu_percent) AS 'Average CPU use in percent',
            max(avg_cpu_percent) AS 'Maximum CPU use in percent',
            avg(avg_data_io_percent) AS 'Average physical data I/O use in percent',
            max(avg_data_io_percent) AS 'Maximum physical data I/O use in percent',
            avg(avg_log_write_percent) AS 'Average log write use in percent',
            max(avg_log_write_percent) AS 'Maximum log write use in percent',
            avg(max_session_percent) AS 'Average % of sessions',
            max(max_session_percent) AS 'Maximum % of sessions',
            avg(max_worker_percent) AS 'Average % of workers',
            max(max_worker_percent) AS 'Maximum % of workers'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
3. <span data-ttu-id="37618-180">Bu her kaynak ölçümü ile Merhaba ortalama ve en yüksek değerleri hakkında bilgi yükünüzü seçtiğiniz hello performans düzeyi ne kadar iyi uyduğunu değerlendirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-180">With this information about hello average and maximum values of each resource metric, you can assess how well your workload fits into hello performance level you chose.</span></span> <span data-ttu-id="37618-181">Genellikle, değerleri ortalama **sys.resource_stats** iyi temel toouse hello hedef boyutu karşı verin.</span><span class="sxs-lookup"><span data-stu-id="37618-181">Usually, average values from **sys.resource_stats** give you a good baseline toouse against hello target size.</span></span> <span data-ttu-id="37618-182">Birincil ölçüm çubuğu olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="37618-182">It should be your primary measurement stick.</span></span> <span data-ttu-id="37618-183">Bir örnek için hello standart hizmet katmanında S2 performans düzeyiyle kullanıyor olabilir.</span><span class="sxs-lookup"><span data-stu-id="37618-183">For an example, you might be using hello Standard service tier with S2 performance level.</span></span> <span data-ttu-id="37618-184">Merhaba ortalama CPU ve g/ç okuma yüzdeleri kullanın ve yazma 40 oranın altında olan, hello çalışanları 50 sayısıdır ve hello ortalama oturum sayısını 200.</span><span class="sxs-lookup"><span data-stu-id="37618-184">hello average use percentages for CPU and I/O reads and writes are below 40 percent, hello average number of workers is below 50, and hello average number of sessions is below 200.</span></span> <span data-ttu-id="37618-185">İş yükünüzün S1 performans düzeyine hello uygun.</span><span class="sxs-lookup"><span data-stu-id="37618-185">Your workload might fit into hello S1 performance level.</span></span> <span data-ttu-id="37618-186">Veritabanınızı hello çalışan ve oturumu sınırlarını uygun olup olmadığını kolay toosee var.</span><span class="sxs-lookup"><span data-stu-id="37618-186">It's easy toosee whether your database fits in hello worker and session limits.</span></span> <span data-ttu-id="37618-187">tooCPU, okuma ve yazma işlemleri, bir veritabanı içine daha düşük bir performans düzeyine olup olmadığını uygun tahminini toosee hello daha düşük performans düzeyine hello DTU sayısı, geçerli performans düzeyini DTU sayı hello tarafından bölmek ve ardından hello sonucu 100 ile çarpın:</span><span class="sxs-lookup"><span data-stu-id="37618-187">toosee whether a database fits into a lower performance level with regards tooCPU, reads, and writes, divide hello DTU number of hello lower performance level by hello DTU number of your current performance level, and then multiply hello result by 100:</span></span>
   
    <span data-ttu-id="37618-188">**S1 DTU / S2 DTU * 100 = 20 / 50 * 100 = 40**</span><span class="sxs-lookup"><span data-stu-id="37618-188">**S1 DTU / S2 DTU * 100 = 20 / 50 * 100 = 40**</span></span>
   
    <span data-ttu-id="37618-189">Merhaba, yüzde cinsinden hello iki performans düzeyleri arasında hello göreli performans farkı sonucudur.</span><span class="sxs-lookup"><span data-stu-id="37618-189">hello result is hello relative performance difference between hello two performance levels in percentage.</span></span> <span data-ttu-id="37618-190">Kaynak kullanımınız bu miktar aşmadığından, iş yükünüzü hello daha düşük performans düzeyine uygun.</span><span class="sxs-lookup"><span data-stu-id="37618-190">If your resource use doesn't exceed this amount, your workload might fit into hello lower performance level.</span></span> <span data-ttu-id="37618-191">Ancak, kaynak kullanım değerleri olan tüm aralıklarını adresindeki toolook gerekir ve yüzde olarak, veritabanının yükünüzü hello daha düşük performans düzeyine ne sıklıkta uyar belirler.</span><span class="sxs-lookup"><span data-stu-id="37618-191">However, you need toolook at all ranges of resource use values, and determine, by percentage, how often your database workload would fit into hello lower performance level.</span></span> <span data-ttu-id="37618-192">Merhaba aşağıdaki sorguyu kaynak boyutu, 40 oranında Biz bu örnekte, hesaplanan hello eşik göre başına yüzde hello sığacak çıkarır:</span><span class="sxs-lookup"><span data-stu-id="37618-192">hello following query outputs hello fit percentage per resource dimension, based on hello threshold of 40 percent that we calculated in this example:</span></span>
   
        SELECT
            (COUNT(database_name) - SUM(CASE WHEN avg_cpu_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'CPU Fit Percent'
            ,(COUNT(database_name) - SUM(CASE WHEN avg_log_write_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Log Write Fit Percent'
            ,(COUNT(database_name) - SUM(CASE WHEN avg_data_io_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Physical Data IO Fit Percent'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
   
    <span data-ttu-id="37618-193">Veritabanı Hizmet düzeyi hedefi (SLO) bağlı olarak, iş yükünüzü hello daha düşük performans düzeyine uygun olup olmadığını karar verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-193">Based on your database service level objective (SLO), you can decide whether your workload fits into hello lower performance level.</span></span> <span data-ttu-id="37618-194">Veritabanının yükünüzü SLO yüzde 99,9 ise ve hello önceki sorgu değerlerinin tüm üç kaynak boyutları için yüzde 99,9 büyük döndürür, büyük olasılıkla, iş yükü hello daha düşük performans düzeyine sığar.</span><span class="sxs-lookup"><span data-stu-id="37618-194">If your database workload SLO is 99.9 percent and hello preceding query returns values greater than 99.9 percent for all three resource dimensions, your workload likely fits into hello lower performance level.</span></span>
   
    <span data-ttu-id="37618-195">Ayrıca uygun hello yüzdesiyle arayan olup, SLO toohello sonraki daha yüksek performans düzeyi toomeet taşımalısınız içine Insight sağlar.</span><span class="sxs-lookup"><span data-stu-id="37618-195">Looking at hello fit percentage also gives you insight into whether you should move toohello next higher performance level toomeet your SLO.</span></span> <span data-ttu-id="37618-196">Örneğin, geçen hafta CPU kullanımını hello için aşağıdaki hello userdb1 gösterir:</span><span class="sxs-lookup"><span data-stu-id="37618-196">For example, userdb1 shows hello following CPU use for hello past week:</span></span>
   
   | <span data-ttu-id="37618-197">Ortalama CPU yüzdesi</span><span class="sxs-lookup"><span data-stu-id="37618-197">Average CPU percent</span></span> | <span data-ttu-id="37618-198">En fazla CPU yüzdesi</span><span class="sxs-lookup"><span data-stu-id="37618-198">Maximum CPU percent</span></span> |
   | --- | --- |
   | <span data-ttu-id="37618-199">24.5</span><span class="sxs-lookup"><span data-stu-id="37618-199">24.5</span></span> |<span data-ttu-id="37618-200">100.00</span><span class="sxs-lookup"><span data-stu-id="37618-200">100.00</span></span> |
   
    <span data-ttu-id="37618-201">Merhaba sınırı iyi hello performans düzeyini hello veritabanı uyar hello performans düzeyinin çeyreği Hello ortalama CPU hakkındadır.</span><span class="sxs-lookup"><span data-stu-id="37618-201">hello average CPU is about a quarter of hello limit of hello performance level, which would fit well into hello performance level of hello database.</span></span> <span data-ttu-id="37618-202">Ancak bu hello veritabanı hello performans düzeyinin hello sınıra ulaşana hello en büyük değeri gösterir.</span><span class="sxs-lookup"><span data-stu-id="37618-202">But, hello maximum value shows that hello database reaches hello limit of hello performance level.</span></span> <span data-ttu-id="37618-203">Toomove toohello sonraki daha yüksek performans düzeyi gerekiyor mu?</span><span class="sxs-lookup"><span data-stu-id="37618-203">Do you need toomove toohello next higher performance level?</span></span> <span data-ttu-id="37618-204">Ne birçok kez iş yükü ulaştığında yüzde 100 arayın ve ardından tooyour veritabanı iş yükü SLO karşılaştırın.</span><span class="sxs-lookup"><span data-stu-id="37618-204">Look at how many times your workload reaches 100 percent, and then compare it tooyour database workload SLO.</span></span>
   
        SELECT
        (COUNT(database_name) - SUM(CASE WHEN avg_cpu_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'CPU fit percent'
        ,(COUNT(database_name) - SUM(CASE WHEN avg_log_write_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Log write fit percent'
        ,(COUNT(database_name) - SUM(CASE WHEN avg_data_io_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Physical data I/O fit percent'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
   
    <span data-ttu-id="37618-205">Bu sorgu bir değer döndürürse yüzde 99,9'den az hello üç kaynak boyutlardan herhangi birinde için ya da taşıma toohello sonraki daha yüksek performans düzeyi göz önünde bulundurun veya uygulama ayarlamayı teknikleri tooreduce hello yük hello SQL database kullanın.</span><span class="sxs-lookup"><span data-stu-id="37618-205">If this query returns a value less than 99.9 percent for any of hello three resource dimensions, consider either moving toohello next higher performance level or use application-tuning techniques tooreduce hello load on hello SQL database.</span></span>
4. <span data-ttu-id="37618-206">Bu alıştırmada ayrıca Merhaba, tahmini iş yükü artış gelecekteki göz önünde bulundurur.</span><span class="sxs-lookup"><span data-stu-id="37618-206">This exercise also considers your projected workload increase in hello future.</span></span>

<span data-ttu-id="37618-207">Esnek havuzlar için bu bölümde açıklanan hello teknikleri ile Merhaba havuzdaki tek veritabanlarını izleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-207">For elastic pools, you can monitor individual databases in hello pool with hello techniques described in this section.</span></span> <span data-ttu-id="37618-208">Ancak hello havuzu bir bütün olarak da izleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-208">But you can also monitor hello pool as a whole.</span></span> <span data-ttu-id="37618-209">Bilgi için bkz. [Elastik havuz izleme ve yönetme](sql-database-elastic-pool-manage-portal.md).</span><span class="sxs-lookup"><span data-stu-id="37618-209">For information, see [Monitor and manage an elastic pool](sql-database-elastic-pool-manage-portal.md).</span></span>


### <a name="maximum-concurrent-requests"></a><span data-ttu-id="37618-210">Maksimum eşzamanlı istek</span><span class="sxs-lookup"><span data-stu-id="37618-210">Maximum concurrent requests</span></span>
<span data-ttu-id="37618-211">toosee hello eşzamanlı istek sayısı bu Transact-SQL sorgusu SQL veritabanınızda çalıştırın:</span><span class="sxs-lookup"><span data-stu-id="37618-211">toosee hello number of concurrent requests, run this Transact-SQL query on your SQL database:</span></span>

    SELECT COUNT(*) AS [Concurrent_Requests]
    FROM sys.dm_exec_requests R

<span data-ttu-id="37618-212">bir şirket içi SQL Server veritabanının tooanalyze hello iş yükü değiştirmek bu sorgu toofilter hello belirli veritabanında tooanalyze istiyor.</span><span class="sxs-lookup"><span data-stu-id="37618-212">tooanalyze hello workload of an on-premises SQL Server database, modify this query toofilter on hello specific database you want tooanalyze.</span></span> <span data-ttu-id="37618-213">Örneğin, Veritabanım adlı bir şirket içi veritabanınız varsa, bu Transact-SQL sorgusu bu veritabanında eşzamanlı istek Merhaba sayımını döndürür:</span><span class="sxs-lookup"><span data-stu-id="37618-213">For example, if you have an on-premises database named MyDatabase, this Transact-SQL query returns hello count of concurrent requests in that database:</span></span>

    SELECT COUNT(*) AS [Concurrent_Requests]
    FROM sys.dm_exec_requests R
    INNER JOIN sys.databases D ON D.database_id = R.database_id
    AND D.name = 'MyDatabase'

<span data-ttu-id="37618-214">Bu, zaman içinde yalnızca tek bir noktada anlık görüntüsüdür.</span><span class="sxs-lookup"><span data-stu-id="37618-214">This is just a snapshot at a single point in time.</span></span> <span data-ttu-id="37618-215">daha iyi, iş yükü ve eş zamanlı istek gereksinimleri anlamak tooget toocollect gerekir zaman içinde birçok örnekleri.</span><span class="sxs-lookup"><span data-stu-id="37618-215">tooget a better understanding of your workload and concurrent request requirements, you'll need toocollect many samples over time.</span></span>

### <a name="maximum-concurrent-logins"></a><span data-ttu-id="37618-216">En fazla eşzamanlı oturum açma</span><span class="sxs-lookup"><span data-stu-id="37618-216">Maximum concurrent logins</span></span>
<span data-ttu-id="37618-217">Kullanıcı ve uygulama desenleri tooget oturumları hello sıklığını hakkında bir fikir analiz edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-217">You can analyze your user and application patterns tooget an idea of hello frequency of logins.</span></span> <span data-ttu-id="37618-218">Ayrıca, bir test ortamı toomake, bu veya bu makalede aşağıdakiler ele diğer sınırları basarsa değil olduğundan emin gerçek yükleri de çalıştırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37618-218">You also can run real-world loads in a test environment toomake sure that you're not hitting this or other limits we discuss in this article.</span></span> <span data-ttu-id="37618-219">Tek bir sorgu veya dinamik yönetim görünümünü (DMV), eşzamanlı oturum açma sayar gösterebilir veya geçmişi yok.</span><span class="sxs-lookup"><span data-stu-id="37618-219">There isn’t a single query or dynamic management view (DMV) that can show you concurrent login counts or history.</span></span>

<span data-ttu-id="37618-220">Birden çok istemci kullanıyorsanız, aynı bağlantı dizesine hello hello hizmeti her oturum açma kimliğini doğrular.</span><span class="sxs-lookup"><span data-stu-id="37618-220">If multiple clients use hello same connection string, hello service authenticates each login.</span></span> <span data-ttu-id="37618-221">10 kullanıcı aynı anda bağlanıyorsanız, aynı kullanıcı adı ve parola kullanarak tooa veritabanı Merhaba, 10 eşzamanlı oturum açma olacaktır.</span><span class="sxs-lookup"><span data-stu-id="37618-221">If 10 users simultaneously connect tooa database by using hello same username and password, there would be 10 concurrent logins.</span></span> <span data-ttu-id="37618-222">Bu sınır yalnızca toohello süresi hello oturum açma ve kimlik doğrulama geçerlidir.</span><span class="sxs-lookup"><span data-stu-id="37618-222">This limit applies only toohello duration of hello login and authentication.</span></span> <span data-ttu-id="37618-223">Merhaba aynı 10 kullanıcılar toohello veritabanı sırayla bağlanıyorsa, eşzamanlı oturum açma sayısı hello hiçbir zaman 1'den büyük olacaktır.</span><span class="sxs-lookup"><span data-stu-id="37618-223">If hello same 10 users connect toohello database sequentially, hello number of concurrent logins would never be greater than 1.</span></span>

> [!NOTE]
> <span data-ttu-id="37618-224">Şu anda, bu sınır esnek havuzlar toodatabases geçerli değildir.</span><span class="sxs-lookup"><span data-stu-id="37618-224">Currently, this limit does not apply toodatabases in elastic pools.</span></span>
> 
> 

### <a name="maximum-sessions"></a><span data-ttu-id="37618-225">En fazla oturum</span><span class="sxs-lookup"><span data-stu-id="37618-225">Maximum sessions</span></span>
<span data-ttu-id="37618-226">toosee hello geçerli etkin oturum sayısı bu Transact-SQL sorgusu SQL veritabanınızda çalıştırın:</span><span class="sxs-lookup"><span data-stu-id="37618-226">toosee hello number of current active sessions, run this Transact-SQL query on your SQL database:</span></span>

    SELECT COUNT(*) AS [Sessions]
    FROM sys.dm_exec_connections

<span data-ttu-id="37618-227">Bir şirket içi SQL Server iş yükü analiz etme, belirli bir veritabanı üzerinde hello sorgu toofocus değiştirin.</span><span class="sxs-lookup"><span data-stu-id="37618-227">If you're analyzing an on-premises SQL Server workload, modify hello query toofocus on a specific database.</span></span> <span data-ttu-id="37618-228">Bu sorgu, tooAzure SQL veritabanını taşımadan düşünüyorsanız hello veritabanı için olası oturum gereksinimlerini belirlemenize yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="37618-228">This query helps you determine possible session needs for hello database if you are considering moving it tooAzure SQL Database.</span></span>

    SELECT COUNT(*)  AS [Sessions]
    FROM sys.dm_exec_connections C
    INNER JOIN sys.dm_exec_sessions S ON (S.session_id = C.session_id)
    INNER JOIN sys.databases D ON (D.database_id = S.database_id)
    WHERE D.name = 'MyDatabase'

<span data-ttu-id="37618-229">Yeniden, bu sorguları zaman içinde nokta sayısını döndürür.</span><span class="sxs-lookup"><span data-stu-id="37618-229">Again, these queries return a point-in-time count.</span></span> <span data-ttu-id="37618-230">Zaman içinde birden fazla örnek toplarsanız hello en iyi anlama kullanın, oturumunuz sahip olacaksınız.</span><span class="sxs-lookup"><span data-stu-id="37618-230">If you collect multiple samples over time, you’ll have hello best understanding of your session use.</span></span>

<span data-ttu-id="37618-231">SQL veritabanı analize geçmiş istatistikleri oturumlarını hello sorgulayarak alabileceğiniz [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) Görünüm ve hello gözden geçirme **active_session_count** sütun.</span><span class="sxs-lookup"><span data-stu-id="37618-231">For SQL Database analysis, you can get historical statistics on sessions by querying hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) view and reviewing hello **active_session_count** column.</span></span> 
