---
title: "aaaPerformance ipuçları - Azure Cosmos DB NoSQL | Microsoft Docs"
description: "İstemci yapılandırma seçenekleri tooimprove Azure Cosmos DB veritabanı performansını öğrenin"
keywords: "nasıl tooimprove veritabanı performansı"
services: cosmos-db
author: mimig1
manager: jhubbard
editor: 
documentationcenter: 
ms.assetid: 94ff155e-f9bc-488f-8c7a-5e7037091bb9
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/23/2017
ms.author: mimig
ms.openlocfilehash: 4f3e82ae5048e3dbc20b0fd891a2d3aa22adf3fc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tips-for-azure-cosmos-db"></a><span data-ttu-id="1beba-104">Azure Cosmos DB performans ipuçları</span><span class="sxs-lookup"><span data-stu-id="1beba-104">Performance tips for Azure Cosmos DB</span></span>
<span data-ttu-id="1beba-105">Azure Cosmos DB garantili gecikme süresi ve verimlilik ile sorunsuz bir şekilde ölçeklendirilebilen bir hızlı ve esnek dağıtılmış veritabanıdır.</span><span class="sxs-lookup"><span data-stu-id="1beba-105">Azure Cosmos DB is a fast and flexible distributed database that scales seamlessly with guaranteed latency and throughput.</span></span> <span data-ttu-id="1beba-106">Değil toomake büyük mimari değişikliklerinin veya karmaşık kodlar tooscale veritabanınızla Cosmos DB yazma.</span><span class="sxs-lookup"><span data-stu-id="1beba-106">You do not have toomake major architecture changes or write complex code tooscale your database with Cosmos DB.</span></span> <span data-ttu-id="1beba-107">Yukarı ve aşağı doğru ölçeklendirme tek bir API çağrısı yapma olarak kadar kolay veya [SDK yöntem çağrısı](set-throughput.md#set-throughput-sdk).</span><span class="sxs-lookup"><span data-stu-id="1beba-107">Scaling up and down is as easy as making a single API call or [SDK method call](set-throughput.md#set-throughput-sdk).</span></span> <span data-ttu-id="1beba-108">Ancak, Cosmos DB aracılığıyla erişilir ağ çağrıları tooachieve en yüksek performans yapabileceğiniz istemci-tarafı iyileştirmeler değildir.</span><span class="sxs-lookup"><span data-stu-id="1beba-108">However, because Cosmos DB is accessed via network calls there are client-side optimizations you can make tooachieve peak performance.</span></span>

<span data-ttu-id="1beba-109">Soran, "nasıl ı my veritabanı performansını geliştirebilir şekilde?"</span><span class="sxs-lookup"><span data-stu-id="1beba-109">So if you're asking "How can I improve my database performance?"</span></span> <span data-ttu-id="1beba-110">Seçenekler aşağıdaki hello göz önünde bulundurun:</span><span class="sxs-lookup"><span data-stu-id="1beba-110">consider hello following options:</span></span>

## <a name="networking"></a><span data-ttu-id="1beba-111">Ağ</span><span class="sxs-lookup"><span data-stu-id="1beba-111">Networking</span></span>
<a id="direct-connection"></a>

1. <span data-ttu-id="1beba-112">**Bağlantı İlkesi: doğrudan bağlantı modu kullan**</span><span class="sxs-lookup"><span data-stu-id="1beba-112">**Connection policy: Use direct connection mode**</span></span>

    <span data-ttu-id="1beba-113">Bir istemci tooCosmos DB nasıl bağlandığını gözlemlenen istemci-tarafı gecikme açısından özellikle performansı önemli etkilere sahiptir.</span><span class="sxs-lookup"><span data-stu-id="1beba-113">How a client connects tooCosmos DB has important implications on performance, especially in terms of observed client-side latency.</span></span> <span data-ttu-id="1beba-114">İki anahtar yapılandırma ayarlarını istemci bağlantı İlkesi – hello bağlantısı yapılandırmak için kullanılabilir *modu* ve hello [bağlantı *Protokolü*](#connection-protocol).</span><span class="sxs-lookup"><span data-stu-id="1beba-114">There are two key configuration settings available for configuring client Connection Policy – hello connection *mode* and hello [connection *protocol*](#connection-protocol).</span></span>  <span data-ttu-id="1beba-115">Merhaba iki kullanılabilir modları şunlardır:</span><span class="sxs-lookup"><span data-stu-id="1beba-115">hello two available modes are:</span></span>

   1. <span data-ttu-id="1beba-116">Ağ geçidi modunda (varsayılan)</span><span class="sxs-lookup"><span data-stu-id="1beba-116">Gateway Mode (default)</span></span>
   2. <span data-ttu-id="1beba-117">Doğrudan modu</span><span class="sxs-lookup"><span data-stu-id="1beba-117">Direct Mode</span></span>

      <span data-ttu-id="1beba-118">Ağ geçidi modu tüm SDK platformlarda desteklenir ve yapılandırılmış hello varsayılandır.</span><span class="sxs-lookup"><span data-stu-id="1beba-118">Gateway Mode is supported on all SDK platforms and is hello configured default.</span></span>  <span data-ttu-id="1beba-119">Uygulamanız bir şirket ağı içinde katı güvenlik duvarı kısıtlamalarıyla çalışıyorsa hello standart HTTPS bağlantı noktası ve tek bir uç nokta kullandığından ağ geçidi modu hello en iyi seçimdir.</span><span class="sxs-lookup"><span data-stu-id="1beba-119">If your application runs within a corporate network with strict firewall restrictions, Gateway Mode is hello best choice since it uses hello standard HTTPS port and a single endpoint.</span></span> <span data-ttu-id="1beba-120">Performans kolaylığını Merhaba, ancak veri okuma veya tooCosmos DB yazılan her zaman ağ geçidi modu ek ağ atlama içermesidir.</span><span class="sxs-lookup"><span data-stu-id="1beba-120">hello performance tradeoff, however, is that Gateway Mode involves an additional network hop every time data is read or written tooCosmos DB.</span></span> <span data-ttu-id="1beba-121">Bu nedenle, doğrudan modu toofewer ağ atlamalarını nedeniyle daha iyi performans sunar.</span><span class="sxs-lookup"><span data-stu-id="1beba-121">Because of this, Direct Mode offers better performance due toofewer network hops.</span></span>
<a id="use-tcp"></a>
2. <span data-ttu-id="1beba-122">**Bağlantı İlkesi: hello TCP protokolünü kullanır**</span><span class="sxs-lookup"><span data-stu-id="1beba-122">**Connection policy: Use hello TCP protocol**</span></span>

    <span data-ttu-id="1beba-123">Doğrudan modu kullanırken, kullanılabilir iki protokolü seçenek vardır:</span><span class="sxs-lookup"><span data-stu-id="1beba-123">When using Direct Mode, there are two protocol options available:</span></span>

   * <span data-ttu-id="1beba-124">TCP</span><span class="sxs-lookup"><span data-stu-id="1beba-124">TCP</span></span>
   * <span data-ttu-id="1beba-125">HTTPS</span><span class="sxs-lookup"><span data-stu-id="1beba-125">HTTPS</span></span>

     <span data-ttu-id="1beba-126">Cosmos DB Basit bir sunar ve HTTPS üzerinden RESTful programlama modeli açın.</span><span class="sxs-lookup"><span data-stu-id="1beba-126">Cosmos DB offers a simple and open RESTful programming model over HTTPS.</span></span> <span data-ttu-id="1beba-127">Ayrıca, aynı zamanda RESTful kendi iletişim modelini ve hello .NET İstemci SDK kullanılabilir verimli bir TCP protokolü sunar.</span><span class="sxs-lookup"><span data-stu-id="1beba-127">Additionally, it offers an efficient TCP protocol, which is also RESTful in its communication model and is available through hello .NET client SDK.</span></span> <span data-ttu-id="1beba-128">Doğrudan TCP ve HTTPS SSL ilk kimlik doğrulaması ve şifreleme trafiği için kullanın.</span><span class="sxs-lookup"><span data-stu-id="1beba-128">Both Direct TCP and HTTPS use SSL for initial authentication and encrypting traffic.</span></span> <span data-ttu-id="1beba-129">En iyi performans için mümkün olduğunda hello TCP protokolü kullanın.</span><span class="sxs-lookup"><span data-stu-id="1beba-129">For best performance, use hello TCP protocol when possible.</span></span>

     <span data-ttu-id="1beba-130">TCP ağ geçidi modunda kullanılırken, TCP bağlantı noktası 443 hello Cosmos DB bağlantı noktası ve 10255 değerini bulur hello MongoDB API bağlantı noktası.</span><span class="sxs-lookup"><span data-stu-id="1beba-130">When using TCP in Gateway Mode, TCP Port 443 is hello Cosmos DB port, and 10255 is hello MongoDB API port.</span></span> <span data-ttu-id="1beba-131">TCP toplama toohello ağ geçidi bağlantı noktaları, doğrudan modunda kullanırken tooensure hello bağlantı noktası gerekir Cosmos DB dinamik TCP bağlantı noktaları kullandığından 10000 20000 arasındaki aralığı açın.</span><span class="sxs-lookup"><span data-stu-id="1beba-131">When using TCP in Direct Mode, in addition toohello Gateway ports, you need tooensure hello port range between 10000 and 20000 is open because Cosmos DB uses dynamic TCP ports.</span></span> <span data-ttu-id="1beba-132">Bu bağlantı noktalarının açık değildir ve toouse TCP çalışırsanız, 503 Hizmet kullanılamıyor hatası alırsınız.</span><span class="sxs-lookup"><span data-stu-id="1beba-132">If these ports are not open and you attempt toouse TCP, you receive a 503 Service Unavailable error.</span></span>

     <span data-ttu-id="1beba-133">Bağlantı modunu Hello hello ConnectionPolicy parametresiyle hello DocumentClient örneğinin hello oluşturma sırasında yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="1beba-133">hello Connectivity Mode is configured during hello construction of hello DocumentClient instance with hello ConnectionPolicy parameter.</span></span> <span data-ttu-id="1beba-134">Doğrudan modunda kullanılırsa, hello Protokolü hello ConnectionPolicy parametresi içinde de ayarlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1beba-134">If Direct Mode is used, hello Protocol can also be set within hello ConnectionPolicy parameter.</span></span>

    ```C#
    var serviceEndpoint = new Uri("https://contoso.documents.net");
    var authKey = new "your authKey from hello Azure portal";
    DocumentClient client = new DocumentClient(serviceEndpoint, authKey,
    new ConnectionPolicy
    {
        ConnectionMode = ConnectionMode.Direct,
        ConnectionProtocol = Protocol.Tcp
    });
    ```

    <span data-ttu-id="1beba-135">Ağ geçidi modunda kullanılırsa, TCP yalnızca doğrudan modunda desteklendiğinden, ardından HTTPS protokolünü her zaman olduğu hello toocommunicate hello ağ geçidi ile ve hello protokol değeri ConnectionPolicy göz ardı hello kullanılır.</span><span class="sxs-lookup"><span data-stu-id="1beba-135">Because TCP is only supported in Direct Mode, if Gateway Mode is used, then hello HTTPS protocol is always used toocommunicate with hello Gateway and hello Protocol value in hello ConnectionPolicy is ignored.</span></span>

    ![Hello Azure Cosmos DB bağlantı İlkesi çizimi](./media/performance-tips/connection-policy.png)

3. <span data-ttu-id="1beba-137">**İlk isteği OpenAsync tooavoid başlatma gecikmesi çağırın**</span><span class="sxs-lookup"><span data-stu-id="1beba-137">**Call OpenAsync tooavoid startup latency on first request**</span></span>

    <span data-ttu-id="1beba-138">Toofetch hello adresi yönlendirme tablosu olduğundan varsayılan olarak, daha yüksek gecikme hello ilk istek sahiptir.</span><span class="sxs-lookup"><span data-stu-id="1beba-138">By default, hello first request has a higher latency because it has toofetch hello address routing table.</span></span> <span data-ttu-id="1beba-139">tooavoid hello bu başlangıç gecikmesine ilk istek, bir kez başlatma sırasında şu şekilde OpenAsync() çağırmalıdır.</span><span class="sxs-lookup"><span data-stu-id="1beba-139">tooavoid this startup latency on hello first request, you should call OpenAsync() once during initialization as follows.</span></span>

        await client.OpenAsync();
   <a id="same-region"></a>
4. <span data-ttu-id="1beba-140">**Performans için aynı Azure bölgesinde istemciler birlikte bulundurma**</span><span class="sxs-lookup"><span data-stu-id="1beba-140">**Collocate clients in same Azure region for performance**</span></span>

    <span data-ttu-id="1beba-141">Ne zaman mümkün Cosmos DB arayan herhangi bir uygulama ile aynı bölgeye hello yerine Cosmos DB veritabanı hello.</span><span class="sxs-lookup"><span data-stu-id="1beba-141">When possible, place any applications calling Cosmos DB in hello same region as hello Cosmos DB database.</span></span> <span data-ttu-id="1beba-142">Yaklaşık bir karşılaştırma için aynı bölgede tamamlamak 1-2 ms ancak hello Batı ve us Merhaba, Doğu Yakası arasındaki hello gecikme süresi içinde hello içinde tooCosmos DB çağırır > 50 ms.</span><span class="sxs-lookup"><span data-stu-id="1beba-142">For an approximate comparison, calls tooCosmos DB within hello same region complete within 1-2 ms, but hello latency between hello West and East coast of hello US is >50 ms.</span></span> <span data-ttu-id="1beba-143">Bu gecikme, büyük olasılıkla gelen isteği toorequest hello istemci toohello Azure veri merkezi bir sınır geçerken hello istek tarafından alınan hello rota bağlı olarak değişebilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-143">This latency can likely vary from request toorequest depending on hello route taken by hello request as it passes from hello client toohello Azure datacenter boundary.</span></span> <span data-ttu-id="1beba-144">Merhaba olası en düşük gecikme süresi hello arama sağlayarak gerçekleştirilir uygulama hello içinde bulunduğu hello olduğu Azure bölgesinin sağlanan Cosmos DB uç noktası.</span><span class="sxs-lookup"><span data-stu-id="1beba-144">hello lowest possible latency is achieved by ensuring hello calling application is located within hello same Azure region as hello provisioned Cosmos DB endpoint.</span></span> <span data-ttu-id="1beba-145">Kullanılabilir bölgelerin bir listesi için bkz: [Azure bölgeleri](https://azure.microsoft.com/regions/#services).</span><span class="sxs-lookup"><span data-stu-id="1beba-145">For a list of available regions, see [Azure Regions](https://azure.microsoft.com/regions/#services).</span></span>

    <span data-ttu-id="1beba-146">![Hello Azure Cosmos DB bağlantı İlkesi çizimi](./media/performance-tips/same-region.png)
   <a id="increase-threads"></a></span><span class="sxs-lookup"><span data-stu-id="1beba-146">![Illustration of hello Azure Cosmos DB connection policy](./media/performance-tips/same-region.png)
<a id="increase-threads"></a></span></span>
5. <span data-ttu-id="1beba-147">**İş parçacıkları/görevleri sayısını artırın**</span><span class="sxs-lookup"><span data-stu-id="1beba-147">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="1beba-148">Merhaba ağ üzerinden çağrıları tooAzure Cosmos DB yapılma olduğundan, böylece hello istemci uygulamanın bekleyen istekler arasında çok az zaman geçirdiği toovary Merhaba, istekleri paralellik derecesini gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-148">Since calls tooAzure Cosmos DB are made over hello network, you may need toovary hello degree of parallelism of your requests so that hello client application spends very little time waiting between requests.</span></span> <span data-ttu-id="1beba-149">Örneğin, kullanıyorsanız. NET'in [görev paralel Kitaplığı](https://msdn.microsoft.com//library/dd460717.aspx), okuma veya yazma tooCosmos DB görevlerin 100s hello sırada oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1beba-149">For example, if you're using .NET's [Task Parallel Library](https://msdn.microsoft.com//library/dd460717.aspx), create in hello order of 100s of Tasks reading or writing tooCosmos DB.</span></span>

## <a name="sdk-usage"></a><span data-ttu-id="1beba-150">SDK kullanımı</span><span class="sxs-lookup"><span data-stu-id="1beba-150">SDK Usage</span></span>
1. <span data-ttu-id="1beba-151">**Yükleme son SDK hello**</span><span class="sxs-lookup"><span data-stu-id="1beba-151">**Install hello most recent SDK**</span></span>

    <span data-ttu-id="1beba-152">Merhaba Cosmos DB SDK'ları sürekli geliştirilmiş tooprovide hello en iyi performansı bırakılıyor.</span><span class="sxs-lookup"><span data-stu-id="1beba-152">hello Cosmos DB SDKs are constantly being improved tooprovide hello best performance.</span></span> <span data-ttu-id="1beba-153">Merhaba bkz [Cosmos DB SDK](documentdb-sdk-dotnet.md) sayfaları toodetermine en son SDK hello ve geliştirmeleri gözden geçirin.</span><span class="sxs-lookup"><span data-stu-id="1beba-153">See hello [Cosmos DB SDK](documentdb-sdk-dotnet.md) pages toodetermine hello most recent SDK and review improvements.</span></span>
2. <span data-ttu-id="1beba-154">**Bir singleton Cosmos DB istemci uygulamanız hello ömrü boyunca kullanın**</span><span class="sxs-lookup"><span data-stu-id="1beba-154">**Use a singleton Cosmos DB client for hello lifetime of your application**</span></span>

    <span data-ttu-id="1beba-155">Her DocumentClient örnek iş parçacığı açısından güvenli ve verimli bağlantı yönetimi ve doğrudan modunda çalışırken adresi önbelleğe alma gerçekleştirir unutmayın.</span><span class="sxs-lookup"><span data-stu-id="1beba-155">Note that each DocumentClient instance is thread-safe and performs efficient connection management and address caching when operating in Direct Mode.</span></span> <span data-ttu-id="1beba-156">tooallow verimli bağlantı yönetimi ve daha iyi performans DocumentClient ile toouse DocumentClient AppDomain başına tek bir örneğini Merhaba uygulaması hello ömrü boyunca önerilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-156">tooallow efficient connection management and better performance by DocumentClient, it is recommended toouse a single instance of DocumentClient per AppDomain for hello lifetime of hello application.</span></span>

   <a id="max-connection"></a>
3. <span data-ttu-id="1beba-157">**Ağ geçidi modu kullanırken System.Net MaxConnections ana bilgisayar başına artırın**</span><span class="sxs-lookup"><span data-stu-id="1beba-157">**Increase System.Net MaxConnections per host when using Gateway mode**</span></span>

    <span data-ttu-id="1beba-158">Cosmos DB istekler ağ geçidi modu kullanırken HTTPS/REST yapılan ve ana bilgisayar adı veya IP adresi başına tabi toohello varsayılan bağlantı sınırı.</span><span class="sxs-lookup"><span data-stu-id="1beba-158">Cosmos DB requests are made over HTTPS/REST when using Gateway mode, and are subjected toohello default connection limit per hostname or IP address.</span></span> <span data-ttu-id="1beba-159">Böylece Hello istemci kitaplığı birden çok eşzamanlı bağlantı tooCosmos DB kullanabilir tooset hello MaxConnections tooa daha yüksek değere (100-1000) gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-159">You may need tooset hello MaxConnections tooa higher value (100-1000) so that hello client library can utilize multiple simultaneous connections tooCosmos DB.</span></span> <span data-ttu-id="1beba-160">.NET SDK'sı 1.8.0 hello ve yukarıdaki için varsayılan değer hello [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) olan 50 ve toochange Merhaba değeri, hello ayarlayabilirsiniz [Documents.Client.ConnectionPolicy.MaxConnectionLimit ](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa daha yüksek değer.</span><span class="sxs-lookup"><span data-stu-id="1beba-160">In hello .NET SDK 1.8.0 and above, hello default value for [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) is 50 and toochange hello value, you can set hello [Documents.Client.ConnectionPolicy.MaxConnectionLimit](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa higher value.</span></span>   
4. <span data-ttu-id="1beba-161">**Paralel sorgular bölümlenmiş koleksiyonlar için ayarlama**</span><span class="sxs-lookup"><span data-stu-id="1beba-161">**Tuning parallel queries for partitioned collections**</span></span>

     <span data-ttu-id="1beba-162">DocumentDB .NET SDK sürüm 1.9.0 ve tooquery paralel bölümlendirilmiş bir koleksiyon etkinleştirme desteği paralel sorgular yukarıda (bkz [hello SDK'ları ile çalışma](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) ve ilgili hello [kod örnekleri](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) için Daha fazla bilgi).</span><span class="sxs-lookup"><span data-stu-id="1beba-162">DocumentDB .NET SDK version 1.9.0 and above support parallel queries, which enable you tooquery a partitioned collection in parallel (see [Working with hello SDKs](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) and hello related [code samples](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) for more info).</span></span> <span data-ttu-id="1beba-163">Paralel sorgular tasarlanmış tooimprove sorgu gecikme süresi ve verimlilik seri bunların karşılık gelen ' dir.</span><span class="sxs-lookup"><span data-stu-id="1beba-163">Parallel queries are designed tooimprove query latency and throughput over their serial counterpart.</span></span> <span data-ttu-id="1beba-164">Paralel sorgular sağlayan iki parametre kullanıcıların gereksinimlerine, (a) MaxDegreeOfParallelism toocustom sığacak şekilde ayarlayabilirsiniz: toocontrol hello en fazla bölüm sayısı ardından sorgulanan paralel ve (b) MaxBufferedItemCount: toocontrol hello sayısı önceden getirilen sonuç.</span><span class="sxs-lookup"><span data-stu-id="1beba-164">Parallel queries provide two parameters that users can tune toocustom-fit their requirements, (a) MaxDegreeOfParallelism: toocontrol hello maximum number of partitions then can be queried in parallel, and (b) MaxBufferedItemCount: toocontrol hello number of pre-fetched results.</span></span>

    <span data-ttu-id="1beba-165">(a) ***ayarlama MaxDegreeOfParallelism\: *** paralel sorgu works birden çok bölümü paralel sorgulayarak.</span><span class="sxs-lookup"><span data-stu-id="1beba-165">(a) ***Tuning MaxDegreeOfParallelism\:*** Parallel query works by querying multiple partitions in parallel.</span></span> <span data-ttu-id="1beba-166">Ancak, tek bir bölümlenmiş toplama verileri seri olarak saygı toohello sorguyla getirilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-166">However, data from an individual partitioned collect is fetched serially with respect toohello query.</span></span> <span data-ttu-id="1beba-167">Bu nedenle, ayarı hello MaxDegreeOfParallelism toohello bölüm sayısı çoğu kullanıcı sorgu Merhaba, diğer tüm sistem koşulları kalır sağlanan aynı hello elde hello maksimum fırsat sahiptir.</span><span class="sxs-lookup"><span data-stu-id="1beba-167">So, setting hello MaxDegreeOfParallelism toohello number of partitions has hello maximum chance of achieving hello most performant query, provided all other system conditions remain hello same.</span></span> <span data-ttu-id="1beba-168">Bölüm sayısı hello bilmiyorsanız, hello MaxDegreeOfParallelism tooa yüksek sayı ayarlayabilirsiniz ve MaxDegreeOfParallelism hello gibi hello sistem hello minimum (bölüm, kullanıcı tarafından sağlanan girdi sayısı) seçer.</span><span class="sxs-lookup"><span data-stu-id="1beba-168">If you don't know hello number of partitions, you can set hello MaxDegreeOfParallelism tooa high number, and hello system chooses hello minimum (number of partitions, user provided input) as hello MaxDegreeOfParallelism.</span></span>

    <span data-ttu-id="1beba-169">Merhaba veri saygı toohello sorgusuyla tüm bölümleri arasında eşit olarak dağıtılır, bu sorguları üretim hello en iyi avantajları paralel önemli toonote olur.</span><span class="sxs-lookup"><span data-stu-id="1beba-169">It is important toonote that parallel queries produce hello best benefits if hello data is evenly distributed across all partitions with respect toohello query.</span></span> <span data-ttu-id="1beba-170">Merhaba koleksiyon bölümlendiğinde ise (en kötü durumda bir bölüm) birkaç bölümlerdeki tamamı veya bir sorgu tarafından döndürülen hello veri çoğunluğu bir yoğunlaşmıştır sonra hello hello sorgu performansını tarafından bu bölümler nedeniyle düşük performansa şekilde bölümlenmiş.</span><span class="sxs-lookup"><span data-stu-id="1beba-170">If hello partitioned collection is partitioned such a way that all or a majority of hello data returned by a query is concentrated in a few partitions (one partition in worst case), then hello performance of hello query would be bottlenecked by those partitions.</span></span>

    <span data-ttu-id="1beba-171">(b) ***ayarlama MaxBufferedItemCount\: *** paralel sorgudur hello istemci tarafından hello sonuçları geçerli toplu işlem gerçekleştirilirken tasarlanmış toopre fetch sonuçları.</span><span class="sxs-lookup"><span data-stu-id="1beba-171">(b) ***Tuning MaxBufferedItemCount\:*** Parallel query is designed toopre-fetch results while hello current batch of results is being processed by hello client.</span></span> <span data-ttu-id="1beba-172">bir sorgunun genel gecikme geliştirme yardımcı önceden getirme hello.</span><span class="sxs-lookup"><span data-stu-id="1beba-172">hello pre-fetching helps in overall latency improvement of a query.</span></span> <span data-ttu-id="1beba-173">MaxBufferedItemCount hello parametresi toolimit hello önceden getirilen sonuçları sayısıdır.</span><span class="sxs-lookup"><span data-stu-id="1beba-173">MaxBufferedItemCount is hello parameter toolimit hello number of pre-fetched results.</span></span> <span data-ttu-id="1beba-174">MaxBufferedItemCount ayarı toohello döndürülen sonuçları (veya daha yüksek bir sayı) sayısı önceden getirme gelen hello sorgu tooreceive maksimum avantajı sağlar bekleniyordu.</span><span class="sxs-lookup"><span data-stu-id="1beba-174">Setting MaxBufferedItemCount toohello expected number of results returned (or a higher number) allows hello query tooreceive maximum benefit from pre-fetching.</span></span>

    <span data-ttu-id="1beba-175">Önceden getirilirken works MaxDegreeOfParallelism Merhaba şekilde belirtilmediğine aynı hello ve tüm bölümleri hello verileri için tek bir arabelleğe olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="1beba-175">Note that pre-fetching works hello same way irrespective of hello MaxDegreeOfParallelism, and there is a single buffer for hello data from all partitions.</span></span>  
5. <span data-ttu-id="1beba-176">**Sunucu tarafı GC üzerinde Aç**</span><span class="sxs-lookup"><span data-stu-id="1beba-176">**Turn on server-side GC**</span></span>

    <span data-ttu-id="1beba-177">Çöp toplama Hello sıklığını azaltmayı bazı durumlarda yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-177">Reducing hello frequency of garbage collection may help in some cases.</span></span> <span data-ttu-id="1beba-178">.NET ile ayarlamak [gcServer](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span><span class="sxs-lookup"><span data-stu-id="1beba-178">In .NET, set [gcServer](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span></span>
6. <span data-ttu-id="1beba-179">**Geri Çekilme RetryAfter aralıklarla uygulama**</span><span class="sxs-lookup"><span data-stu-id="1beba-179">**Implement backoff at RetryAfter intervals**</span></span>

    <span data-ttu-id="1beba-180">Performans testi sırasında istekleri küçük oranını kısıtlanan kadar yük artırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="1beba-180">During performance testing, you should increase load until a small rate of requests get throttled.</span></span> <span data-ttu-id="1beba-181">Kısıtlanan, Merhaba istemci uygulaması kısıtlama üzerinde geri Çekilme hello sunucu belirtilen yeniden deneme aralığını gerekir.</span><span class="sxs-lookup"><span data-stu-id="1beba-181">If throttled, hello client application should backoff on throttle for hello server-specified retry interval.</span></span> <span data-ttu-id="1beba-182">Merhaba geri Çekilme uyarak denemeler arasındaki bekleme süresi en az miktarda harcamanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="1beba-182">Respecting hello backoff ensures that you spend minimal amount of time waiting between retries.</span></span> <span data-ttu-id="1beba-183">Yeniden deneme ilkesi desteği eklenmiştir sürümünde 1.8.0 ve yukarıdaki hello DocumentDB, [.NET](documentdb-sdk-dotnet.md) ve [Java](documentdb-sdk-java.md), sürüm 1.9.0 ve yukarıdaki Merhaba, [Node.js](documentdb-sdk-node.md) ve [ Python](documentdb-sdk-python.md), ve tüm desteklenen sürümlerinde hello [.NET Core](documentdb-sdk-dotnet-core.md) SDK'ları.</span><span class="sxs-lookup"><span data-stu-id="1beba-183">Retry policy support is included in Version 1.8.0 and above of hello DocumentDB [.NET](documentdb-sdk-dotnet.md) and [Java](documentdb-sdk-java.md), version 1.9.0 and above of hello [Node.js](documentdb-sdk-node.md) and [Python](documentdb-sdk-python.md), and all supported versions of hello [.NET Core](documentdb-sdk-dotnet-core.md) SDKs.</span></span> <span data-ttu-id="1beba-184">Daha fazla bilgi için bkz: [Exceeding ayrılmış işleme sınırları](request-units.md#RequestRateTooLarge) ve [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span><span class="sxs-lookup"><span data-stu-id="1beba-184">For more information, see [Exceeding reserved throughput limits](request-units.md#RequestRateTooLarge) and [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span></span>
7. <span data-ttu-id="1beba-185">**İstemci-iş yükünü ölçeklendirme**</span><span class="sxs-lookup"><span data-stu-id="1beba-185">**Scale out your client-workload**</span></span>

    <span data-ttu-id="1beba-186">Yüksek işleme düzeyleri sınıyorsanız (> 50.000 RU/s), Merhaba istemci uygulaması toohello capping CPU veya ağ kullanımını makine çıkışı son hello performans sorunu hale.</span><span class="sxs-lookup"><span data-stu-id="1beba-186">If you are testing at high throughput levels (>50,000 RU/s), hello client application may become hello bottleneck due toohello machine capping out on CPU or Network utilization.</span></span> <span data-ttu-id="1beba-187">Bu noktaya ulaştıysanız, birden çok sunucu arasında istemci uygulamalarının ölçeklendirme tarafından toopush hello Cosmos DB hesap ek devam edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1beba-187">If you reach this point, you can continue toopush hello Cosmos DB account further by scaling out your client applications across multiple servers.</span></span>
8. <span data-ttu-id="1beba-188">**Daha düşük okuma gecikmesi için önbellek belge URI'ler**</span><span class="sxs-lookup"><span data-stu-id="1beba-188">**Cache document URIs for lower read latency**</span></span>

    <span data-ttu-id="1beba-189">Önbellek belge URI'ler hello okuma en iyi performans için mümkün.</span><span class="sxs-lookup"><span data-stu-id="1beba-189">Cache document URIs whenever possible for hello best read performance.</span></span>
   <a id="tune-page-size"></a>
9. <span data-ttu-id="1beba-190">**Merhaba sayfa boyutu sorguları/okuma akışları daha iyi performans için ayarlama**</span><span class="sxs-lookup"><span data-stu-id="1beba-190">**Tune hello page size for queries/read feeds for better performance**</span></span>

    <span data-ttu-id="1beba-191">Bir toplu gerçekleştirme belgeleri okuma akışı işlevleri (örneğin, ReadDocumentFeedAsync) kullanarak veya bir DocumentDB SQL sorgu gönderirken okurken hello sonuç kümesi çok büyük ise hello sonuçları bölümlenmiş bir şekilde döndürülür.</span><span class="sxs-lookup"><span data-stu-id="1beba-191">When performing a bulk read of documents using read feed functionality (for example, ReadDocumentFeedAsync) or when issuing a DocumentDB SQL query, hello results are returned in a segmented fashion if hello result set is too large.</span></span> <span data-ttu-id="1beba-192">Varsayılan olarak, ilk isabet sınırlarından hangisi olduğunu, sonuçları 100 öğeleri ya da 1 MB yığınlar halinde döndürdü.</span><span class="sxs-lookup"><span data-stu-id="1beba-192">By default, results are returned in chunks of 100 items or 1 MB, whichever limit is hit first.</span></span>

    <span data-ttu-id="1beba-193">tooreduce hello sayısı, tüm geçerli sonuçları gidiş dönüş gerekli tooretrieve ağ, x-ms-max-öğesi-count istek üstbilgisi tooup too1000 kullanarak hello sayfa boyutunu artırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1beba-193">tooreduce hello number of network round trips required tooretrieve all applicable results, you can increase hello page size using x-ms-max-item-count request header tooup too1000.</span></span> <span data-ttu-id="1beba-194">Yalnızca birkaç sonuçları toodisplay gereken yeri durumlarda Örneğin, kullanıcı arabirimi veya uygulama API yalnızca 10 döndürürse birer sonuçları, okuma ve sorgular için tüketilen hello sayfa boyutu too10 tooreduce hello üretilen iş da azaltabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1beba-194">In cases where you need toodisplay only a few results, for example, if your user interface or application API returns only 10 results a time, you can also decrease hello page size too10 tooreduce hello throughput consumed for reads and queries.</span></span>

    <span data-ttu-id="1beba-195">Merhaba sayfa boyutu da yerleştirebilir hello kullanılabilir Cosmos DB SDK'ları kullanarak.</span><span class="sxs-lookup"><span data-stu-id="1beba-195">You may also set hello page size using hello available Cosmos DB SDKs.</span></span>  <span data-ttu-id="1beba-196">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="1beba-196">For example:</span></span>

        IQueryable<dynamic> authorResults = client.CreateDocumentQuery(documentCollection.SelfLink, "SELECT p.Author FROM Pages p WHERE p.Title = 'About Seattle'", new FeedOptions { MaxItemCount = 1000 });
10. <span data-ttu-id="1beba-197">**İş parçacıkları/görevleri sayısını artırın**</span><span class="sxs-lookup"><span data-stu-id="1beba-197">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="1beba-198">Bkz: [iş parçacıkları/görevlerin sayısını artırmak](#increase-threads) hello ağ bölüm içinde.</span><span class="sxs-lookup"><span data-stu-id="1beba-198">See [Increase number of threads/tasks](#increase-threads) in hello Networking section.</span></span>

11. <span data-ttu-id="1beba-199">**64-bit ana bilgisayar işleme kullanın**</span><span class="sxs-lookup"><span data-stu-id="1beba-199">**Use 64-bit host processing**</span></span>

    <span data-ttu-id="1beba-200">Hello DocumentDB SDK'sı, DocumentDB .NET SDK sürüm 1.11.4 kullanırken ve üzerini 32-bit ana işleminde çalışır.</span><span class="sxs-lookup"><span data-stu-id="1beba-200">hello DocumentDB SDK works in a 32-bit host process when you are using DocumentDB .NET SDK version 1.11.4 and above.</span></span> <span data-ttu-id="1beba-201">Ancak, çapraz bölüm sorguları kullanıyorsanız, 64-bit ana bilgisayar işleme Gelişmiş performans için önerilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-201">However, if you are using cross partition queries, 64-bit host processing is recommended for improved performance.</span></span> <span data-ttu-id="1beba-202">Şu uygulama türlerini hello hello varsayılan işlemi, sipariş toochange bu too64 bit'da, uygulamanızın hello türüne göre aşağıdaki adımları izleyin 32-bit barındırmasını:</span><span class="sxs-lookup"><span data-stu-id="1beba-202">hello following types of applications have 32-bit host process as hello default, so in order toochange that too64-bit, follow these steps based on hello type of your application:</span></span>

    - <span data-ttu-id="1beba-203">Yürütülebilir uygulamalar için bu in işaretini kaldırarak hello tarafından yapılabilir **tercih 32-bit** hello seçeneğinde **proje özelliklerini** penceresinde hello **yapı** sekmesi.</span><span class="sxs-lookup"><span data-stu-id="1beba-203">For Executable applications, this can be done by unchecking hello **Prefer 32-bit** option in hello **Project Properties** window, on hello **Build** tab.</span></span>

    - <span data-ttu-id="1beba-204">Test projeleri VSTest tabanlı için bu seçerek yapılabilir **Test**->**Test ayarlarını**->**varsayılan İşlemci mimarisi X64 olarak**, Merhaba gelen **Visual Studio Test** menü seçeneği.</span><span class="sxs-lookup"><span data-stu-id="1beba-204">For VSTest based test projects, this can be done by selecting **Test**->**Test Settings**->**Default Processor Architecture as X64**, from hello **Visual Studio Test** menu option.</span></span>

    - <span data-ttu-id="1beba-205">Yerel olarak dağıtılan ASP.NET Web uygulamaları için bu hello denetleyerek yapılabilir **hello 64-bit sürümünü kullanın IIS Express web siteleri ve projeler için**altında **Araçları** ->  **Seçenekler**->**projeler ve çözümler**->**Web projeleri**.</span><span class="sxs-lookup"><span data-stu-id="1beba-205">For locally deployed ASP.NET Web applications, this can be done by checking hello **Use hello 64-bit version of IIS Express for web sites and projects**, under **Tools**->**Options**->**Projects and Solutions**->**Web Projects**.</span></span>

    - <span data-ttu-id="1beba-206">Azure üzerinde dağıtılan ASP.NET Web uygulamaları için bu hello seçerek yapılabilir **64-bit olarak Platform** hello içinde **uygulama ayarları** hello Azure portalı üzerinde.</span><span class="sxs-lookup"><span data-stu-id="1beba-206">For ASP.NET Web applications deployed on Azure, this can be done by choosing hello **Platform as 64-bit** in hello **Application Settings** on hello Azure portal.</span></span>

## <a name="indexing-policy"></a><span data-ttu-id="1beba-207">Dizin oluşturma ilkesi</span><span class="sxs-lookup"><span data-stu-id="1beba-207">Indexing Policy</span></span>
1. <span data-ttu-id="1beba-208">**Kullanım için daha hızlı yoğun zamanı alım hızlarını dizin geç**</span><span class="sxs-lookup"><span data-stu-id="1beba-208">**Use lazy indexing for faster peak time ingestion rates**</span></span>

    <span data-ttu-id="1beba-209">Cosmos DB toospecify – hello koleksiyonu düzeyinde – otomatik olarak veya dizini oluşturulmuş bir koleksiyon toobe hello belgelerde istiyorsanız, toochoose sağlayan bir dizin oluşturma ilkesi sağlar.</span><span class="sxs-lookup"><span data-stu-id="1beba-209">Cosmos DB allows you toospecify – at hello collection level – an indexing policy, which enables you toochoose if you want hello documents in a collection toobe automatically indexed or not.</span></span>  <span data-ttu-id="1beba-210">Ayrıca, zaman uyumlu (CONSISTENT) ve zaman uyumsuz (Lazy) dizin güncelleştirmeleri arasında da seçebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1beba-210">In addition, you may also choose between synchronous (Consistent) and asynchronous (Lazy) index updates.</span></span> <span data-ttu-id="1beba-211">Varsayılan olarak, her ekleme, değiştirme veya belge toohello koleksiyonu silme işlemi hello dizini zaman uyumlu olarak güncelleştirilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-211">By default, hello index is updated synchronously on each insert, replace, or delete of a document toohello collection.</span></span> <span data-ttu-id="1beba-212">Zaman uyumlu olarak modunu etkinleştirir hello sorguları toohonor hello aynı [tutarlılık düzeyi](consistency-levels.md) hello dizin için herhangi bir gecikme çok "Yakala olmadan" hello, belgesini okur.</span><span class="sxs-lookup"><span data-stu-id="1beba-212">Synchronously mode enables hello queries toohonor hello same [consistency level](consistency-levels.md) as that of hello document reads without any delay for hello index too“catch up".</span></span>

    <span data-ttu-id="1beba-213">Yavaş dizin oluşturma verileri WINS'e içinde yazılmış senaryoları için düşünülebilecek ve tooamortize hello gerekli iş tooindex daha uzun bir süre boyunca içerik istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="1beba-213">Lazy indexing may be considered for scenarios in which data is written in bursts, and you want tooamortize hello work required tooindex content over a longer period of time.</span></span> <span data-ttu-id="1beba-214">Yavaş dizin de sağlar, toouse, üretilen iş etkili bir şekilde sağlanabilen ve hizmet vermemesini yazma isteği yoğun saatlerde en düşük gecikme süresine sahip.</span><span class="sxs-lookup"><span data-stu-id="1beba-214">Lazy indexing also allows you toouse your provisioned throughput effectively and serve write requests at peak times with minimal latency.</span></span> <span data-ttu-id="1beba-215">Yavaş dizin oluşturma etkin olduğunda, sorgu sonuçları hello Cosmos DB hesabı için yapılandırılan hello tutarlılık düzeyi bağımsız olarak tutarlı sonunda önemli toonote, ancak olur.</span><span class="sxs-lookup"><span data-stu-id="1beba-215">It is important toonote, however, that when lazy indexing is enabled, query results are eventually consistent regardless of hello consistency level configured for hello Cosmos DB account.</span></span>

    <span data-ttu-id="1beba-216">Bu nedenle, (IndexingPolicy.IndexingMode tooConsistent ayarlanır) tutarlı dizin oluşturma modu hello en yüksek istek birimi ücret Lazy modu (IndexingPolicy.IndexingMode tooLazy ayarlanır) ve dizin oluşturma dizin oluşturma sırasında yazma başına doğurur (IndexingPolicy.Automatic ayarlanır tooFalse) yazma hello zamanda sıfır dizin maliyeti vardır.</span><span class="sxs-lookup"><span data-stu-id="1beba-216">Hence, Consistent indexing mode (IndexingPolicy.IndexingMode is set tooConsistent) incurs hello highest request unit charge per write, while Lazy indexing mode (IndexingPolicy.IndexingMode is set tooLazy) and no indexing (IndexingPolicy.Automatic is set tooFalse) have zero indexing cost at hello time of write.</span></span>
2. <span data-ttu-id="1beba-217">**Daha hızlı yazmalar için dizin oluşturma kullanılmayan yolu dışla**</span><span class="sxs-lookup"><span data-stu-id="1beba-217">**Exclude unused paths from indexing for faster writes**</span></span>

    <span data-ttu-id="1beba-218">Cosmos veritabanı dizin oluşturma ilkesi Ayrıca hangi yolları tooinclude belge veya dizin yolları (IndexingPolicy.IncludedPaths ve IndexingPolicy.ExcludedPaths) yararlanarak dizin hariç toospecify sağlar.</span><span class="sxs-lookup"><span data-stu-id="1beba-218">Cosmos DB’s indexing policy also allows you toospecify which document paths tooinclude or exclude from indexing by leveraging Indexing Paths (IndexingPolicy.IncludedPaths and IndexingPolicy.ExcludedPaths).</span></span> <span data-ttu-id="1beba-219">Merhaba kullanımını yollarda dizin oluşturmayı, geliştirilmiş yazma performansı ve dizin oluşturma maliyetleri doğrudan olarak hangi hello sorgu desenlerine önceden bilinen senaryolar için alt dizini depolama dizini benzersiz yol toohello sayısını bağıntılı sunabilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-219">hello use of indexing paths can offer improved write performance and lower index storage for scenarios in which hello query patterns are known beforehand, as indexing costs are directly correlated toohello number of unique paths indexed.</span></span>  <span data-ttu-id="1beba-220">Örneğin, kod aşağıdaki hello nasıl tooexclude hello bölümünün tamamını (paketini belgeleri gösterir.</span><span class="sxs-lookup"><span data-stu-id="1beba-220">For example, hello following code shows how tooexclude an entire section of hello documents (a.k.a.</span></span> <span data-ttu-id="1beba-221">bir alt ağacı) hello kullanarak dizin gelen "*" joker karakter.</span><span class="sxs-lookup"><span data-stu-id="1beba-221">a subtree) from indexing using hello "*" wildcard.</span></span>

    ```C#
    var collection = new DocumentCollection { Id = "excludedPathCollection" };
    collection.IndexingPolicy.IncludedPaths.Add(new IncludedPath { Path = "/*" });
    collection.IndexingPolicy.ExcludedPaths.Add(new ExcludedPath { Path = "/nonIndexedContent/*");
    collection = await client.CreateDocumentCollectionAsync(UriFactory.CreateDatabaseUri("db"), excluded);
    ```

    <span data-ttu-id="1beba-222">Daha fazla bilgi için bkz: [Azure Cosmos ilkeleri dizin DB](indexing-policies.md).</span><span class="sxs-lookup"><span data-stu-id="1beba-222">For more information, see [Azure Cosmos DB indexing policies](indexing-policies.md).</span></span>

## <a name="throughput"></a><span data-ttu-id="1beba-223">Aktarım hızı</span><span class="sxs-lookup"><span data-stu-id="1beba-223">Throughput</span></span>
<a id="measure-rus"></a>

1. <span data-ttu-id="1beba-224">**Ölçmek ve alt istek için saniye başına birim kullanım ayarlayın.**</span><span class="sxs-lookup"><span data-stu-id="1beba-224">**Measure and tune for lower request units/second usage**</span></span>

    <span data-ttu-id="1beba-225">Cosmos DB zengin bir ilişkisel ve hiyerarşik sorgularıyla UDF'ler, saklı yordamları ve Tetikleyicileri – hello belgelerde veritabanı koleksiyonundaki tüm işletim dahil olmak üzere veritabanı işlemleri sunar.</span><span class="sxs-lookup"><span data-stu-id="1beba-225">Cosmos DB offers a rich set of database operations including relational and hierarchical queries with UDFs, stored procedures, and triggers – all operating on hello documents within a database collection.</span></span> <span data-ttu-id="1beba-226">Bu işlemlerin her biri ile ilişkili hello maliyet hello CPU, g/ç ve gerekli bellek toocomplete hello işlemi göre değişir.</span><span class="sxs-lookup"><span data-stu-id="1beba-226">hello cost associated with each of these operations varies based on hello CPU, IO, and memory required toocomplete hello operation.</span></span> <span data-ttu-id="1beba-227">Göz önünde bulundurulması ve donanım kaynaklarını yönetmek yerine, bir istek birimi (RU) hello kaynakları gerekli tooperform için tek bir ölçü olarak çeşitli veritabanı işlemleri ve hizmeti bir uygulama isteği düşünebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1beba-227">Instead of thinking about and managing hardware resources, you can think of a request unit (RU) as a single measure for hello resources required tooperform various database operations and service an application request.</span></span>

    <span data-ttu-id="1beba-228">[İstek birimleri](request-units.md) hello satın aldığınız kapasite birimlerinin sayısına göre her bir veritabanı hesabı için sağlanır.</span><span class="sxs-lookup"><span data-stu-id="1beba-228">[Request units](request-units.md) are provisioned for each database account based on hello number of capacity units that you purchase.</span></span> <span data-ttu-id="1beba-229">İstek birimi tüketim saniye başına oranı olarak değerlendirilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-229">Request unit consumption is evaluated as a rate per second.</span></span> <span data-ttu-id="1beba-230">Merhaba oranı hello hello hesabı için bir düzey ayrılmış altına düşene kadar hesaplarında sınırlıdır hello sağlanan istek birimi aşan uygulamaları oranı.</span><span class="sxs-lookup"><span data-stu-id="1beba-230">Applications that exceed hello provisioned request unit rate for their account is limited until hello rate drops below hello reserved level for hello account.</span></span> <span data-ttu-id="1beba-231">Uygulamanız daha yüksek düzeyde üretilen iş gerektiriyorsa, ek kapasite birimleri satın alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1beba-231">If your application requires a higher level of throughput, you can purchase additional capacity units.</span></span>

    <span data-ttu-id="1beba-232">bir sorgu Hello karmaşıklığını kaç tane istek birimleri için bir işlem tüketilen etkiler.</span><span class="sxs-lookup"><span data-stu-id="1beba-232">hello complexity of a query impacts how many Request Units are consumed for an operation.</span></span> <span data-ttu-id="1beba-233">koşulları Hello sayısı, hello koşulları, UDF'ler sayısı ve tüm hello maliyetini etkilemek hello kaynak veri kümesinin hello boyutu yapısını işlemleri sorgu.</span><span class="sxs-lookup"><span data-stu-id="1beba-233">hello number of predicates, nature of hello predicates, number of UDFs, and hello size of hello source data set all influence hello cost of query operations.</span></span>

    <span data-ttu-id="1beba-234">herhangi bir işlem, toomeasure hello yükünü (oluşturma, güncelleştirme veya silme) hello x-ms-istek-ücret üstbilgi inceleyin (veya ResourceResponse eşdeğer RequestCharge özelliğinde hello<T> veya FeedResponse<T> hello .NET SDK içinde) toomeasure Bu işlemler tarafından tüketilen istek birimleri Hello sayısı.</span><span class="sxs-lookup"><span data-stu-id="1beba-234">toomeasure hello overhead of any operation (create, update, or delete), inspect hello x-ms-request-charge header (or hello equivalent RequestCharge property in ResourceResponse<T> or FeedResponse<T> in hello .NET SDK) toomeasure hello number of request units consumed by these operations.</span></span>

    ```C#
    // Measure hello performance (request units) of writes
    ResourceResponse<Document> response = await client.CreateDocumentAsync(collectionSelfLink, myDocument);
    Console.WriteLine("Insert of document consumed {0} request units", response.RequestCharge);
    // Measure hello performance (request units) of queries
    IDocumentQuery<dynamic> queryable = client.CreateDocumentQuery(collectionSelfLink, queryString).AsDocumentQuery();
    while (queryable.HasMoreResults)
         {
              FeedResponse<dynamic> queryResponse = await queryable.ExecuteNextAsync<dynamic>();
              Console.WriteLine("Query batch consumed {0} request units", queryResponse.RequestCharge);
         }
    ```             

    <span data-ttu-id="1beba-235">Merhaba bu üstbilgisinde döndürülen istek ücret bir sağlanan işleme bölümüdür (yani, 2000 RUs / saniye).</span><span class="sxs-lookup"><span data-stu-id="1beba-235">hello request charge returned in this header is a fraction of your provisioned throughput (i.e., 2000 RUs / second).</span></span> <span data-ttu-id="1beba-236">Örneğin, Hello önceki sorgu 1000 1 KB-belgeleri döndürürse, hello işlemi hello maliyetini 1000'dir.</span><span class="sxs-lookup"><span data-stu-id="1beba-236">For example, if hello preceding query returns 1000 1KB-documents, hello cost of hello operation is 1000.</span></span> <span data-ttu-id="1beba-237">Bu nedenle, bir saniye içinde sonraki istekler azaltma önce hello sunucu yalnızca iki tür isteklere korur.</span><span class="sxs-lookup"><span data-stu-id="1beba-237">As such, within one second, hello server honors only two such requests before throttling subsequent requests.</span></span> <span data-ttu-id="1beba-238">Daha fazla bilgi için bkz: [istek birimleri](request-units.md) ve hello [istek birimi hesaplayıcı](https://www.documentdb.com/capacityplanner).</span><span class="sxs-lookup"><span data-stu-id="1beba-238">For more information, see [Request units](request-units.md) and hello [request unit calculator](https://www.documentdb.com/capacityplanner).</span></span>
<a id="429"></a>
2. <span data-ttu-id="1beba-239">**Tanıtıcı oranı sınırlama istek oranı çok büyük**</span><span class="sxs-lookup"><span data-stu-id="1beba-239">**Handle rate limiting/request rate too large**</span></span>

    <span data-ttu-id="1beba-240">Bir istemci bir hesap için tooexceed hello ayrılmış işleme çalıştığında hello sunucuda bir performans düşüşü olmadan ve hiçbir ayrılmış hello düzeyinin ötesine işleme kapasitesi kullanımını yoktur.</span><span class="sxs-lookup"><span data-stu-id="1beba-240">When a client attempts tooexceed hello reserved throughput for an account, there is no performance degradation at hello server and no use of throughput capacity beyond hello reserved level.</span></span> <span data-ttu-id="1beba-241">Merhaba sunucu erken önlem hello istekle RequestRateTooLarge (HTTP durum kodu 429) ve kullanıcı hello milisaniye cinsinden süre hello miktarını hello isteği reattempting önce beklemesi gereken x-ms-yeniden deneme-sonra-ms üstbilgi dönüş hello belirten sona erer.</span><span class="sxs-lookup"><span data-stu-id="1beba-241">hello server will preemptively end hello request with RequestRateTooLarge (HTTP status code 429) and return hello x-ms-retry-after-ms header indicating hello amount of time, in milliseconds, that hello user must wait before reattempting hello request.</span></span>

        HTTP Status 429,
        Status Line: RequestRateTooLarge
        x-ms-retry-after-ms :100

    <span data-ttu-id="1beba-242">Merhaba SDK'ları tüm örtük olarak bu yanıt catch, yeniden deneme sonrasında hello sunucu belirtilen üstbilgi saygı ve hello isteği yeniden deneyin.</span><span class="sxs-lookup"><span data-stu-id="1beba-242">hello SDKs all implicitly catch this response, respect hello server-specified retry-after header, and retry hello request.</span></span> <span data-ttu-id="1beba-243">Hesabınızı eşzamanlı olarak birden çok istemci tarafından erişilen sürece hello sonraki yeniden deneme işlemi başarılı olur.</span><span class="sxs-lookup"><span data-stu-id="1beba-243">Unless your account is being accessed concurrently by multiple clients, hello next retry will succeed.</span></span>

    <span data-ttu-id="1beba-244">Üst üste hello istek hızı tutarlı bir şekilde işletim birden fazla istemciniz varsa kümesi too9 hello istemci tarafından dahili olarak değil yeterli varsayılan yeniden deneme sayısı şu anda hello; Bu durumda, hello istemci durum kodu 429 toohello uygulama ile bir DocumentClientException oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1beba-244">If you have more than one client cumulatively operating consistently above hello request rate, hello default retry count currently set too9 internally by hello client may not suffice; in this case, hello client throws a DocumentClientException with status code 429 toohello application.</span></span> <span data-ttu-id="1beba-245">Hello varsayılan yeniden deneme sayısına ayar hello RetryOptions hello ConnectionPolicy örneğinde tarafından değiştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-245">hello default retry count can be changed by setting hello RetryOptions on hello ConnectionPolicy instance.</span></span> <span data-ttu-id="1beba-246">Merhaba isteği hello istek hızı yukarıda toooperate devam ederse, varsayılan olarak 30 saniye sonra bir toplam bekleme süresi hello DocumentClientException 429 durum koduyla döndürülür.</span><span class="sxs-lookup"><span data-stu-id="1beba-246">By default, hello DocumentClientException with status code 429 is returned after a cumulative wait time of 30 seconds if hello request continues toooperate above hello request rate.</span></span> <span data-ttu-id="1beba-247">Merhaba varsayılan 9 veya kullanıcı tanımlı bir değer olması, bu hello geçerli yeniden deneme sayısı hello en fazla yeniden deneme sayısından daha az olduğunda bile oluşur.</span><span class="sxs-lookup"><span data-stu-id="1beba-247">This occurs even when hello current retry count is less than hello max retry count, be it hello default of 9 or a user-defined value.</span></span>

    <span data-ttu-id="1beba-248">Merhaba otomatik sırada yeniden deneme davranışı tooimprove dayanıklılık ve kullanılabilirlik hello için uygulamaların çoğu yardımcı olur, bu performans kıyaslamaları, özellikle olduğunda gecikme süresini ölçme yaparken at odds gelebilir.</span><span class="sxs-lookup"><span data-stu-id="1beba-248">While hello automated retry behavior helps tooimprove resiliency and usability for hello most applications, it might come at odds when doing performance benchmarks, especially when measuring latency.</span></span>  <span data-ttu-id="1beba-249">Merhaba deneme hello sunucu kısıtlama isabetler ve hello istemci SDK toosilently yeniden deneme neden olursa hello istemci gözlenen gecikme çıkmasına.</span><span class="sxs-lookup"><span data-stu-id="1beba-249">hello client-observed latency will spike if hello experiment hits hello server throttle and causes hello client SDK toosilently retry.</span></span> <span data-ttu-id="1beba-250">tooavoid gecikme ölçü hello ücret her işlem tarafından döndürülen performans denemeleri sırasında ani ve istekleri hello ayrılmış istek hızı çalıştığından emin olun.</span><span class="sxs-lookup"><span data-stu-id="1beba-250">tooavoid latency spikes during performance experiments, measure hello charge returned by each operation and ensure that requests are operating below hello reserved request rate.</span></span> <span data-ttu-id="1beba-251">Daha fazla bilgi için bkz: [istek birimleri](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="1beba-251">For more information, see [Request units](request-units.md).</span></span>
3. <span data-ttu-id="1beba-252">**Daha fazla üretilen işi için daha küçük belgeler için Tasarım**</span><span class="sxs-lookup"><span data-stu-id="1beba-252">**Design for smaller documents for higher throughput**</span></span>

    <span data-ttu-id="1beba-253">Merhaba verilen işlemi isteği giderleri (yani istek işleme maliyet) doğrudan olduğu hello belgenin toohello boyutu bağıntılı.</span><span class="sxs-lookup"><span data-stu-id="1beba-253">hello request charge (i.e. request processing cost) of a given operation is directly correlated toohello size of hello document.</span></span> <span data-ttu-id="1beba-254">Büyük belgeleri işlemleri birden çok küçük belgeler için işlemleri maliyeti.</span><span class="sxs-lookup"><span data-stu-id="1beba-254">Operations on large documents cost more than operations for small documents.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1beba-255">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="1beba-255">Next steps</span></span>
<span data-ttu-id="1beba-256">Bir örnek kullanılan uygulama tooevaluate için Cosmos DB birkaç istemci makineler yüksek performanslı senaryoları için bkz: [performansı ve ölçeği Cosmos DB ile test](performance-testing.md).</span><span class="sxs-lookup"><span data-stu-id="1beba-256">For a sample application used tooevaluate Cosmos DB for high-performance scenarios on a few client machines, see [Performance and scale testing with Cosmos DB](performance-testing.md).</span></span>

<span data-ttu-id="1beba-257">Ayrıca, uygulamanız ölçeği ve yüksek performans için tasarlama hakkında daha fazla toolearn bkz [bölümleme ve Azure Cosmos DB'de ölçeklendirme](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="1beba-257">Also, toolearn more about designing your application for scale and high performance, see [Partitioning and scaling in Azure Cosmos DB](partition-data.md).</span></span>
