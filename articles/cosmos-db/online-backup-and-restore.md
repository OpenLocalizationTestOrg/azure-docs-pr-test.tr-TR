---
title: "Çevrimiçi Yedekleme ve geri yükleme Azure Cosmos DB ile | Microsoft Docs"
description: "Otomatik yedekleme gerçekleştirmek ve bir Azure Cosmos DB veritabanını geri yükleme hakkında bilgi edinin."
keywords: "Yedekleme ve geri yükleme, çevrimiçi yedekleme"
services: cosmos-db
documentationcenter: 
author: RahulPrasad16
manager: jhubbard
editor: monicar
ms.assetid: 98eade4a-7ef4-4667-b167-6603ecd80b79
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 08/11/2017
ms.author: raprasa
ms.openlocfilehash: 130f0eb259621737d6dbdb151e363915fb334ce1
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 08/18/2017
---
# <a name="automatic-online-backup-and-restore-with-azure-cosmos-db"></a><span data-ttu-id="fb231-104">Otomatik çevrimiçi yedekleme ve geri yükleme ile Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="fb231-104">Automatic online backup and restore with Azure Cosmos DB</span></span>
<span data-ttu-id="fb231-105">Azure Cosmos DB tüm verilerinizi yedeklerini düzenli aralıklarla otomatik olarak alır.</span><span class="sxs-lookup"><span data-stu-id="fb231-105">Azure Cosmos DB automatically takes backups of all your data at regular intervals.</span></span> <span data-ttu-id="fb231-106">Otomatik yedekleme performansı veya veritabanı işlemlerinizin kullanılabilirliğini etkilemeden alınır.</span><span class="sxs-lookup"><span data-stu-id="fb231-106">The automatic backups are taken without affecting the performance or availability of your database operations.</span></span> <span data-ttu-id="fb231-107">Tüm yedeklemeler ayrı olarak başka bir depolama hizmetinde depolanır ve bu yedekleri bölgesel afetler karşı dayanıklılık için genel olarak çoğaltılır.</span><span class="sxs-lookup"><span data-stu-id="fb231-107">All your backups are stored separately in another storage service, and those backups are globally replicated for resiliency against regional disasters.</span></span> <span data-ttu-id="fb231-108">Yanlışlıkla Comos DB kapsayıcı sildiğinizde ve daha sonra veri kurtarma veya bir olağanüstü durum kurtarma çözümü gerektiren otomatik yedekleme senaryoları için tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="fb231-108">The automatic backups are intended for scenarios when you accidentally delete your Comos DB container and later require data recovery or a disaster recovery solution.</span></span>  

<span data-ttu-id="fb231-109">Bu makalede hızlı bir özeti veri artıklık ve kullanılabilirlik Cosmos DB'de ile başlayan ve yedeklemeleri ele alınmaktadır.</span><span class="sxs-lookup"><span data-stu-id="fb231-109">This article starts with a quick recap of the data redundancy and availability in Cosmos DB, and then discusses backups.</span></span> 

## <a name="high-availability-with-cosmos-db---a-recap"></a><span data-ttu-id="fb231-110">Cosmos DB - bir özeti ile yüksek kullanılabilirlik</span><span class="sxs-lookup"><span data-stu-id="fb231-110">High availability with Cosmos DB - a recap</span></span>
<span data-ttu-id="fb231-111">Cosmos DB olacak şekilde tasarlanmıştır [Genel dağıtılmış](distribute-data-globally.md) – yük devretme ve saydam çok girişli API'leri güdümlü İlkesi ile birlikte birden çok Azure bölgeler arasında verimliliği ölçeklendirmenizi sağlar.</span><span class="sxs-lookup"><span data-stu-id="fb231-111">Cosmos DB is designed to be [globally distributed](distribute-data-globally.md) – it allows you to scale throughput across multiple Azure regions along with policy driven failover and transparent multi-homing APIs.</span></span> <span data-ttu-id="fb231-112">Bir veritabanı sistem sunumu olarak [% 99,99 kullanılabilirlik SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db), Cosmos DB tüm yazma işlemlerini istemciye bildirmeden önce yerel disklere işlemi, bir yerel veri merkezi içinde çoğaltmalarının bir çekirdek tarafından uygulanır.</span><span class="sxs-lookup"><span data-stu-id="fb231-112">As a database system offering [99.99% availability SLAs](https://azure.microsoft.com/support/legal/sla/cosmos-db), all the writes in Cosmos DB are durably committed to local disks by a quorum of replicas within a local data center before acknowledging to the client.</span></span> <span data-ttu-id="fb231-113">Cosmos DB yüksek kullanılabilirliğini yerel depolama biriminde bulunan güvenir ve hiçbir harici depolama teknolojileri bağlı değildir unutmayın.</span><span class="sxs-lookup"><span data-stu-id="fb231-113">Note that the high availability of Cosmos DB relies on local storage and does not depend on any external storage technologies.</span></span> <span data-ttu-id="fb231-114">Ayrıca, veritabanı hesabınızı birden fazla Azure bölgesiyle ilişkiliyse, yazma diğer bölgeler arasında çoğaltılır.</span><span class="sxs-lookup"><span data-stu-id="fb231-114">Additionally, if your database account is associated with more than one Azure region, your writes are replicated across other regions as well.</span></span> <span data-ttu-id="fb231-115">Birçok dilediğiniz şekilde veritabanı hesabınızla ilişkili bölgeler salt okunur düşük gecikme, üretilen iş ve erişim verilerinizi ölçeklendirmek için olabilir.</span><span class="sxs-lookup"><span data-stu-id="fb231-115">To scale your throughput and access data at low latencies, you can have as many read regions associated with your database account as you like.</span></span> <span data-ttu-id="fb231-116">Okuma her bölgede (çoğaltılmış) veri çoğaltma kümesi boyunca işlemi kalıcıdır.</span><span class="sxs-lookup"><span data-stu-id="fb231-116">In each read region, the (replicated) data is durably persisted across a replica set.</span></span>  

<span data-ttu-id="fb231-117">Aşağıdaki çizimde gösterildiği gibi bir tek Cosmos DB kapsayıcıdır [yatay olarak bölümlenmiş](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="fb231-117">As illustrated in the following diagram, a single Cosmos DB container is [horizontally partitioned](partition-data.md).</span></span> <span data-ttu-id="fb231-118">"Bölüm" Aşağıdaki diyagramda bir daire gösterilir ve her bölüm bir çoğaltma kümesi yüksek oranda kullanılabilir hale gelir.</span><span class="sxs-lookup"><span data-stu-id="fb231-118">A “partition” is denoted by a circle in the following diagram, and each partition is made highly available via a replica set.</span></span> <span data-ttu-id="fb231-119">Yerel dağıtım (X ekseni tarafından gösterilen) tek bir Azure bölgesi içinde budur.</span><span class="sxs-lookup"><span data-stu-id="fb231-119">This is the local distribution within a single Azure region (denoted by the X axis).</span></span> <span data-ttu-id="fb231-120">Ayrıca, her bölüm (karşılık gelen çoğaltma kümesi) sonra genel veritabanı hesabınızı (örneğin, bölgelerde Bu çizim üç – Doğu ABD, Batı ABD ve orta Hindistan) ile ilişkili birden çok bölgeye dağıtılır.</span><span class="sxs-lookup"><span data-stu-id="fb231-120">Further, each partition (with its corresponding replica set) is then globally distributed across multiple regions associated with your database account (for example, in this illustration the three regions – East US, West US and Central India).</span></span> <span data-ttu-id="fb231-121">"Bölüm kümesi" Genel dağıtılmış olduğu varlık verilerinizi (Y ekseni tarafından gösterilen) her bölgede birden çok kopyasını kapsayan.</span><span class="sxs-lookup"><span data-stu-id="fb231-121">The “partition set” is a globally distributed entity comprising of multiple copies of your data in each region (denoted by the Y axis).</span></span> <span data-ttu-id="fb231-122">Veritabanı hesabınızla ilişkili bölgeler öncelik atayabilir ve Cosmos DB olacak saydam yük devretme durumunda olağanüstü durum sonraki bölge.</span><span class="sxs-lookup"><span data-stu-id="fb231-122">You can assign priority to the regions associated with your database account and Cosmos DB will transparently failover to the next region in case of disaster.</span></span> <span data-ttu-id="fb231-123">El ile de uygulamanız uçtan uca kullanılabilirliğini test etmek için yük devretme benzetimini de yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="fb231-123">You can also manually simulate failover to test the end-to-end availability of your application.</span></span>  

<span data-ttu-id="fb231-124">Aşağıdaki resimde artıklık Cosmos DB ile yüksek derecede gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="fb231-124">The following image illustrates the high degree of redundancy with Cosmos DB.</span></span>

![Yüksek düzeyde artıklık Cosmos DB ile](./media/online-backup-and-restore/redundancy.png)

![Yüksek düzeyde artıklık Cosmos DB ile](./media/online-backup-and-restore/global-distribution.png)

## <a name="full-automatic-online-backups"></a><span data-ttu-id="fb231-127">Tam otomatik, çevrimiçi yedeklemeleri</span><span class="sxs-lookup"><span data-stu-id="fb231-127">Full, automatic, online backups</span></span>
<span data-ttu-id="fb231-128">Hata, ı my kapsayıcı veya veritabanı silindi!</span><span class="sxs-lookup"><span data-stu-id="fb231-128">Oops, I deleted my container or database!</span></span> <span data-ttu-id="fb231-129">Cosmos DB ile yalnızca verilerinizi ancak verilerinizin yedekleri da bölgesel olağanüstü yüksek oranda yedekli ve esnek yapılır.</span><span class="sxs-lookup"><span data-stu-id="fb231-129">With Cosmos DB, not only your data, but the backups of your data are also made highly redundant and resilient to regional disasters.</span></span> <span data-ttu-id="fb231-130">Bu otomatik yedeklemeler şu anda yaklaşık dört saat alınır ve her zaman en son 2 yedeklemeler depolanır.</span><span class="sxs-lookup"><span data-stu-id="fb231-130">These automated backups are currently taken approximately every four hours and latest 2 backups are stored at all times.</span></span> <span data-ttu-id="fb231-131">Verilerin yanlışlıkla ise bırakılan veya bozuk, lütfen [Azure desteğine başvurun](https://azure.microsoft.com/support/options/) 8 saat içinde.</span><span class="sxs-lookup"><span data-stu-id="fb231-131">If the data is accidently dropped or corrupted, please [contact Azure support](https://azure.microsoft.com/support/options/) within 8 hours.</span></span> 

<span data-ttu-id="fb231-132">Yedeklemeler, performans veya veritabanı işlemlerinizin kullanılabilirliğini etkilemeden alınır.</span><span class="sxs-lookup"><span data-stu-id="fb231-132">The backups are taken without affecting the performance or availability of your database operations.</span></span> <span data-ttu-id="fb231-133">Cosmos DB yedekleme sağlanan RUs kullanma veya performansını etkileyen olmadan ve veritabanınızın kullanılabilirliğini etkilemeden arka planda alır.</span><span class="sxs-lookup"><span data-stu-id="fb231-133">Cosmos DB takes the backup in the background without consuming your provisioned RUs or affecting the performance and without affecting the availability of your database.</span></span> 

<span data-ttu-id="fb231-134">Cosmos DB içinde depolanan verileriniz farklı olarak, otomatik yedeklemeler, Azure Blob Storage hizmetinde depolanır.</span><span class="sxs-lookup"><span data-stu-id="fb231-134">Unlike your data that is stored inside Cosmos DB, the automatic backups are stored in Azure Blob Storage service.</span></span> <span data-ttu-id="fb231-135">Düşük gecikme/verimli karşıya yükleme güvence altına almak için yedekleme anlık görüntü Cosmos DB veritabanı hesabınızın geçerli yazma bölge ile aynı bölgede Azure Blob storage'nın bir örneğine yüklenir.</span><span class="sxs-lookup"><span data-stu-id="fb231-135">To guarantee the low latency/efficient upload, the snapshot of your backup is uploaded to an instance of Azure Blob storage in the same region as the current write region of your Cosmos DB database account.</span></span> <span data-ttu-id="fb231-136">Bölgesel olağanüstü durum karşı dayanıklılık için Azure Blob Depolama, yedekleme verilerinizin her anlık görüntü yeniden başka bir bölgeye coğrafi olarak yedekli depolama (GRS) üzerinden çoğaltılır.</span><span class="sxs-lookup"><span data-stu-id="fb231-136">For resiliency against regional disaster, each snapshot of your backup data in Azure Blob Storage is again replicated via geo-redundant storage (GRS) to another region.</span></span> <span data-ttu-id="fb231-137">Aşağıdaki diyagramda, Batı ABD uzak bir Azure Blob Storage hesabında tüm Cosmos DB kapsayıcıyla (üç birincil içindeki tüm bölümlerin Batı ABD, bu örnekte) yedeklenen ve ardından GRS Doğu ABD kopyalandığı gösterir.</span><span class="sxs-lookup"><span data-stu-id="fb231-137">The following diagram shows that the entire Cosmos DB container (with all three primary partitions in West US, in this example) is backed up in a remote Azure Blob Storage account in West US and then GRS replicated to East US.</span></span> 

<span data-ttu-id="fb231-138">Aşağıdaki resimde GRS Azure depolama birimindeki tüm Cosmos DB varlıkların düzenli tam yedeklemeler gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="fb231-138">The following image illustrates periodic full backups of all Cosmos DB entities in GRS Azure Storage.</span></span>

![Tüm Cosmos DB varlıkların GRS Azure storage'da düzenli tam yedeklemeler](./media/online-backup-and-restore/automatic-backup.png)

## <a name="backup-retention-period"></a><span data-ttu-id="fb231-140">Yedekleme saklama süresi</span><span class="sxs-lookup"><span data-stu-id="fb231-140">Backup retention period</span></span>
<span data-ttu-id="fb231-141">Yukarıda açıklandığı gibi Azure Cosmos DB dört saatte verilerinizin anlık görüntüleri alır ve her bölümün son iki anlık görüntü 30 gün boyunca korur.</span><span class="sxs-lookup"><span data-stu-id="fb231-141">As described above, Azure Cosmos DB takes snapshots of your data every four hours and retains the last two snapshots of every partition for 30 days.</span></span> <span data-ttu-id="fb231-142">Bizim uyumluluk düzenlemeleri anlık görüntüleri 90 gün sonra temizlenir.</span><span class="sxs-lookup"><span data-stu-id="fb231-142">Per our compliance regulations, snapshots are purged after 90 days.</span></span>

<span data-ttu-id="fb231-143">Kendi anlık görüntülerini korumak istiyorsanız, JSON seçeneği ver Azure Cosmos DB'de kullanabilirsiniz [veri geçiş aracı](import-data.md#export-to-json-file) ek yedeklemeleri zamanlamak için.</span><span class="sxs-lookup"><span data-stu-id="fb231-143">If you want to maintain your own snapshots, you can use the export to JSON option in the Azure Cosmos DB [Data Migration tool](import-data.md#export-to-json-file) to schedule additional backups.</span></span> 

## <a name="restoring-a-database-from-an-online-backup"></a><span data-ttu-id="fb231-144">Bir veritabanı çevrimiçi bir yedekten geri yükleme</span><span class="sxs-lookup"><span data-stu-id="fb231-144">Restoring a database from an online backup</span></span>
<span data-ttu-id="fb231-145">Veritabanı veya koleksiyon yanlışlıkla silerseniz, şunları yapabilirsiniz [bir destek bileti dosya](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) veya [Azure destek çağrısı](https://azure.microsoft.com/support/options/) verileri son otomatik yedeklemeden geri yüklemek için.</span><span class="sxs-lookup"><span data-stu-id="fb231-145">If you accidentally delete your database or collection, you can [file a support ticket](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) or [call Azure support](https://azure.microsoft.com/support/options/) to restore the data from the last automatic backup.</span></span> <span data-ttu-id="fb231-146">Veri bozulması sorunları nedeniyle veritabanınızı geri yüklemeniz gerekiyorsa bkz [veri bozulması işleme](#handling-data-corruption) olarak bozuk verilerin yedeklemeleri penetrating engellemek için ek adımlar uygulamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="fb231-146">If you need to restore your database because of data corruption issue, see [Handling data corruption](#handling-data-corruption) as you need to take additional steps to prevent the corrupted data from penetrating the backups.</span></span> <span data-ttu-id="fb231-147">Belirli bir anlık görüntüye geri yüklenecek yedekleme için verileri bu anlık görüntü için yedekleme döngüsü boyunca kullanılabilir olduğunu Cosmos DB gerektirir.</span><span class="sxs-lookup"><span data-stu-id="fb231-147">For a specific snapshot of your backup to be restored, Cosmos DB requires that the data was available for the duration of the backup cycle for that snapshot.</span></span>

## <a name="handling-data-corruption"></a><span data-ttu-id="fb231-148">Veri bozulması işleme</span><span class="sxs-lookup"><span data-stu-id="fb231-148">Handling data corruption</span></span>
<span data-ttu-id="fb231-149">Azure Cosmos DB sistemde her bölümün son iki yedekleme korur.</span><span class="sxs-lookup"><span data-stu-id="fb231-149">Azure Cosmos DB retains the last two backups of every partition in the system.</span></span> <span data-ttu-id="fb231-150">Son sürümlerinden birini geri bu yana bir kapsayıcı (belgeler, grafik, tablo koleksiyonu) veya bir veritabanı yanlışlıkla silindiğinde, bu model çok iyi çalışır.</span><span class="sxs-lookup"><span data-stu-id="fb231-150">This model works very well when a container (collection of documents, graph, table) or a database is accidentally deleted since one of the last versions can be restored.</span></span> <span data-ttu-id="fb231-151">Ancak, durumda kullanıcıların bir veri bozulması sorunu zaman çıkarabilir, Azure Cosmos DB veri bozulmasını farkında ve bozulmayı yedeklemeleri penetrated mümkündür.</span><span class="sxs-lookup"><span data-stu-id="fb231-151">However, in the case when when users may introduce a data corruption issue, Azure Cosmos DB may be unaware of the data corruption, and it is possible that the corruption may have penetrated the backups.</span></span> <span data-ttu-id="fb231-152">Bozulması algıladı hemen yedeklemeler bozuk verilerle üzerine korunmaya bozuk kapsayıcı (grafik/koleksiyonu/tablosu) silmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="fb231-152">As soon as corruption is detected, you should delete the corrupted container (collection/graph/table) so that backups are protected from being overwritten with corrupted data.</span></span> <span data-ttu-id="fb231-153">Dört saat eski olabilir son yedekleme olduğundan, kullanıcı uygulayabileceğiniz [akış değiştirmek](change-feed.md) yakalamak ve son dört kapsayıcı silmeden önce saat değerinde veri depolamak için.</span><span class="sxs-lookup"><span data-stu-id="fb231-153">Since the last backup could be four hours old, the user can employ [change feed](change-feed.md) to capture and store the last four hours worth of data before deleting the container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fb231-154">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="fb231-154">Next steps</span></span>

<span data-ttu-id="fb231-155">Birden çok veri merkezleri veritabanınızda çoğaltmak için bkz: [verilerinizle genel Cosmos DB dağıtmak](distribute-data-globally.md).</span><span class="sxs-lookup"><span data-stu-id="fb231-155">To replicate your database in multiple data centers, see [distribute your data globally with Cosmos DB](distribute-data-globally.md).</span></span> 

<span data-ttu-id="fb231-156">Azure desteği, dosya kişiye [Azure portalından bir bilet dosya](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span><span class="sxs-lookup"><span data-stu-id="fb231-156">To file contact Azure Support, [file a ticket from the Azure portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span></span>

