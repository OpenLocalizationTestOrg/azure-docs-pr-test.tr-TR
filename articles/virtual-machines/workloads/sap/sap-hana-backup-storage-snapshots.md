---
title: "aaaSAP HANA Azure yedekleme depolama anlık görüntü tabanlı | Microsoft Docs"
description: "İki ana yedekleme olasılıklarını SAP HANA Azure sanal makinelerde vardır, bu makalede, SAP HANA yedekleme depolama anlık görüntü tabanlı yer almaktadır"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: 32bb80f5a928a2cf63699bfe4f4cf5bbad81e6fe
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="sap-hana-backup-based-on-storage-snapshots"></a><span data-ttu-id="12796-103">Depolama anlık görüntülerine dayalı SAP HANA yedeklemesi</span><span class="sxs-lookup"><span data-stu-id="12796-103">SAP HANA backup based on storage snapshots</span></span>

## <a name="introduction"></a><span data-ttu-id="12796-104">Giriş</span><span class="sxs-lookup"><span data-stu-id="12796-104">Introduction</span></span>

<span data-ttu-id="12796-105">Bu üç bölümlük SAP HANA yedeklemede ilgili makaleleri bir parçasıdır.</span><span class="sxs-lookup"><span data-stu-id="12796-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="12796-106">[SAP HANA için yedekleme Kılavuzu Azure sanal makineler üzerinde](sap-hana-backup-guide.md) Başlarken, genel bir bakış ve bilgi sağlar ve [SAP HANA Azure yedekleme dosya düzeyinde](sap-hana-backup-file-level.md) kapsar hello dosya tabanlı yedekleme seçeneği.</span><span class="sxs-lookup"><span data-stu-id="12796-106">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) covers hello file-based backup option.</span></span>

<span data-ttu-id="12796-107">Tek Örnekli hepsi bir arada demo sistem için bir VM yedekleme özelliğini kullanarak, bir hello işletim sistemi düzeyinde adresindeki HANA yedeklemeleri yönetmek yerine VM Yedekleme yapmayı düşünmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="12796-107">When using a VM backup feature for a single-instance all-in-one demo system, one should consider doing a VM backup instead of managing HANA backups at hello OS level.</span></span> <span data-ttu-id="12796-108">Tootake Azure blob anlık görüntüleri toocreate ekli tooa sanal makine olan ve hello HANA veri dosyalarını tutmak tek tek sanal disk kopyaları alternatiftir.</span><span class="sxs-lookup"><span data-stu-id="12796-108">An alternative is tootake Azure blob snapshots toocreate copies of individual virtual disks, which are attached tooa virtual machine, and keep hello HANA data files.</span></span> <span data-ttu-id="12796-109">Ancak hello sistem yukarı durumdayken VM yedekleme veya disk anlık görüntü oluşturma ve çalıştırma olduğunda uygulama tutarlılığı kritik noktasıdır.</span><span class="sxs-lookup"><span data-stu-id="12796-109">But a critical point is app consistency when creating a VM backup or disk snapshot while hello system is up and running.</span></span> <span data-ttu-id="12796-110">Bkz: _depolama anlık görüntüleri duruma getirirken SAP HANA veri tutarlılığını_ hello ilgili makalede [yedekleme Kılavuzu SAP HANA Azure sanal makineler üzerinde](sap-hana-backup-guide.md).</span><span class="sxs-lookup"><span data-stu-id="12796-110">See _SAP HANA data consistency when taking storage snapshots_ in hello related article [Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md).</span></span> <span data-ttu-id="12796-111">SAP HANA bu tür bir depolama anlık görüntüleri destekleyen bir özelliği vardır.</span><span class="sxs-lookup"><span data-stu-id="12796-111">SAP HANA has a feature that supports these kinds of storage snapshots.</span></span>

## <a name="sap-hana-snapshots"></a><span data-ttu-id="12796-112">SAP HANA anlık görüntüler</span><span class="sxs-lookup"><span data-stu-id="12796-112">SAP HANA snapshots</span></span>

<span data-ttu-id="12796-113">SAP HANA içinde depolama anlık destekleyen bir özellik yok.</span><span class="sxs-lookup"><span data-stu-id="12796-113">There is a feature in SAP HANA that supports taking a storage snapshot.</span></span> <span data-ttu-id="12796-114">Ancak, aralık 2016 itibariyle bir kısıtlama yoktur toosingle kapsayıcı sistemler.</span><span class="sxs-lookup"><span data-stu-id="12796-114">However, as of December 2016, there is a restriction toosingle-container systems.</span></span> <span data-ttu-id="12796-115">Çok müşterili kapsayıcı yapılandırmaları, bu tür bir veritabanı anlık görüntüsü desteklemez (bkz [depolama anlık görüntü (SAP HANA Studio)](https://help.sap.com/saphelp_hanaplatform/helpdata/en/a0/3f8f08501e44d89115db3c5aa08e3f/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="12796-115">Multitenant container configurations do not support this kind of database snapshot (see [Create a Storage Snapshot (SAP HANA Studio)](https://help.sap.com/saphelp_hanaplatform/helpdata/en/a0/3f8f08501e44d89115db3c5aa08e3f/content.htm)).</span></span>

<span data-ttu-id="12796-116">Şu şekilde çalışır:</span><span class="sxs-lookup"><span data-stu-id="12796-116">It works as follows:</span></span>

- <span data-ttu-id="12796-117">Merhaba SAP HANA anlık görüntü başlatarak depolama anlık görüntü için hazırlama</span><span class="sxs-lookup"><span data-stu-id="12796-117">Prepare for a storage snapshot by initiating hello SAP HANA snapshot</span></span>
- <span data-ttu-id="12796-118">Merhaba depolama anlık görüntü (anlık görüntü, örneğin Azure blob) çalıştırın</span><span class="sxs-lookup"><span data-stu-id="12796-118">Run hello storage snapshot (Azure blob snapshot, for example)</span></span>
- <span data-ttu-id="12796-119">Merhaba SAP HANA anlık görüntü onaylayın</span><span class="sxs-lookup"><span data-stu-id="12796-119">Confirm hello SAP HANA snapshot</span></span>

![Bu ekran görüntüsü, bir SAP HANA veri anlık bir SQL deyimi oluşturduğunuz gösterir.](media/sap-hana-backup-storage-snapshots/image011.png)

<span data-ttu-id="12796-121">Bu ekran, SAP HANA veri anlık görüntüsünü bir SQL deyimi oluşturduğunuz gösterir.</span><span class="sxs-lookup"><span data-stu-id="12796-121">This screenshot shows that an SAP HANA data snapshot can be created via a SQL statement.</span></span>

![ardından anlık görüntü hello hello yedekleme kataloğu SAP HANA Studio'da da görüntülenir.](media/sap-hana-backup-storage-snapshots/image012.png)

<span data-ttu-id="12796-123">SAP HANA Studio'da hello yedekleme kataloğunda sonra anlık görüntü hello da görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="12796-123">hello snapshot then also appears in hello backup catalog in SAP HANA Studio.</span></span>

![Disk üzerinde hello anlık görüntü hello SAP HANA veri dizininde görüntülenir](media/sap-hana-backup-storage-snapshots/image013.png)

<span data-ttu-id="12796-125">Disk üzerinde hello anlık görüntü hello SAP HANA veri dizininde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="12796-125">On disk, hello snapshot shows up in hello SAP HANA data directory.</span></span>

<span data-ttu-id="12796-126">Merhaba dosya sistemi tutarlılığı SAP HANA hello anlık görüntü hazırlama modunda çalışırken hello depolama anlık görüntü çalıştırmadan önce de garanti tooensure sahip.</span><span class="sxs-lookup"><span data-stu-id="12796-126">One has tooensure that hello file system consistency is also guaranteed before running hello storage snapshot while SAP HANA is in hello snapshot preparation mode.</span></span> <span data-ttu-id="12796-127">Bkz: _depolama anlık görüntüleri duruma getirirken SAP HANA veri tutarlılığını_ hello ilgili makalede [yedekleme Kılavuzu SAP HANA Azure sanal makineler üzerinde](sap-hana-backup-guide.md).</span><span class="sxs-lookup"><span data-stu-id="12796-127">See _SAP HANA data consistency when taking storage snapshots_ in hello related article [Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md).</span></span>

<span data-ttu-id="12796-128">Merhaba depolama anlık görüntü yaptıktan sonra kritik tooconfirm hello SAP HANA anlık görüntüsüdür.</span><span class="sxs-lookup"><span data-stu-id="12796-128">Once hello storage snapshot is done, it is critical tooconfirm hello SAP HANA snapshot.</span></span> <span data-ttu-id="12796-129">Karşılık gelen bir SQL deyimi toorun yoktur: yedekleme verilerini Kapat anlık görüntü (bkz [yedekleme verileri Kapat anlık görüntü deyimi (yedekleme ve kurtarma)](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/9739966f7f4bd5818769ad4ce6a7f8/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="12796-129">There is a corresponding SQL statement toorun: BACKUP DATA CLOSE SNAPSHOT (see [BACKUP DATA CLOSE SNAPSHOT Statement (Backup and Recovery)](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/9739966f7f4bd5818769ad4ce6a7f8/content.htm)).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="12796-130">Merhaba HANA anlık görüntü onaylayın.</span><span class="sxs-lookup"><span data-stu-id="12796-130">Confirm hello HANA snapshot.</span></span> <span data-ttu-id="12796-131">Son çok&quot;kopyalama yazarken,&quot; SAP HANA ek disk alanı hazırlama anlık görüntü modu ve hello SAP HANA anlık görüntü onaylandıktan kadar olası toostart yeni yedeklemeler olmadığı gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="12796-131">Due too&quot;Copy-on-Write,&quot; SAP HANA might require additional disk space in snapshot-prepare mode, and it is not possible toostart new backups until hello SAP HANA snapshot is confirmed.</span></span>

## <a name="hana-vm-backup-via-azure-backup-service"></a><span data-ttu-id="12796-132">Azure Backup hizmeti aracılığıyla HANA VM yedekleme</span><span class="sxs-lookup"><span data-stu-id="12796-132">HANA VM backup via Azure Backup service</span></span>

<span data-ttu-id="12796-133">Aralık 2016 itibariyle hello Azure Backup hizmeti yedekleme aracısını hello Linux VM'ler için kullanılabilir değil.</span><span class="sxs-lookup"><span data-stu-id="12796-133">As of December 2016, hello backup agent of hello Azure Backup service is not available for Linux VMs.</span></span> <span data-ttu-id="12796-134">Azure yedekleme toomake kullanımını hello dosya/dizin düzeyi, bir SAP HANA yedekleme dosyalarını tooa Windows VM kopyalayın ve hello yedekleme aracısını kullanın.</span><span class="sxs-lookup"><span data-stu-id="12796-134">toomake use of Azure backup on hello file/directory level, one would copy SAP HANA backup files tooa Windows VM and then use hello backup agent.</span></span> <span data-ttu-id="12796-135">Aksi takdirde, yalnızca tam bir Linux VM yedekleme hello Azure Backup hizmeti mümkündür.</span><span class="sxs-lookup"><span data-stu-id="12796-135">Otherwise, only a full Linux VM backup is possible via hello Azure Backup service.</span></span> <span data-ttu-id="12796-136">Bkz: [hello genel bakış özellikleri Azure Yedekleme'de](../../../backup/backup-introduction-to-azure-backup.md) toofind daha fazla bilgi.</span><span class="sxs-lookup"><span data-stu-id="12796-136">See [Overview of hello features in Azure Backup](../../../backup/backup-introduction-to-azure-backup.md) toofind out more.</span></span>

<span data-ttu-id="12796-137">Hello Azure Backup hizmeti bir seçenek tooback sunar ve bir VM geri yükleyin.</span><span class="sxs-lookup"><span data-stu-id="12796-137">hello Azure Backup service offers an option tooback up and restore a VM.</span></span> <span data-ttu-id="12796-138">Bu hizmet ve nasıl çalıştığı hakkında daha fazla bilgi hello makalesinde bulunabilir [azure'da VM yedekleme altyapınızı planlama](../../../backup/backup-azure-vms-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="12796-138">More information about this service and how it works can be found in hello article [Plan your VM backup infrastructure in Azure](../../../backup/backup-azure-vms-introduction.md).</span></span>

<span data-ttu-id="12796-139">Toothat makale göre iki önemli noktalar şunlardır:</span><span class="sxs-lookup"><span data-stu-id="12796-139">There are two important considerations according toothat article:</span></span>

<span data-ttu-id="12796-140">_&quot;Linux eşdeğer platform tooVSS olmadığından Linux sanal makineleri için yalnızca dosya tutarlı yedeklemeler olasılığı vardır.&quot;_</span><span class="sxs-lookup"><span data-stu-id="12796-140">_&quot;For Linux virtual machines, only file-consistent backups are possible, since Linux does not have an equivalent platform tooVSS.&quot;_</span></span>

<span data-ttu-id="12796-141">_&quot;Uygulamaların gerekiyor tooimplement kendi &quot;düzeltme&quot; hello mekanizmasını geri veri.&quot;_</span><span class="sxs-lookup"><span data-stu-id="12796-141">_&quot;Applications need tooimplement their own &quot;fix-up&quot; mechanism on hello restored data.&quot;_</span></span>

<span data-ttu-id="12796-142">Bu nedenle, bir tane toomake hello yedekleme başladığında SAP HANA disk tutarlı bir durumda olduğundan emin içeriyor.</span><span class="sxs-lookup"><span data-stu-id="12796-142">Therefore, one has toomake sure SAP HANA is in a consistent state on disk when hello backup starts.</span></span> <span data-ttu-id="12796-143">Bkz: _SAP HANA anlık görüntüleri_ hello belgenin önceki bölümlerinde açıklanan.</span><span class="sxs-lookup"><span data-stu-id="12796-143">See _SAP HANA snapshots_ described earlier in hello document.</span></span> <span data-ttu-id="12796-144">Ancak bu anlık görüntü hazırlama modunda SAP HANA kaldığında oluşan olası bir sorunu olduğunu.</span><span class="sxs-lookup"><span data-stu-id="12796-144">But there is a potential issue when SAP HANA stays in this snapshot preparation mode.</span></span> <span data-ttu-id="12796-145">Bkz: [depolama anlık görüntü (SAP HANA Studio)](https://help.sap.com/saphelp_hanaplatform/helpdata/en/a0/3f8f08501e44d89115db3c5aa08e3f/content.htm) daha fazla bilgi için.</span><span class="sxs-lookup"><span data-stu-id="12796-145">See [Create a Storage Snapshot (SAP HANA Studio)](https://help.sap.com/saphelp_hanaplatform/helpdata/en/a0/3f8f08501e44d89115db3c5aa08e3f/content.htm) for more information.</span></span>

<span data-ttu-id="12796-146">Bu makale durumları:</span><span class="sxs-lookup"><span data-stu-id="12796-146">That article states:</span></span>

<span data-ttu-id="12796-147">_&quot;Tooconfirm önerilir veya oluşturulduktan sonra depolama anlık görüntü mümkün olan en kısa sürede bırakın. Anlık görüntü ilgili verileri Hello depolama anlık görüntü hazırlanan ya da oluşturulan hello dondurulmuş. Başlangıç anlık görüntü ilgili verileri dondurulmuş kalırken değişiklikleri hala hello veritabanında yapılabilir. Anlık görüntü ilgili verileri toobe değiştirilen dondurulmuş hello değişikliğe neden olmaz. Bunun yerine, hello değişiklikler hello depolama anlık görüntüden ayrı hello veri alanında toopositions yazılır. Değişiklikleri de toohello günlüğüne yazılır. Ancak, anlık görüntü ilgili verileri uzun hello hello dondurulmuş tutulur, veri birimi büyüyebilir daha fazla hello hello.&quot;_</span><span class="sxs-lookup"><span data-stu-id="12796-147">_&quot;It is strongly recommended tooconfirm or abandon a storage snapshot as soon as possible after it has been created. While hello storage snapshot is being prepared or created, hello snapshot-relevant data is frozen. While hello snapshot-relevant data remains frozen, changes can still be made in hello database. Such changes will not cause hello frozen snapshot-relevant data toobe changed. Instead, hello changes are written toopositions in hello data area that are separate from hello storage snapshot. Changes are also written toohello log. However, hello longer hello snapshot-relevant data is kept frozen, hello more hello data volume can grow.&quot;_</span></span>

<span data-ttu-id="12796-148">Azure yedekleme hello dosya sistemi tutarlılığı Azure VM uzantıları aracılığıyla ilgilenir.</span><span class="sxs-lookup"><span data-stu-id="12796-148">Azure Backup takes care of hello file system consistency via Azure VM extensions.</span></span> <span data-ttu-id="12796-149">Bu uzantılar, mevcut tek başına değildir ve yalnızca Azure Backup hizmeti ile birlikte çalışır.</span><span class="sxs-lookup"><span data-stu-id="12796-149">These extensions are not available standalone, and work only in combination with Azure Backup service.</span></span> <span data-ttu-id="12796-150">Bununla birlikte, yine gereksinim toomanage bir SAP HANA anlık görüntü tooguarantee uygulama tutarlılığı etmektir.</span><span class="sxs-lookup"><span data-stu-id="12796-150">Nevertheless, it is still a requirement toomanage an SAP HANA snapshot tooguarantee app consistency.</span></span>

<span data-ttu-id="12796-151">Azure yedekleme iki ana aşamadan oluşur:</span><span class="sxs-lookup"><span data-stu-id="12796-151">Azure Backup has two major phases:</span></span>

- <span data-ttu-id="12796-152">Anlık görüntü alın</span><span class="sxs-lookup"><span data-stu-id="12796-152">Take Snapshot</span></span>
- <span data-ttu-id="12796-153">Veri toovault Aktarım</span><span class="sxs-lookup"><span data-stu-id="12796-153">Transfer data toovault</span></span>

<span data-ttu-id="12796-154">Bir anlık görüntü alma hello Azure Backup hizmeti aşaması tamamlandıktan sonra bu nedenle bir hello SAP HANA anlık görüntü onaylayabilir.</span><span class="sxs-lookup"><span data-stu-id="12796-154">So one could confirm hello SAP HANA snapshot once hello Azure Backup service phase of taking a snapshot is completed.</span></span> <span data-ttu-id="12796-155">Birkaç dakika toosee hello Azure portal geçmesi gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="12796-155">It might take several minutes toosee in hello Azure portal.</span></span>

![Bu şekilde hello yedekleme işi listesinin bir Azure Backup hizmeti parçası gösterilmektedir](media/sap-hana-backup-storage-snapshots/image014.png)

<span data-ttu-id="12796-157">Bu şekilde hello yedekleme işi listesinin hello HANA test VM yukarı kullanılan tooback olan bir Azure Backup hizmeti parçası gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="12796-157">This figure shows part of hello backup job list of an Azure Backup service, which was used tooback up hello HANA test VM.</span></span>

![tooshow hello iş ayrıntıları, hello yedekleme işinden hello Azure portal'ı tıklatın](media/sap-hana-backup-storage-snapshots/image015.png)

<span data-ttu-id="12796-159">tooshow hello iş ayrıntıları, hello yedekleme işinden hello Azure portal'ı tıklatın.</span><span class="sxs-lookup"><span data-stu-id="12796-159">tooshow hello job details, click hello backup job in hello Azure portal.</span></span> <span data-ttu-id="12796-160">Burada, bir iki aşamaya hello görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="12796-160">Here, one can see hello two phases.</span></span> <span data-ttu-id="12796-161">Tamamlandı olarak hello anlık görüntü aşaması görüntüleyene kadar birkaç dakika sürebilir.</span><span class="sxs-lookup"><span data-stu-id="12796-161">It might take a few minutes until it shows hello snapshot phase as completed.</span></span> <span data-ttu-id="12796-162">Başlangıç zamanının çoğunu hello veri aktarımı aşamasında harcanır.</span><span class="sxs-lookup"><span data-stu-id="12796-162">Most of hello time is spent in hello data transfer phase.</span></span>

## <a name="hana-vm-backup-automation-via-azure-backup-service"></a><span data-ttu-id="12796-163">Azure Backup hizmeti aracılığıyla HANA VM yedekleme Otomasyonu</span><span class="sxs-lookup"><span data-stu-id="12796-163">HANA VM backup automation via Azure Backup service</span></span>

<span data-ttu-id="12796-164">Biri el ile Merhaba SAP HANA anlık görüntü bir kez daha önce açıklandığı gibi hello Azure yedekleme anlık görüntü aşaması tamamlandığında, ancak bir yönetici hello yedekleme işi hello Azure portal listesinde izlemeyecek çünkü bunu yararlı tooconsider Otomasyon onaylayabilir.</span><span class="sxs-lookup"><span data-stu-id="12796-164">One could manually confirm hello SAP HANA snapshot once hello Azure Backup snapshot phase is completed, as described earlier, but it is helpful tooconsider automation because an admin might not monitor hello backup job list in hello Azure portal.</span></span>

<span data-ttu-id="12796-165">Burada, nasıl, Azure PowerShell cmdlet'leri gerçekleştirilmesi bir açıklaması verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="12796-165">Here is an explanation how it could be accomplished via Azure PowerShell cmdlets.</span></span>

![Azure Backup hizmeti hello adı hana-yedekleme-kasayla oluşturuldu](media/sap-hana-backup-storage-snapshots/image016.png)

<span data-ttu-id="12796-167">Azure Backup hizmeti hello adla oluşturuldu &quot;hana-yedekleme-kasası.&quot; PS komutu hello **Get-AzureRmRecoveryServicesVault-ad hana yedekleme kasası** hello karşılık gelen nesnesini alır.</span><span class="sxs-lookup"><span data-stu-id="12796-167">An Azure Backup service was created with hello name &quot;hana-backup-vault.&quot; hello PS command **Get-AzureRmRecoveryServicesVault -Name hana-backup-vault** retrieves hello corresponding object.</span></span> <span data-ttu-id="12796-168">Kullanılan tooset hello sonra yedekleme içerik üzerinde hello sonraki şekilde görüldüğü gibi bu nesnesidir.</span><span class="sxs-lookup"><span data-stu-id="12796-168">This object is then used tooset hello backup context as seen on hello next figure.</span></span>

![Bir yedekleme işi şu anda devam ediyor hello için kontrol edebilirsiniz](media/sap-hana-backup-storage-snapshots/image017.png)

<span data-ttu-id="12796-170">Ayar hello doğru bağlamı sonra bir hello yedekleme işi şu anda devam ediyor için denetleyin ve iş ayrıntılarını bakın.</span><span class="sxs-lookup"><span data-stu-id="12796-170">After setting hello correct context, one can check for hello backup job currently in progress, and then look for its job details.</span></span> <span data-ttu-id="12796-171">Merhaba alt liste hello anlık görüntü hello Azure yedekleme işi aşaması zaten tamamlanmış gösterir:</span><span class="sxs-lookup"><span data-stu-id="12796-171">hello subtask list shows if hello snapshot phase of hello Azure backup job is already completed:</span></span>

```
$ars = Get-AzureRmRecoveryServicesVault -Name hana-backup-vault
Set-AzureRmRecoveryServicesVaultContext -Vault $ars
$jid = Get-AzureRmRecoveryServicesBackupJob -Status InProgress | select -ExpandProperty jobid
Get-AzureRmRecoveryServicesBackupJobDetails -Jobid $jid | select -ExpandProperty subtasks
```

![Yoklama hello değeri tooCompleted renge kadar döngü](media/sap-hana-backup-storage-snapshots/image018.png)

<span data-ttu-id="12796-173">Bir değişkende Hello iş ayrıntılarını depolandıktan sonra yalnızca PS sözdizimi tooget toohello ilk dizi girişi ve hello durum değeri alın.</span><span class="sxs-lookup"><span data-stu-id="12796-173">Once hello job details are stored in a variable, it is simply PS syntax tooget toohello first array entry and retrieve hello status value.</span></span> <span data-ttu-id="12796-174">toocomplete hello otomasyon komut dosyası, bu kadar Döngü yoklama hello değeri bırakır çok&quot;tamamlandı.&quot;</span><span class="sxs-lookup"><span data-stu-id="12796-174">toocomplete hello automation script, poll hello value in a loop until it turns too&quot;Completed.&quot;</span></span>

```
$st = Get-AzureRmRecoveryServicesBackupJobDetails -Jobid $jid | select -ExpandProperty subtasks
$st[0] | select -ExpandProperty status
```

## <a name="hana-license-key-and-vm-restore-via-azure-backup-service"></a><span data-ttu-id="12796-175">HANA lisans anahtarı ve VM Azure Backup hizmeti geri yükleme</span><span class="sxs-lookup"><span data-stu-id="12796-175">HANA license key and VM restore via Azure Backup service</span></span>

<span data-ttu-id="12796-176">Hello Azure Backup hizmeti tasarlanmış toocreate yeni bir VM geri yükleme sırasında ' dir.</span><span class="sxs-lookup"><span data-stu-id="12796-176">hello Azure Backup service is designed toocreate a new VM during restore.</span></span> <span data-ttu-id="12796-177">Toodo artık doğru hiçbir plan yoktur bir &quot;yerinde&quot; mevcut bir Azure VM'i geri yükleme.</span><span class="sxs-lookup"><span data-stu-id="12796-177">There is no plan right now toodo an &quot;in-place&quot; restore of an existing Azure VM.</span></span>

![Bu şekilde hello Azure hizmeti hello geri yükleme seçeneği hello Azure portal gösterilmektedir.](media/sap-hana-backup-storage-snapshots/image019.png)

<span data-ttu-id="12796-179">Bu şekilde hello Azure hizmeti hello geri yükleme seçeneği hello Azure portal gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="12796-179">This figure shows hello restore option of hello Azure service in hello Azure portal.</span></span> <span data-ttu-id="12796-180">Bir geri yükleme sırasında bir VM oluşturma hello diskleri geri yükleme arasında seçim yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="12796-180">One can choose between creating a VM during restore or restoring hello disks.</span></span> <span data-ttu-id="12796-181">Merhaba diskleri geri yükledikten sonra hala gerekli toocreate üzerine yeni bir VM olur.</span><span class="sxs-lookup"><span data-stu-id="12796-181">After restoring hello disks, it is still necessary toocreate a new VM on top of it.</span></span> <span data-ttu-id="12796-182">Her yeni bir VM oluşturulan Azure hello benzersiz VM kimliği değişiklikler (bkz [erişme ve Azure VM benzersiz kimliği kullanarak](https://azure.microsoft.com/blog/accessing-and-using-azure-vm-unique-id/)).</span><span class="sxs-lookup"><span data-stu-id="12796-182">Whenever a new VM gets created on Azure hello unique VM ID changes (see [Accessing and Using Azure VM Unique ID](https://azure.microsoft.com/blog/accessing-and-using-azure-vm-unique-id/)).</span></span>

![Bu şekilde hello Azure VM benzersiz kimliği, önce ve sonra Azure Backup hizmeti ile Merhaba geri yükleme gösterilmektedir.](media/sap-hana-backup-storage-snapshots/image020.png)

<span data-ttu-id="12796-184">Bu şekilde hello Azure VM benzersiz kimliği önce ve sonra Azure Backup hizmeti ile Merhaba geri yükleme gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="12796-184">This figure shows hello Azure VM unique ID before and after hello restore via Azure Backup service.</span></span> <span data-ttu-id="12796-185">Bu benzersiz VM kimliği lisans SAP için kullanılır, hello SAP donanım anahtarı kullanma</span><span class="sxs-lookup"><span data-stu-id="12796-185">hello SAP hardware key, which is used for SAP licensing, is using this unique VM ID.</span></span> <span data-ttu-id="12796-186">Sonuç olarak, yeni bir SAP lisans VM geri yüklendikten sonra yüklü toobe sahiptir.</span><span class="sxs-lookup"><span data-stu-id="12796-186">As a consequence, a new SAP license has toobe installed after a VM restore.</span></span>

<span data-ttu-id="12796-187">Yeni bir Azure yedekleme özelliği, bu yedekleme Kılavuzu hello oluşturma sırasında önizleme modunda sunulmadı.</span><span class="sxs-lookup"><span data-stu-id="12796-187">A new Azure Backup feature was presented in preview mode during hello creation of this backup guide.</span></span> <span data-ttu-id="12796-188">Merhaba VM yedekleme alınan hello VM üzerinde anlık görüntü tabanlı bir dosya düzeyinde geri yükleme sağlar.</span><span class="sxs-lookup"><span data-stu-id="12796-188">It allows a file level restore based on hello VM snapshot that was taken for hello VM backup.</span></span> <span data-ttu-id="12796-189">Bu hello gerek toodeploy yeni bir VM engeller ve bu nedenle hello benzersiz VM kimliği kalır aynı hello ve hiçbir yeni SAP HANA lisans anahtarı gereklidir.</span><span class="sxs-lookup"><span data-stu-id="12796-189">This avoids hello need toodeploy a new VM, and therefore hello unique VM ID stays hello same and no new SAP HANA license key is required.</span></span> <span data-ttu-id="12796-190">Tamamen test edildikten sonra bu özellik hakkında daha fazla belge sağlanacaktır.</span><span class="sxs-lookup"><span data-stu-id="12796-190">More documentation on this feature will be provided after it is fully tested.</span></span>

<span data-ttu-id="12796-191">Azure yedekleme sonunda Azure tek tek sanal diskleri yedekleme izin verir ve ayrıca dosyaları ve dizinleri içindeki VM hello.</span><span class="sxs-lookup"><span data-stu-id="12796-191">Azure Backup will eventually allow backup of individual Azure virtual disks, plus files and directories from inside hello VM.</span></span> <span data-ttu-id="12796-192">Azure Backup önemli bir avantajı, toodo kalmaktan hello müşteri kaydetme tüm hello yedeklemeler yönetimidir onu.</span><span class="sxs-lookup"><span data-stu-id="12796-192">A major advantage of Azure Backup is its management of all hello backups, saving hello customer from having toodo it.</span></span> <span data-ttu-id="12796-193">Bir geri yükleme gerekli hale gelirse, Azure Backup hello doğru yedekleme toouse seçer.</span><span class="sxs-lookup"><span data-stu-id="12796-193">If a restore becomes necessary, Azure Backup will select hello correct backup toouse.</span></span>

## <a name="sap-hana-vm-backup-via-manual-disk-snapshot"></a><span data-ttu-id="12796-194">SAP HANA VM yedekleme el ile disk anlık görüntü aracılığıyla</span><span class="sxs-lookup"><span data-stu-id="12796-194">SAP HANA VM backup via manual disk snapshot</span></span>

<span data-ttu-id="12796-195">Hello Azure Backup hizmeti kullanmak yerine, bir tek tek bir yedekleme çözümü PowerShell aracılığıyla el ile Azure VHD blob anlık görüntüleri oluşturarak yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="12796-195">Instead of using hello Azure Backup service, one could configure an individual backup solution by creating blob snapshots of Azure VHDs manually via PowerShell.</span></span> <span data-ttu-id="12796-196">Bkz: [PowerShell ile kullanma blob anlık görüntüleri](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/) hello adımları açıklaması.</span><span class="sxs-lookup"><span data-stu-id="12796-196">See [Using blob snapshots with PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/) for a description of hello steps.</span></span>

<span data-ttu-id="12796-197">Daha fazla esneklik sağlar ancak bu belgenin önceki bölümlerinde açıklanan hello sorunları gidermek değil:</span><span class="sxs-lookup"><span data-stu-id="12796-197">It provides more flexibility but does not resolve hello issues explained earlier in this document:</span></span>

- <span data-ttu-id="12796-198">Bir hala SAP HANA tutarlı bir durumda olduğundan emin olmanız gerekir</span><span class="sxs-lookup"><span data-stu-id="12796-198">One still must make sure that SAP HANA is in a consistent state</span></span>
- <span data-ttu-id="12796-199">VM belirten bir hata nedeniyle bir kira serbest hello varsa bile hello işletim sistemi diski üzerine yazılamaz.</span><span class="sxs-lookup"><span data-stu-id="12796-199">hello OS disk cannot be overwritten even if hello VM is deallocated because of an error stating that a lease exists.</span></span> <span data-ttu-id="12796-200">Silme hello sonra tooa yeni benzersiz VM kimliği ve hello gerek tooinstall yeni bir SAP lisans sunulmasını VM yalnızca çalışır.</span><span class="sxs-lookup"><span data-stu-id="12796-200">It only works after deleting hello VM, which would lead tooa new unique VM ID and hello need tooinstall a new SAP license.</span></span>

![Olası toorestore yalnızca hello veri disklerinin bir Azure VM değil](media/sap-hana-backup-storage-snapshots/image021.png)

<span data-ttu-id="12796-202">Bu olası toorestore yalnızca hello veri diskleri yeni ve benzersiz bir VM kimliği alma hello sorunu önlemenin bir Azure VM ve, bu nedenle, hello SAP lisans geçersiz:</span><span class="sxs-lookup"><span data-stu-id="12796-202">It is possible toorestore only hello data disks of an Azure VM, avoiding hello problem of getting a new unique VM ID and, therefore, invalidated hello SAP license:</span></span>

- <span data-ttu-id="12796-203">Merhaba test için iki Azure veri diskleri ekli tooa VM olan ve yazılım RAID bunların üstüne tanımlandı</span><span class="sxs-lookup"><span data-stu-id="12796-203">For hello test, two Azure data disks were attached tooa VM and software RAID was defined on top of them</span></span> 
- <span data-ttu-id="12796-204">Bunu SAP HANA tutarlı bir durumda olduğunu SAP HANA anlık görüntü özelliği tarafından onaylanıp</span><span class="sxs-lookup"><span data-stu-id="12796-204">It was confirmed that SAP HANA was in a consistent state by SAP HANA snapshot feature</span></span>
- <span data-ttu-id="12796-205">Dosya sistemi donmasına (bkz _depolama anlık görüntüleri duruma getirirken SAP HANA veri tutarlılığını_ hello ilgili makalede [yedekleme Kılavuzu SAP HANA Azure sanal makineler üzerinde](sap-hana-backup-guide.md))</span><span class="sxs-lookup"><span data-stu-id="12796-205">File system freeze (see _SAP HANA data consistency when taking storage snapshots_ in hello related article [Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md))</span></span>
- <span data-ttu-id="12796-206">BLOB anlık görüntüleri hem veri disklerinden gerçekleştirilen</span><span class="sxs-lookup"><span data-stu-id="12796-206">Blob snapshots were taken from both data disks</span></span>
- <span data-ttu-id="12796-207">Dosya Sistemi Çöz</span><span class="sxs-lookup"><span data-stu-id="12796-207">File system unfreeze</span></span>
- <span data-ttu-id="12796-208">SAP HANA anlık görüntü onayı</span><span class="sxs-lookup"><span data-stu-id="12796-208">SAP HANA snapshot confirmation</span></span>
- <span data-ttu-id="12796-209">toorestore hello veri diskleri hello VM kapatıldı ve her iki diskin ayrılmış</span><span class="sxs-lookup"><span data-stu-id="12796-209">toorestore hello data disks, hello VM was shut down and both disks detached</span></span>
- <span data-ttu-id="12796-210">Hello disk ayırma sonra bunlar sahip hello eski blob anlık görüntüleri verilerinin üzerine yazıldı</span><span class="sxs-lookup"><span data-stu-id="12796-210">After detaching hello disks, they were overwritten with hello former blob snapshots</span></span>
- <span data-ttu-id="12796-211">Geri hello sanal diskler bağlı yeniden toohello VM</span><span class="sxs-lookup"><span data-stu-id="12796-211">Then hello restored virtual disks were attached again toohello VM</span></span>
- <span data-ttu-id="12796-212">Başlangıç hello RAID düzgün çalıştığını ve toohello blob döndürülmek hello yazılım her şeyi VM anlık görüntü saat sonra</span><span class="sxs-lookup"><span data-stu-id="12796-212">After starting hello VM, everything on hello software RAID worked fine and was set back toohello blob snapshot time</span></span>
- <span data-ttu-id="12796-213">HANA toohello HANA anlık görüntü geri ayarlandı</span><span class="sxs-lookup"><span data-stu-id="12796-213">HANA was set back toohello HANA snapshot</span></span>

<span data-ttu-id="12796-214">SAP HANA aşağı olası tooshut hello blob anlık görüntüleri önce yazılmışsa hello yordamı daha az karmaşık olabilir.</span><span class="sxs-lookup"><span data-stu-id="12796-214">If it was possible tooshut down SAP HANA before hello blob snapshots, hello procedure would be less complex.</span></span> <span data-ttu-id="12796-215">Bu durumda, bir hello HANA anlık görüntü atlayın ve, hiçbir şey hello sistemde olacağına hello dosya sistemi dondurma de atlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="12796-215">In that case, one could skip hello HANA snapshot and, if nothing else is going on in hello system, also skip hello file system freeze.</span></span> <span data-ttu-id="12796-216">Her şeyi çevrimiçi durumdayken gerekli toodo anlık görüntüleri olduğunda eklenen karmaşıklık hello devreye.</span><span class="sxs-lookup"><span data-stu-id="12796-216">Added complexity comes into hello picture when it is necessary toodo snapshots while everything is online.</span></span> <span data-ttu-id="12796-217">Bkz: _depolama anlık görüntüleri duruma getirirken SAP HANA veri tutarlılığını_ hello ilgili makalede [yedekleme Kılavuzu SAP HANA Azure sanal makineler üzerinde](sap-hana-backup-guide.md).</span><span class="sxs-lookup"><span data-stu-id="12796-217">See _SAP HANA data consistency when taking storage snapshots_ in hello related article [Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="12796-218">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="12796-218">Next steps</span></span>
* <span data-ttu-id="12796-219">[SAP HANA için yedekleme Kılavuzu Azure sanal makineler üzerinde](sap-hana-backup-guide.md) genel bir bakış ve çalışmaya başlama hakkında bilgi sağlar.</span><span class="sxs-lookup"><span data-stu-id="12796-219">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="12796-220">[SAP HANA yedekleme tabanlı dosya düzeyinde](sap-hana-backup-file-level.md) kapsar hello dosya tabanlı yedekleme seçeneği.</span><span class="sxs-lookup"><span data-stu-id="12796-220">[SAP HANA backup based on file level](sap-hana-backup-file-level.md) covers hello file-based backup option.</span></span>
* <span data-ttu-id="12796-221">tooestablish yüksek kullanılabilirlik ve olağanüstü durum kurtarma SAP HANA planlama (büyük örnekler), azure'da nasıl görürüm toolearn [SAP HANA (büyük örnekler) Azure üzerinde yüksek kullanılabilirlik ve olağanüstü durum kurtarma](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="12796-221">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
