---
title: "SAP HANA Azure Backup dosya düzeyinde | Microsoft Docs"
description: "İki ana yedekleme olasılıklarını SAP HANA Azure sanal makinelerde vardır, bu makalede, SAP HANA Azure yedekleme dosya düzeyinde yer almaktadır"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: 5db0ceb1648b5afa278e1cbe1c42fce8033bfdc1
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 08/29/2017
---
# <a name="sap-hana-azure-backup-on-file-level"></a><span data-ttu-id="d4e36-103">Dosya düzeyinde bir SAP HANA Azure yedekleme</span><span class="sxs-lookup"><span data-stu-id="d4e36-103">SAP HANA Azure Backup on file level</span></span>

## <a name="introduction"></a><span data-ttu-id="d4e36-104">Giriş</span><span class="sxs-lookup"><span data-stu-id="d4e36-104">Introduction</span></span>

<span data-ttu-id="d4e36-105">Bu üç bölümlük SAP HANA yedeklemede ilgili makaleleri bir parçasıdır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="d4e36-106">[SAP HANA için yedekleme Kılavuzu Azure sanal makineler üzerinde](./sap-hana-backup-guide.md) Başlarken, genel bir bakış ve bilgi sağlar ve [tabanlı depolama anlık görüntü SAP HANA yedeklemeyi](./sap-hana-backup-storage-snapshots.md) depolama anlık görüntü tabanlı yedekleme seçeneği ele alınmaktadır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-106">[Backup guide for SAP HANA on Azure Virtual Machines](./sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA backup based on storage snapshots](./sap-hana-backup-storage-snapshots.md) covers the storage snapshot-based backup option.</span></span>

<span data-ttu-id="d4e36-107">Azure VM boyutlarda baktığınızda, biri bir GS5 64 eklenen veri disklerini izin verdiğini görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d4e36-107">Looking at the Azure VM sizes, one can see that a GS5 allows 64 attached data disks.</span></span> <span data-ttu-id="d4e36-108">Büyük SAP HANA sistemler için çok sayıda disk zaten veri ve günlük dosyaları için büyük olasılıkla en iyi disk g/ç işleme için RAID yazılım ile birlikte duruma getirilebilir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-108">For large SAP HANA systems, a significant number of disks might already be taken for data and log files, possibly in combination with software RAID for optimal disk IO throughput.</span></span> <span data-ttu-id="d4e36-109">Soru daha sonra eklenen veri disklerini zamanla doldurabilir SAP HANA yedekleme dosyalarının depolanacağı mi?</span><span class="sxs-lookup"><span data-stu-id="d4e36-109">The question then is where to store SAP HANA backup files, which could fill up the attached data disks over time?</span></span> <span data-ttu-id="d4e36-110">Bkz: [azure'daki Linux sanal makineler için Boyutlar](../../linux/sizes.md) Azure VM boyutu tablolar için.</span><span class="sxs-lookup"><span data-stu-id="d4e36-110">See [Sizes for Linux virtual machines in Azure](../../linux/sizes.md) for the Azure VM size tables.</span></span>

<span data-ttu-id="d4e36-111">Şu anda Azure Backup hizmeti ile kullanılabilecek hiçbir SAP HANA yedekleme tümleştirme yoktur.</span><span class="sxs-lookup"><span data-stu-id="d4e36-111">There is no SAP HANA backup integration available with Azure Backup service at this time.</span></span> <span data-ttu-id="d4e36-112">Dosya düzeyinde yedekleme/geri yükleme yönetmek için standart dosya tabanlı Yedekleme SAP HANA Studio aracılığıyla veya SAP HANA SQL deyimlerini aracılığıyla ile yoludur.</span><span class="sxs-lookup"><span data-stu-id="d4e36-112">The standard way to manage backup/restore at the file level is with a file-based backup via SAP HANA Studio or via SAP HANA SQL statements.</span></span> <span data-ttu-id="d4e36-113">Bkz: [SAP HANA SQL ve sistem görünümleri başvurusu](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) daha fazla bilgi için.</span><span class="sxs-lookup"><span data-stu-id="d4e36-113">See [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) for more information.</span></span>

![Bu şekilde yedekleme menü öğesi iletişim SAP HANA Studio'da gösterilmektedir.](media/sap-hana-backup-file-level/image022.png)

<span data-ttu-id="d4e36-115">Bu şekilde yedekleme menü öğesi iletişim SAP HANA Studio'da gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-115">This figure shows the dialog of the backup menu item in SAP HANA Studio.</span></span> <span data-ttu-id="d4e36-116">Türü seçerken &quot;dosyası&quot; varsa dosya sistemindeki yolunu belirtmek yedekleme dosyalarının nerede SAP HANA yazar.</span><span class="sxs-lookup"><span data-stu-id="d4e36-116">When choosing type &quot;file,&quot; one has to specify a path in the file system where SAP HANA writes the backup files.</span></span> <span data-ttu-id="d4e36-117">Geri yükleme aynı şekilde çalışır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-117">Restore works the same way.</span></span>

<span data-ttu-id="d4e36-118">Bu seçenek basit ve düz iletme sesleri olsa da, bazı noktalar vardır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-118">While this choice sounds simple and straight forward, there are some considerations.</span></span> <span data-ttu-id="d4e36-119">Önceden belirtildiği gibi bir Azure VM eklenebilecek veri disklerinin sayısının bir kısıtlaması vardır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-119">As mentioned before, an Azure VM has a limitation of number of data disks that can be attached.</span></span> <span data-ttu-id="d4e36-120">SAP HANA yazılım gerektirebilir veritabanı ve disk işleme gereksinimleri boyutuna bağlı olarak VM dosya sistemi yedek dosyalarını depolamak için kapasite olmayabilir arasında birden çok veri diskleri bölümlemesine kullanarak RAID.</span><span class="sxs-lookup"><span data-stu-id="d4e36-120">There might not be capacity to store SAP HANA backup files on the file systems of the VM, depending on the size of the database and disk throughput requirements, which might involve software RAID using striping across multiple data disks.</span></span> <span data-ttu-id="d4e36-121">Bu yedekleme dosyaları ve yönetme dosya boyutu sınırlamaları ve performans verileri terabayt işlerken taşıma için çeşitli seçenekler bu makalenin sonraki bölümlerinde sağlanır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-121">Various options for moving these backup files, and managing file size restrictions and performance when handling terabytes of data, are provided later in this article.</span></span>

<span data-ttu-id="d4e36-122">Toplam Kapasite ilgili daha fazla özgürlük sunar, başka bir seçenek Azure blob depolama olur.</span><span class="sxs-lookup"><span data-stu-id="d4e36-122">Another option, which offers more freedom regarding total capacity, is Azure blob storage.</span></span> <span data-ttu-id="d4e36-123">Şu anda tek bir blob de 1 TB'ye kadar kısıtlı olsa da, bir tek blob kapsayıcı toplam kapasitesini 500 TB'tır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-123">While a single blob is also restricted to 1 TB, the total capacity of a single blob container is currently 500 TB.</span></span> <span data-ttu-id="d4e36-124">Buna ek olarak, müşteriler içermeyeceğini seçebilirsiniz verir &quot;cool&quot; blob depolama maliyeti avantajına sahiptir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-124">Additionally, it gives customers the choice to select so-called &quot;cool&quot; blob storage, which has a cost benefit.</span></span> <span data-ttu-id="d4e36-125">Bkz: [Azure Blob Storage: sık erişimli ve seyrek erişimli depolama katmanları](../../../storage/blobs/storage-blob-storage-tiers.md) cool blob depolama hakkında ayrıntılı bilgi için.</span><span class="sxs-lookup"><span data-stu-id="d4e36-125">See [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md) for details about cool blob storage.</span></span>

<span data-ttu-id="d4e36-126">Ek güvenlik için SAP HANA yedeklemelerini depolamak için bir coğrafi olarak çoğaltılmış depolama hesabı kullanın.</span><span class="sxs-lookup"><span data-stu-id="d4e36-126">For additional safety, use a geo-replicated storage account to store the SAP HANA backups.</span></span> <span data-ttu-id="d4e36-127">Bkz: [Azure Storage çoğaltma](../../../storage/common/storage-redundancy.md) depolama hesabı çoğaltma hakkında ayrıntılı bilgi için.</span><span class="sxs-lookup"><span data-stu-id="d4e36-127">See [Azure Storage replication](../../../storage/common/storage-redundancy.md) for details about storage account replication.</span></span>

<span data-ttu-id="d4e36-128">Bir SAP HANA yedeklemeler için ayrılmış VHD'leri coğrafi olarak çoğaltılmış bir özel yedekleme depolama hesabında yerleştir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-128">One could place dedicated VHDs for SAP HANA backups in a dedicated backup storage account that is geo-replicated.</span></span> <span data-ttu-id="d4e36-129">Aksi takdirde bir SAP HANA yedeklemeler coğrafi olarak çoğaltılmış depolama hesabına veya farklı bir bölgede olan bir depolama hesabını tutmak VHD'ler kopyalamak.</span><span class="sxs-lookup"><span data-stu-id="d4e36-129">Or else one could copy the VHDs that keep the SAP HANA backups to a geo-replicated storage account, or to a storage account that is in a different region.</span></span>

## <a name="azure-backup-agent"></a><span data-ttu-id="d4e36-130">Azure Yedekleme aracısı</span><span class="sxs-lookup"><span data-stu-id="d4e36-130">Azure backup agent</span></span>

<span data-ttu-id="d4e36-131">Azure yedekleme yalnızca tam VM'ler, ancak ayrıca dosyaları ve dizinleri konuk işletim sistemi yüklü olmalıdır yedekleme aracısını aracılığıyla yedekleme seçeneği sunar.</span><span class="sxs-lookup"><span data-stu-id="d4e36-131">Azure backup offers the option to not only back up complete VMs, but also files and directories via the backup agent, which has to be installed on the guest OS.</span></span> <span data-ttu-id="d4e36-132">Ancak aralık 2016 itibariyle, bu aracı yalnızca Windows üzerinde desteklenir (bkz [bir Windows Server veya Azure Resource Manager dağıtım modelini kullanarak istemciye yedekleme](../../../backup/backup-configure-vault.md)).</span><span class="sxs-lookup"><span data-stu-id="d4e36-132">But as of December 2016, this agent is only supported on Windows (see [Back up a Windows Server or client to Azure using the Resource Manager deployment model](../../../backup/backup-configure-vault.md)).</span></span>

<span data-ttu-id="d4e36-133">Geçici bir çözüm, ilk SAP HANA yedekleme dosyalarını Azure üzerinde bir Windows VM (örneğin, SAMBA paylaşım) kopyalayın ve ardından Azure Yedekleme aracısı buradan kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-133">A workaround is to first copy SAP HANA backup files to a Windows VM on Azure (for example, via SAMBA share) and then use the Azure backup agent from there.</span></span> <span data-ttu-id="d4e36-134">Teknik olarak mümkün olsa da, karmaşıklık eklemek ve yedekleme yavaş veya bir bit Linux ve Windows VM arasında kopyalama nedeniyle geri yükleme işlemi.</span><span class="sxs-lookup"><span data-stu-id="d4e36-134">While it is technically possible, it would add complexity and slow down the backup or restore process quite a bit due to the copy between the Linux and the Windows VM.</span></span> <span data-ttu-id="d4e36-135">Bu yaklaşım izlemek için önerilmez.</span><span class="sxs-lookup"><span data-stu-id="d4e36-135">It is not recommended to follow this approach.</span></span>

## <a name="azure-blobxfer-utility-details"></a><span data-ttu-id="d4e36-136">Azure blobxfer yardımcı programı ayrıntıları</span><span class="sxs-lookup"><span data-stu-id="d4e36-136">Azure blobxfer utility details</span></span>

<span data-ttu-id="d4e36-137">Azure depolama dosyaları ve dizinleri depolamak için bir CLI veya PowerShell kullanın veya birini kullanarak bir aracı geliştirmeyi [Azure SDK'ları](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="d4e36-137">To store directories and files on Azure storage, one could use CLI or PowerShell, or develop a tool using one of the [Azure SDKs](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="d4e36-138">Ayrıca bir kullanıma hazır yardımcı AzCopy, Azure depolama alanına veri kopyalamak için ancak Windows ise yalnızca (bkz [AzCopy komut satırı yardımcı programı ile veri aktarma](../../../storage/common/storage-use-azcopy.md)).</span><span class="sxs-lookup"><span data-stu-id="d4e36-138">There is also a ready-to-use utility, AzCopy, for copying data to Azure storage, but it is Windows only (see [Transfer data with the AzCopy Command-Line Utility](../../../storage/common/storage-use-azcopy.md)).</span></span>

<span data-ttu-id="d4e36-139">Bu nedenle blobxfer SAP HANA yedekleme dosyalarını kopyalamak için kullanıldı.</span><span class="sxs-lookup"><span data-stu-id="d4e36-139">Therefore blobxfer was used for copying SAP HANA backup files.</span></span> <span data-ttu-id="d4e36-140">Açık kaynak, üretim ortamlarında birçok müşteri tarafından kullanılan ve kullanılabilir olan [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="d4e36-140">It is open source, used by many customers in production environments, and available on [GitHub](https://github.com/Azure/blobxfer).</span></span> <span data-ttu-id="d4e36-141">Bu araç doğrudan Azure blob depolama ya da Azure dosya paylaşımı için veri kopyalamak için sağlar.</span><span class="sxs-lookup"><span data-stu-id="d4e36-141">This tool allows one to copy data directly to either Azure blob storage or Azure file share.</span></span> <span data-ttu-id="d4e36-142">Ayrıca, çeşitli md5 karma değeri veya bir dizin ile birden çok dosya kopyalarken otomatik paralellik gibi kullanışlı özellikler sunar.</span><span class="sxs-lookup"><span data-stu-id="d4e36-142">It also offers a range of useful features, like md5 hash or automatic parallelism when copying a directory with multiple files.</span></span>

## <a name="sap-hana-backup-performance"></a><span data-ttu-id="d4e36-143">SAP HANA yedekleme performansı</span><span class="sxs-lookup"><span data-stu-id="d4e36-143">SAP HANA backup performance</span></span>

![SAP HANA Studio SAP HANA yedekleme konsolunda bu ekran değil](media/sap-hana-backup-file-level/image023.png)

<span data-ttu-id="d4e36-145">SAP HANA Studio'da SAP HANA yedekleme konsolunun bu ekran görüntüsüdür.</span><span class="sxs-lookup"><span data-stu-id="d4e36-145">This screenshot is of the SAP HANA backup console in SAP HANA Studio.</span></span> <span data-ttu-id="d4e36-146">XFS dosya sistemi kullanılarak HANA VM'ye bağlı tek bir Azure standart depolama diskte 230 GB yedekleme yapmak için yaklaşık 42 dakika sürdü.</span><span class="sxs-lookup"><span data-stu-id="d4e36-146">It took about 42 minutes to do the backup of the 230 GB on a single Azure standard storage disk attached to the HANA VM using XFS file system.</span></span>

![Bu ekran YaST SAP HANA üzerinde VM sınamasıdır](media/sap-hana-backup-file-level/image024.png)

<span data-ttu-id="d4e36-148">Bu ekran YaST SAP HANA test VM ' dir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-148">This screenshot is of YaST on the SAP HANA test VM.</span></span> <span data-ttu-id="d4e36-149">Önceden belirtildiği gibi bir SAP HANA yedekleme için 1 TB'lik tek disk görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d4e36-149">One can see the 1-TB single disk for SAP HANA backup as mentioned before.</span></span> <span data-ttu-id="d4e36-150">Yedekleme 230 GB yaklaşık 42 dakika sürdü.</span><span class="sxs-lookup"><span data-stu-id="d4e36-150">It took about 42 minutes to backup 230 GB.</span></span> <span data-ttu-id="d4e36-151">Ayrıca, beş 200 GB disk eklenmedi ve bu beş Azure veri diskleri üstünde şeritleme ile yazılım RAID md0 oluşturulmuş.</span><span class="sxs-lookup"><span data-stu-id="d4e36-151">In addition, five 200-GB disks were attached and software RAID md0 created, with striping on top of these five Azure data disks.</span></span>

![Yazılım üzerinde aynı yedekleme yinelenen RAID 5 arasında şeritleme ile Azure standart depolama veri diskleri bağlı](media/sap-hana-backup-file-level/image025.png)

<span data-ttu-id="d4e36-153">Yazılım üzerinde aynı yedekleme yinelenen RAID 5 arasında şeritleme ile Azure standart depolama veri diskleri yedekleme süresi 10 dakika kadar 42 dakika duruma bağlı.</span><span class="sxs-lookup"><span data-stu-id="d4e36-153">Repeating the same backup on software RAID with striping across five attached Azure standard storage data disks brought the backup time from 42 minutes down to 10 minutes.</span></span> <span data-ttu-id="d4e36-154">Diskler VM önbelleğe alma olmadan eklenmedi.</span><span class="sxs-lookup"><span data-stu-id="d4e36-154">The disks were attached without caching to the VM.</span></span> <span data-ttu-id="d4e36-155">Dolayısıyla belirgin ne kadar önemli disk yazma üretimi yedekleme zamanı taşır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-155">So it is obvious how important disk write throughput is for the backup time.</span></span> <span data-ttu-id="d4e36-156">Bir sonra daha fazla en iyi performans için işlemi hızlandırmak için Azure premium Depolama'ya geçiş.</span><span class="sxs-lookup"><span data-stu-id="d4e36-156">One could then switch to Azure premium storage to further accelerate the process for optimal performance.</span></span> <span data-ttu-id="d4e36-157">Genel olarak, Azure premium storage üretim sistemleri için kullanılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-157">In general, Azure premium storage should be used for production systems.</span></span>

## <a name="copy-sap-hana-backup-files-to-azure-blob-storage"></a><span data-ttu-id="d4e36-158">SAP HANA yedekleme dosyalarını Azure blob depolama alanına kopyalayın</span><span class="sxs-lookup"><span data-stu-id="d4e36-158">Copy SAP HANA backup files to Azure blob storage</span></span>

<span data-ttu-id="d4e36-159">Aralık 2016 itibariyle hızla SAP HANA yedek dosyalarını depolamak için en iyi Azure blob depolama seçenektir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-159">As of December 2016, the best option to quickly store SAP HANA backup files is Azure blob storage.</span></span> <span data-ttu-id="d4e36-160">Tek tek blob kapsayıcısı yeterli GS5 VM ile yeterli SAP HANA yedekleri korumak için Azure üzerinde çalışan çoğu SAP HANA sistemler için 500 TB'lık bir sınırı vardır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-160">One single blob container has a limit of 500 TB, enough for most SAP HANA systems, running in a GS5 VM on Azure, to keep sufficient SAP HANA backups.</span></span> <span data-ttu-id="d4e36-161">Müşterilerin sahip arasında seçim &quot;etkin&quot; ve &quot;soğuk&quot; blob depolamada (bkz [Azure Blob Storage: sık erişimli ve seyrek erişimli depolama katmanları](../../../storage/blobs/storage-blob-storage-tiers.md)).</span><span class="sxs-lookup"><span data-stu-id="d4e36-161">Customers have the choice between &quot;hot&quot; and &quot;cold&quot; blob storage (see [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md)).</span></span>

<span data-ttu-id="d4e36-162">Blobxfer aracı ile SAP HANA yedekleme dosyalarını doğrudan Azure blob depolama alanına kopyalama kolaydır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-162">With the blobxfer tool, it is easy to copy the SAP HANA backup files directly to Azure blob storage.</span></span>

![Bir tam SAP HANA dosya yedekleme dosyaları burada görebilirsiniz](media/sap-hana-backup-file-level/image026.png)

<span data-ttu-id="d4e36-164">Burada bir tam SAP HANA dosya yedekleme dosyaları görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d4e36-164">Here one can see the files of a full SAP HANA file backup.</span></span> <span data-ttu-id="d4e36-165">Dört dosyası vardır ve en büyük kaygılardan biri kabaca 230 GB sahiptir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-165">There are four files and the biggest one has roughly 230 GB.</span></span>

![Bir Azure standart depolama hesabı blob kapsayıcısına 230 GB kopyalamak için kabaca 3000 saniye sürdü](media/sap-hana-backup-file-level/image027.png)

<span data-ttu-id="d4e36-167">MD5 karma değeri ilk testinde kullanmak değil, bir Azure standart depolama hesabı blob kapsayıcısına 230 GB kopyalamak için kabaca 3000 saniye sürdü.</span><span class="sxs-lookup"><span data-stu-id="d4e36-167">Not using md5 hash in the initial test, it took roughly 3000 seconds to copy the 230 GB to an Azure standard storage account blob container.</span></span>

![Bu ekran görüntüsünde, bir Azure Portal'da nasıl göründüğünü görebilirsiniz](media/sap-hana-backup-file-level/image028.png)

<span data-ttu-id="d4e36-169">Bu ekran görüntüsünde, bir Azure Portal'da nasıl göründüğünü görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d4e36-169">In this screenshot, one can see how it looks on the Azure portal.</span></span> <span data-ttu-id="d4e36-170">Adlı bir blob kapsayıcı &quot;sap hana yedeklemeleri&quot; oluşturuldu ve SAP HANA yedekleme dosyalarını temsil eden dört BLOB içerir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-170">A blob container named &quot;sap-hana-backups&quot; was created and includes the four blobs, which represent the SAP HANA backup files.</span></span> <span data-ttu-id="d4e36-171">Bunlardan birini kabaca 230 GB bir boyuta sahiptir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-171">One of them has a size of roughly 230 GB.</span></span>

<span data-ttu-id="d4e36-172">HANA Studio yedekleme konsol HANA yedek dosyaları en fazla dosya boyutunu sınırlamak bir izin verir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-172">The HANA Studio backup console allows one to restrict the max file size of HANA backup files.</span></span> <span data-ttu-id="d4e36-173">Örnek ortamında, birden çok daha küçük yedek dosya yerine bir büyük 230 GB dosyasına sahip olacak şekilde sağlayarak, performans geliştirilmiş.</span><span class="sxs-lookup"><span data-stu-id="d4e36-173">In the sample environment, it improved performance by making it possible to have multiple smaller backup files, instead of one large 230-GB file.</span></span>

![T artırmak yedekleme saati HANA yan belirlemeden #39; üzerinde yedekleme dosya boyutu sınırını ayarlama](media/sap-hana-backup-file-level/image029.png)

<span data-ttu-id="d4e36-175">HANA yan belirlemeden #39; üzerinde yedekleme dosya boyutu sınırını ayarlama t artırmak yedekleme saati dosyaları bu şekilde gösterildiği gibi sıralı olarak yazıldığından.</span><span class="sxs-lookup"><span data-stu-id="d4e36-175">Setting the backup file size limit on the HANA side doesn&#39;t improve the backup time, because the files are written sequentially as shown in this figure.</span></span> <span data-ttu-id="d4e36-176">Yedekleme 230 GB tek dosya yerine dört büyük veri dosyaları oluşmasını dosya boyutu sınırını 60 GB ayarlandı.</span><span class="sxs-lookup"><span data-stu-id="d4e36-176">The file size limit was set to 60 GB, so the backup created four large data files instead of the 230-GB single file.</span></span>

![Paralellik blobxfer aracının test etmek için HANA yedeklemeler için maksimum dosya boyutu 15 GB sonra ayarlandı](media/sap-hana-backup-file-level/image030.png)

<span data-ttu-id="d4e36-178">Paralellik blobxfer aracının test etmek için HANA yedeklemeler için maksimum dosya boyutu sonra 19 yedekleme dosyalarında sonuçlandı 15 GB ayarlandı.</span><span class="sxs-lookup"><span data-stu-id="d4e36-178">To test parallelism of the blobxfer tool, the max file size for HANA backups was then set to 15 GB, which resulted in 19 backup files.</span></span> <span data-ttu-id="d4e36-179">Bu yapılandırma 230 GB 875 saniye kadar 3000 saniye Azure blob depolama alanına kopyalama blobxfer süredir duruma getirdi.</span><span class="sxs-lookup"><span data-stu-id="d4e36-179">This configuration brought the time for blobxfer to copy the 230 GB to Azure blob storage from 3000 seconds down to 875 seconds.</span></span>

<span data-ttu-id="d4e36-180">Bir Azure blob yazmak için 60 MB/sn sınırı nedeniyle bu sonucudur.</span><span class="sxs-lookup"><span data-stu-id="d4e36-180">This result is due to the limit of 60 MB/sec for writing an Azure blob.</span></span> <span data-ttu-id="d4e36-181">Birden çok BLOB'ları aracılığıyla paralellik sorununu çözer, ancak bir dezavantajı yok: tüm bu HANA yedekleme dosyaları Azure blob depolama alanına kopyalamak için blobxfer aracı performansını artırma koyar yük HANA VM hem ağ.</span><span class="sxs-lookup"><span data-stu-id="d4e36-181">Parallelism via multiple blobs solves the bottleneck, but there is a downside: increasing performance of the blobxfer tool to copy all these HANA backup files to Azure blob storage puts load on both the HANA VM and the network.</span></span> <span data-ttu-id="d4e36-182">İşlem HANA sisteminin etkilenmiş haline gelir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-182">Operation of HANA system becomes impacted.</span></span>

## <a name="blob-copy-of-dedicated-azure-data-disks-in-backup-software-raid"></a><span data-ttu-id="d4e36-183">Yedekleme yazılım RAID ayrılmış Azure veri diski BLOB kopyalama</span><span class="sxs-lookup"><span data-stu-id="d4e36-183">Blob copy of dedicated Azure data disks in backup software RAID</span></span>

<span data-ttu-id="d4e36-184">El ile VM veri disk yedekleme, bu yaklaşım bir değil HANA veriler dahil tüm SAP yükleme kaydetmek için bir VM üzerindeki tüm veri diskleri yedekleme HANA dosyaları ve yapılandırma dosyaları günlüğe kaydetmez.</span><span class="sxs-lookup"><span data-stu-id="d4e36-184">Unlike the manual VM data disk backup, in this approach one does not back up all the data disks on a VM to save the whole SAP installation, including HANA data, HANA log files, and config files.</span></span> <span data-ttu-id="d4e36-185">Bunun yerine, bir fikir yazılım RAID şeritleme ile birden çok Azure veri VHD'ler arasında tam bir SAP HANA dosya yedekleme depolamak için ayrılmış olmaktır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-185">Instead, the idea is to have dedicated software RAID with striping across multiple Azure data VHDs for storing a full SAP HANA file backup.</span></span> <span data-ttu-id="d4e36-186">Bir SAP HANA yedeğiniz yalnızca bu diskler, kopyalar.</span><span class="sxs-lookup"><span data-stu-id="d4e36-186">One copies only these disks, which have the SAP HANA backup.</span></span> <span data-ttu-id="d4e36-187">Bunlar kolayca bir adanmış HANA yedekleme depolama hesabında tutulan veya ayrılmış bir bağlı &quot;yönetim VM yedekleme&quot; başka bir işleme için.</span><span class="sxs-lookup"><span data-stu-id="d4e36-187">They could easily be kept in a dedicated HANA backup storage account, or attached to a dedicated &quot;backup management VM&quot; for further processing.</span></span>

![Tüm VHD'leri söz konusu kullanarak kopyalanan ** start-azurestorageblobcopy ** PowerShell komutu](media/sap-hana-backup-file-level/image031.png)

<span data-ttu-id="d4e36-189">Yerel yazılım RAID Yedekleme tamamlandıktan sonra tüm VHD'leri söz konusu kullanarak kopyalanan **başlangıç azurestorageblobcopy** PowerShell komutunu (bkz [başlangıç AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span><span class="sxs-lookup"><span data-stu-id="d4e36-189">After the backup to the local software RAID was completed, all VHDs involved were copied using the **start-azurestorageblobcopy** PowerShell command (see [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span></span> <span data-ttu-id="d4e36-190">Yalnızca yedekleme dosyalarını tutmak için ayrılmış dosya sistemi etkilediği gibi SAP HANA veri veya günlük dosyası tutarlılık disk üzerinde hiçbir endişeniz vardır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-190">As it only affects the dedicated file system for keeping the backup files, there are no concerns about SAP HANA data or log file consistency on the disk.</span></span> <span data-ttu-id="d4e36-191">Bu komutun VM çevrimiçi kalırken çalıştığını avantajdır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-191">A benefit of this command is that it works while the VM stays online.</span></span> <span data-ttu-id="d4e36-192">Hiçbir işlem yedekleme kümesi Yazar emin olmak için önce blob kopyalama çıkarın ve daha sonra yeniden bağlamak emin olun.</span><span class="sxs-lookup"><span data-stu-id="d4e36-192">To be certain that no process writes to the backup stripe set, be sure to unmount it before the blob copy, and mount it again afterwards.</span></span> <span data-ttu-id="d4e36-193">Veya uygun bir şekilde kullanmayı &quot;Dondur&quot; dosya sistemi.</span><span class="sxs-lookup"><span data-stu-id="d4e36-193">Or one could use an appropriate way to &quot;freeze&quot; the file system.</span></span> <span data-ttu-id="d4e36-194">Örneğin, xfs aracılığıyla\_XFS dosya sistemini Dondur.</span><span class="sxs-lookup"><span data-stu-id="d4e36-194">For example, via xfs\_freeze for the XFS file system.</span></span>

![Bu ekran görüntüsü, Azure portalındaki VHD'ler kapsayıcısında BLOB listesi gösterir.](media/sap-hana-backup-file-level/image032.png)

<span data-ttu-id="d4e36-196">Bu ekran BLOB'ları listesini gösterir &quot;VHD'ler&quot; Azure portalındaki kapsayıcı.</span><span class="sxs-lookup"><span data-stu-id="d4e36-196">This screenshot shows the list of blobs in the &quot;vhds&quot; container on the Azure portal.</span></span> <span data-ttu-id="d4e36-197">Ekran görüntüsü, SAP HANA sunucunun SAP HANA yedek dosyaları saklamak için RAID yazılım olarak hizmet vermek için VM eklendiği beş VHD'leri gösterir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-197">The screenshot shows the five VHDs, which were attached to the SAP HANA server VM to serve as the software RAID to keep SAP HANA backup files.</span></span> <span data-ttu-id="d4e36-198">Ayrıca, aracılığıyla blob kopyalama komut gerçekleştirilen beş kopyaları gösterir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-198">It also shows the five copies, which were taken via the blob copy command.</span></span>

![Test amacıyla, SAP HANA yedekleme yazılımı RAID disklerini kopyalarını VM uygulama sunucusunun eklenmedi](media/sap-hana-backup-file-level/image033.png)

<span data-ttu-id="d4e36-200">Test amacıyla, SAP HANA yedekleme yazılımı RAID disklerini kopyalarını VM uygulama sunucusunun eklenmedi.</span><span class="sxs-lookup"><span data-stu-id="d4e36-200">For testing purposes, the copies of the SAP HANA backup software RAID disks were attached to the app server VM.</span></span>

![VM diski eklemek için kapatıldı uygulama sunucusuna kopyalar.](media/sap-hana-backup-file-level/image034.png)

<span data-ttu-id="d4e36-202">VM uygulama sunucusunun diski eklemek için kopyalar kapatıldı.</span><span class="sxs-lookup"><span data-stu-id="d4e36-202">The app server VM was shut down to attach the disk copies.</span></span> <span data-ttu-id="d4e36-203">VM başlattıktan sonra diskler ve RAID doğru bulunan (UUID bağlanan).</span><span class="sxs-lookup"><span data-stu-id="d4e36-203">After starting the VM, the disks and the RAID were discovered correctly (mounted via UUID).</span></span> <span data-ttu-id="d4e36-204">Bağlama noktası eksik yalnızca YaST bölümleyici oluşturulduğu.</span><span class="sxs-lookup"><span data-stu-id="d4e36-204">Only the mount point was missing, which was created via the YaST partitioner.</span></span> <span data-ttu-id="d4e36-205">Daha sonra SAP HANA yedek dosya kopyalarını işletim sistemi düzeyinde görünür hale geldi.</span><span class="sxs-lookup"><span data-stu-id="d4e36-205">Afterwards the SAP HANA backup file copies became visible on OS level.</span></span>

## <a name="copy-sap-hana-backup-files-to-nfs-share"></a><span data-ttu-id="d4e36-206">SAP HANA yedekleme dosyalarını NFS paylaşımına kopyalayın</span><span class="sxs-lookup"><span data-stu-id="d4e36-206">Copy SAP HANA backup files to NFS share</span></span>

<span data-ttu-id="d4e36-207">Bir performans veya disk alanı perspektif SAP HANA sistemde olası etkisini azaltmak için bir NFS paylaşımını SAP HANA yedekleme dosyalarını depolamak düşünebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d4e36-207">To lessen the potential impact on the SAP HANA system from a performance or disk space perspective, one might consider storing the SAP HANA backup files on an NFS share.</span></span> <span data-ttu-id="d4e36-208">Teknik olarak çalışır, ancak ikinci bir Azure VM bir NFS paylaşımına konağı olarak kullanılması anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-208">Technically it works, but it means using a second Azure VM as the host of the NFS share.</span></span> <span data-ttu-id="d4e36-209">VM ağ bant genişliği nedeniyle küçük bir VM boyutu olmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-209">It should not be a small VM size, due to the VM network bandwidth.</span></span> <span data-ttu-id="d4e36-210">Ardından bu kapatmaya anlamlı olacaktır &quot;yedekleme VM&quot; ve yalnızca SAP HANA yedekleme yürütme kaydınızı duruma getirin.</span><span class="sxs-lookup"><span data-stu-id="d4e36-210">It would make sense then to shut down this &quot;backup VM&quot; and only bring it up for executing the SAP HANA backup.</span></span> <span data-ttu-id="d4e36-211">Bir NFS yazma paylaşım ağda yükü getirir ve yalnızca yedekleme dosyalarının daha sonra açmayı yönetme ancak SAP HANA sistem etkiler &quot;yedekleme VM&quot; SAP HANA sistem hiç etkilemek değil.</span><span class="sxs-lookup"><span data-stu-id="d4e36-211">Writing on an NFS share puts load on the network and impacts the SAP HANA system, but merely managing the backup files afterwards on the &quot;backup VM&quot; would not influence the SAP HANA system at all.</span></span>

![Başka bir Azure VM NFS paylaşımından SAP HANA server VM'ye takılı](media/sap-hana-backup-file-level/image035.png)

<span data-ttu-id="d4e36-213">NFS kullanım doğrulamak için başka bir Azure VM NFS paylaşımından SAP HANA sunucunun VM takıldı.</span><span class="sxs-lookup"><span data-stu-id="d4e36-213">To verify the NFS use case, an NFS share from another Azure VM was mounted to the SAP HANA server VM.</span></span> <span data-ttu-id="d4e36-214">Hiçbir özel vardı uygulanan NFS ayarlama.</span><span class="sxs-lookup"><span data-stu-id="d4e36-214">There was no special NFS tuning applied.</span></span>

![1 saat ve 46 yedekleme doğrudan yapmak için dakika sürdü](media/sap-hana-backup-file-level/image036.png)

<span data-ttu-id="d4e36-216">NFS paylaşım hızlı kümesi, SAP HANA sunucuda gibi oluştu.</span><span class="sxs-lookup"><span data-stu-id="d4e36-216">The NFS share was a fast stripe set, like the one on the SAP HANA server.</span></span> <span data-ttu-id="d4e36-217">Bununla birlikte, 10 dakika yerine yerel bir Şerit yazma ayarlandığında NFS paylaşım doğrudan üzerinde yedekleme yapmak için 1 saat ve 46 dakika sürdü.</span><span class="sxs-lookup"><span data-stu-id="d4e36-217">Nevertheless, it took 1 hour and 46 minutes to do the backup directly on the NFS share instead of 10 minutes, when writing to a local stripe set.</span></span>

![Seçenek 1 saat 43 dakikada çok daha hızlı değildi](media/sap-hana-backup-file-level/image037.png)

<span data-ttu-id="d4e36-219">Yerel kümesi için Yedekleme yapmayı ve işletim sistemi düzeyinde NFS paylaşımına kopyalanması alternatif (basit bir **cp - avr** komutu) çok daha hızlı değildi.</span><span class="sxs-lookup"><span data-stu-id="d4e36-219">The alternative of doing a backup to a local stripe set and copying to the NFS share on OS level (a simple **cp -avr** command) wasn't much quicker.</span></span> <span data-ttu-id="d4e36-220">1 saat 43 dakika sürdü.</span><span class="sxs-lookup"><span data-stu-id="d4e36-220">It took 1 hour and 43 minutes.</span></span>

<span data-ttu-id="d4e36-221">Bu nedenle çalışır ancak performans 230 GB yedekleme test için iyi değildi.</span><span class="sxs-lookup"><span data-stu-id="d4e36-221">So it works, but performance wasn't good for the 230-GB backup test.</span></span> <span data-ttu-id="d4e36-222">Görüneceğini çoklu terabayt için daha büyük.</span><span class="sxs-lookup"><span data-stu-id="d4e36-222">It would look even worse for multi terabytes.</span></span>

## <a name="copy-sap-hana-backup-files-to-azure-file-service"></a><span data-ttu-id="d4e36-223">Azure dosya hizmeti SAP HANA yedekleme dosyalarını kopyalayın</span><span class="sxs-lookup"><span data-stu-id="d4e36-223">Copy SAP HANA backup files to Azure file service</span></span>

<span data-ttu-id="d4e36-224">Bir Azure Linux VM içinde bir Azure dosya paylaşımının mümkündür.</span><span class="sxs-lookup"><span data-stu-id="d4e36-224">It is possible to mount an Azure file share inside an Azure Linux VM.</span></span> <span data-ttu-id="d4e36-225">Makaleyi [Azure File storage'ı Linux ile kullanma konusunda](../../../storage/files/storage-how-to-use-files-linux.md) yapmak ayrıntılar verilmektedir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-225">The article [How to use Azure File storage with Linux](../../../storage/files/storage-how-to-use-files-linux.md) provides details on how to do it.</span></span> <span data-ttu-id="d4e36-226">Olduğundan şu anda bir Azure dosya paylaşımı 5 TB kota sınırı ve 1 TB dosya başına bir dosya boyutu sınırını aklınızda bulundurun.</span><span class="sxs-lookup"><span data-stu-id="d4e36-226">Keep in mind that there is currently a 5-TB quota limit of one Azure file share, and a file size limit of 1 TB per file.</span></span> <span data-ttu-id="d4e36-227">Bkz: [Azure Storage ölçeklenebilirlik ve performans hedefleri](../../../storage/common/storage-scalability-targets.md) depolama sınırları hakkında bilgi için.</span><span class="sxs-lookup"><span data-stu-id="d4e36-227">See [Azure Storage Scalability and Performance Targets](../../../storage/common/storage-scalability-targets.md) for information on storage limits.</span></span>

<span data-ttu-id="d4e36-228">Testler, ancak, SAP HANA yedekleme olmayan & #39 göstermiştir; t şu anda doğrudan CIFS bağlama bu tür ile çalışır.</span><span class="sxs-lookup"><span data-stu-id="d4e36-228">Tests have shown, however, that SAP HANA backup doesn&#39;t currently work directly with this kind of CIFS mount.</span></span> <span data-ttu-id="d4e36-229">İçinde de belirtildiği [SAP Not 1820529](https://launchpad.support.sap.com/#/notes/1820529) , CIFS önerilmez.</span><span class="sxs-lookup"><span data-stu-id="d4e36-229">It is also stated in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) that CIFS is not recommended.</span></span>

![Bu şekil, SAP HANA Studio'da yedekleme iletişiminde bir hata gösterir.](media/sap-hana-backup-file-level/image038.png)

<span data-ttu-id="d4e36-231">Bu şekilde bir hata SAP HANA Studio'da yedekleme iletişim kutusunda doğrudan bir CIFS monte Azure dosya paylaşımına yedeklemek çalışırken gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-231">This figure shows an error in the backup dialog in SAP HANA Studio, when trying to back up directly to a CIFS-mounted Azure file share.</span></span> <span data-ttu-id="d4e36-232">Bu nedenle standart SAP HANA yedek bir VM dosya sistemine ilk yapabilir ve ardından Yedekleme dosyaları buradan Azure dosya hizmeti kopyalayın sahip.</span><span class="sxs-lookup"><span data-stu-id="d4e36-232">So one has to do a standard SAP HANA backup into a VM file system first, and then copy the backup files from there to Azure file service.</span></span>

![Bu şekilde işlem 19 SAP HANA yedekleme dosyalarını kopyalamak için yaklaşık 929 saniye sürdü gösterilmektedir](media/sap-hana-backup-file-level/image039.png)

<span data-ttu-id="d4e36-234">Bu şekilde, Azure dosya paylaşımına kabaca 230 GB toplam boyutunu 19 SAP HANA yedek dosyaları kopyalamak için yaklaşık 929 saniye sürdü gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-234">This figure shows that it took about 929 seconds to copy 19 SAP HANA backup files with a total size of roughly 230 GB to the Azure file share.</span></span>

![SAP HANA VM kaynak dizin yapısını Azure dosya paylaşımına kopyalandı](media/sap-hana-backup-file-level/image040.png)

<span data-ttu-id="d4e36-236">Bu ekran görüntüsünde, bir kaynak dizin yapısını SAP HANA VM Azure dosya paylaşımına kopyalanmıştır görebilirsiniz: bir dizin (hana\_yedekleme\_fsl\_15 gb) ve 19 tek tek yedekleme dosyaları.</span><span class="sxs-lookup"><span data-stu-id="d4e36-236">In this screenshot, one can see that the source directory structure on the SAP HANA VM was copied to the Azure file share: one directory (hana\_backup\_fsl\_15gb) and 19 individual backup files.</span></span>

<span data-ttu-id="d4e36-237">Gelecekte SAP HANA dosyası yedeklerini doğrudan desteklendiğinde Azure dosyalarda SAP HANA yedekleme dosyalarını depolamak ilginç bir seçenek olabilir.</span><span class="sxs-lookup"><span data-stu-id="d4e36-237">Storing SAP HANA backup files on Azure files could be an interesting option in the future when SAP HANA file backups support it directly.</span></span> <span data-ttu-id="d4e36-238">Veya ne zaman bağlama Azure dosyaları NFS yoluyla olanaklı hale gelir ve en yüksek kota sınırına 5 TB'den önemli ölçüde daha yüksek.</span><span class="sxs-lookup"><span data-stu-id="d4e36-238">Or when it becomes possible to mount Azure files via NFS and the maximum quota limit is considerably higher than 5 TB.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d4e36-239">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="d4e36-239">Next steps</span></span>
* <span data-ttu-id="d4e36-240">[SAP HANA için yedekleme Kılavuzu Azure sanal makineler üzerinde](sap-hana-backup-guide.md) genel bir bakış ve çalışmaya başlama hakkında bilgi sağlar.</span><span class="sxs-lookup"><span data-stu-id="d4e36-240">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="d4e36-241">[SAP HANA yedekleme depolama anlık görüntü tabanlı](sap-hana-backup-storage-snapshots.md) depolama anlık görüntü tabanlı yedekleme seçeneği açıklar.</span><span class="sxs-lookup"><span data-stu-id="d4e36-241">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes the storage snapshot-based backup option.</span></span>
* <span data-ttu-id="d4e36-242">Yüksek kullanılabilirlik ve olağanüstü durum kurtarma SAP HANA planlama azure'da (büyük örnekler) oluşturmayı öğrenmek için bkz: [SAP HANA (büyük örnekler) Azure üzerinde yüksek kullanılabilirlik ve olağanüstü durum kurtarma](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="d4e36-242">To learn how to establish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
