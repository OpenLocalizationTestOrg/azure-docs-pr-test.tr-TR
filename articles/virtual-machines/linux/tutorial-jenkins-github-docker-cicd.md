---
title: "Jenkins ile azure'da geliştirme işlem hattı oluşturma | Microsoft Docs"
description: "Her kod tamamlama Github'dan çeker ve uygulamanızı çalıştırmak için yeni bir Docker kapsayıcısı derlemeler Azure'da Jenkins sanal makine oluşturma hakkında bilgi edinin"
services: virtual-machines-linux
documentationcenter: virtual-machines
author: iainfoulds
manager: timlt
editor: tysonn
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 05/08/2017
ms.author: iainfou
ms.custom: mvc
ms.openlocfilehash: d9849b5e061dd7f2ae0744a3522dc2eb1fb37035
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 08/29/2017
---
# <a name="how-to-create-a-development-infrastructure-on-a-linux-vm-in-azure-with-jenkins-github-and-docker"></a>Jenkins, GitHub ve Docker ile azure'da bir Linux VM üzerinde bir geliştirme altyapısı oluşturma
Uygulama geliştirme, derleme ve test aşaması otomatikleştirmek için sürekli tümleştirme ve dağıtım (CI/CD) ardışık düzen kullanabilirsiniz. Bu öğreticide, Azure VM temelinde CI/CD işlem hattı oluşturmak için nasıl dahil:

> [!div class="checklist"]
> * Jenkins VM oluşturma
> * Yükleme ve Jenkins yapılandırma
> * GitHub ile Jenkins arasında Web kancası tümleştirme oluşturma
> * Oluşturma ve GitHub yürütme Jenkins yapı işlerden tetikler
> * Uygulamanız için Docker görüntü oluşturma
> * Yeni Docker görüntü ve uygulamayı çalıştıran güncelleştirmeleri GitHub yürütme yapı doğrulayın


[!INCLUDE [cloud-shell-try-it.md](../../../includes/cloud-shell-try-it.md)]

Yüklemek ve CLI yerel olarak kullanmak seçerseniz, Bu öğretici, Azure CLI Sürüm 2.0.4 çalıştırmasını gerektirir veya sonraki bir sürümü. Sürümü bulmak için `az --version` komutunu çalıştırın. Yüklemeniz veya yükseltmeniz gerekirse, bkz. [Azure CLI 2.0 yükleme]( /cli/azure/install-azure-cli). 

## <a name="create-jenkins-instance"></a>Jenkins örneği oluşturma
Önceki bir öğretici içinde [Linux sanal bir makinede ilk önyükleme özelleştirmek nasıl](tutorial-automate-vm-deployment.md), bulut init VM özelleştirmesiyle otomatikleştirmek öğrendiniz. Bu öğretici bir bulut init dosya Jenkins ve Docker bir VM yüklemek için kullanır. 

Geçerli kabuğunuzu adlı bir dosya oluşturun *bulut init.txt* ve aşağıdaki yapılandırma yapıştırın. Örneğin, yerel makinenizde olmayan bulut kabuğunda dosyası oluşturun. Girin `sensible-editor cloud-init-jenkins.txt` dosyası oluşturun ve kullanılabilir düzenleyicileri listesini görmek için. Tüm bulut init dosyanın doğru şekilde kopyalandığından emin olun özellikle ilk satırı:

```yaml
#cloud-config
package_upgrade: true
write_files:
  - path: /etc/systemd/system/docker.service.d/docker.conf
    content: |
      [Service]
        ExecStart=
        ExecStart=/usr/bin/dockerd
  - path: /etc/docker/daemon.json
    content: |
      {
        "hosts": ["fd://","tcp://127.0.0.1:2375"]
      }
runcmd:
  - wget -q -O - https://jenkins-ci.org/debian/jenkins-ci.org.key | apt-key add -
  - sh -c 'echo deb http://pkg.jenkins-ci.org/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
  - apt-get update && apt-get install jenkins -y
  - curl -sSL https://get.docker.com/ | sh
  - usermod -aG docker azureuser
  - usermod -aG docker jenkins
  - service jenkins restart
```

Bir VM oluşturmadan önce bir kaynak grubuyla oluşturmanız [az grubu oluşturma](/cli/azure/group#create). Aşağıdaki örnek, bir kaynak grubu oluşturur *myResourceGroupJenkins* içinde *eastus* konumu:

```azurecli-interactive 
az group create --name myResourceGroupJenkins --location eastus
```

Şimdi bir VM oluşturmak [az vm oluşturma](/cli/azure/vm#create). Kullanım `--custom-data` bulut init yapılandırma dosyanızda geçirmek için parametre. Tam yolunu belirtmeniz *bulut init jenkins.txt* mevcut çalışma dizininizi dışında dosyasını kaydettiyseniz.

```azurecli-interactive 
az vm create --resource-group myResourceGroupJenkins \
    --name myVM \
    --image UbuntuLTS \
    --admin-username azureuser \
    --generate-ssh-keys \
    --custom-data cloud-init-jenkins.txt
```

Oluşturulan ve yapılandırılacak VM için birkaç dakika sürer.

VM ulaşmak web trafiğine izin vermek için kullanın [az vm Aç-port](/cli/azure/vm#open-port) bağlantı noktasını açmak için *8080* Jenkins trafiği ve bağlantı noktası için *1337* bir örnek uygulamayı çalıştırmak için kullanılan Node.js uygulaması için:

```azurecli-interactive 
az vm open-port --resource-group myResourceGroupJenkins --name myVM --port 8080 --priority 1001
az vm open-port --resource-group myResourceGroupJenkins --name myVM --port 1337 --priority 1002
```


## <a name="configure-jenkins"></a>Jenkins yapılandırın
Jenkins örneğinizi erişmek için VM genel IP adresi alın:

```azurecli-interactive 
az vm show --resource-group myResourceGroupJenkins --name myVM -d --query [publicIps] --o tsv
```

Güvenlik nedeniyle, Jenkins yüklemeyi başlatmak için VM üzerindeki bir metin dosyasında depolanan ilk yönetici parolasını girmeniz gerekir. SSH, VM için önceki adımda elde edilen ortak IP adresi kullanın:

```bash
ssh azureuser@<publicIps>
```

Görünüm `initialAdminPassword` , Jenkins yükleyin ve onu kopyalamak için:

```bash
sudo cat /var/lib/jenkins/secrets/initialAdminPassword
```

Dosya henüz kullanılabilir durumda değilse, Jenkins ve Docker yüklemeyi tamamlamak bulut başlatma birkaç dakika daha bekleyin.

Şimdi bir web tarayıcısı açın ve gidin `http://<publicIps>:8080`. İlk Jenkins Kurulum aşağıdaki gibi tamamlayın:

- Girin *initialAdminPassword* VM önceki adımda elde.
- Tıklatın **yüklemek için eklentileri seçin**
- Arama *GitHub* üstte metin kutusunda seçin *GitHub eklentisi*, ardından **yükleyin**
- Jenkins kullanıcı hesabı oluşturmak için istediğiniz gibi formu doldurun. Güvenlik açısından bakıldığında, varsayılan yönetici hesabıyla etmeden yerine bu ilk Jenkins kullanıcı oluşturmanız gerekir.
- Tamamlandığında tıklatarak **Jenkins kullanmaya başlama**


## <a name="create-github-webhook"></a>GitHub Web kancası oluşturma
GitHub ile tümleştirme yapılandırmak için açın [Node.js Hello World örnek uygulaması](https://github.com/Azure-Samples/nodejs-docs-hello-world) Azure örneklerinden depoyu gelen. Kendi GitHub hesabınızda depoyu çatallaştırma için tıklatın **çatalı** sağ üst köşesindeki düğmesi.

Oluşturduğunuz çatalı içinde bir Web kancası oluşturun:

- Tıklatın **ayarları**seçeneğini belirleyip **tümleştirmeler & Hizmetleri** sol taraftaki.
- Tıklatın **Hizmet Ekle**, enter *Jenkins* filtre kutusuna.
- Seçin *Jenkins (GitHub eklentisi)*
- İçin **Jenkins kanca URL**, girin `http://<publicIps>:8080/github-webhook/`. Sondaki eklediğinizden emin olun /
- Tıklatın **Hizmet Ekle**

![GitHub Web kancası, forked deposuna ekleme](media/tutorial-jenkins-github-docker-cicd/github_webhook.png)


## <a name="create-jenkins-job"></a>Jenkins işi oluşturma
Bir olay Jenkins yanıt kodu yürütme gibi Github'da sağlamak için Jenkins işi oluşturun. 

Jenkins siteniz tıklatın **yeni işleri oluşturmak** giriş sayfasından:

- Girin *HelloWorld* iş adı olarak. Seçin **Serbest stilde proje**seçeneğini belirleyip **Tamam**.
- Altında **genel** bölümünde, select **GitHub** proje ve çatallanmış depodaki URL'nizi girin *https://github.com/iainfoulds/nodejs-docs-hello-world*
- Altında **kaynak kodu Yönetimi** bölümünde, select **Git**, forked depodaki girin *.git* URL gibi *https://github.com/iainfoulds/nodejs-docs-hello-world.git*
- Altında **yapı tetikleyicileri** bölümünde, select **GITscm yoklama için GitHub kanca tetikleyici**.
- Altında **yapı** bölümünde, seçin **Ekle derleme adımı**. Seçin **Kabuk yürütme**, enter `echo "Testing"` içinde komut penceresine.
- Tıklatın **kaydetmek** işleri pencerenin altındaki.


## <a name="test-github-integration"></a>Test GitHub tümleştirme
Jenkins GitHub tümleşme test etmek için bir değişiklik, çatalı uygulayın. 

Geri Github'da web kullanıcı Arabirimi, forked depoyu seçin ve ardından **index.js** dosya. Satır 6 okunacak şekilde bu dosyayı düzenlemek için Kalem simgesine tıklayın:

```nodejs
response.end("Hello World!");
```

Değişikliklerinizi kaydetmek için tıklatın **değişiklikleri** altındaki düğmesini.

Jenkins içinde altında yeni bir yapı başlatır **yapı geçmiş** iş sayfanızı sol alt köşesindeki bölümü. Yapı numarası bağlantısına tıklayın ve **konsol çıkış** sol boyutu. Jenkins alan, kodunuzun Github'dan çekildiğinde adımları görüntüleyebilir ve yapı eylemi ileti çıkaran `Testing` Konsolu'na. Github'da, her bir işleme yapıldığında Web kancası için Jenkins ulaştığında ve bu şekilde yeni bir derlemeyi tetiklemeyi.


## <a name="define-docker-build-image"></a>Docker derleme görüntüyü tanımlayın
GitHub yürütme üzerinde göre çalışan Node.js uygulaması görmenizi sağlar uygulamayı çalıştırmak için Docker görüntüsünü oluşturabilirsiniz. Görüntü uygulamanın çalıştığı kapsayıcı yapılandırma tanımlayan bir Dockerfile yerleşik olarak bulunur. 

Bir önceki adımda oluşturduğunuz iş sonra adlı Jenkins çalışma dizini için VM SSH bağlantısı değiştirin. Bizim örneğimizde, adlandırılması *HelloWorld*.

```bash
cd /var/lib/jenkins/workspace/HelloWorld
```

Bu çalışma alanı dizindeki bir dosya oluşturmak `sudo sensible-editor Dockerfile` ve aşağıdaki içeriğini yapıştırın. Tüm Dockerfile doğru şekilde kopyalandığından emin olun özellikle ilk satırı:

```yaml
FROM node:alpine

EXPOSE 1337

WORKDIR /var/www
COPY package.json /var/www/
RUN npm install
COPY index.js /var/www/
```

Alpine Linux kullanarak temel Node.js görüntü, Hello World uygulama çalıştıran çıkarır bağlantı noktası 1337 sonra uygulama dosyalarını kopyalar ve onu başlatır bu Dockerfile kullanır.


## <a name="create-jenkins-build-rules"></a>Jenkins derleme kuralları oluşturma
Önceki adımda, bir ileti konsola çıktı temel bir Jenkins yapı kuralı oluşturuldu. Bizim Dockerfile kullanın ve uygulamayı çalıştırmak için derleme adımı oluşturmak olanak sağlar.

Geri Jenkins örneğinizi içinde bir önceki adımda oluşturduğunuz işi seçin. Tıklatın **yapılandırma** aşağı kaydırın ve sol taraftaki **yapı** bölümü:

- Var olan kaldırmak `echo "Test"` adım oluşturma. Varolan derleme adımı kutusu sağ üst köşesinde bulunan kırmızı çarpı'ı tıklatın.
- Tıklatın **Ekle derleme adımı**seçeneğini belirleyip **Kabuk yürütme**
- İçinde **komutu** kutusunda, aşağıdaki Docker komutları girin, ardından seçin **kaydetmek**:

  ```bash
  docker build --tag helloworld:$BUILD_NUMBER .
  docker stop helloworld && docker rm helloworld
  docker run --name helloworld -p 1337:1337 helloworld:$BUILD_NUMBER node /var/www/index.js &
  ```

Docker derleme adımları imaj ve Jenkins ile yapı numarası görüntüleri bir geçmişini sağlamak için etiketi oluşturun. Uygulamayı çalıştıran herhangi bir varolan kapsayıcıdaki durdurulur ve sonra kaldırılır. Yeni bir kapsayıcı görüntüsünü kullanarak başlatılır ve Node.js uygulamanızı github'da son işlemeleri göre çalıştırır.


## <a name="test-your-pipeline"></a>İşlem hattınızı test
Eylem tüm ardışık görmek için Düzenle *index.js* , forked GitHub deposuna dosya yeniden ve tıklayın **Commit değişiklik**. Jenkins için GitHub Web kancası üzerinde dayalı yeni bir iş başlatır. Docker görüntü oluşturma ve yeni bir kapsayıcı uygulamanızı başlatmak için birkaç saniye sürer.

Gerekirse, VM genel IP adresi yeniden alın:

```azurecli-interactive 
az vm show --resource-group myResourceGroupJenkins --name myVM -d --query [publicIps] --o tsv
```

Bir web tarayıcısı açın ve girin `http://<publicIps>:1337`. Node.js uygulamanızı görüntülenir ve en son işlemeleri GitHub çatalı içinde aşağıdaki gibi yansıtır:

![Çalışan Node.js uygulaması](media/tutorial-jenkins-github-docker-cicd/running_nodejs_app.png)

Artık başka bir düzenleme yapın *index.js* dosya Github'da ve değişikliği uygulayın. İş Jenkins içinde tamamlanması birkaç saniye bekleyin, sonra da yeni bir kapsayıcı şu şekilde çalışan, uygulamanın güncelleştirilmiş sürümünü görmek için web tarayıcınızı yenileyin:

![Başka bir GitHub yürütme sonrasında çalışan Node.js uygulaması](media/tutorial-jenkins-github-docker-cicd/another_running_nodejs_app.png)


## <a name="next-steps"></a>Sonraki adımlar
Bu öğreticide, bir Jenkins yapı her kod tamamlama çalıştırın ve uygulamanızı test etmek için Docker kapsayıcısı dağıtmak için GitHub yapılandırılmış. Size nasıl öğrenilen için:

> [!div class="checklist"]
> * Jenkins VM oluşturma
> * Yükleme ve Jenkins yapılandırma
> * GitHub ile Jenkins arasında Web kancası tümleştirme oluşturma
> * Oluşturma ve GitHub yürütme Jenkins yapı işlerden tetikler
> * Uygulamanız için Docker görüntü oluşturma
> * Yeni Docker görüntü ve uygulamayı çalıştıran güncelleştirmeleri GitHub yürütme yapı doğrulayın

Jenkins Visual Studio Team Services ile tümleştirme hakkında daha fazla bilgi için sonraki öğretici ilerleyin.

> [!div class="nextstepaction"]
> [Jenkins ve Team Services ile uygulamaları dağıtma](tutorial-build-deploy-jenkins.md)