---
title: "aaaAdd izleme ve tanılama tooan Azure sanal makinesi | Microsoft Docs"
description: "Bir Azure Kaynak Yöneticisi şablonu toocreate yeni bir Windows sanal makine ile Azure tanılama uzantısını kullanır."
services: virtual-machines-windows
documentationcenter: 
author: sbtron
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 8cde8fe7-977b-43d2-be74-ad46dc946058
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 05/31/2017
ms.author: saurabh
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: d8a831421a0f9d38c09d51cf8c2e6dff913c77ff
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="use-monitoring-and-diagnostics-with-a-windows-vm-and-azure-resource-manager-templates"></a><span data-ttu-id="642a3-103">İzleme ve tanılama Windows VM ve Azure Resource Manager şablonları ile kullanın.</span><span class="sxs-lookup"><span data-stu-id="642a3-103">Use monitoring and diagnostics with a Windows VM and Azure Resource Manager templates</span></span>
<span data-ttu-id="642a3-104">Hello Azure tanılama uzantısını hello izleme sağlar ve tanılama yetenekleri bir Windows Azure sanal makine tabanlı.</span><span class="sxs-lookup"><span data-stu-id="642a3-104">hello Azure Diagnostics Extension provides hello monitoring and diagnostics capabilities on a Windows based Azure virtual machine.</span></span> <span data-ttu-id="642a3-105">Bu özellikler hello sanal makineye hello azure resource manager şablonu bir parçası olarak hello uzantısı dahil olmak üzere etkinleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="642a3-105">You can enable these capabilities on hello virtual machine by including hello extension as part of hello azure resource manager template.</span></span> <span data-ttu-id="642a3-106">Bkz: [VM uzantıları ile Azure Resource Manager şablonları yazma](template-description.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json#extensions) uzantıyı bir sanal makine şablonunun parçası olarak dahil olmak üzere daha fazla bilgi.</span><span class="sxs-lookup"><span data-stu-id="642a3-106">See [Authoring Azure Resource Manager Templates with VM Extensions](template-description.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json#extensions) for more information on including any extension as part of a virtual machine template.</span></span> <span data-ttu-id="642a3-107">Bu makalede hello Azure tanılama uzantısını tooa windows sanal makine şablonu nasıl ekleyebileceğiniz açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="642a3-107">This article describes how you can add hello Azure Diagnostics extension tooa windows virtual machine template.</span></span>  

## <a name="add-hello-azure-diagnostics-extension-toohello-vm-resource-definition"></a><span data-ttu-id="642a3-108">Hello Azure tanılama toohello VM kaynak tanımı uzantısı Ekle</span><span class="sxs-lookup"><span data-stu-id="642a3-108">Add hello Azure Diagnostics extension toohello VM resource definition</span></span>
<span data-ttu-id="642a3-109">tooenable hello tanılama uzantısını üzerinde bir Windows sanal bir VM kaynak olarak tooadd hello uzantısı gerekir makine Resource manager şablonu hello.</span><span class="sxs-lookup"><span data-stu-id="642a3-109">tooenable hello diagnostics extension on a Windows Virtual Machine you need tooadd hello extension as a VM resource in hello Resource manager template.</span></span>

<span data-ttu-id="642a3-110">İçin basit bir Resource Manager tabanlı sanal makine Ekle hello uzantısı yapılandırma toohello *kaynakları* dizi hello sanal makine için:</span><span class="sxs-lookup"><span data-stu-id="642a3-110">For a simple Resource Manager based Virtual Machine add hello extension configuration toohello *resources* array for hello Virtual Machine:</span></span> 

    "resources": [
                {
                    "name": "Microsoft.Insights.VMDiagnosticsSettings",
                    "type": "extensions",
                    "location": "[resourceGroup().location]",
                    "apiVersion": "2015-06-15",
                    "dependsOn": [
                        "[concat('Microsoft.Compute/virtualMachines/', variables('vmName'))]"
                    ],
                    "tags": {
                        "displayName": "AzureDiagnostics"
                    },
                    "properties": {
                        "publisher": "Microsoft.Azure.Diagnostics",
                        "type": "IaaSDiagnostics",
                        "typeHandlerVersion": "1.5",
                        "autoUpgradeMinorVersion": true,
                        "settings": {
                            "xmlCfg": "[base64(concat(variables('wadcfgxstart'), variables('wadmetricsresourceid'), variables('vmName'), variables('wadcfgxend')))]",
                            "storageAccount": "[parameters('existingdiagnosticsStorageAccountName')]"
                        },
                        "protectedSettings": {
                            "storageAccountName": "[parameters('existingdiagnosticsStorageAccountName')]",
                            "storageAccountKey": "[listkeys(variables('accountid'), '2015-05-01-preview').key1]",
                            "storageAccountEndPoint": "https://core.windows.net"
                        }
                    }
                }
            ]


<span data-ttu-id="642a3-111">Başka bir ortak kuralı ekleyin hello uzantı yapılandırması hello kök kaynakları düğümde hello sanal makinenin kaynakları düğümünde tanımlama yerine hello şablonunun.</span><span class="sxs-lookup"><span data-stu-id="642a3-111">Another common convention is add hello extension configuration at hello root resources node of hello template instead of defining it under hello virtual machine's resources node.</span></span> <span data-ttu-id="642a3-112">Bu yaklaşımda hello uzantısı ile Merhaba sanal makine arasındaki hiyerarşik bir ilişki ile Merhaba belirtin tooexplicitly sahip *adı* ve *türü* değerleri.</span><span class="sxs-lookup"><span data-stu-id="642a3-112">With this approach you have tooexplicitly specify a hierarchical relation between hello extension and hello virtual machine with hello *name* and *type* values.</span></span> <span data-ttu-id="642a3-113">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="642a3-113">For example:</span></span> 

    "name": "[concat(variables('vmName'),'Microsoft.Insights.VMDiagnosticsSettings')]",
    "type": "Microsoft.Compute/virtualMachines/extensions",

<span data-ttu-id="642a3-114">Merhaba uzantısı hello sanal makineyle ilişkili her zaman, ya da doğrudan hello sanal makinenin kaynak düğümünde doğrudan tanımlayın veya hello temel düzeyde tanımlamak ve hello hiyerarşik adlandırma kuralı tooassociate kullanmak hello sanal ile Makine.</span><span class="sxs-lookup"><span data-stu-id="642a3-114">hello extension is always associated with hello virtual machine, you can either directly define it under hello virtual machine's resource node directly or define it at hello base level and use hello hierarchical naming convention tooassociate it with hello virtual machine.</span></span>

<span data-ttu-id="642a3-115">Sanal makine ölçek kümeleri hello uzantıları hello belirtilen yapılandırma *extensionProfile* hello özelliğinin *VirtualMachineProfile*.</span><span class="sxs-lookup"><span data-stu-id="642a3-115">For Virtual Machine Scale Sets hello extensions configuration is specified in hello *extensionProfile* property of hello *VirtualMachineProfile*.</span></span>

<span data-ttu-id="642a3-116">Merhaba *yayımcı* hello değerini özelliğiyle **Microsoft.Azure.Diagnostics** ve hello *türü* hello değerini özelliğiyle **IaaSDiagnostics** hello Azure tanılama uzantısını benzersiz şekilde tanımlar.</span><span class="sxs-lookup"><span data-stu-id="642a3-116">hello *publisher* property with hello value of **Microsoft.Azure.Diagnostics** and hello *type* property with hello value of **IaaSDiagnostics** uniquely identify hello Azure Diagnostics extension.</span></span>

<span data-ttu-id="642a3-117">Merhaba hello değerini *adı* özelliği kullanılan toorefer toohello uzantısı hello kaynak grubunda olması olabilir.</span><span class="sxs-lookup"><span data-stu-id="642a3-117">hello value of hello *name* property can be used toorefer toohello extension in hello resource group.</span></span> <span data-ttu-id="642a3-118">Özellikle çok ayarı**Microsoft.Insights.VMDiagnosticsSettings** kolayca izleme grafikleri Göster yukarı doğru hello Azure portal hello Azure portal sağlama hello tarafından tanımlanan toobe olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="642a3-118">Setting it specifically too**Microsoft.Insights.VMDiagnosticsSettings** will enable it toobe easily identified by hello Azure portal ensuring that hello monitoring charts show up correctly in hello Azure portal.</span></span>

<span data-ttu-id="642a3-119">Merhaba *typeHandlerVersion* hello sürümünü belirten hello uzantısı toouse istersiniz.</span><span class="sxs-lookup"><span data-stu-id="642a3-119">hello *typeHandlerVersion* specifies hello version of hello extension you would like toouse.</span></span> <span data-ttu-id="642a3-120">Ayarı *autoUpgradeMinorVersion* çok ikincil sürüm**true** kullanılabilir hello uzantısı'nın en son alt sürüm hello alırsınız sağlar.</span><span class="sxs-lookup"><span data-stu-id="642a3-120">Setting *autoUpgradeMinorVersion* minor version too**true** ensures that you will get hello latest Minor version of hello extension that is available.</span></span> <span data-ttu-id="642a3-121">Her zaman ayarlamanız önerilir *autoUpgradeMinorVersion* tooalways olması **true** böylece her zaman toouse hello tüm hello yeni özellikler ve hata ile en son kullanılabilir tanılama uzantısını Al giderir.</span><span class="sxs-lookup"><span data-stu-id="642a3-121">It is highly recommended that you always set *autoUpgradeMinorVersion* tooalways be **true** so that you always get toouse hello latest available diagnostics extension with all hello new features and bug fixes.</span></span> 

<span data-ttu-id="642a3-122">Merhaba *ayarları* öğesi ayarlayın ve geri hello uzantısı (bazen başvurulan tooas ortak yapılandırma) okuma hello uzantısı yapılandırmaları özelliklerini içerir.</span><span class="sxs-lookup"><span data-stu-id="642a3-122">hello *settings* element contains configurations properties for hello extension that can be set and read back from hello extension (sometimes referred tooas public configuration).</span></span> <span data-ttu-id="642a3-123">Merhaba *xmlcfg* özelliği içeren xml tabanlı yapılandırma hello tanılama günlükleri, performans sayaçları hello tanılama aracısı tarafından toplanan vs.</span><span class="sxs-lookup"><span data-stu-id="642a3-123">hello *xmlcfg* property contains xml based configuration for hello diagnostics logs, performance counters etc that will be collected by hello diagnostics agent.</span></span> <span data-ttu-id="642a3-124">Bkz: [tanılama yapılandırma şeması](https://msdn.microsoft.com/library/azure/dn782207.aspx) hello xml şeması kendisi hakkında daha fazla bilgi.</span><span class="sxs-lookup"><span data-stu-id="642a3-124">See [Diagnostics Configuration Schema](https://msdn.microsoft.com/library/azure/dn782207.aspx) for more information about hello xml schema itself.</span></span> <span data-ttu-id="642a3-125">Değişkeni hello Azure Resource Manager şablonu ve ardından Birleştir ve base64 bunları tooset hello değeri için kodlama gibi yaygın bir toostore hello gerçek xml yapılandırması uygulamadır *xmlcfg*.</span><span class="sxs-lookup"><span data-stu-id="642a3-125">A common practice is toostore hello actual xml configuration as a variable in hello Azure Resource Manager template and then concatenate and base64 encode them tooset hello value for *xmlcfg*.</span></span> <span data-ttu-id="642a3-126">Merhaba bölümüne bakarak [tanılama yapılandırma değişkenleri](#diagnostics-configuration-variables) toounderstand nasıl toostore hello değişkenleri XML'de hakkında daha fazla bilgi.</span><span class="sxs-lookup"><span data-stu-id="642a3-126">See hello section on [diagnostics configuration variables](#diagnostics-configuration-variables) toounderstand more about how toostore hello xml in variables.</span></span> <span data-ttu-id="642a3-127">Merhaba *storageAccount* özellik belirtir hello depolama hesabı toowhich tanılama verilerini hello adını aktarılmayacak.</span><span class="sxs-lookup"><span data-stu-id="642a3-127">hello *storageAccount* property specifies hello name of hello storage account toowhich diagnostics data will be transferred.</span></span> 

<span data-ttu-id="642a3-128">Merhaba özelliklerinde *protectedSettings* (bazen başvurulan tooas özel yapılandırma) ayarlanabilir, ancak geri ayarlanmasından sonra okunamıyor.</span><span class="sxs-lookup"><span data-stu-id="642a3-128">hello properties in *protectedSettings* (sometimes referred tooas private configuration) can be set but cannot be read back after being set.</span></span> <span data-ttu-id="642a3-129">salt yazılır yapısını Hello *protectedSettings* hello depolama hesabı anahtarı gibi parolaları depolamak için yararlı hello tanılama verilerini yazılacağı kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="642a3-129">hello write-only nature of *protectedSettings* makes it useful for storing secrets like hello storage account key where hello diagnostics data will be written.</span></span>    

## <a name="specifying-diagnostics-storage-account-as-parameters"></a><span data-ttu-id="642a3-130">Parametre olarak tanılama depolama hesabı belirtme</span><span class="sxs-lookup"><span data-stu-id="642a3-130">Specifying diagnostics storage account as parameters</span></span>
<span data-ttu-id="642a3-131">Merhaba tanılama uzantısını json parçacığı Yukarıdaki iki parametre varsayar *existingdiagnosticsStorageAccountName* ve *existingdiagnosticsStorageResourceGroup* toospecify hello tanılama Tanılama verilerini depolanacağı depolama hesabı.</span><span class="sxs-lookup"><span data-stu-id="642a3-131">hello diagnostics extension json snippet above assumes two parameters *existingdiagnosticsStorageAccountName* and *existingdiagnosticsStorageResourceGroup* toospecify hello diagnostics storage account where diagnostics data will be stored.</span></span> <span data-ttu-id="642a3-132">Merhaba tanılama depolama hesabı belirten isteğe bağlı olarak bir parametreyi kolay toochange hello tanılama depolama hesabı yapar gibi farklı ortamlar genelinde örn, toouse farklı tanılama depolama hesabı için farklı bir test ve için isteyebilirsiniz, Üretim dağıtımı.</span><span class="sxs-lookup"><span data-stu-id="642a3-132">Specifying hello diagnostics storage account as a parameter makes it easy toochange hello diagnostics storage account across different environments e.g. you may want toouse a different diagnostics storage account for testing and a different one for your production deployment.</span></span>  

        "existingdiagnosticsStorageAccountName": {
            "type": "string",
            "metadata": {
        "description": "hello name of an existing storage account toowhich diagnostics data will be transfered."
            }        
        },
        "existingdiagnosticsStorageResourceGroup": {
            "type": "string",
            "metadata": {
        "description": "hello resource group for hello storage account specified in existingdiagnosticsStorageAccountName"
              }
        }

<span data-ttu-id="642a3-133">En iyi yöntem toospecify tanılama depolama hesabı hello kaynak grubundan hello sanal makine için farklı bir kaynak grubunda değil.</span><span class="sxs-lookup"><span data-stu-id="642a3-133">It is best practice toospecify a diagnostics storage account in a different resource group than hello resource group for hello virtual machine.</span></span> <span data-ttu-id="642a3-134">Bir kaynak grubu toobe kendi ömrü sahip bir dağıtım birimi kabul edilebilir, bir sanal makine dağıtılabilir ve yeni yapılandırmaları güncelleştirmeleri gerçekleştirilmediğinden imzalanmasını tooit ancak hello hello tanılama veri depolama toocontinue isteyebilir aynı depolama hesabı Bu sanal makine dağıtımlar arasında.</span><span class="sxs-lookup"><span data-stu-id="642a3-134">A resource group can be considered toobe a deployment unit with its own lifetime, a virtual machine can be deployed and redeployed as new configurations updates are made it tooit but you may want toocontinue storing hello diagnostics data in hello same storage account across those virtual machine deployments.</span></span> <span data-ttu-id="642a3-135">Farklı kaynak etkinleştirir hello depolama hesabı tooaccept veri kolay tootroubleshoot yapmadan çeşitli sanal makine dağıtımlarından Hello depolama hesabına sahip olunması çeşitli sürümler arasında sorunları hello.</span><span class="sxs-lookup"><span data-stu-id="642a3-135">Having hello storage account in a different resource enables hello storage account tooaccept data from various virtual machine deployments making it easy tootroubleshoot issues across hello various versions.</span></span>

> [!NOTE]
> <span data-ttu-id="642a3-136">Merhaba varsayılan depolama hesabı ayarlayabilirsiniz Visual Studio'dan bir windows sanal makine şablonu oluşturursanız toouse hello sanal makine VHD burada karşıya aynı depolama hesabındaki hello.</span><span class="sxs-lookup"><span data-stu-id="642a3-136">If you create a windows virtual machine template from Visual Studio hello default storage account might be set toouse hello same storage account where hello virtual machine VHD is uploaded.</span></span> <span data-ttu-id="642a3-137">Merhaba VM ilk kurulumu toosimplify budur.</span><span class="sxs-lookup"><span data-stu-id="642a3-137">This is toosimplify initial setup of hello VM.</span></span> <span data-ttu-id="642a3-138">Merhaba şablonu toouse parametre olarak geçirilebilir farklı depolama hesabı yeniden bulundurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="642a3-138">You should re-factor hello template toouse a different storage account that can be passed in as a parameter.</span></span> 
> 
> 

## <a name="diagnostics-configuration-variables"></a><span data-ttu-id="642a3-139">Tanılama yapılandırma değişkenleri</span><span class="sxs-lookup"><span data-stu-id="642a3-139">Diagnostics configuration variables</span></span>
<span data-ttu-id="642a3-140">Merhaba tanılama uzantısını json parçacığı yukarıdaki tanımlayan bir *AccountID* değişken toosimplify hello depolama hesabı anahtarı hello tanılama depolama alınıyor:</span><span class="sxs-lookup"><span data-stu-id="642a3-140">hello diagnostics extension json snippet above defines an *accountid* variable toosimplify getting hello storage account key for hello diagnostics storage:</span></span>   

    "accountid": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/',parameters('existingdiagnosticsStorageResourceGroup'), '/providers/','Microsoft.Storage/storageAccounts/', parameters('existingdiagnosticsStorageAccountName'))]"


<span data-ttu-id="642a3-141">Merhaba *xmlcfg* hello tanılama uzantısını özelliği birlikte birleştirilmiş birden çok değişkenleri kullanılarak tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="642a3-141">hello *xmlcfg* property for hello diagnostics extension is defined using multiple variables that are concatenated together.</span></span> <span data-ttu-id="642a3-142">Merhaba json değişkenleri ayarlarken doğru bir şekilde Atlanan toobe ihtiyaç duydukları şekilde hello bu değişkenlerin XML'de değerlerdir.</span><span class="sxs-lookup"><span data-stu-id="642a3-142">hello values of these variables are in xml so they need toobe escaped correctly when setting hello json variables.</span></span>

<span data-ttu-id="642a3-143">Bazı windows olay günlüklerini ve tanılama altyapı günlükleri ile birlikte standart sistem düzeyinde performans sayaçlarını toplar hello tanılama yapılandırması xml Hello açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="642a3-143">hello following describes hello diagnostics configuration xml that collects standard system level performance counters along with some windows event logs and diagnostics infrastructure logs.</span></span> <span data-ttu-id="642a3-144">Bunu olduğundan kaçışlı ve böylece hello yapılandırma doğrudan şablonunuzun değişkenleri bölüme hello yapıştırılabilmesi için doğru biçimlendirilmiş.</span><span class="sxs-lookup"><span data-stu-id="642a3-144">It has been escaped and formatted correctly so that hello configuration can directly be pasted into hello variables section of your template.</span></span> <span data-ttu-id="642a3-145">Merhaba bkz [tanılama yapılandırma şeması](https://msdn.microsoft.com/library/azure/dn782207.aspx) hello yapılandırma xml İnsan daha okunabilir bir örneğin.</span><span class="sxs-lookup"><span data-stu-id="642a3-145">See hello [Diagnostics Configuration Schema](https://msdn.microsoft.com/library/azure/dn782207.aspx) for a more human readable example of hello configuration xml.</span></span>

        "wadlogs": "<WadCfg> <DiagnosticMonitorConfiguration overallQuotaInMB=\"4096\" xmlns=\"http://schemas.microsoft.com/ServiceHosting/2010/10/DiagnosticsConfiguration\"> <DiagnosticInfrastructureLogs scheduledTransferLogLevelFilter=\"Error\"/> <WindowsEventLog scheduledTransferPeriod=\"PT1M\" > <DataSource name=\"Application!*[System[(Level = 1 or Level = 2)]]\" /> <DataSource name=\"Security!*[System[(Level = 1 or Level = 2)]]\" /> <DataSource name=\"System!*[System[(Level = 1 or Level = 2)]]\" /></WindowsEventLog>",
        "wadperfcounters1": "<PerformanceCounters scheduledTransferPeriod=\"PT1M\"><PerformanceCounterConfiguration counterSpecifier=\"\\Processor(_Total)\\% Processor Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"CPU utilization\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Processor(_Total)\\% Privileged Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"CPU privileged time\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Processor(_Total)\\% User Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"CPU user time\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Processor Information(_Total)\\Processor Frequency\" sampleRate=\"PT15S\" unit=\"Count\"><annotation displayName=\"CPU frequency\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\System\\Processes\" sampleRate=\"PT15S\" unit=\"Count\"><annotation displayName=\"Processes\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Process(_Total)\\Thread Count\" sampleRate=\"PT15S\" unit=\"Count\"><annotation displayName=\"Threads\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Process(_Total)\\Handle Count\" sampleRate=\"PT15S\" unit=\"Count\"><annotation displayName=\"Handles\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Memory\\% Committed Bytes In Use\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Memory usage\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Memory\\Available Bytes\" sampleRate=\"PT15S\" unit=\"Bytes\"><annotation displayName=\"Memory available\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Memory\\Committed Bytes\" sampleRate=\"PT15S\" unit=\"Bytes\"><annotation displayName=\"Memory committed\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Memory\\Commit Limit\" sampleRate=\"PT15S\" unit=\"Bytes\"><annotation displayName=\"Memory commit limit\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\% Disk Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Disk active time\" locale=\"en-us\"/></PerformanceCounterConfiguration>",
        "wadperfcounters2": "<PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\% Disk Read Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Disk active read time\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\% Disk Write Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Disk active write time\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Transfers/sec\" sampleRate=\"PT15S\" unit=\"CountPerSecond\"><annotation displayName=\"Disk operations\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Reads/sec\" sampleRate=\"PT15S\" unit=\"CountPerSecond\"><annotation displayName=\"Disk read operations\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Writes/sec\" sampleRate=\"PT15S\" unit=\"CountPerSecond\"><annotation displayName=\"Disk write operations\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Bytes/sec\" sampleRate=\"PT15S\" unit=\"BytesPerSecond\"><annotation displayName=\"Disk speed\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Read Bytes/sec\" sampleRate=\"PT15S\" unit=\"BytesPerSecond\"><annotation displayName=\"Disk read speed\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Write Bytes/sec\" sampleRate=\"PT15S\" unit=\"BytesPerSecond\"><annotation displayName=\"Disk write speed\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\LogicalDisk(_Total)\\% Free Space\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Disk free space (percentage)\" locale=\"en-us\"/></PerformanceCounterConfiguration></PerformanceCounters>",
        "wadcfgxstart": "[concat(variables('wadlogs'), variables('wadperfcounters1'), variables('wadperfcounters2'), '<Metrics resourceId=\"')]",
        "wadmetricsresourceid": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name , '/providers/', 'Microsoft.Compute/virtualMachines/')]",
        "wadcfgxend": "\"><MetricAggregation scheduledTransferPeriod=\"PT1H\"/><MetricAggregation scheduledTransferPeriod=\"PT1M\"/></Metrics></DiagnosticMonitorConfiguration></WadCfg>"

<span data-ttu-id="642a3-146">Hello ölçümleri tanım xml yapılandırma yukarıda hello düğümünde olduğu önemli yapılandırma öğesi nasıl hello performans sayaçları önceki hello xml dosyasında tanımlanan tanımlar gibi *PerformanceCounter* düğüm araya getirilir ve depolanır.</span><span class="sxs-lookup"><span data-stu-id="642a3-146">hello Metrics definition xml node in hello above configuration is an important configuration element as it defines how hello performance counters defined earlier in hello xml in *PerformanceCounter* node will be aggregated and stored.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="642a3-147">Bu ölçümler grafikler ve hello Azure portalında uyarılar izleme hello sürücü.</span><span class="sxs-lookup"><span data-stu-id="642a3-147">These metrics drive hello monitoring charts and alerts in hello Azure portal.</span></span>  <span data-ttu-id="642a3-148">Merhaba **ölçümleri** hello düğümle *ResourceId* ve **MetricAggregation** toosee hello VM istiyorsanız, VM için hello tanılama yapılandırmasında eklenmelidir hello Azure portal izleme verileri.</span><span class="sxs-lookup"><span data-stu-id="642a3-148">hello **Metrics** node with hello *resourceID* and **MetricAggregation** must be included in hello diagnostics configuration for your VM if you want toosee hello VM monitoring data in hello Azure portal.</span></span> 
> 
> 

<span data-ttu-id="642a3-149">Merhaba, ölçüm tanımlarını hello xml örneği aşağıdadır:</span><span class="sxs-lookup"><span data-stu-id="642a3-149">hello following is an example of hello xml for metrics definitions:</span></span> 

        <Metrics resourceId="/subscriptions/subscription().subscriptionId/resourceGroups/resourceGroup().name/providers/Microsoft.Compute/virtualMachines/vmName">
            <MetricAggregation scheduledTransferPeriod="PT1H"/>
            <MetricAggregation scheduledTransferPeriod="PT1M"/>
        </Metrics>

<span data-ttu-id="642a3-150">Merhaba *ResourceId* özniteliği benzersiz olarak tanımlayan aboneliğinizde hello sanal makine.</span><span class="sxs-lookup"><span data-stu-id="642a3-150">hello *resourceID* attribute uniquely identifies hello virtual machine in your subscription.</span></span> <span data-ttu-id="642a3-151">Toouse hello subscription() emin olun ve hello şablonu otomatik olarak dağıttığınız hello abonelik ve kaynak grubuna göre bu değerleri güncelleştirilebilmesi için resourceGroup() çalışır.</span><span class="sxs-lookup"><span data-stu-id="642a3-151">Make sure toouse hello subscription() and resourceGroup() functions so that hello template automatically updates those values based on hello subscription and resource group you are deploying to.</span></span>

<span data-ttu-id="642a3-152">Birden çok sanal makine bir döngüde oluşturmakta olduğunuz sonra toopopulate hello olacaktır *ResourceId* copyındex () işlevini toocorrectly değerle birbirinden ayrı ayrı her VM.</span><span class="sxs-lookup"><span data-stu-id="642a3-152">If you are creating multiple Virtual Machines in a loop then you will have toopopulate hello *resourceID* value with an copyIndex() function toocorrectly differentiate each individual VM.</span></span> <span data-ttu-id="642a3-153">Merhaba *xmlCfg* değeri güncelleştirilmiş toosupport bu aşağıdaki gibi olabilir:</span><span class="sxs-lookup"><span data-stu-id="642a3-153">hello *xmlCfg* value can be updated toosupport this as follows:</span></span>  

    "xmlCfg": "[base64(concat(variables('wadcfgxstart'), variables('wadmetricsresourceid'), concat(parameters('vmNamePrefix'), copyindex()), variables('wadcfgxend')))]", 

<span data-ttu-id="642a3-154">MetricAggregation değerini hello *PT1H* ve *PT1M* bir dakika içinde bir toplama ve bir saat içinde bir toplama türünü belirtir.</span><span class="sxs-lookup"><span data-stu-id="642a3-154">hello MetricAggregation value of *PT1H* and *PT1M* signify an aggregation over a minute and an aggregation over an hour.</span></span>

## <a name="wadmetrics-tables-in-storage"></a><span data-ttu-id="642a3-155">Depolama WADMetrics tabloları</span><span class="sxs-lookup"><span data-stu-id="642a3-155">WADMetrics tables in storage</span></span>
<span data-ttu-id="642a3-156">Hello ölçümleri yapılandırma yukarıdaki tablolarda tanılama depolama hesabınızdaki adlandırma kurallarına hello ile üretir:</span><span class="sxs-lookup"><span data-stu-id="642a3-156">hello Metrics configuration above will generate tables in your diagnostics storage account with hello following naming conventions:</span></span>

* <span data-ttu-id="642a3-157">**WADMetrics** : tüm WADMetrics tablolar için standart bir önek</span><span class="sxs-lookup"><span data-stu-id="642a3-157">**WADMetrics** : Standard prefix for all WADMetrics tables</span></span>
* <span data-ttu-id="642a3-158">**PT1H** veya **PT1M** : hello tablosunun içeren veri toplama üzerinde 1 saat veya 1 dakika belirtir</span><span class="sxs-lookup"><span data-stu-id="642a3-158">**PT1H** or **PT1M** : Signifies that hello table contains aggregate data over 1 hour or 1 minute</span></span>
* <span data-ttu-id="642a3-159">**P10D** : hello tablo hello tablo veri toplama başladığında gelen 10 gün için veri içerecek belirtir</span><span class="sxs-lookup"><span data-stu-id="642a3-159">**P10D** : Signifies hello table will contain data for 10 days from when hello table started collecting data</span></span>
* <span data-ttu-id="642a3-160">**V2S** : dize sabiti</span><span class="sxs-lookup"><span data-stu-id="642a3-160">**V2S** : String constant</span></span>
* <span data-ttu-id="642a3-161">**yyyyaagg** : hello tarih hangi hello başlatıldı verileri toplama</span><span class="sxs-lookup"><span data-stu-id="642a3-161">**yyyymmdd** : hello date at which hello table started collecting data</span></span>

<span data-ttu-id="642a3-162">Örnek: *WADMetricsPT1HP10DV2S20151108* 11-Kas-2015 tarihinde başlayan 10 günlük bir saate üzerinden toplanan ölçümleri veri içermez</span><span class="sxs-lookup"><span data-stu-id="642a3-162">Example: *WADMetricsPT1HP10DV2S20151108* will contain metrics data aggregated over an hour for 10 days starting on 11-Nov-2015</span></span>    

<span data-ttu-id="642a3-163">Her WADMetrics tablo sütunları aşağıdaki hello içerir:</span><span class="sxs-lookup"><span data-stu-id="642a3-163">Each WADMetrics table will contain hello following columns:</span></span>

* <span data-ttu-id="642a3-164">**PartitionKey**: Merhaba partitionkey üzerinde hello göre yapılandırılmıştır *ResourceId* değeri toouniquely hello VM kaynak belirleyin.</span><span class="sxs-lookup"><span data-stu-id="642a3-164">**PartitionKey**: hello partitionkey is constructed based on hello *resourceID* value toouniquely identify hello VM resource.</span></span> <span data-ttu-id="642a3-165">için örn: 002Fsubscriptions:<subscriptionID>: 002FresourceGroups:002F<ResourceGroupName>: 002Fproviders:002FMicrosoft:002ECompute:002FvirtualMachines:002F<vmName></span><span class="sxs-lookup"><span data-stu-id="642a3-165">for e.g. : 002Fsubscriptions:<subscriptionID>:002FresourceGroups:002F<ResourceGroupName>:002Fproviders:002FMicrosoft:002ECompute:002FvirtualMachines:002F<vmName></span></span>  
* <span data-ttu-id="642a3-166">**RowKey** : aşağıdaki hello biçimi <Descending time tick>:<Performance Counter Name>.</span><span class="sxs-lookup"><span data-stu-id="642a3-166">**RowKey** : Follows hello format <Descending time tick>:<Performance Counter Name>.</span></span> <span data-ttu-id="642a3-167">süresi onay hesaplaması azalan hello hello toplama dönemi hello başlangıcından hello süresini eksi max zaman ticks ' dir.</span><span class="sxs-lookup"><span data-stu-id="642a3-167">hello descending time tick calculation is max time ticks minus hello time of hello beginning of hello aggregation period.</span></span> <span data-ttu-id="642a3-168">Örneğin</span><span class="sxs-lookup"><span data-stu-id="642a3-168">E.g.</span></span> <span data-ttu-id="642a3-169">Merhaba örnek süresi 10-Kas-2015 tarihinde başlatılır ve 00:00Hrs UTC sonra hello hesaplama olacaktır: DateTime.MaxValue.Ticks - (yeni DateTime(2015,11,10,0,0,0,DateTimeKind.Utc). Ticks).</span><span class="sxs-lookup"><span data-stu-id="642a3-169">if hello sample period started on 10-Nov-2015 and 00:00Hrs UTC then hello calculation would be: DateTime.MaxValue.Ticks - (new DateTime(2015,11,10,0,0,0,DateTimeKind.Utc).Ticks).</span></span> <span data-ttu-id="642a3-170">Merhaba bellek kullanılabilir bayt sayısı performans sayacı hello satır anahtarını görüneceğini için ister: 2519551871999999999__:005CMemory:005CAvailable:0020 bayt</span><span class="sxs-lookup"><span data-stu-id="642a3-170">For hello memory available bytes performance counter hello row key will look like: 2519551871999999999__:005CMemory:005CAvailable:0020Bytes</span></span>
* <span data-ttu-id="642a3-171">**CounterName** : hello performans sayacı hello adıdır.</span><span class="sxs-lookup"><span data-stu-id="642a3-171">**CounterName** : Is hello name of hello performance counter.</span></span> <span data-ttu-id="642a3-172">Bu hello eşleşen *counterSpecifier* hello xml yapılandırma dosyasında tanımlanmış.</span><span class="sxs-lookup"><span data-stu-id="642a3-172">This matches hello *counterSpecifier* defined in hello xml config.</span></span>
* <span data-ttu-id="642a3-173">**En fazla** : Merhaba hello performans sayacı en büyük değerini hello toplama süresi içinde.</span><span class="sxs-lookup"><span data-stu-id="642a3-173">**Maximum** : hello maximum value of hello performance counter over hello aggregation period.</span></span>
* <span data-ttu-id="642a3-174">**En düşük** : hello toplama süresi içinde hello hello performans sayacı en küçük değeri.</span><span class="sxs-lookup"><span data-stu-id="642a3-174">**Minimum** : hello minimum value of hello performance counter over hello aggregation period.</span></span>
* <span data-ttu-id="642a3-175">**Toplam** : hello hello performans sayacı tüm değerlerin toplamını hello toplama süresi içinde bildirdi.</span><span class="sxs-lookup"><span data-stu-id="642a3-175">**Total** : hello sum of all values of hello performance counter reported over hello aggregation period.</span></span>
* <span data-ttu-id="642a3-176">**Count** : hello performans sayacı için bildirilen hello değerleri toplam sayısı.</span><span class="sxs-lookup"><span data-stu-id="642a3-176">**Count** : hello total number of values reported for hello performance counter.</span></span>
* <span data-ttu-id="642a3-177">**Ortalama** : hello toplama süresi içinde hello hello performans sayacının ortalama (toplam/sayısı) değeri.</span><span class="sxs-lookup"><span data-stu-id="642a3-177">**Average** : hello average (total/count) value of hello performance counter over hello aggregation period.</span></span>

## <a name="next-steps"></a><span data-ttu-id="642a3-178">Sonraki Adımlar</span><span class="sxs-lookup"><span data-stu-id="642a3-178">Next Steps</span></span>
* <span data-ttu-id="642a3-179">Windows sanal makinesi tanılama uzantısını içeren tam örnek şablonu için bkz: [201-vm-monitoring-tanılama-uzantısı](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-monitoring-diagnostics-extension)</span><span class="sxs-lookup"><span data-stu-id="642a3-179">For a complete sample template of a Windows virtual machine with diagnostics extension see [201-vm-monitoring-diagnostics-extension](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-monitoring-diagnostics-extension)</span></span>   
* <span data-ttu-id="642a3-180">Merhaba resource manager şablonunu kullanarak dağıtın [Azure PowerShell](ps-template.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) veya [Azure komut satırı](../linux/create-ssh-secured-vm-from-template.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span><span class="sxs-lookup"><span data-stu-id="642a3-180">Deploy hello resource manager template using [Azure PowerShell](ps-template.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) or [Azure Command Line](../linux/create-ssh-secured-vm-from-template.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span></span>
* <span data-ttu-id="642a3-181">Daha fazla bilgi edinmek [Azure Resource Manager şablonları yazma](../../resource-group-authoring-templates.md)</span><span class="sxs-lookup"><span data-stu-id="642a3-181">Learn more about [authoring Azure Resource Manager templates](../../resource-group-authoring-templates.md)</span></span>

