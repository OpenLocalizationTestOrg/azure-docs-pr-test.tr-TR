---
title: "Bulut hizmeti ayırma hatası aaaTroubleshooting | Microsoft Docs"
description: "Azure’da Cloud Services dağıtımı sırasında oluşan ayırma hatalarını giderme"
services: azure-service-management, cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 529157eb-e4a1-4388-aa2b-09e8b923af74
ms.service: cloud-services
ms.workload: na
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: dfd5cc4663ccc6ed1b27ca9df579182737363b0e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-allocation-failure-when-you-deploy-cloud-services-in-azure"></a><span data-ttu-id="4a869-103">Azure’da Cloud Services dağıtımı sırasında oluşan ayırma hatalarını giderme</span><span class="sxs-lookup"><span data-stu-id="4a869-103">Troubleshooting allocation failure when you deploy Cloud Services in Azure</span></span>
## <a name="summary"></a><span data-ttu-id="4a869-104">Özet</span><span class="sxs-lookup"><span data-stu-id="4a869-104">Summary</span></span>
<span data-ttu-id="4a869-105">Bulut hizmeti örnekleri tooa dağıtmak veya yeni web veya çalışan rolü örnekleri eklediğinizde, Microsoft Azure işlem kaynakları ayırır.</span><span class="sxs-lookup"><span data-stu-id="4a869-105">When you deploy instances tooa Cloud Service or add new web or worker role instances, Microsoft Azure allocates compute resources.</span></span> <span data-ttu-id="4a869-106">Zaman zaman bile hello Azure abonelik limitleri düşmeden önce bu işlemleri yaparken hatalar alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4a869-106">You may occasionally receive errors when performing these operations even before you reach hello Azure subscription limits.</span></span> <span data-ttu-id="4a869-107">Bu makalede, bazı hello ortak ayırma hatalarının hello nedenlerini açıklar ve olası düzeltme önerir.</span><span class="sxs-lookup"><span data-stu-id="4a869-107">This article explains hello causes of some of hello common allocation failures and suggests possible remediation.</span></span> <span data-ttu-id="4a869-108">hizmetlerinizin hello dağıtımını planlarken hello bilgiler de yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a869-108">hello information may also be useful when you plan hello deployment of your services.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

### <a name="background--how-allocation-works"></a><span data-ttu-id="4a869-109">Arka plan – ayırma nasıl çalışır?</span><span class="sxs-lookup"><span data-stu-id="4a869-109">Background – How allocation works</span></span>
<span data-ttu-id="4a869-110">Azure veri merkezlerinde Hello sunucuları kümeler halinde bölümlenir.</span><span class="sxs-lookup"><span data-stu-id="4a869-110">hello servers in Azure datacenters are partitioned into clusters.</span></span> <span data-ttu-id="4a869-111">Yeni bir bulut hizmeti ayırma isteği birden çok kümelerde denenir.</span><span class="sxs-lookup"><span data-stu-id="4a869-111">A new cloud service allocation request is attempted in multiple clusters.</span></span> <span data-ttu-id="4a869-112">Merhaba ilk örneği, bulut hizmeti dağıtılan tooa bulut hizmetinde (hazırlama veya üretim) olduğunda sabitlenmiş tooa küme alır.</span><span class="sxs-lookup"><span data-stu-id="4a869-112">When hello first instance is deployed tooa cloud service(in either staging or production), that cloud service gets pinned tooa cluster.</span></span> <span data-ttu-id="4a869-113">Herhangi bir daha fazla dağıtımları hello bulut hizmeti hello aynı olacağını için küme.</span><span class="sxs-lookup"><span data-stu-id="4a869-113">Any further deployments for hello cloud service will happen in hello same cluster.</span></span> <span data-ttu-id="4a869-114">Bu makalede, biz "sabitlenmiş tooa küme olarak" toothis başvurun.</span><span class="sxs-lookup"><span data-stu-id="4a869-114">In this article, we'll refer toothis as "pinned tooa cluster".</span></span> <span data-ttu-id="4a869-115">Aşağıdaki diyagram 1, birden çok kümelerde denenir normal bir ayırma hello durumunun gösterir; Diyagram 2, burada mevcut bulut hizmeti CS_1 hello çünkü o sabitlenmiş tooCluster 2 barındırılan bir ayırma hello durumunu gösterir.</span><span class="sxs-lookup"><span data-stu-id="4a869-115">Diagram 1 below illustrates hello case of a normal allocation which is attempted in multiple clusters; Diagram 2 illustrates hello case of an allocation that's pinned tooCluster 2 because that's where hello existing Cloud Service CS_1 is hosted.</span></span>

![Ayırma diyagramı](./media/cloud-services-allocation-failure/Allocation1.png)

### <a name="why-allocation-failure-happens"></a><span data-ttu-id="4a869-117">Ayırma hatası neden olur</span><span class="sxs-lookup"><span data-stu-id="4a869-117">Why allocation failure happens</span></span>
<span data-ttu-id="4a869-118">Ayırma isteği sabitlenmiş tooa küme olduğunda hello kullanılabilir kaynak havuzu sınırlı tooa küme olduğundan toofind boş kaynak başarısız bir yüksek ihtimalini yoktur.</span><span class="sxs-lookup"><span data-stu-id="4a869-118">When an allocation request is pinned tooa cluster, there's a higher chance of failing toofind free resources since hello available resource pool is limited tooa cluster.</span></span> <span data-ttu-id="4a869-119">Merhaba küme ücretsiz kaynağa sahip olsa bile Ayrıca, ayırma isteği sabitlenmiş tooa küme olmakla birlikte, istenen kaynak hello türü, küme tarafından desteklenmiyor, isteğiniz başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="4a869-119">Furthermore, if your allocation request is pinned tooa cluster but hello type of resource you requested is not supported by that cluster, your request will fail even if hello cluster has free resource.</span></span> <span data-ttu-id="4a869-120">Aşağıdaki diyagram 3 hello çalışması hello yalnızca adayı küme kaynakları serbest bırakmak olmadığından burada Sabitlenmiş ayırma başarısız gösterir.</span><span class="sxs-lookup"><span data-stu-id="4a869-120">Diagram 3 below illustrates hello case where a pinned allocation fails because hello only candidate cluster does not have free resources.</span></span> <span data-ttu-id="4a869-121">Diyagram 4 gösterir; burada Sabitlenmiş ayırma başarısız hello yalnızca adayı küme desteklemediğinden hello çalışması hello küme kaynakları serbest bırakmak olmasına rağmen hello istenen VM boyutu.</span><span class="sxs-lookup"><span data-stu-id="4a869-121">Diagram 4 illustrates hello case where a pinned allocation fails because hello only candidate cluster does not support hello requested VM size, even though hello cluster has free resources.</span></span>

![Sabitlenmiş ayırma hatası](./media/cloud-services-allocation-failure/Allocation2.png)

## <a name="troubleshooting-allocation-failure-for-cloud-services"></a><span data-ttu-id="4a869-123">Bulut Hizmetleri için sorun giderme ayırma hatası</span><span class="sxs-lookup"><span data-stu-id="4a869-123">Troubleshooting allocation failure for cloud services</span></span>
### <a name="error-message"></a><span data-ttu-id="4a869-124">Hata iletisi</span><span class="sxs-lookup"><span data-stu-id="4a869-124">Error Message</span></span>
<span data-ttu-id="4a869-125">Aşağıdaki hata iletisini hello görebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="4a869-125">You may see hello following error message:</span></span>

    "Azure operation '{operation id}' failed with code Compute.ConstrainedAllocationFailed. Details: Allocation failed; unable toosatisfy constraints in request. hello requested new service deployment is bound tooan Affinity Group, or it targets a Virtual Network, or there is an existing deployment under this hosted service. Any of these conditions constrains hello new deployment toospecific Azure resources. Please retry later or try reducing hello VM size or number of role instances. Alternatively, if possible, remove hello aforementioned constraints or try deploying tooa different region."

### <a name="common-issues"></a><span data-ttu-id="4a869-126">Yaygın Sorunlar</span><span class="sxs-lookup"><span data-stu-id="4a869-126">Common Issues</span></span>
<span data-ttu-id="4a869-127">Bir ayırma isteği toobe sabitlenmiş tooa tek küme neden hello ortak ayırma senaryolar verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="4a869-127">Here are hello common allocation scenarios that cause an allocation request toobe pinned tooa single cluster.</span></span>

* <span data-ttu-id="4a869-128">Bir bulut hizmeti her iki yuvada bir dağıtım varsa tooStaging yuva - dağıtma, ardından hello tüm bulut sabitlenmiş tooa belirli küme hizmetidir.</span><span class="sxs-lookup"><span data-stu-id="4a869-128">Deploying tooStaging Slot - If a cloud service has a deployment in either slot, then hello entire cloud service is pinned tooa specific cluster.</span></span>  <span data-ttu-id="4a869-129">Bu, zaten bir dağıtım hello üretim yuvasında zaten varsa, ardından yeni bir hazırlama dağıtımı yalnızca aynı hello üretim yuvasına küme hello tahsis edilebilir olduğunu anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="4a869-129">This means that if a deployment already exists in hello production slot, then a new staging deployment can only be allocated in hello same cluster as hello production slot.</span></span> <span data-ttu-id="4a869-130">Merhaba küme kapasitesine yaklaşıyor hello isteği başarısız olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a869-130">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="4a869-131">Ölçeklendirme - yeni örnekleri tooan mevcut bulut hizmetine eklenmesi gerekir tahsis hello aynı küme.</span><span class="sxs-lookup"><span data-stu-id="4a869-131">Scaling - Adding new instances tooan existing cloud service must allocate in hello same cluster.</span></span>  <span data-ttu-id="4a869-132">Küçük istekleri ölçekleme genellikle ayrılan, ancak her zaman değil.</span><span class="sxs-lookup"><span data-stu-id="4a869-132">Small scaling requests can usually be allocated, but not always.</span></span> <span data-ttu-id="4a869-133">Merhaba küme kapasitesine yaklaşıyor hello isteği başarısız olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a869-133">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="4a869-134">Merhaba bulut hizmeti sabitlenmiş tooan benzeşim grubu olmadıkça benzeşim grubu - hello yapıda bu bölgedeki herhangi bir küme tarafından yeni bir dağıtım tooan boş bulut hizmeti ayrılabilir.</span><span class="sxs-lookup"><span data-stu-id="4a869-134">Affinity Group - A new deployment tooan empty cloud service can be allocated by hello fabric in any cluster in that region, unless hello cloud service is pinned tooan affinity group.</span></span> <span data-ttu-id="4a869-135">Aynı benzeşim grubu üzerinde hello deneneceğini dağıtımları toohello aynı küme.</span><span class="sxs-lookup"><span data-stu-id="4a869-135">Deployments toohello same affinity group will be attempted on hello same cluster.</span></span> <span data-ttu-id="4a869-136">Merhaba küme kapasitesine yaklaşıyor hello isteği başarısız olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a869-136">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="4a869-137">Benzeşim grubu vNet - eski sanal ağları olan bölgeler yerine bağlı tooaffinity grupları ve bu sanal ağlar bulut Hizmetleri'nde sabitlenmiş toohello benzeşim grubu küme olacaktır.</span><span class="sxs-lookup"><span data-stu-id="4a869-137">Affinity Group vNet - Older Virtual Networks were tied tooaffinity groups instead of regions, and cloud services in these Virtual Networks would be pinned toohello affinity group cluster.</span></span> <span data-ttu-id="4a869-138">Sanal ağ dağıtımları toothis türü sabitlenmiş hello kümede denenir.</span><span class="sxs-lookup"><span data-stu-id="4a869-138">Deployments toothis type of virtual network will be attempted on hello pinned cluster.</span></span> <span data-ttu-id="4a869-139">Merhaba küme kapasitesine yaklaşıyor hello isteği başarısız olabilir.</span><span class="sxs-lookup"><span data-stu-id="4a869-139">If hello cluster is nearing capacity, hello request may fail.</span></span>

## <a name="solutions"></a><span data-ttu-id="4a869-140">Çözümler</span><span class="sxs-lookup"><span data-stu-id="4a869-140">Solutions</span></span>
1. <span data-ttu-id="4a869-141">Bu bölgedeki tüm küme hello platform toochoose verdiğinden dağıtın tooa yeni bulut - Bu çözüm büyük olasılıkla toobe en başarılı hizmetidir.</span><span class="sxs-lookup"><span data-stu-id="4a869-141">Redeploy tooa new cloud service - This solution is likely toobe most successful as it allows hello platform toochoose from all clusters in that region.</span></span>

   * <span data-ttu-id="4a869-142">Merhaba iş yükü tooa yeni bulut hizmeti dağıtma</span><span class="sxs-lookup"><span data-stu-id="4a869-142">Deploy hello workload tooa new cloud service</span></span>  
   * <span data-ttu-id="4a869-143">Merhaba CNAME veya bir kayıt toopoint trafiği toohello yeni bulut hizmeti güncelleştir</span><span class="sxs-lookup"><span data-stu-id="4a869-143">Update hello CNAME or A record toopoint traffic toohello new cloud service</span></span>
   * <span data-ttu-id="4a869-144">Sıfır trafiği toohello eski site geçiyor sonra hello eski bulut hizmeti silebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4a869-144">Once zero traffic is going toohello old site, you can delete hello old cloud service.</span></span> <span data-ttu-id="4a869-145">Bu çözüm, sıfır kapalı kalma süresi maruz.</span><span class="sxs-lookup"><span data-stu-id="4a869-145">This solution should incur zero downtime.</span></span>
2. <span data-ttu-id="4a869-146">Üretim ve hazırlama yuvası delete - Bu çözüm, var olan DNS adınızı korur ancak kapalı kalma süresi tooyour uygulama oluşturulmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="4a869-146">Delete both production and staging slots - This solution will preserve your existing DNS name, but will cause downtime tooyour application.</span></span>

   * <span data-ttu-id="4a869-147">Merhaba üretim ve böylece hello bulut hizmeti boştur var olan bir bulut hizmetini yuvaları hazırlama silin ve ardından</span><span class="sxs-lookup"><span data-stu-id="4a869-147">Delete hello production and staging slots of an existing cloud service so that hello cloud service is empty, and then</span></span>
   * <span data-ttu-id="4a869-148">Yeni bir dağıtımını hello mevcut bulut hizmeti oluşturun.</span><span class="sxs-lookup"><span data-stu-id="4a869-148">Create a new deployment in hello existing cloud service.</span></span> <span data-ttu-id="4a869-149">Bu tooallocation hello bölgedeki tüm kümelerde yeniden deneyecek.</span><span class="sxs-lookup"><span data-stu-id="4a869-149">This will re-attempt tooallocation on all clusters in hello region.</span></span> <span data-ttu-id="4a869-150">Merhaba bulut hizmetinin değil bağlı tooan benzeşim grubu olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="4a869-150">Ensure hello cloud service is not tied tooan affinity group.</span></span>
3. <span data-ttu-id="4a869-151">Ayrılmış IP - Bu çözüm korumak, var olan IP adresi, ancak kapalı kalma süresi tooyour uygulama oluşturulmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="4a869-151">Reserved IP -  This solution will preserve your existing IP address, but will cause downtime tooyour application.</span></span>  

   * <span data-ttu-id="4a869-152">Powershell kullanarak, varolan dağıtım için bir ReservedIP oluşturma</span><span class="sxs-lookup"><span data-stu-id="4a869-152">Create a ReservedIP for your existing deployment using Powershell</span></span>

     ```
     New-AzureReservedIP -ReservedIPName {new reserved IP name} -Location {location} -ServiceName {existing service name}
     ```
   * <span data-ttu-id="4a869-153">Yukarıdaki hello hizmetin CSCFG içinde yeni ReservedIP hello emin toospecify yapmadan #2 izleyin.</span><span class="sxs-lookup"><span data-stu-id="4a869-153">Follow #2 from above, making sure toospecify hello new ReservedIP in hello service's CSCFG.</span></span>
4. <span data-ttu-id="4a869-154">Yeni dağıtımlar - benzeşim grubunun benzeşim grupları artık önerilen kaldırın.</span><span class="sxs-lookup"><span data-stu-id="4a869-154">Remove affinity group for new deployments - Affinity Groups are no longer recommended.</span></span> <span data-ttu-id="4a869-155">#1 toodeploy yeni bir bulut hizmeti yukarıdaki adımları izleyin.</span><span class="sxs-lookup"><span data-stu-id="4a869-155">Follow steps for #1 above toodeploy a new cloud service.</span></span> <span data-ttu-id="4a869-156">Bulut hizmeti bir benzeşim grubunda değil emin olun.</span><span class="sxs-lookup"><span data-stu-id="4a869-156">Ensure cloud service is not in an affinity group.</span></span>
5. <span data-ttu-id="4a869-157">Tooa bölgesel sanal ağ - bakın Dönüştür [nasıl toomigrate benzeşim grupları tooa bölgesel sanal ağ (VNet) gelen](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="4a869-157">Convert tooa Regional Virtual Network - See [How toomigrate from Affinity Groups tooa Regional Virtual Network (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span></span>
