---
title: "Akış analizi için aaaJSON çıkış | Microsoft Docs"
description: "Stream Analytics Veri arşivleme ve düşük gecikme süreli sorguları yapılandırılmamış JSON verileri için JSON çıktı için Azure Cosmos DB nasıl hedefleyebilirsiniz öğrenin."
keywords: "JSON çıktısını"
documentationcenter: 
services: stream-analytics,documentdb
author: samacha
manager: jhubbard
editor: cgronlun
ms.assetid: 5d2a61a6-0dbf-4f1b-80af-60a80eb25dd1
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: samacha
ms.openlocfilehash: fa717818c839ecd7a60fcee33d22011990fd5878
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/06/2017
---
# <a name="target-azure-cosmos-db-for-json-output-from-stream-analytics"></a><span data-ttu-id="573a4-104">Hedef Azure Stream Analytics JSON çıktısını Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="573a4-104">Target Azure Cosmos DB for JSON output from Stream Analytics</span></span>
<span data-ttu-id="573a4-105">Akış analizi hedef [Azure Cosmos DB](https://azure.microsoft.com/services/documentdb/) veri arşivleme ve düşük gecikme süreli sorguları yapılandırılmamış JSON verileri JSON çıktısını için etkinleştirme.</span><span class="sxs-lookup"><span data-stu-id="573a4-105">Stream Analytics can target [Azure Cosmos DB](https://azure.microsoft.com/services/documentdb/) for JSON output, enabling data archiving and low-latency queries on unstructured JSON data.</span></span> <span data-ttu-id="573a4-106">Bu belgede, bu yapılandırmayı uygulamak için bazı en iyi yöntemler kapsar.</span><span class="sxs-lookup"><span data-stu-id="573a4-106">This document covers some best practices for implementing this configuration.</span></span>

<span data-ttu-id="573a4-107">Kişiler için Cosmos DB ile iyi tanımıyorsanız, bir göz atalım [Azure Cosmos veritabanı öğrenme yolu](https://azure.microsoft.com/documentation/learning-paths/documentdb/) tooget başlatıldı.</span><span class="sxs-lookup"><span data-stu-id="573a4-107">For those who are unfamiliar with Cosmos DB, take a look at [Azure Cosmos DB’s learning path](https://azure.microsoft.com/documentation/learning-paths/documentdb/) tooget started.</span></span> 

<span data-ttu-id="573a4-108">Not: Mongo DB API Cosmos DB dayalı koleksiyonlar şu anda desteklenmiyor.</span><span class="sxs-lookup"><span data-stu-id="573a4-108">Note: Mongo DB API based Cosmos DB collections is currently not supported.</span></span> 

## <a name="basics-of-cosmos-db-as-an-output-target"></a><span data-ttu-id="573a4-109">Cosmos DB bir çıktı hedefi olarak temelleri</span><span class="sxs-lookup"><span data-stu-id="573a4-109">Basics of Cosmos DB as an output target</span></span>
<span data-ttu-id="573a4-110">Hello Stream Analytics Azure Cosmos DB çıktısında sonuçları, Cosmos DB collection(s) JSON çıkış olarak işleme akışınızı yazılmasını etkinleştirir.</span><span class="sxs-lookup"><span data-stu-id="573a4-110">hello Azure Cosmos DB output in Stream Analytics enables writing your stream processing results as JSON output into your Cosmos DB collection(s).</span></span> <span data-ttu-id="573a4-111">Akış analizi oluşturmaz koleksiyonları veritabanınızda, bunun yerine, gerektiren toocreate bunları önceden.</span><span class="sxs-lookup"><span data-stu-id="573a4-111">Stream Analytics does not create collections in your database, instead requiring you toocreate them upfront.</span></span> <span data-ttu-id="573a4-112">Bu, böylelikle hello fatura maliyetleri Cosmos DB koleksiyonların saydam tooyou olan ve hello performansı ayarlamak için tutarlılık ve kapasite kullanarak doğrudan koleksiyonlarınızı hello [Cosmos DB API'leri](https://msdn.microsoft.com/library/azure/dn781481.aspx).</span><span class="sxs-lookup"><span data-stu-id="573a4-112">This is so that hello billing costs of Cosmos DB collections are transparent tooyou, and so that you can tune hello performance, consistency and capacity of your collections directly using hello [Cosmos DB APIs](https://msdn.microsoft.com/library/azure/dn781481.aspx).</span></span> <span data-ttu-id="573a4-113">Tek Cosmos DB iş toologically ayrı akış başına veritabanı kullanan koleksiyonunuz için bir iş akışında öneririz.</span><span class="sxs-lookup"><span data-stu-id="573a4-113">We recommend using one Cosmos DB Database per streaming job toologically separate your collections for a streaming job.</span></span>

<span data-ttu-id="573a4-114">Merhaba Cosmos DB toplama seçeneklerini bazıları aşağıda açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="573a4-114">Some of hello Cosmos DB collection options are detailed below.</span></span>

## <a name="tune-consistency-availability-and-latency"></a><span data-ttu-id="573a4-115">Tutarlılık, kullanılabilirlik ve gecikme süresini ayarlama</span><span class="sxs-lookup"><span data-stu-id="573a4-115">Tune consistency, availability, and latency</span></span>
<span data-ttu-id="573a4-116">toomatch uygulama gereksinimlerinizi Cosmos DB sağlar. toofine ayarlama hello veritabanı, koleksiyonlar ve yapma dengelemeler tutarlılık, kullanılabilirlik ve gecikme süresi arasında.</span><span class="sxs-lookup"><span data-stu-id="573a4-116">toomatch your application requirements, Cosmos DB allows you toofine tune hello database and collections and make trade-offs between consistency, availability and latency.</span></span> <span data-ttu-id="573a4-117">Hangi düzeyde okuma tutarlılığı bağlı olarak senaryo gereksinimlerinize göre okuma ve veritabanı hesabınızdaki tutarlılık düzeyi seçebilirsiniz gecikme, yazma.</span><span class="sxs-lookup"><span data-stu-id="573a4-117">Depending on what levels of read consistency your scenario needs against read and write latency, you can choose a consistency level on your database account.</span></span> <span data-ttu-id="573a4-118">Ayrıca varsayılan olarak, zaman uyumlu her CRUD işlemi tooyour koleksiyonu dizin Cosmos DB sağlar.</span><span class="sxs-lookup"><span data-stu-id="573a4-118">Also by default, Cosmos DB enables synchronous indexing on each CRUD operation tooyour collection.</span></span> <span data-ttu-id="573a4-119">Yazma/okuma performans Cosmos DB'de başka yararlı seçeneği toocontrol hello budur.</span><span class="sxs-lookup"><span data-stu-id="573a4-119">This is another useful option toocontrol hello write/read performance in Cosmos DB.</span></span> <span data-ttu-id="573a4-120">Bu konu hakkında daha fazla bilgi için hello gözden [, veritabanı ve sorgu tutarlılık düzeylerini değiştirme](../documentdb/documentdb-consistency-levels.md) makalesi.</span><span class="sxs-lookup"><span data-stu-id="573a4-120">For further information on this topic, review hello [change your database and query consistency levels](../documentdb/documentdb-consistency-levels.md) article.</span></span>

## <a name="upserts-from-stream-analytics"></a><span data-ttu-id="573a4-121">Stream analytics'ten Upserts</span><span class="sxs-lookup"><span data-stu-id="573a4-121">Upserts from Stream Analytics</span></span>
<span data-ttu-id="573a4-122">Stream Analytics tümleştirme Cosmos DB ile belirli bir belge kimliği sütununa dayalı Cosmos DB koleksiyonunuzdaki tooinsert veya güncelleştirme kayıtları sağlar.</span><span class="sxs-lookup"><span data-stu-id="573a4-122">Stream Analytics integration with Cosmos DB allows you tooinsert or update records in your Cosmos DB collection based on a given Document ID column.</span></span> <span data-ttu-id="573a4-123">Bu aynı zamanda başvurulan tooas olup bir *Upsert*.</span><span class="sxs-lookup"><span data-stu-id="573a4-123">This is also referred tooas an *Upsert*.</span></span>

<span data-ttu-id="573a4-124">Akış analizi Ekle tooa belge kimliği çakışması başarısız olduğunda burada güncelleştirmeleri yalnızca yapılır bir iyimser Upsert yaklaşımı kullanır.</span><span class="sxs-lookup"><span data-stu-id="573a4-124">Stream Analytics utilizes an optimistic Upsert approach, where updates are only done when insert fails due tooa Document ID conflict.</span></span> <span data-ttu-id="573a4-125">Bu güncelleştirme kısmi güncelleştirmeler toohello belge, yani yeni özellikleri veya mevcut bir özellik artımlı olarak gerçekleştirilen değiştirme eklenmesi tanır şekilde akış analizi tarafından bir düzeltme eki gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="573a4-125">This update is performed by Stream Analytics as a PATCH, so it enables partial updates toohello document, i.e. addition of new properties or replacing an existing property is performed incrementally.</span></span> <span data-ttu-id="573a4-126">Üzerine hello tüm dizisinde hello değerleri dizisi özellikleri JSON belgenize değişikliklerine neden, yani hello dizi olmayan birleştirilmiş dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="573a4-126">Note that changes in hello values of array properties in your JSON document result in hello entire array getting overwritten, i.e. hello array is not merged.</span></span>

## <a name="data-partitioning-in-cosmos-db"></a><span data-ttu-id="573a4-127">Cosmos DB'de veri bölümlendirme</span><span class="sxs-lookup"><span data-stu-id="573a4-127">Data partitioning in Cosmos DB</span></span>
<span data-ttu-id="573a4-128">Cosmos DB [bölümlenmiş koleksiyonlar](../cosmos-db/partition-data.md) önerilen verilerinizi bölümleme için yaklaşımı hello şunlardır.</span><span class="sxs-lookup"><span data-stu-id="573a4-128">Cosmos DB [partitioned collections](../cosmos-db/partition-data.md) are hello recommended approach for partitioning your data.</span></span> 

<span data-ttu-id="573a4-129">Tek Cosmos DB koleksiyonlar için Stream Analytics hala verileriniz hello sorgu desenlerine hem uygulamanızın performans gereksinimlerini temel toopartition sağlar.</span><span class="sxs-lookup"><span data-stu-id="573a4-129">For single Cosmos DB collections, Stream Analytics still allows you toopartition your data based on both hello query patterns and performance needs of your application.</span></span> <span data-ttu-id="573a4-130">Her (maksimum) verilerin ve şu anda too10GB yukarı hiçbir şekilde tooscale yoktur içeren (veya taşması) bir koleksiyon.</span><span class="sxs-lookup"><span data-stu-id="573a4-130">Each collection may contain up too10GB of data (maximum) and currently there is no way tooscale up (or overflow) a collection.</span></span> <span data-ttu-id="573a4-131">Ölçeğini için akış analizi, belirli bir önek toowrite toomultiple koleksiyonlarla sağlar (aşağıda kullanım ayrıntılarını bakın).</span><span class="sxs-lookup"><span data-stu-id="573a4-131">For scaling out, Stream Analytics allows you toowrite toomultiple collections with a given prefix (see usage details below).</span></span> <span data-ttu-id="573a4-132">Stream Analytics kullanır hello tutarlı [karma bölüm çözümleyici](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.partitioning.hashpartitionresolver.aspx) hello kullanıcıyı temel alarak stratejisi sağlanan PartitionKey sütun toopartition çıkış kayıtlarını.</span><span class="sxs-lookup"><span data-stu-id="573a4-132">Stream Analytics uses hello consistent [Hash Partition Resolver](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.partitioning.hashpartitionresolver.aspx) strategy based on hello user provided PartitionKey column toopartition its output records.</span></span> <span data-ttu-id="573a4-133">Merhaba önek işin başlangıç saati akış hello sırasında verilen hello koleksiyonlarla sayısı hello çıkış bölüm sayısı toowhich hello iş tooin paralel Yazar kullanılır (Cosmos DB koleksiyonları çıkış bölümleri =).</span><span class="sxs-lookup"><span data-stu-id="573a4-133">hello number of collections with hello given prefix at hello streaming job’s start time is used as hello output partition count, toowhich hello job writes tooin parallel (Cosmos DB Collections = Output Partitions).</span></span> <span data-ttu-id="573a4-134">Yavaş dizin ile tek bir koleksiyon için yalnızca eklemeleri yapılması, MB/sn üretilen iş yazma 0.4 hakkında beklenebilir.</span><span class="sxs-lookup"><span data-stu-id="573a4-134">For a single collection with lazy indexing doing only inserts, about 0.4 MB/s write throughput can be expected.</span></span> <span data-ttu-id="573a4-135">Birden çok koleksiyonları kullanarak, tooachieve daha yüksek verimlilik ve daha yüksek kapasite izin verebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="573a4-135">Using multiple collections can allow you tooachieve higher throughput and increased capacity.</span></span>

<span data-ttu-id="573a4-136">Merhaba gelecekteki tooincrease hello bölüm sayısı düşünüyorsanız, varolan koleksiyonlarınızı yeni Koleksiyonlar ve ardından yeniden hello Stream Analytics işi yeniden bölümle hello verileri işinizi toostop gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="573a4-136">If you intend tooincrease hello partition count in hello future, you may need toostop your job, repartition hello data from your existing collections into new collections and then restart hello Stream Analytics job.</span></span> <span data-ttu-id="573a4-137">Örnek kod ile birlikte yeniden bölümlendirme ve PartitionResolver kullanma hakkında daha fazla bilgi dahil izleme postasına edilir.</span><span class="sxs-lookup"><span data-stu-id="573a4-137">More details on using PartitionResolver and re-partitioning along with sample code, will be included in a follow-up post.</span></span> <span data-ttu-id="573a4-138">Merhaba makale [bölümleme ve Cosmos DB'de ölçeklendirme](../documentdb/documentdb-partition-data.md) de bu ayrıntıları sağlar.</span><span class="sxs-lookup"><span data-stu-id="573a4-138">hello article [Partitioning and scaling in Cosmos DB](../documentdb/documentdb-partition-data.md) also provides details on this.</span></span>

## <a name="cosmos-db-settings-for-json-output"></a><span data-ttu-id="573a4-139">JSON çıktısını cosmos DB ayarları</span><span class="sxs-lookup"><span data-stu-id="573a4-139">Cosmos DB settings for JSON output</span></span>
<span data-ttu-id="573a4-140">Stream Analytics bir çıkış olarak Cosmos DB oluşturma aşağıda görüldüğü gibi bilgileri için bir istem oluşturur.</span><span class="sxs-lookup"><span data-stu-id="573a4-140">Creating Cosmos DB as an output in Stream Analytics generates a prompt for information as seen below.</span></span> <span data-ttu-id="573a4-141">Bu bölümde hello özellikleri tanımının bir açıklama sağlar.</span><span class="sxs-lookup"><span data-stu-id="573a4-141">This section provides an explanation of hello properties definition.</span></span>

<span data-ttu-id="573a4-142">Bölümlenmiş koleksiyonu</span><span class="sxs-lookup"><span data-stu-id="573a4-142">Partitioned Collection</span></span> | <span data-ttu-id="573a4-143">Birden çok "Tek bölüm" koleksiyonları</span><span class="sxs-lookup"><span data-stu-id="573a4-143">Multiple “Single Partition” collections</span></span>
---|---
![documentdb stream analytics çıkış ekranı](media/stream-analytics-documentdb-output/stream-analytics-documentdb-output-1.png) |  ![documentdb stream analytics çıkış ekranı](media/stream-analytics-documentdb-output/stream-analytics-documentdb-output-2.png)


  
> [!NOTE]
> <span data-ttu-id="573a4-146">Merhaba **birden çok "Tek bölüm" koleksiyonları** senaryo bölüm anahtarı gerektirir ve desteklenen bir yapılandırmadır.</span><span class="sxs-lookup"><span data-stu-id="573a4-146">hello **Multiple “Single Partition” collections** scenario requires a partition key and is a supported configuration.</span></span> 

* <span data-ttu-id="573a4-147">**Diğer ad çıktı** – Bu çıktı ASA sorgunuzda bir diğer ad toorefer</span><span class="sxs-lookup"><span data-stu-id="573a4-147">**Output Alias** – An alias toorefer this output in your ASA query</span></span>  
* <span data-ttu-id="573a4-148">**Hesap adı** – hello adı veya bitiş noktası hello Cosmos DB hesap URI'si.</span><span class="sxs-lookup"><span data-stu-id="573a4-148">**Account Name** – hello name or endpoint URI of hello Cosmos DB account.</span></span>  
* <span data-ttu-id="573a4-149">**Anahtar hesap** – hello Cosmos DB hesap hello paylaşılan erişim anahtarı.</span><span class="sxs-lookup"><span data-stu-id="573a4-149">**Account Key** – hello shared access key for hello Cosmos DB account.</span></span>  
* <span data-ttu-id="573a4-150">**Veritabanı** – hello Cosmos DB veritabanı adı.</span><span class="sxs-lookup"><span data-stu-id="573a4-150">**Database** – hello Cosmos DB database name.</span></span>  
* <span data-ttu-id="573a4-151">**Koleksiyon adı deseni** – hello koleksiyon adı ya da kullanılan hello koleksiyonları toobe için kendi deseni.</span><span class="sxs-lookup"><span data-stu-id="573a4-151">**Collection Name Pattern** – hello collection name or their pattern for hello collections toobe used.</span></span> <span data-ttu-id="573a4-152">Merhaba koleksiyon adı biçimi, burada bölümlerin 0'dan başlar hello isteğe bağlı {partition} belirteci kullanılarak oluşturulabilir.</span><span class="sxs-lookup"><span data-stu-id="573a4-152">hello collection name format can be constructed using hello optional {partition} token, where partitions start from 0.</span></span> <span data-ttu-id="573a4-153">Örnek geçerli girişler şunlardır:</span><span class="sxs-lookup"><span data-stu-id="573a4-153">Following are sample valid inputs:</span></span>  
  <span data-ttu-id="573a4-154">1\) MyCollection – "MyCollection" adlı bir koleksiyon bulunmalıdır.</span><span class="sxs-lookup"><span data-stu-id="573a4-154">1\) MyCollection – One collection named “MyCollection” must exist.</span></span>  
  <span data-ttu-id="573a4-155">2\) – böyle koleksiyonları bulunmalıdır – MyCollection {partition} "MyCollection0", "MyCollection1", "MyCollection2" ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="573a4-155">2\) MyCollection{partition} – Such collections must exist– "MyCollection0”, “MyCollection1”, “MyCollection2” and so on.</span></span>  
* <span data-ttu-id="573a4-156">**Anahtar bölüm** – isteğe bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="573a4-156">**Partition Key** – Optional.</span></span> <span data-ttu-id="573a4-157">Bu, yalnızca, koleksiyon adı deseni {bölümlendirmesini} belirteci kullanıyorsanız gereklidir.</span><span class="sxs-lookup"><span data-stu-id="573a4-157">This is only needed if you are using a {parition} token in your collection name pattern.</span></span> <span data-ttu-id="573a4-158">çıkışın koleksiyonlar üzerinde bölümlenmesine için çıktı kullanılan olayları toospecify hello anahtar hello alanında Hello adı.</span><span class="sxs-lookup"><span data-stu-id="573a4-158">hello name of hello field in output events used toospecify hello key for partitioning output across collections.</span></span> <span data-ttu-id="573a4-159">Tek koleksiyon çıktı için herhangi bir rastgele çıkış sütunu olabilir örneğin PartitionID kullanılır.</span><span class="sxs-lookup"><span data-stu-id="573a4-159">For single collection output, any arbitrary output column can be used e.g. PartitionId.</span></span>  
* <span data-ttu-id="573a4-160">**Belge Kimliği** – isteğe bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="573a4-160">**Document ID** – Optional.</span></span> <span data-ttu-id="573a4-161">hangi ekleme veya güncelleştirme işlemleri dayalı toospecify hello birincil anahtar kullanılan çıkış olaylarındaki alanın hello Hello adı.</span><span class="sxs-lookup"><span data-stu-id="573a4-161">hello name of hello field in output events used toospecify hello primary key on which insert or update operations are based.</span></span>  
